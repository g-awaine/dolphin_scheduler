import{d as b,b7 as _,b8 as j,b9 as y,aL as F,a as d,u as W,bI as v,e as S,w as D,ba as L,c as t,t as k,be as O}from"./index.851b5188.js";import{u as p}from"./index.73124cc7.js";import{s as m}from"./service.4be3af67.js";import{C as R}from"./index.6c124806.js";import x from"./Graph.9ced834a.js";import{R as B}from"./index.c76e1268.js";import{R as z}from"./ReloadOutlined.bda43ab1.js";import{N as c}from"./Tooltip.52cb9ce9.js";import{N as V}from"./Space.f9ece73f.js";import{a as q}from"./Select.3e0f2c28.js";import{N as h}from"./Button.4e249408.js";import{N as g}from"./Icon.afc45566.js";import"./ui-setting.39219f0f.js";import"./lodash.68b7405b.js";import"./Card.19bc42e2.js";import"./resolve-slot.9e6a0162.js";import"./index.7a579f81.js";import"./keysOf.ab13e590.js";import"./index.8b7b126b.js";import"./Popover.30015336.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./_baseMap.9542141b.js";import"./get.aa32335f.js";import"./utils.f449ed5c.js";import"./format-length.d7d829b3.js";import"./use-merged-state.e40d3a9f.js";import"./use-compitable.ae5454ac.js";import"./next-frame-once.e5ee25e8.js";import"./is-browser.45c3bd93.js";import"./get-slot.80096ab3.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./use-locale.f8ac8f2c.js";import"./use-form-item.bb4d7ada.js";import"./Selection.28a32045.js";import"./Suffix.21a8a87f.js";import"./index.3ef69258.js";const $={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},E=y("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),I=[E],M=b({name:"EyeOutlined",render:function(l,s){return _(),j("svg",$,I)}});function A(e){return m({url:`/projects/${e.projectCode}/lineages/list`,method:"get"})}function G(e){return m({url:`/projects/${e.projectCode}/lineages/query-by-name`,method:"get"})}function T(e,l){return m({url:`/projects/${l.projectCode}/lineages/${e.workFlowCode}`,method:"get"})}function U(){const e=F({workflowOptions:[],workflow:d(null),seriesData:[],labelShow:d(!0),links:[]}),l=r=>{e.seriesData=[],e.links=[],e.seriesData=r.workFlowList.map(o=>({name:o.workFlowName,id:o.workFlowCode,...o})),e.links=r.workFlowRelationList.map(o=>({source:String(o.sourceWorkFlowCode),target:String(o.targetWorkFlowCode)}))};return{variables:e,getWorkflowName:r=>{const{state:o}=p(G({projectCode:r}).then(i=>{e.workflowOptions=i.map(n=>({label:n.workFlowName,value:n.workFlowCode}))}),{});return o},getOneWorkflow:(r,o)=>{const{state:i}=p(T({workFlowCode:r},{projectCode:o}).then(n=>{l(n)}),{});return i},getWorkflowList:r=>{const{state:o}=p(A({projectCode:r}).then(i=>{l(i)}),{});return o}}}const xe=b({name:"workflow-relation",setup(){const{t:e,locale:l}=W(),s=v(),{variables:a,getWorkflowName:f,getOneWorkflow:r,getWorkflowList:o}=U();S(()=>{o(Number(s.params.projectCode)),f(Number(s.params.projectCode))});const i=()=>{a.seriesData=[],a.workflow&&a.workflow!==0?r(Number(a.workflow),Number(s.params.projectCode)):o(Number(s.params.projectCode))},n=({node:w,option:u})=>k(c,null,{trigger:()=>w,default:()=>u.label}),C=(w,u)=>u.label?u.label.toString().toLowerCase().includes(w.toLowerCase()):!1,N=w=>{a.workflow=w};return D(()=>[a.workflow,a.labelShow,l.value],()=>{i()}),{t:e,handleResetDate:i,...L(a),renderOption:n,selectFilter:C,updateValue:N}},render(){const{t:e,handleResetDate:l}=this;return this.seriesData.length===0&&t(B,{title:e("project.workflow.workflow_relation_no_data_result_title"),description:e("project.workflow.workflow_relation_no_data_result_desc"),status:"info",size:"medium"},null)||this.seriesData.length>0&&t(R,{title:e("project.workflow.workflow_relation")},{default:()=>Object.keys(this.seriesData).length>0&&t(x,{seriesData:this.seriesData,labelShow:this.labelShow,links:this.links},null),"header-extra":()=>t(V,null,{default:()=>[k(q,{style:{width:"300px"},clearable:!0,filterable:!0,placeholder:e("project.workflow.workflow_name"),options:O(this.workflowOptions),value:this.workflow,filter:this.selectFilter,onUpdateValue:s=>{this.updateValue(s)}}),t(c,{trigger:"hover"},{default:()=>e("project.workflow.refresh"),trigger:()=>t(h,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:l},{default:()=>[t(g,null,{default:()=>[t(z,null,null)]})]})}),t(c,{trigger:"hover"},{default:()=>e("project.workflow.show_hide_label"),trigger:()=>t(h,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:()=>this.labelShow=!this.labelShow},{default:()=>[t(g,null,{default:()=>[t(M,null,null)]})]})})]})})}});export{xe as default};
