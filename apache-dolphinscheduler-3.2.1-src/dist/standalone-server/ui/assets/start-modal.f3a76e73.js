import{d as K,a as z,u as Y,bI as q,n as J,at as Q,e as X,w as Z,ba as P,c as e,t as M,F as $,al as ee}from"./index.851b5188.js";import{M as te}from"./index.e69e8738.js";import{u as ae,a as re}from"./use-modal.a8c92e75.js";import{A as O,a as A}from"./ArrowUpOutlined.284f08d8.js";import{P as x}from"./PlusCircleOutlined.b025a581.js";import{D as oe}from"./DeleteOutlined.07e1d3fe.js";import{N as S}from"./Icon.afc45566.js";import{N as le}from"./Form.9f7fa8c1.js";import{N as r}from"./FormItem.f5b3f80b.js";import{N as m}from"./RadioGroup.c3ead4f3.js";import{N as n}from"./Space.f9ece73f.js";import{N as s}from"./Radio.fc32ca3b.js";import{a as w}from"./Select.3e0f2c28.js";import{a as G}from"./Checkbox.98b84c16.js";import{N as U}from"./Input.79ba0d48.js";import{N as se}from"./RadioButton.cdb434b9.js";import{N as ne}from"./DatePicker.b69ef36a.js";import{N as R}from"./Button.4e249408.js";import{N as V}from"./Switch.f95d65b1.js";const ue="_startup_14f40_17",ie="_formItem_14f40_24",D={startup:ue,formItem:ie};function o(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!ee(l)}const de={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}},pe=K({name:"workflowDefinitionStart",props:de,emits:["update:show","update:row","updateList"],setup(l,f){var C;const h=z(!1),{t:u}=Y(),_=q(),{startState:d}=ae(),{variables:i,handleStartDefinition:v,getWorkerGroups:k,getTenantList:F,getAlertGroups:b,getEnvironmentList:y,getStartParamsList:j}=re(d,f),g=()=>{f.emit("update:show")},L=()=>{v(l.row.code,l.row.version)},N=()=>[{value:"NONE",label:u("project.workflow.none_send")},{value:"SUCCESS",label:u("project.workflow.success_send")},{value:"FAILURE",label:u("project.workflow.failure_send")},{value:"ALL",label:u("project.workflow.all_send")}],T=()=>[{value:"HIGHEST",label:"HIGHEST",color:"#ff0000",icon:O},{value:"HIGH",label:"HIGH",color:"#ff0000",icon:O},{value:"MEDIUM",label:"MEDIUM",color:"#EA7D24",icon:O},{value:"LOW",label:"LOW",color:"#2A8734",icon:A},{value:"LOWEST",label:"LOWEST",color:"#2A8734",icon:A}],a=J(()=>_.name==="workflow-definition-detail"),t=c=>[M(S,{style:{verticalAlign:"middle",marginRight:"4px",marginBottom:"3px"},color:c.color},{default:()=>M(c.icon)}),c.label],p=()=>{d.startForm.environmentCode=null},E=()=>{i.startParamsList.push({prop:"",value:""})},W=(c,I)=>{i.startParamsList[c].prop=I[0],i.startParamsList[c].value=I[1]},H=c=>{i.startParamsList.splice(c,1)},B=(C=Q())==null?void 0:C.appContext.config.globalProperties.trim;return X(()=>{k(),F(),b(),y()}),Z(()=>l.show,()=>{l.show&&(j(l.row.code),l.taskCode&&(d.startForm.startNodeList=l.taskCode))}),{t:u,showTaskDependType:a,parallelismRef:h,hideModal:g,handleStart:L,generalWarningTypeListOptions:N,generalPriorityList:T,renderLabel:t,updateWorkerGroup:p,removeStartParams:H,addStartParams:E,updateParamsList:W,...P(i),...P(d),...P(l),trim:B}},render(){let l,f,h,u,_,d,i,v,k,F,b,y,j,g,L,N,T;const{t:a}=this;return e(te,{show:this.show,title:a("project.workflow.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[e(le,{ref:"startFormRef",model:this.startForm,rules:this.rules},{default:()=>[e(r,{label:a("project.workflow.workflow_name"),path:"workflow_name"},{default:()=>[e("div",{class:D.formItem,title:this.row.name},[this.row.name])]}),e(r,{label:a("project.workflow.failure_strategy"),path:"failureStrategy"},{default:()=>[e(m,{value:this.startForm.failureStrategy,"onUpdate:value":t=>this.startForm.failureStrategy=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"CONTINUE"},o(l=a("project.workflow.continue"))?l:{default:()=>[l]}),e(s,{value:"END"},o(f=a("project.workflow.end"))?f:{default:()=>[f]})]})]})]}),this.showTaskDependType&&e(r,{label:a("project.workflow.node_execution"),path:"taskDependType"},{default:()=>[e(m,{value:this.startForm.taskDependType,"onUpdate:value":t=>this.startForm.taskDependType=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"TASK_POST"},o(h=a("project.workflow.backward_execution"))?h:{default:()=>[h]}),e(s,{value:"TASK_PRE"},o(u=a("project.workflow.forward_execution"))?u:{default:()=>[u]}),e(s,{value:"TASK_ONLY"},o(_=a("project.workflow.current_node_execution"))?_:{default:()=>[_]})]})]})]}),e(r,{label:a("project.workflow.notification_strategy"),path:"warningType"},{default:()=>[e(w,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":t=>this.startForm.warningType=t},null)]}),e(r,{label:a("project.workflow.workflow_priority"),path:"processInstancePriority"},{default:()=>[e(w,{options:this.generalPriorityList(),renderLabel:this.renderLabel,value:this.startForm.processInstancePriority,"onUpdate:value":t=>this.startForm.processInstancePriority=t},null)]}),e(r,{label:a("project.workflow.worker_group"),path:"workerGroup"},{default:()=>[e(w,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":t=>this.startForm.workerGroup=t},null)]}),e(r,{label:a("project.workflow.tenant_code"),path:"tenantCode"},{default:()=>[e(w,{options:this.tenantList,value:this.startForm.tenantCode,"onUpdate:value":t=>this.startForm.tenantCode=t},null)]}),e(r,{label:a("project.workflow.environment_name"),path:"environmentCode"},{default:()=>[e(w,{options:this.environmentList.filter(t=>{var p;return(p=t.workerGroups)==null?void 0:p.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":t=>this.startForm.environmentCode=t,clearable:!0},null)]}),this.startForm.warningType!=="NONE"&&e(r,{label:a("project.workflow.alarm_group"),path:"warningGroupId"},{default:()=>[e(w,{options:this.alertGroups,placeholder:a("project.workflow.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":t=>this.startForm.warningGroupId=t,clearable:!0},null)]}),e(r,{label:a("project.workflow.complement_data"),path:"complement_data"},{default:()=>[e(G,{checkedValue:"COMPLEMENT_DATA",uncheckedValue:"START_PROCESS",checked:this.startForm.execType,"onUpdate:checked":t=>this.startForm.execType=t},o(d=a("project.workflow.whether_complement_data"))?d:{default:()=>[d]})]}),this.startForm.execType&&this.startForm.execType!=="START_PROCESS"&&e(n,{vertical:!0,class:D["width-100"]},{default:()=>[e(r,{label:a("project.workflow.mode_of_dependent"),path:"complementDependentMode"},{default:()=>[e(m,{value:this.startForm.complementDependentMode,"onUpdate:value":t=>this.startForm.complementDependentMode=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"OFF_MODE"},o(i=a("project.workflow.close"))?i:{default:()=>[i]}),e(s,{value:"ALL_DEPENDENT"},o(v=a("project.workflow.open"))?v:{default:()=>[v]})]})]})]}),this.startForm.complementDependentMode==="ALL_DEPENDENT"&&e(r,{label:a("project.workflow.all_level_dependent"),path:"allLevelDependent"},{default:()=>[e(m,{value:this.startForm.allLevelDependent,"onUpdate:value":t=>this.startForm.allLevelDependent=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"false"},o(k=a("project.workflow.close"))?k:{default:()=>[k]}),e(s,{value:"true"},o(F=a("project.workflow.open"))?F:{default:()=>[F]})]})]})]}),e(r,{label:a("project.workflow.mode_of_execution"),path:"runMode"},{default:()=>[e(m,{value:this.startForm.runMode,"onUpdate:value":t=>this.startForm.runMode=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"RUN_MODE_SERIAL"},o(b=a("project.workflow.serial_execution"))?b:{default:()=>[b]}),e(s,{value:"RUN_MODE_PARALLEL"},o(y=a("project.workflow.parallel_execution"))?y:{default:()=>[y]})]})]})]}),this.startForm.runMode==="RUN_MODE_PARALLEL"&&e(r,{label:a("project.workflow.parallelism"),path:"expectedParallelismNumber"},{default:()=>[e(G,{checked:this.parallelismRef,"onUpdate:checked":t=>this.parallelismRef=t},o(j=a("project.workflow.custom_parallelism"))?j:{default:()=>[j]}),e(U,{allowInput:this.trim,disabled:!this.parallelismRef,placeholder:a("project.workflow.please_enter_parallelism"),value:this.startForm.expectedParallelismNumber,"onUpdate:value":t=>this.startForm.expectedParallelismNumber=t},null)]}),e(r,{label:a("project.workflow.order_of_execution"),path:"executionOrder"},{default:()=>[e(m,{value:this.startForm.executionOrder,"onUpdate:value":t=>this.startForm.executionOrder=t},{default:()=>[e(n,null,{default:()=>[e(s,{value:"DESC_ORDER"},o(g=a("project.workflow.descending_order"))?g:{default:()=>[g]}),e(s,{value:"ASC_ORDER"},o(L=a("project.workflow.ascending_order"))?L:{default:()=>[L]})]})]})]}),e(r,{label:a("project.workflow.schedule_date"),path:this.startForm.dataDateType===1?"startEndTime":"scheduleTime"},{default:()=>[e(n,{vertical:!0,class:D["width-100"]},{default:()=>[e(m,{name:"data-date",value:this.startForm.dataDateType,"onUpdate:value":t=>this.startForm.dataDateType=t},o(N=[{label:a("project.workflow.select_date"),value:1},{label:a("project.workflow.enter_date"),value:2}].map(t=>e(se,$(t,{key:t.value}),null)))?N:{default:()=>[N]}),this.startForm.dataDateType===1?e(ne,{type:"datetimerange",clearable:!0,value:this.startForm.startEndTime,"onUpdate:value":t=>this.startForm.startEndTime=t,placement:"top"},null):e(U,{allowInput:this.trim,clearable:!0,type:"textarea",value:this.startForm.scheduleTime,"onUpdate:value":t=>this.startForm.scheduleTime=t,placeholder:a("project.workflow.schedule_date_tips")},null)]})]})]}),e(r,{label:a("project.workflow.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?e(R,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[e(S,null,{default:()=>[e(x,null,null)]})]}):e(n,{vertical:!0},o(T=this.startParamsList.map((t,p)=>e(n,{class:D.startup,key:Date.now()+p},{default:()=>[e(U,{allowInput:this.trim,pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[t.prop,t.value],onUpdateValue:E=>this.updateParamsList(p,E)},null),e(R,{text:!0,type:"error",onClick:()=>this.removeStartParams(p),class:"btn-delete-custom-parameter"},{default:()=>[e(S,null,{default:()=>[e(oe,null,null)]})]}),e(R,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[e(S,null,{default:()=>[e(x,null,null)]})]})]})))?T:{default:()=>[T]})]}),e(r,{label:a("project.workflow.whether_dry_run"),path:"dryRun"},{default:()=>[e(V,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":t=>this.startForm.dryRun=t},null)]}),e(r,{label:a("project.workflow.whether_test"),path:"testFlag"},{default:()=>[e(V,{checkedValue:1,uncheckedValue:0,value:this.startForm.testFlag,"onUpdate:value":t=>this.startForm.testFlag=t},null)]})]})]})}}),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{pe as S,Pe as a,D as s};
