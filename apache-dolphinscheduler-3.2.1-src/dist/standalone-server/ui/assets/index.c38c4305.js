import{g as N,f as y,i as A,h as k,d as U,m as H,l as P,B as G,z as K,n as T,s as W,t as R,y as X,cs as J,a as f,e as j,$ as Q,A as Y,u as x,bt as q,aL as Z,bq as ee,at as te,w as re,ba as oe,c as l,al as ae}from"./index.851b5188.js";import{e as ie}from"./common.ee372ad3.js";import se from"./table-action.42e84339.js";import{B as ne}from"./index.8acb741a.js";import{c as le,D as ce,C as b}from"./column-width-config.4c11a147.js";import{u as I}from"./index.73124cc7.js";import{e as ue,v as me}from"./index.59799c67.js";import{N as pe}from"./Ellipsis.b13f7726.js";import{u as de}from"./file.74735815.js";import{C as B}from"./index.6c124806.js";import fe from"./index.a4ed002d.js";import he from"./index.ea05a57e.js";import ge from"./index.bad43cab.js";import{s as be}from"./index.module.9c9bd97f.js";import{S as ve}from"./index.94a7e931.js";import{N as ye}from"./ButtonGroup.90ec260c.js";import{S as Re}from"./SearchOutlined.3b9a5586.js";import{i as Ce}from"./is-browser.45c3bd93.js";import{a as Se}from"./resolve-slot.9e6a0162.js";import{N as z}from"./Space.f9ece73f.js";import{N as L}from"./Button.4e249408.js";import{N as Ne}from"./Icon.afc45566.js";import{N as _e,a as ke}from"./DataTable.0e9ec324.js";import"./lodash.68b7405b.js";import"./SettingOutlined.e20148d7.js";import"./PauseCircleOutlined.28d888d0.js";import"./CloseCircleOutlined.9e282d8c.js";import"./CheckCircleOutlined.67794958.js";import"./EditOutlined.e0b6da4a.js";import"./index.d671386a.js";import"./FormOutlined.42f04dba.js";import"./UploadOutlined.8bf7c13f.js";import"./DownloadOutlined.2b4ed5b8.js";import"./InfoCircleFilled.b53f03a6.js";import"./DeleteOutlined.07e1d3fe.js";import"./Tooltip.52cb9ce9.js";import"./Popover.30015336.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./_baseMap.9542141b.js";import"./get.aa32335f.js";import"./utils.f449ed5c.js";import"./format-length.d7d829b3.js";import"./use-merged-state.e40d3a9f.js";import"./use-compitable.ae5454ac.js";import"./next-frame-once.e5ee25e8.js";import"./Popconfirm.013915ef.js";import"./use-locale.f8ac8f2c.js";import"./keysOf.ab13e590.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./Card.19bc42e2.js";import"./index.7a579f81.js";import"./index.e69e8738.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./index.3ef69258.js";import"./Form.9f7fa8c1.js";import"./FormItem.f5b3f80b.js";import"./use-form-item.bb4d7ada.js";import"./Input.79ba0d48.js";import"./Suffix.21a8a87f.js";import"./get-slot.80096ab3.js";import"./Upload.62ae1afa.js";import"./Add.3164a73d.js";import"./Image.2f947741.js";import"./ArrowDown.45f9e719.js";import"./Checkbox.98b84c16.js";import"./RadioGroup.c3ead4f3.js";import"./Radio.fc32ca3b.js";import"./Dropdown.4af83811.js";import"./ChevronRight.d6536995.js";import"./Selection.28a32045.js";import"./use-keyboard.f4d2f0c0.js";import"./Select.3e0f2c28.js";import"./Forward.bddcd6d4.js";const ze=N("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[y("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),y("a",`
 color: inherit;
 text-decoration: inherit;
 `),N("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[N("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),y("&:not(:last-child)",[A("clickable",[k("link",`
 cursor: pointer;
 `,[y("&:hover",`
 background-color: var(--n-item-color-hover);
 `),y("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),k("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[y("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[N("icon",`
 color: var(--n-item-text-color-hover);
 `)]),y("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[N("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),k("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),y("&:last-child",[k("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[N("icon",`
 color: var(--n-item-text-color-active);
 `)]),k("separator",`
 display: none;
 `)])])]),E=X("n-breadcrumb"),Le=Object.assign(Object.assign({},P.props),{separator:{type:String,default:"/"}}),we=U({name:"Breadcrumb",props:Le,setup(e){const{mergedClsPrefixRef:r,inlineThemeDisabled:t}=H(e),u=P("Breadcrumb","-breadcrumb",ze,J,e,r);G(E,{separatorRef:K(e,"separator"),mergedClsPrefixRef:r});const o=T(()=>{const{common:{cubicBezierEaseInOut:m},self:{separatorColor:h,itemTextColor:p,itemTextColorHover:a,itemTextColorPressed:d,itemTextColorActive:i,fontSize:s,fontWeightActive:n,itemBorderRadius:g,itemColorHover:C,itemColorPressed:S,itemLineHeight:w}}=u.value;return{"--n-font-size":s,"--n-bezier":m,"--n-item-text-color":p,"--n-item-text-color-hover":a,"--n-item-text-color-pressed":d,"--n-item-text-color-active":i,"--n-separator-color":h,"--n-item-color-hover":C,"--n-item-color-pressed":S,"--n-item-border-radius":g,"--n-font-weight-active":n,"--n-item-line-height":w}}),c=t?W("breadcrumb",void 0,o,e):void 0;return{mergedClsPrefix:r,cssVars:t?void 0:o,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),R("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},R("ul",null,this.$slots))}}),Te=Ce?window:null,xe=(e=Te)=>{const r=()=>{const{hash:o,host:c,hostname:m,href:h,origin:p,pathname:a,port:d,protocol:i,search:s}=(e==null?void 0:e.location)||{};return{hash:o,host:c,hostname:m,href:h,origin:p,pathname:a,port:d,protocol:i,search:s}},t=()=>{u.value=r()},u=f(r());return j(()=>{e&&(e.addEventListener("popstate",t),e.addEventListener("hashchange",t))}),Q(()=>{e&&(e.removeEventListener("popstate",t),e.removeEventListener("hashchange",t))}),u},Ue={separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},Fe=U({name:"BreadcrumbItem",props:Ue,setup(e,{slots:r}){const t=Y(E,null);if(!t)return()=>null;const{separatorRef:u,mergedClsPrefixRef:o}=t,c=xe(),m=T(()=>e.href?"a":"span"),h=T(()=>c.value.href===e.href?"location":null);return()=>{const{value:p}=o;return R("li",{class:[`${p}-breadcrumb-item`,e.clickable&&`${p}-breadcrumb-item--clickable`]},R(m.value,{class:`${p}-breadcrumb-item__link`,"aria-current":h.value,href:e.href,onClick:e.onClick},r),R("span",{class:`${p}-breadcrumb-item__separator`,"aria-hidden":"true"},Se(r.separator,()=>{var a;return[(a=e.separator)!==null&&a!==void 0?a:u.value]})))}}});function Ie(e={}){return{getResourceListState:(u,o="",c="",m="",h=1,p=10)=>{const{state:a}=I(ue({fullName:o,tenantCode:c,type:u,searchVal:m,pageNo:h,pageSize:p}).then(d=>{const{total:i}=d;e(i);const s=d.totalList.map(n=>({id:n.id,name:n.alias,alias:n.alias,fullName:n.fullName,type:n.type,user_name:n.userName,directory:n.directory,file_name:n.fileName,size:n.size,create_time:n.createTime,update_time:n.updateTime}));return{total:i,table:s}}),{total:0,table:[]});return a},getResourceView:(u,o)=>{const c={skipLineNum:0,limit:3e3,fullName:u,tenantCode:o},{state:m}=I(me(c),{});return m}}}const Be=(e,r)=>{r.directory?e.push({name:r.type==="UDF"?"resource-sub-manage":"resource-file-subdirectory",query:{prefix:r.fullName,tenantCode:r.user_name}}):r.type==="FILE"&&e.push({name:"resource-file-list",query:{prefix:r.fullName,tenantCode:r.user_name}})};function De(){const{t:e}=x(),r=q(),t=Z({columns:[],fullName:f(String(r.currentRoute.value.query.prefix||"")),tenantCode:f(String(r.currentRoute.value.query.tenantCode||"")),resourceType:f(),resourceList:f(),folderShowRef:f(!1),uploadShowRef:f(!1),isReupload:f(!1),renameShowRef:f(!1),searchRef:f(),renameInfo:f({name:"",description:"",fullName:"",user_name:""}),reuploadInfo:f({name:"",description:"",fullName:"",user_name:""}),pagination:f({page:1,pageSize:10,itemCount:0,pageSizes:[10,30,50]})}),u=i=>{i.columns=[{title:"#",key:"id",...b.index,render:(s,n)=>n+1},{title:e("resource.file.name"),key:"name",...b.linkName,render:s=>s.directory?R(ne,{onClick:()=>Be(r,s)},{default:()=>R(pe,b.linkEllipsis,()=>s.alias)}):s.alias},{title:e("resource.file.tenant_name"),...b.userName,key:"user_name"},{title:e("resource.file.whether_directory"),key:"whether_directory",...b.yesOrNo,render:s=>s.directory?e("resource.file.yes"):e("resource.file.no")},{title:e("resource.file.file_name"),...b.name,key:"file_name"},{title:e("resource.file.size"),key:"size",...b.size,render:s=>ie(s.size)},{title:e("resource.file.create_time"),...b.time,key:"create_time"},{title:e("resource.file.update_time"),...b.time,key:"update_time"},{title:e("resource.file.operation"),key:"operation",render:s=>R(se,{row:s,onReuploadResource:(n,g,C,S)=>c(n,g,C,S),onRenameResource:(n,g,C,S)=>m(n,g,C,S),onUpdateList:()=>d()}),...b.operation(i.resourceType==="UDF"?4:5)}]},o=()=>{const{fullName:i}=t,s=i?"resource-subfile-create":"resource-file-create";r.push({name:s,params:{id:i}})},c=(i,s,n,g)=>{t.reuploadInfo={name:i,description:s,fullName:n,user_name:g},t.isReupload=!0,t.uploadShowRef=!0},m=(i,s,n,g)=>{t.renameInfo={name:i,description:s,fullName:n,user_name:g},t.renameShowRef=!0},h=i=>{t.pagination.itemCount=i},{getResourceListState:p}=Ie(h),a=()=>{t.resourceList=p(t.resourceType,t.fullName,t.tenantCode,t.searchRef,t.pagination.page,t.pagination.pageSize)},d=()=>{t.pagination.page=1,a()};return{variables:t,tableWidth:le(t.columns)||ce,requestData:a,updateList:d,createColumns:u,handleCreateFile:o}}function D(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ae(e)}const Pe={resourceType:{type:String,default:void 0}},lr=U({name:"ResourceList",props:Pe,setup(e){var F;const r=q(),t=de(),u=f(),{variables:o,tableWidth:c,requestData:m,updateList:h,createColumns:p,handleCreateFile:a}=De(),d=ee();o.resourceType=e.resourceType;const i=v=>{o.pagination.page=v,m()},s=v=>{o.pagination.page=1,o.pagination.pageSize=v,m()},n=()=>{m()},g=()=>{o.folderShowRef=!0},C=()=>{o.isReupload=!1,o.uploadShowRef=!0},S=()=>{o.renameShowRef=!0};j(()=>{p(o),t.setCurrentDir(o.fullName),u.value=t.getCurrentDir.replace(/\/+$/g,"").split("/").slice(2),m()});const w=(F=te())==null?void 0:F.appContext.config.globalProperties.trim,O=v=>{const _=o.fullName.split("/").slice(0,v+3).join("/")+"/";$(_)},$=v=>{const{resourceType:_,tenantCode:M}=o,V=_==="UDF"?d.getBaseUdfDir:d.getBaseResDir;v===""||!v.startsWith(V)?r.push({name:_==="UDF"?"resource-manage":"file-manage"}):r.push({name:_==="UDF"?"resource-sub-manage":"resource-file-subdirectory",query:{prefix:v,tenantCode:M}})};return re(x().locale,()=>{p(o)}),{breadListRef:u,tableWidth:c,updateList:h,handleConditions:n,handleCreateFolder:g,handleCreateFile:a,handleUploadFile:C,handleRenameFile:S,handleUpdatePage:i,handleUpdatePageSize:s,handleBread:O,trim:w,...oe(o)}},render(){let e,r;const{t}=x(),{handleConditions:u,handleCreateFolder:o,handleCreateFile:c,handleUploadFile:m,tableWidth:h}=this,p=this.resourceType==="UDF"?t("resource.udf.udf_resources"):t("resource.file.file_manage");return l(z,{vertical:!0},{default:()=>[l(B,null,{default:()=>[l(z,{justify:"space-between"},{default:()=>[l(ye,{size:"small"},{default:()=>[l(L,{type:"primary",onClick:o,class:"btn-create-directory"},D(e=t("resource.file.create_folder"))?e:{default:()=>[e]}),this.resourceType!=="UDF"&&l(L,{onClick:c,class:"btn-create-file"},D(r=t("resource.file.create_file"))?r:{default:()=>[r]}),l(L,{onClick:m,class:"btn-upload-resource"},{default:()=>[this.resourceType==="UDF"?t("resource.udf.upload_udf_resources"):t("resource.file.upload_files")]})]}),l(z,null,{default:()=>[l(ve,{placeholder:t("resource.file.enter_keyword_tips"),value:this.searchRef,"onUpdate:value":a=>this.searchRef=a,onSearch:u},null),l(L,{size:"small",type:"primary",onClick:u},{default:()=>[l(Ne,null,{default:()=>[l(Re,null,null)]})]})]})]})]}),l(B,{title:p},{header:()=>l(we,{separator:">"},{default:()=>{var a;return[(a=this.breadListRef)==null?void 0:a.map((d,i)=>l(Fe,null,{default:()=>[l(L,{text:!0,disabled:i>0&&i===this.breadListRef.length-1,onClick:()=>this.handleBread(i)},{default:()=>[i===0?p:d]})]}))]}}),default:()=>l(z,{vertical:!0},{default:()=>{var a;return[l(_e,{remote:!0,columns:this.columns,data:(a=this.resourceList)==null?void 0:a.table,striped:!0,size:"small",class:be["table-box"],"row-class-name":"items",scrollX:h},null),l(z,{justify:"center"},{default:()=>[l(ke,{page:this.pagination.page,"onUpdate:page":d=>this.pagination.page=d,pageSize:this.pagination.pageSize,"onUpdate:pageSize":d=>this.pagination.pageSize=d,pageSizes:this.pagination.pageSizes,"item-count":this.pagination.itemCount,onUpdatePage:this.handleUpdatePage,onUpdatePageSize:this.handleUpdatePageSize,"show-quick-jumper":!0,"show-size-picker":!0},null)]})]}})}),l(fe,{show:this.folderShowRef,"onUpdate:show":a=>this.folderShowRef=a,resourceType:this.resourceType,onUpdateList:this.updateList},null),l(he,{show:this.uploadShowRef,"onUpdate:show":a=>this.uploadShowRef=a,isReupload:this.isReupload,resourceType:this.resourceType,name:this.reuploadInfo.name,fullName:this.reuploadInfo.fullName,description:this.reuploadInfo.description,userName:this.reuploadInfo.user_name,onUpdateList:this.updateList},null),l(ge,{show:this.renameShowRef,"onUpdate:show":a=>this.renameShowRef=a,resourceType:this.resourceType,name:this.renameInfo.name,fullName:this.renameInfo.fullName,description:this.renameInfo.description,userName:this.renameInfo.user_name,onUpdateList:this.updateList},null)]})}});export{lr as default};
