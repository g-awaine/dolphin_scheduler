import{d as P,u as G,at as I,e as U,w as O,ba as p,c as t,al as V}from"./index.851b5188.js";import{M}from"./index.e69e8738.js";import{useStart as R}from"./use-start.52d38fd8.js";import{P as h}from"./PlusCircleOutlined.b025a581.js";import{D as T}from"./DeleteOutlined.07e1d3fe.js";import{N as D}from"./Form.9f7fa8c1.js";import{N as s}from"./FormItem.f5b3f80b.js";import{a as i}from"./Select.3e0f2c28.js";import{N as m}from"./Button.4e249408.js";import{N as u}from"./Icon.afc45566.js";import{N as f}from"./Space.f9ece73f.js";import{N as W}from"./Input.79ba0d48.js";import{N as E}from"./Switch.f95d65b1.js";import"./index.8acb741a.js";import"./keysOf.ab13e590.js";import"./Card.19bc42e2.js";import"./resolve-slot.9e6a0162.js";import"./index.7a579f81.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./utils.f449ed5c.js";import"./is-browser.45c3bd93.js";import"./index.3ef69258.js";import"./index.18b4303b.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./lodash.68b7405b.js";import"./index.23da2c90.js";import"./index.2d754617.js";import"./index.57e264b5.js";import"./index.71fea87c.js";import"./index.b3847370.js";import"./use-form-item.bb4d7ada.js";import"./format-length.d7d829b3.js";import"./get.aa32335f.js";import"./use-merged-state.e40d3a9f.js";import"./use-locale.f8ac8f2c.js";import"./use-compitable.ae5454ac.js";import"./Selection.28a32045.js";import"./Popover.30015336.js";import"./_baseMap.9542141b.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.21a8a87f.js";import"./get-slot.80096ab3.js";function A(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!V(r)}const B={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}},Dt=P({name:"task-definition-start",props:B,emits:["update:show","update:row","updateList"],setup(r,o){var d;const{t:e}=G(),{variables:a,handleStartDefinition:n,getWorkerGroups:k,getTenantList:v,getAlertGroups:w,getEnvironmentList:g,getStartParamsList:S}=R(o),b=()=>[{value:"NONE",label:e("project.task.none_send")},{value:"SUCCESS",label:e("project.task.success_send")},{value:"FAILURE",label:e("project.task.failure_send")},{value:"ALL",label:e("project.task.all_send")}],y=()=>{o.emit("update:show")},C=()=>{n(r.row.taskCode)},N=()=>{a.startForm.environmentCode=null},_=()=>{a.startState.startParamsList.push({prop:"",value:""})},L=(l,c)=>{a.startState.startParamsList[l].prop=c[0],a.startState.startParamsList[l].value=c[1]},F=l=>{a.startState.startParamsList.splice(l,1)},j=(d=I())==null?void 0:d.appContext.config.globalProperties.trim;return U(()=>{k(),v(),w(),g()}),O(()=>r.show,()=>{r.show&&S(r.row.processDefinitionCode)}),{t:e,hideModal:y,handleStart:C,updateWorkerGroup:N,removeStartParams:F,addStartParams:_,updateParamsList:L,generalWarningTypeListOptions:b,...p(a),...p(a.startState),...p(r),trim:j}},render(){let r;const{t:o}=this;return t(M,{show:this.show,title:o("project.task.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[t(D,{ref:"startFormRef",model:this.startForm},{default:()=>[t(s,{label:o("project.task.task_name"),path:"task_name"},{default:()=>[t("div",{title:this.row.taskName},[this.row.taskName])]}),t(s,{label:o("project.task.notification_strategy"),path:"warningType"},{default:()=>[t(i,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":e=>this.startForm.warningType=e},null)]}),t(s,{label:o("project.task.worker_group"),path:"workerGroup"},{default:()=>[t(i,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":e=>this.startForm.workerGroup=e},null)]}),t(s,{label:o("project.task.tenant_code"),path:"tenantCode"},{default:()=>[t(i,{options:this.tenantList,value:this.startForm.tenantCode,"onUpdate:value":e=>this.startForm.tenantCode=e},null)]}),t(s,{label:o("project.task.environment_name"),path:"environmentCode"},{default:()=>[t(i,{options:this.environmentList.filter(e=>{var a;return(a=e.workerGroups)==null?void 0:a.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":e=>this.startForm.environmentCode=e,clearable:!0},null)]}),t(s,{label:o("project.task.alarm_group"),path:"warningGroupId"},{default:()=>[t(i,{options:this.alertGroups,placeholder:o("project.task.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":e=>this.startForm.warningGroupId=e,clearable:!0},null)]}),t(s,{label:o("project.task.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?t(m,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[t(u,null,{default:()=>[t(h,null,null)]})]}):t(f,{vertical:!0},A(r=this.startParamsList.map((e,a)=>t(f,{key:Date.now()+a},{default:()=>[t(W,{allowInput:this.trim,pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[e.prop,e.value],onUpdateValue:n=>this.updateParamsList(a,n)},null),t(m,{text:!0,type:"error",onClick:()=>this.removeStartParams(a),class:"btn-delete-custom-parameter"},{default:()=>[t(u,null,{default:()=>[t(T,null,null)]})]}),t(m,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[t(u,null,{default:()=>[t(h,null,null)]})]})]})))?r:{default:()=>[r]})]}),t(s,{label:o("project.task.whether_dry_run"),path:"dryRun"},{default:()=>[t(E,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":e=>this.startForm.dryRun=e},null)]})]})]})}});export{Dt as default};
