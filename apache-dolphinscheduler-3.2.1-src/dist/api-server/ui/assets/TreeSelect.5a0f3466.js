import{d as we,t as v,bB as Zn,aq as Jn,bP as Dn,ap as et,as as nt,y as Pn,A as Ie,Y as tt,Z as lt,N as at,a as F,v as un,_ as X,n as E,e as it,a1 as ot,ac as rt,g as A,f as ge,i as z,bQ as Sn,h as pe,Q as Ve,a2 as fn,m as An,U as dt,l as nn,R as He,z as T,w as Je,B as En,s as Ln,J as hn,K as st,T as ct,G as ut}from"./index.851b5188.js";import{a as ft}from"./Checkbox.98b84c16.js";import{i as ht}from"./is-browser.45c3bd93.js";import{h as gn,V as gt,N as On,c as In,f as Rn,a as vt,u as yt,b as mt,F as bt}from"./Selection.28a32045.js";import{p as kt,g as xt}from"./index.7a579f81.js";import{u as Fe}from"./use-merged-state.e40d3a9f.js";import{X as Cn,g as pt}from"./Scrollbar.7a99b971.js";import{a as Bn,c as I,r as wt}from"./resolve-slot.9e6a0162.js";import{f as St}from"./fade-in-scale-up.cssr.5737b1c6.js";import{u as Rt}from"./use-locale.f8ac8f2c.js";import{u as Ct}from"./use-form-item.bb4d7ada.js";import{c as Kt}from"./index.e739cd60.js";import{m as Nt}from"./index.3ef69258.js";import{u as vn,V as Tt,d as Ft,e as Dt}from"./Popover.30015336.js";function _n(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const Pt=we({name:"Switcher",render(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},v("path",{d:"M12 8l10 8l-10 8z"}))}}),At=e=>{const{popoverColor:t,boxShadow2:d,borderRadius:s,heightMedium:r,dividerColor:f,textColor2:b}=e;return{menuPadding:"4px",menuColor:t,menuBoxShadow:d,menuBorderRadius:s,menuHeight:`calc(${r} * 7.6)`,actionDividerColor:f,actionTextColor:b,actionPadding:"8px 12px"}},Et=Zn({name:"TreeSelect",common:Jn,peers:{Tree:Dn,Empty:et,InternalSelection:nt},self:At}),Lt=Et,yn=Pn("n-tree-select"),qe=Pn("n-tree"),Ot=we({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},expanded:Boolean,hide:Boolean,loading:Boolean,onClick:Function},setup(e){const{renderSwitcherIconRef:t}=Ie(qe,null);return()=>{const{clsPrefix:d}=e;return v("span",{"data-switcher":!0,class:[`${d}-tree-node-switcher`,{[`${d}-tree-node-switcher--expanded`]:e.expanded,[`${d}-tree-node-switcher--hide`]:e.hide}],onClick:e.onClick},v("div",{class:`${d}-tree-node-switcher__icon`},v(tt,null,{default:()=>{if(e.loading)return v(lt,{clsPrefix:d,key:"loading",radius:85,strokeWidth:20});const{value:s}=t;return s?s():v(at,{clsPrefix:d,key:"switcher"},{default:()=>v(Pt,null)})}})))}}}),It=we({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ie(qe);function d(r){const{onCheck:f}=e;if(f)return f(r)}function s(r){e.indeterminate?d(!1):d(r)}return{handleUpdateValue:s,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:d,indeterminate:s,disabled:r,focusable:f,handleUpdateValue:b}=this;return v("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],"data-checkbox":!0},v(ft,{focusable:f,disabled:r,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:d,indeterminate:s,onUpdateChecked:b}))}}),Bt=we({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:d,renderSuffixRef:s,labelFieldRef:r}=Ie(qe),f=F(null);function b(m){const{onClick:w}=e;w&&w(m)}function k(m){b(m)}return{selfRef:f,renderLabel:t,renderPrefix:d,renderSuffix:s,labelField:r,handleClick:k}},render(){const{clsPrefix:e,labelField:t,nodeProps:d,checked:s=!1,selected:r=!1,renderLabel:f,renderPrefix:b,renderSuffix:k,handleClick:m,onDragstart:w,tmNode:{rawNode:y,rawNode:{prefix:K,suffix:S,[t]:h}}}=this;return v("span",Object.assign({},d,{ref:"selfRef",class:[`${e}-tree-node-content`,d==null?void 0:d.class],onClick:m,draggable:w===void 0?void 0:!0,onDragstart:w}),b||K?v("div",{class:`${e}-tree-node-content__prefix`},b?b({option:y,selected:r,checked:s}):un(K)):null,v("div",{class:`${e}-tree-node-content__text`},f?f({option:y,selected:r,checked:s}):un(h)),k||S?v("div",{class:`${e}-tree-node-content__suffix`},k?k({option:y,selected:r,checked:s}):un(S)):null)}});function Kn({position:e,offsetLevel:t,indent:d,el:s}){const r={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const f=e==="before"?"top":"bottom";r[f]=0,r.left=`${s.offsetLeft+6-t*d}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=f,r.borderRadius="1px",r.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return v("div",{style:r})}function _t({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function xe(e,t){return!!e.rawNode[t]}function Un(e,t,d,s){e==null||e.forEach(r=>{d(r),Un(r[t],t,d,s),s(r)})}function Ut(e,t,d,s,r){const f=new Set,b=new Set,k=[];return Un(e,s,m=>{if(k.push(m),r(t,m)){b.add(m[d]);for(let w=k.length-2;w>=0;--w)if(!f.has(k[w][d]))f.add(k[w][d]);else return}},()=>{k.pop()}),{expandedKeys:Array.from(f),highlightKeySet:b}}const Nn=null;if(ht&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Mt(e,t,d,s,r){const f=new Set,b=new Set,k=new Set,m=[],w=[],y=[];function K(h){h.forEach(R=>{if(y.push(R),t(d,R)){f.add(R[s]),k.add(R[s]);for(let L=y.length-2;L>=0;--L){const U=y[L][s];if(!b.has(U))b.add(U),f.has(U)&&f.delete(U);else break}}const C=R[r];C&&K(C),y.pop()})}K(e);function S(h,R){h.forEach(C=>{const L=C[s],U=f.has(L),D=b.has(L);if(!U&&!D)return;const j=C[r];if(j)if(U)R.push(C);else{m.push(L);const W=Object.assign(Object.assign({},C),{[r]:[]});R.push(W),S(j,W[r])}else R.push(C)})}return S(e,w),{filteredTree:w,highlightKeySet:k,expandedKeys:m}}const $t=we({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ie(qe),{droppingNodeParentRef:d,droppingMouseNodeRef:s,draggingNodeRef:r,droppingPositionRef:f,droppingOffsetLevelRef:b,nodePropsRef:k,indentRef:m,blockLineRef:w,checkboxPlacementRef:y,checkOnClickRef:K,disabledFieldRef:S}=t,h=X(()=>!!e.tmNode.rawNode.checkboxDisabled),R=X(()=>xe(e.tmNode,S.value)),C=X(()=>t.disabledRef.value||R.value),L=E(()=>{const{value:c}=k;if(!!c)return c({option:e.tmNode.rawNode})}),U=F(null),D={value:null};it(()=>{D.value=U.value.$el});function j(){const{tmNode:c}=e;if(!c.isLeaf&&!c.shallowLoaded){if(!t.loadingKeysRef.value.has(c.key))t.loadingKeysRef.value.add(c.key);else return;const{onLoadRef:{value:N}}=t;N&&N(c.rawNode).then(()=>{t.handleSwitcherClick(c)}).finally(()=>{t.loadingKeysRef.value.delete(c.key)})}else t.handleSwitcherClick(c)}const W=X(()=>!R.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),V=X(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),ne=X(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),fe=X(()=>{const{value:c}=V;if(!c)return!1;const{value:N}=K;return typeof N=="boolean"?N:N(e.tmNode.rawNode)});function ae(c){const{value:N}=t.expandOnClickRef,{value:_}=W,{value:ye}=fe;if(!_&&!N&&!ye||gn(c,"checkbox")||gn(c,"switcher"))return;const{tmNode:te}=e;_&&t.handleSelect(te),N&&!te.isLeaf&&j(),ye&&re(!ne.value)}function ie(c){var N,_;w.value||(C.value||ae(c),(_=(N=L.value)===null||N===void 0?void 0:N.onClick)===null||_===void 0||_.call(N,c))}function ve(c){var N,_;!w.value||(C.value||ae(c),(_=(N=L.value)===null||N===void 0?void 0:N.onClick)===null||_===void 0||_.call(N,c))}function re(c){t.handleCheck(e.tmNode,c)}function De(c){t.handleDragStart({event:c,node:e.tmNode})}function Y(c){c.currentTarget===c.target&&t.handleDragEnter({event:c,node:e.tmNode})}function de(c){c.preventDefault(),t.handleDragOver({event:c,node:e.tmNode})}function G(c){t.handleDragEnd({event:c,node:e.tmNode})}function Be(c){c.currentTarget===c.target&&t.handleDragLeave({event:c,node:e.tmNode})}function Z(c){c.preventDefault(),f.value!==null&&t.handleDrop({event:c,node:e.tmNode,dropPosition:f.value})}return{showDropMark:X(()=>{const{value:c}=r;if(!c)return;const{value:N}=f;if(!N)return;const{value:_}=s;if(!_)return;const{tmNode:ye}=e;return ye.key===_.key}),showDropMarkAsParent:X(()=>{const{value:c}=d;if(!c)return!1;const{tmNode:N}=e,{value:_}=f;return _==="before"||_==="after"?c.key===N.key:!1}),pending:X(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:X(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:X(()=>{var c;return(c=t.highlightKeySetRef.value)===null||c===void 0?void 0:c.has(e.tmNode.key)}),checked:ne,indeterminate:X(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:X(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:X(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:C,checkable:V,mergedCheckOnClick:fe,checkboxDisabled:h,selectable:W,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:w,nodeProps:L,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:f,droppingOffsetLevel:b,indent:m,checkboxPlacement:y,contentInstRef:U,contentElRef:D,handleCheck:re,handleDrop:Z,handleDragStart:De,handleDragEnter:Y,handleDragOver:de,handleDragEnd:G,handleDragLeave:Be,handleLineClick:ve,handleContentClick:ie,handleSwitcherClick:j}},render(){const{tmNode:e,clsPrefix:t,checkable:d,expandOnClick:s,selectable:r,selected:f,checked:b,highlight:k,draggable:m,blockLine:w,indent:y,disabled:K,pending:S,internalScrollable:h,nodeProps:R,checkboxPlacement:C}=this,L=m&&!K?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,U=h?_n(e.key):void 0,D=C==="right",j=d?v(It,{right:D,focusable:this.checkboxFocusable,disabled:K||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return v("div",Object.assign({class:`${t}-tree-node-wrapper`},L),v("div",Object.assign({},w?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:f,[`${t}-tree-node--checkable`]:d,[`${t}-tree-node--highlight`]:k,[`${t}-tree-node--pending`]:S,[`${t}-tree-node--disabled`]:K,[`${t}-tree-node--selectable`]:r,[`${t}-tree-node--clickable`]:r||s||this.mergedCheckOnClick},R==null?void 0:R.class],"data-key":U,draggable:m&&w,onClick:this.handleLineClick,onDragstart:m&&w&&!K?this.handleDragStart:void 0}),ot(e.level,v("div",{class:`${t}-tree-node-indent`},v("div",{style:{width:`${y}px`}}))),v(Ot,{clsPrefix:t,expanded:this.expanded,loading:this.loading,hide:e.isLeaf,onClick:this.handleSwitcherClick}),D?null:j,v(Bt,{ref:"contentInstRef",clsPrefix:t,checked:b,selected:f,onClick:this.handleContentClick,nodeProps:w?void 0:R,onDragstart:m&&!w&&!K?this.handleDragStart:void 0,tmNode:e}),m?this.showDropMark?Kn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:y}):this.showDropMarkAsParent?Kn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:y}):null:null,D?j:null))}}),Mn=$t;function zt({props:e,fNodesRef:t,mergedExpandedKeysRef:d,mergedSelectedKeysRef:s,handleSelect:r,handleSwitcherClick:f}){const{value:b}=s,k=Ie(yn,null),m=k?k.pendingNodeKeyRef:F(b.length?b[b.length-1]:null);function w(y){if(!e.keyboard)return;const{value:K}=m;if(K===null){if((y.key==="ArrowDown"||y.key==="ArrowUp")&&y.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(y.key)&&K===null){const{value:S}=t;let h=0;for(;h<S.length;){if(!S[h].disabled){m.value=S[h].key;break}h+=1}}}else{const{value:S}=t;let h=S.findIndex(R=>R.key===K);if(!~h)return;if(y.key==="Enter")r(S[h]);else if(y.key==="ArrowDown")for(y.preventDefault(),h+=1;h<S.length;){if(!S[h].disabled){m.value=S[h].key;break}h+=1}else if(y.key==="ArrowUp")for(y.preventDefault(),h-=1;h>=0;){if(!S[h].disabled){m.value=S[h].key;break}h-=1}else if(y.key==="ArrowLeft"){const R=S[h];if(R.isLeaf||!d.value.includes(K)){const C=R.getParent();C&&(m.value=C.key)}else f(R)}else if(y.key==="ArrowRight"){const R=S[h];if(R.isLeaf)return;if(!d.value.includes(K))f(R);else for(h+=1;h<S.length;){if(!S[h].disabled){m.value=S[h].key;break}h+=1}}}}return{pendingNodeKeyRef:m,handleKeydown:w}}const jt=we({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return v(rt,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>v("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:kt(this.height)}},this.nodes.map(t=>v(Mn,{clsPrefix:e,tmNode:t})))})}}),Vt=A("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[ge("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),ge(">",[A("tree-node",[ge("&:first-child",{marginTop:0})])]),A("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 height: 0;
 `),A("tree-motion-wrapper",[z("expand",[Sn({duration:"0.2s"})]),z("collapse",[Sn({duration:"0.2s",reverse:!0})])]),A("tree-node-wrapper",`
 box-sizing: border-box;
 padding: 3px 0;
 `),A("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[z("highlight",[A("tree-node-content",[pe("text",{borderBottomColor:"var(--n-node-text-color-disabled)"})])]),z("disabled",[A("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),Ve("disabled",[z("clickable",[A("tree-node-content",`
 cursor: pointer;
 `)])])]),z("block-node",[A("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),Ve("block-line",[A("tree-node",[Ve("disabled",[A("tree-node-content",[ge("&:hover",{backgroundColor:"var(--n-node-color-hover)"})]),z("selectable",[A("tree-node-content",[ge("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),z("pending",[A("tree-node-content",`
 background-color: var(--n-node-color-hover);
 `)]),z("selected",[A("tree-node-content",{backgroundColor:"var(--n-node-color-active)"})])])])]),z("block-line",[A("tree-node",[Ve("disabled",[ge("&:hover",{backgroundColor:"var(--n-node-color-hover)"}),z("pending",`
 background-color: var(--n-node-color-hover);
 `),z("selectable",[Ve("selected",[ge("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),z("selected",{backgroundColor:"var(--n-node-color-active)"})]),z("disabled",`
 cursor: not-allowed;
 `)])]),A("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: 24px;
 width: 24px;
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[pe("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[A("icon",[fn()]),A("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[fn()]),A("base-icon",[fn()])]),z("hide",{visibility:"hidden"}),z("expanded",{transform:"rotate(90deg)"})]),A("tree-node-checkbox",`
 display: inline-flex;
 height: 24px;
 width: 16px;
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 margin-right: 4px;
 `,[z("right","margin-left: 4px;")]),z("checkable",[A("tree-node-content",`
 padding: 0 6px;
 `)]),A("tree-node-content",`
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: 24px;
 box-sizing: border-box;
 line-height: 1.5;
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 text-decoration-color: #0000;
 text-decoration-line: underline;
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ge("&:last-child",{marginBottom:0}),pe("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),pe("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),pe("suffix",`
 display: inline-flex;
 `)]),pe("empty","margin: auto;")]);var Ht=globalThis&&globalThis.__awaiter||function(e,t,d,s){function r(f){return f instanceof d?f:new d(function(b){b(f)})}return new(d||(d=Promise))(function(f,b){function k(y){try{w(s.next(y))}catch(K){b(K)}}function m(y){try{w(s.throw(y))}catch(K){b(K)}}function w(y){y.done?f(y.value):r(y.value).then(k,m)}w((s=s.apply(e,t||[])).next())})};const en=30;function $n(e,t,d){return{getIsGroup(){return!1},getKey(s){return s[e]},getChildren(s){return s[t]},getDisabled(s){return!!(s[d]||s.checkboxDisabled)}}}const zn={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},qt=Object.assign(Object.assign(Object.assign(Object.assign({},nn.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},indent:{type:Number,default:16},allowDrop:{type:Function,default:_t},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),zn),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),Wt=we({name:"Tree",props:qt,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:d,mergedRtlRef:s}=An(e),r=dt("Tree",s,t),f=nn("Tree","-tree",Vt,Dn,e,t),b=F(null),k=F(null),m=F(null);function w(){var n;return(n=m.value)===null||n===void 0?void 0:n.listElRef}function y(){var n;return(n=m.value)===null||n===void 0?void 0:n.itemsElRef}const K=E(()=>{const{pattern:n}=e;return n?!n.length||!Ce.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Mt(e.data,Ce.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),S=E(()=>In(e.showIrrelevantNodes?e.data:K.value.filteredTree,$n(e.keyField,e.childrenField,e.disabledField))),h=Ie(yn,null),R=e.internalTreeSelect?h.dataTreeMate:S,{watchProps:C}=e,L=F([]);C!=null&&C.includes("defaultCheckedKeys")?He(()=>{L.value=e.defaultCheckedKeys}):L.value=e.defaultCheckedKeys;const U=T(e,"checkedKeys"),D=Fe(U,L),j=E(()=>R.value.getCheckedKeys(D.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),W=E(()=>e.leafOnly?"child":e.checkStrategy),V=E(()=>j.value.checkedKeys),ne=E(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:j.value.indeterminateKeys}),fe=F([]);C!=null&&C.includes("defaultSelectedKeys")?He(()=>{fe.value=e.defaultSelectedKeys}):fe.value=e.defaultSelectedKeys;const ae=T(e,"selectedKeys"),ie=Fe(ae,fe),ve=F([]),re=n=>{ve.value=e.defaultExpandAll?R.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};C!=null&&C.includes("defaultExpandedKeys")?He(()=>re(void 0)):He(()=>re(e.defaultExpandedKeys));const De=T(e,"expandedKeys"),Y=Fe(De,ve),de=E(()=>S.value.getFlattenedNodes(Y.value)),{pendingNodeKeyRef:G,handleKeydown:Be}=zt({props:e,mergedSelectedKeysRef:ie,fNodesRef:de,mergedExpandedKeysRef:Y,handleSelect:oe,handleSwitcherClick:O});let Z=null,c=null;const N=F(new Set),_=E(()=>e.internalHighlightKeySet||K.value.highlightKeySet),ye=Fe(_,N),te=F(new Set),We=E(()=>Y.value.filter(n=>!te.value.has(n)));let _e=0;const J=F(null),Pe=F(null),Ae=F(null),Se=F(null),Re=F(0),se=E(()=>{const{value:n}=Pe;return n?n.parent:null}),Ce=E(()=>{const{filter:n}=e;if(n)return n;const{labelField:l}=e;return(o,u)=>{if(!o.length)return!0;const g=u[l];return typeof g=="string"?g.toLowerCase().includes(o.toLowerCase()):!1}});Je(T(e,"data"),()=>{te.value.clear(),G.value=null,le()},{deep:!1});let Ue=!1;const Me=()=>{Ue=!0,hn(()=>{Ue=!1})};let Ke;Je(T(e,"pattern"),(n,l)=>{if(e.showIrrelevantNodes)if(Ke=void 0,n){const{expandedKeys:o,highlightKeySet:u}=Ut(e.data,e.pattern,e.keyField,e.childrenField,Ce.value);N.value=u,Me(),be(o,ee(o))}else N.value=new Set;else if(!n.length)Ke!==void 0&&(Me(),be(Ke,ee(Ke)));else{l.length||(Ke=Y.value);const{expandedKeys:o}=K.value;o!==void 0&&(Me(),be(o,ee(o)))}});function Ne(n){return Ht(this,void 0,void 0,function*(){const{onLoad:l}=e;if(!l)return yield Promise.resolve();const{value:o}=te;return yield new Promise(u=>{o.has(n.key)||(o.add(n.key),l(n.rawNode).then(()=>{o.delete(n.key),u()}).catch(g=>{console.error(g),x()}))})})}He(()=>{var n;const{value:l}=S;if(!l)return;const{getNode:o}=l;(n=Y.value)===null||n===void 0||n.forEach(u=>{const g=o(u);g&&!g.shallowLoaded&&Ne(g)})});const me=F(!1),ce=F([]);Je(We,(n,l)=>{if(!e.animated||Ue){hn(Ee);return}const o=new Set(l);let u=null,g=null;for(const B of n)if(!o.has(B)){if(u!==null)return;u=B}const H=new Set(n);for(const B of l)if(!H.has(B)){if(g!==null)return;g=B}if(u===null&&g===null)return;const{virtualScroll:$}=e,he=($?m.value.listElRef:b.value).offsetHeight,Te=Math.ceil(he/en)+1;let ue;if(u!==null&&(ue=l),g!==null&&(ue===void 0?ue=n:ue=ue.filter(B=>B!==g)),me.value=!0,ce.value=S.value.getFlattenedNodes(ue),u!==null){const B=ce.value.findIndex(q=>q.key===u);if(~B){const q=ce.value[B].children;if(q){const ke=Rn(q,n);ce.value.splice(B+1,0,{__motion:!0,mode:"expand",height:$?ke.length*en:void 0,nodes:$?ke.slice(0,Te):ke})}}}if(g!==null){const B=ce.value.findIndex(q=>q.key===g);if(~B){const q=ce.value[B].children;if(!q)return;me.value=!0;const ke=Rn(q,n);ce.value.splice(B+1,0,{__motion:!0,mode:"collapse",height:$?ke.length*en:void 0,nodes:$?ke.slice(0,Te):ke})}}});const tn=E(()=>vt(de.value)),ln=E(()=>me.value?ce.value:de.value);function Ee(){const{value:n}=k;n&&n.sync()}function an(){me.value=!1,e.virtualScroll&&hn(Ee)}function ee(n){const{getNode:l}=R.value;return n.map(o=>{var u;return((u=l(o))===null||u===void 0?void 0:u.rawNode)||null})}function be(n,l){const{"onUpdate:expandedKeys":o,onUpdateExpandedKeys:u}=e;ve.value=n,o&&I(o,n,l),u&&I(u,n,l)}function Xe(n,l){const{"onUpdate:checkedKeys":o,onUpdateCheckedKeys:u}=e;L.value=n,u&&I(u,n,l),o&&I(o,n,l)}function Ye(n,l){const{"onUpdate:indeterminateKeys":o,onUpdateIndeterminateKeys:u}=e;o&&I(o,n,l),u&&I(u,n,l)}function $e(n,l){const{"onUpdate:selectedKeys":o,onUpdateSelectedKeys:u}=e;fe.value=n,u&&I(u,n,l),o&&I(o,n,l)}function on(n){const{onDragenter:l}=e;l&&I(l,n)}function rn(n){const{onDragleave:l}=e;l&&I(l,n)}function dn(n){const{onDragend:l}=e;l&&I(l,n)}function Ge(n){const{onDragstart:l}=e;l&&I(l,n)}function ze(n){const{onDragover:l}=e;l&&I(l,n)}function Qe(n){const{onDrop:l}=e;l&&I(l,n)}function le(){a(),i()}function a(){J.value=null}function i(){Re.value=0,Pe.value=null,Ae.value=null,Se.value=null,x()}function x(){Z&&(window.clearTimeout(Z),Z=null),c=null}function p(n,l){if(e.disabled||xe(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){oe(n);return}const{checkedKeys:o,indeterminateKeys:u}=R.value[l?"check":"uncheck"](n.key,V.value,{cascade:e.cascade,checkStrategy:W.value,allowNotLoaded:e.allowCheckingNotLoaded});Xe(o,ee(o)),Ye(u,ee(u))}function M(n){if(e.disabled)return;const{key:l}=n,{value:o}=Y,u=o.findIndex(g=>g===l);if(~u){const g=Array.from(o);g.splice(u,1),be(g,ee(g))}else{const g=S.value.getNode(l);if(!g||g.isLeaf)return;let H;if(e.accordion){const $=new Set(n.siblings.map(({key:he})=>he));H=o.filter(he=>!$.has(he)),H.push(l)}else H=o.concat(l);be(H,ee(H))}}function O(n){e.disabled||me.value||M(n)}function oe(n){if(!(e.disabled||!e.selectable)){if(G.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:l,indeterminateKeys:o}}=j;e.multiple?p(n,!(l.includes(n.key)||o.includes(n.key))):Xe([n.key],ee([n.key]))}if(e.multiple){const l=Array.from(ie.value),o=l.findIndex(u=>u===n.key);~o?e.cancelable&&l.splice(o,1):~o||l.push(n.key),$e(l,ee(l))}else ie.value.includes(n.key)?e.cancelable&&$e([],[]):$e([n.key],ee([n.key]))}}function Le(n){if(Z&&(window.clearTimeout(Z),Z=null),n.isLeaf)return;c=n.key;const l=()=>{if(c!==n.key)return;const{value:o}=Ae;if(o&&o.key===n.key&&!Y.value.includes(n.key)){const u=Y.value.concat(n.key);be(u,ee(u))}Z=null,c=null};n.shallowLoaded?Z=window.setTimeout(()=>{l()},1e3):Z=window.setTimeout(()=>{Ne(n).then(()=>{l()})},1e3)}function Ze({event:n,node:l}){!e.draggable||e.disabled||xe(l,e.disabledField)||(mn({event:n,node:l},!1),on({event:n,node:l.rawNode}))}function je({event:n,node:l}){!e.draggable||e.disabled||xe(l,e.disabledField)||rn({event:n,node:l.rawNode})}function jn(n){n.target===n.currentTarget&&i()}function Vn({event:n,node:l}){le(),!(!e.draggable||e.disabled||xe(l,e.disabledField))&&dn({event:n,node:l.rawNode})}function Hn({event:n,node:l}){var o;!e.draggable||e.disabled||xe(l,e.disabledField)||(Nn&&((o=n.dataTransfer)===null||o===void 0||o.setDragImage(Nn,0,0)),_e=n.clientX,J.value=l,Ge({event:n,node:l.rawNode}))}function mn({event:n,node:l},o=!0){var u;if(!e.draggable||e.disabled||xe(l,e.disabledField))return;const{value:g}=J;if(!g)return;const{allowDrop:H,indent:$}=e;o&&ze({event:n,node:l.rawNode});const he=n.currentTarget,{height:Te,top:ue}=he.getBoundingClientRect(),B=n.clientY-ue;let q;H({node:l.rawNode,dropPosition:"inside",phase:"drag"})?B<=8?q="before":B>=Te-8?q="after":q="inside":B<=Te/2?q="before":q="after";const{value:Qn}=tn;let P,Q;const sn=Qn(l.key);if(sn===null){i();return}let xn=!1;q==="inside"?(P=l,Q="inside"):q==="before"?l.isFirstChild?(P=l,Q="before"):(P=de.value[sn-1],Q="after"):(P=l,Q="after"),!P.isLeaf&&Y.value.includes(P.key)&&(xn=!0,Q==="after"&&(P=de.value[sn+1],P?Q="before":(P=l,Q="inside")));const pn=P;if(Ae.value=pn,!xn&&g.isLastChild&&g.key===P.key&&(Q="after"),Q==="after"){let wn=_e-n.clientX,cn=0;for(;wn>=$/2&&P.parent!==null&&P.isLastChild&&cn<1;)wn-=$,cn+=1,P=P.parent;Re.value=cn}else Re.value=0;if((g.contains(P)||Q==="inside"&&((u=g.parent)===null||u===void 0?void 0:u.key)===P.key)&&!(g.key===pn.key&&g.key===P.key)){i();return}if(!H({node:P.rawNode,dropPosition:Q,phase:"drag"})){i();return}if(g.key===P.key)x();else if(c!==P.key)if(Q==="inside"){if(e.expandOnDragenter){if(Le(P),!P.shallowLoaded&&c!==P.key){le();return}}else if(!P.shallowLoaded){le();return}}else x();else Q!=="inside"&&x();Se.value=Q,Pe.value=P}function qn({event:n,node:l,dropPosition:o}){if(!e.draggable||e.disabled||xe(l,e.disabledField))return;const{value:u}=J,{value:g}=Pe,{value:H}=Se;if(!(!u||!g||!H)&&!!e.allowDrop({node:g.rawNode,dropPosition:H,phase:"drag"})&&u.key!==g.key){if(H==="before"){const $=u.getNext({includeDisabled:!0});if($&&$.key===g.key){i();return}}if(H==="after"){const $=u.getPrev({includeDisabled:!0});if($&&$.key===g.key){i();return}}Qe({event:n,node:g.rawNode,dragNode:u.rawNode,dropPosition:o}),le()}}function Wn(){Ee()}function Xn(){Ee()}function Yn(n){var l;if(e.virtualScroll||e.internalScrollable){const{value:o}=k;if(!((l=o==null?void 0:o.containerRef)===null||l===void 0)&&l.contains(n.relatedTarget))return;G.value=null}else{const{value:o}=b;if(o!=null&&o.contains(n.relatedTarget))return;G.value=null}}Je(G,n=>{var l,o;if(n!==null){if(e.virtualScroll)(l=m.value)===null||l===void 0||l.scrollTo({key:n});else if(e.internalScrollable){const{value:u}=k;if(u===null)return;const g=(o=u.contentRef)===null||o===void 0?void 0:o.querySelector(`[data-key="${_n(n)}"]`);if(!g)return;u.scrollTo({el:g})}}}),En(qe,{loadingKeysRef:te,highlightKeySetRef:ye,displayedCheckedKeysRef:V,displayedIndeterminateKeysRef:ne,mergedSelectedKeysRef:ie,mergedExpandedKeysRef:Y,mergedThemeRef:f,mergedCheckStrategyRef:W,nodePropsRef:T(e,"nodeProps"),disabledRef:T(e,"disabled"),checkableRef:T(e,"checkable"),selectableRef:T(e,"selectable"),expandOnClickRef:T(e,"expandOnClick"),onLoadRef:T(e,"onLoad"),draggableRef:T(e,"draggable"),blockLineRef:T(e,"blockLine"),indentRef:T(e,"indent"),cascadeRef:T(e,"cascade"),checkOnClickRef:T(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Ae,droppingNodeParentRef:se,draggingNodeRef:J,droppingPositionRef:Se,droppingOffsetLevelRef:Re,fNodesRef:de,pendingNodeKeyRef:G,disabledFieldRef:T(e,"disabledField"),internalScrollableRef:T(e,"internalScrollable"),internalCheckboxFocusableRef:T(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:T(e,"renderLabel"),renderPrefixRef:T(e,"renderPrefix"),renderSuffixRef:T(e,"renderSuffix"),renderSwitcherIconRef:T(e,"renderSwitcherIcon"),labelFieldRef:T(e,"labelField"),multipleRef:T(e,"multiple"),handleSwitcherClick:O,handleDragEnd:Vn,handleDragEnter:Ze,handleDragLeave:je,handleDragStart:Hn,handleDrop:qn,handleDragOver:mn,handleSelect:oe,handleCheck:p});function Gn(n){var l;(l=m.value)===null||l===void 0||l.scrollTo(n)}const bn={handleKeydown:Be,scrollTo:Gn},kn=E(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:l,nodeBorderRadius:o,nodeColorHover:u,nodeColorPressed:g,nodeColorActive:H,arrowColor:$,loadingColor:he,nodeTextColor:Te,nodeTextColorDisabled:ue,dropMarkColor:B}}=f.value;return{"--n-arrow-color":$,"--n-loading-color":he,"--n-bezier":n,"--n-font-size":l,"--n-node-border-radius":o,"--n-node-color-active":H,"--n-node-color-hover":u,"--n-node-color-pressed":g,"--n-node-text-color":Te,"--n-node-text-color-disabled":ue,"--n-drop-mark-color":B}}),Oe=d?Ln("tree",void 0,kn,e):void 0;return{mergedClsPrefix:t,mergedTheme:f,rtlEnabled:r,fNodes:ln,aip:me,selfElRef:b,virtualListInstRef:m,scrollbarInstRef:k,handleFocusout:Yn,handleDragLeaveTree:jn,handleScroll:Wn,getScrollContainer:w,getScrollContent:y,handleAfterEnter:an,handleResize:Xn,handleKeydown:bn.handleKeydown,scrollTo:bn.scrollTo,cssVars:d?void 0:kn,themeClass:Oe==null?void 0:Oe.themeClass,onRender:Oe==null?void 0:Oe.onRender}},render(){var e;const{fNodes:t,internalRenderEmpty:d}=this;if(!t.length&&d)return d();const{mergedClsPrefix:s,blockNode:r,blockLine:f,draggable:b,disabled:k,internalFocusable:m,checkable:w,handleKeydown:y,rtlEnabled:K,handleFocusout:S}=this,h=m&&!k,R=h?"0":void 0,C=[`${s}-tree`,K&&`${s}-tree--rtl`,w&&`${s}-tree--checkable`,(f||r)&&`${s}-tree--block-node`,f&&`${s}-tree--block-line`],L=D=>"__motion"in D?v(jt,{height:D.height,nodes:D.nodes,clsPrefix:s,mode:D.mode,onAfterEnter:this.handleAfterEnter}):v(Mn,{key:D.key,tmNode:D,clsPrefix:s});if(this.virtualScroll){const{mergedTheme:D,internalScrollablePadding:j}=this,W=xt(j||"0");return v(Cn,{ref:"scrollbarInstRef",onDragleave:b?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:C,theme:D.peers.Scrollbar,themeOverrides:D.peerOverrides.Scrollbar,tabindex:R,onKeydown:h?y:void 0,onFocusout:h?S:void 0},{default:()=>{var V;return(V=this.onRender)===null||V===void 0||V.call(this),v(gt,{ref:"virtualListInstRef",items:this.fNodes,itemSize:en,ignoreItemResize:this.aip,paddingTop:W.top,paddingBottom:W.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:W.left,paddingRight:W.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:ne})=>L(ne)})}})}const{internalScrollable:U}=this;return C.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),U?v(Cn,{class:C,tabindex:R,onKeydown:h?y:void 0,onFocusout:h?S:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}},{default:()=>v("div",{onDragleave:b?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(L))}):v("div",{class:C,tabindex:R,ref:"selfElRef",style:this.cssVars,onKeydown:h?y:void 0,onFocusout:h?S:void 0,onDragleave:b?this.handleDragLeaveTree:void 0},t.length?t.map(L):Bn(this.$slots.empty,()=>[v(On,{class:`${s}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});function Tn(e,t){const{rawNode:d}=e;return Object.assign(Object.assign({},d),{label:d[t],value:e.key})}function Fn(e,t,d,s){const{rawNode:r}=e;return Object.assign(Object.assign({},r),{value:e.key,label:t.map(f=>f.rawNode[s]).join(d)})}const Xt=ge([A("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),A("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[A("tree","max-height: var(--n-menu-height);"),pe("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),pe("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),St()])]),Yt=Object.assign(Object.assign(Object.assign(Object.assign({},nn.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:vn.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function}),zn),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),cl=we({name:"TreeSelect",props:Yt,setup(e){const t=F(null),d=F(null),s=F(null),r=F(null),{mergedClsPrefixRef:f,namespaceRef:b,inlineThemeDisabled:k}=An(e),{localeRef:m}=Rt("Select"),{mergedSizeRef:w,mergedDisabledRef:y,mergedStatusRef:K,nTriggerFormBlur:S,nTriggerFormChange:h,nTriggerFormFocus:R,nTriggerFormInput:C}=Ct(e),L=F(e.defaultValue),U=T(e,"value"),D=Fe(U,L),j=F(e.defaultShow),W=T(e,"show"),V=Fe(W,j),ne=F(""),fe=E(()=>{const{filter:a}=e;if(a)return a;const{labelField:i}=e;return(x,p)=>x.length?p[i].toLowerCase().includes(x.toLowerCase()):!0}),ae=E(()=>In(e.options,$n(e.keyField,e.childrenField,e.disabledField))),{value:ie}=D,ve=F(e.checkable?null:Array.isArray(ie)&&ie.length?ie[ie.length-1]:null),re=E(()=>e.multiple&&e.cascade&&e.checkable),De=F(e.defaultExpandAll?void 0:e.defaultExpandedKeys||e.expandedKeys),Y=T(e,"expandedKeys"),de=Fe(Y,De),G=F(!1),Be=E(()=>{const{placeholder:a}=e;return a!==void 0?a:m.value.placeholder}),Z=E(()=>e.checkable?[]:c.value),c=E(()=>{const{value:a}=D;return e.multiple?Array.isArray(a)?a:[]:a===null||Array.isArray(a)?[]:[a]}),N=E(()=>{const{multiple:a,showPath:i,separator:x,labelField:p}=e;if(a)return null;const{value:M}=D;if(!Array.isArray(M)&&M!==null){const{value:O}=ae,oe=O.getNode(M);if(oe!==null)return i?Fn(oe,O.getPath(M).treeNodePath,x,p):Tn(oe,p)}return null}),_=E(()=>{const{multiple:a,showPath:i,separator:x}=e;if(!a)return null;const{value:p}=D;if(Array.isArray(p)){const M=[],{value:O}=ae,{checkedKeys:oe}=O.getCheckedKeys(p,{checkStrategy:e.checkStrategy,cascade:re.value,allowNotLoaded:e.allowCheckingNotLoaded}),{labelField:Le}=e;return oe.forEach(Ze=>{const je=O.getNode(Ze);je!==null&&M.push(i?Fn(je,O.getPath(Ze).treeNodePath,x,Le):Tn(je,Le))}),M}return[]}),ye=E(()=>{const{self:{menuPadding:a}}=ze.value;return a});function te(){var a;(a=d.value)===null||a===void 0||a.focus()}function We(){var a;(a=d.value)===null||a===void 0||a.focusInput()}function _e(a){const{onUpdateShow:i,"onUpdate:show":x}=e;i&&I(i,a),x&&I(x,a),j.value=a}function J(a,i){const{onUpdateValue:x,"onUpdate:value":p}=e;x&&I(x,a,i),p&&I(p,a,i),L.value=a,C(),h()}function Pe(a,i){const{onUpdateIndeterminateKeys:x,"onUpdate:indeterminateKeys":p}=e;x&&I(x,a,i),p&&I(p,a,i)}function Ae(a,i){const{onUpdateExpandedKeys:x,"onUpdate:expandedKeys":p}=e;x&&I(x,a,i),p&&I(p,a,i),De.value=a}function Se(a){const{onFocus:i}=e;i&&i(a),R()}function Re(a){se();const{onBlur:i}=e;i&&i(a),S()}function se(){_e(!1)}function Ce(){y.value||(ne.value="",_e(!0),e.filterable&&We())}function Ue(){ne.value=""}function Me(a){var i;V.value&&(!((i=d.value)===null||i===void 0)&&i.$el.contains(pt(a))||se())}function Ke(){y.value||(V.value?e.filterable||se():Ce())}function Ne(a){const{value:{getNode:i}}=ae;return a.map(x=>{var p;return((p=i(x))===null||p===void 0?void 0:p.rawNode)||null})}function me(a){const i=Ne(a);e.multiple?(J(a,i),e.filterable&&(We(),e.clearFilterAfterSelect&&(ne.value=""))):(a.length?J(a[0],i[0]||null):J(null,null),se(),te())}function ce(a){e.checkable&&Pe(a,Ne(a))}function tn(a){var i;!((i=r.value)===null||i===void 0)&&i.contains(a.relatedTarget)||(G.value=!0,Se(a))}function ln(a){var i;!((i=r.value)===null||i===void 0)&&i.contains(a.relatedTarget)||(G.value=!1,Re(a))}function Ee(a){var i,x,p;((i=r.value)===null||i===void 0?void 0:i.contains(a.relatedTarget))||((p=(x=d.value)===null||x===void 0?void 0:x.$el)===null||p===void 0?void 0:p.contains(a.relatedTarget))||(G.value=!0,Se(a))}function an(a){var i,x,p;((i=r.value)===null||i===void 0?void 0:i.contains(a.relatedTarget))||((p=(x=d.value)===null||x===void 0?void 0:x.$el)===null||p===void 0?void 0:p.contains(a.relatedTarget))||(G.value=!1,Re(a))}function ee(a){a.stopPropagation();const{multiple:i}=e;!i&&e.filterable&&se(),i?J([],[]):J(null,null)}function be(a){const{value:i}=D;if(Array.isArray(i)){const{value:x}=ae,{checkedKeys:p}=x.getCheckedKeys(i,{cascade:re.value,allowNotLoaded:e.allowCheckingNotLoaded}),M=p.findIndex(O=>O===a.value);if(~M)if(e.checkable){const{checkedKeys:O}=x.uncheck(a.value,p,{checkStrategy:e.checkStrategy,cascade:re.value,allowNotLoaded:e.allowCheckingNotLoaded});J(O,Ne(O))}else{const O=Array.from(p);O.splice(M,1),J(O,Ne(O))}}}function Xe(a){const{value:i}=a.target;ne.value=i}function Ye(a){const{value:i}=s;i&&i.handleKeydown(a)}function $e(a){a.key==="Enter"?(V.value?(Ye(a),e.multiple||(se(),te())):Ce(),a.preventDefault()):a.key==="Escape"?V.value&&(Nt(a),se(),te()):V.value?Ye(a):a.key==="ArrowDown"&&Ce()}function on(){se(),te()}function rn(a){gn(a,"action")||a.preventDefault()}const dn=E(()=>{const{renderTag:a}=e;if(!!a)return function({option:x,handleClose:p}){const{value:M}=x;if(M!==void 0){const O=ae.value.getNode(M);if(O)return a({option:O.rawNode,handleClose:p})}return M}});En(yn,{pendingNodeKeyRef:ve,dataTreeMate:ae});function Ge(){var a;!V.value||(a=t.value)===null||a===void 0||a.syncPosition()}yt(r,Ge);const ze=nn("TreeSelect","-tree-select",Xt,Lt,e,f),Qe=E(()=>{const{common:{cubicBezierEaseInOut:a},self:{menuBoxShadow:i,menuBorderRadius:x,menuColor:p,menuHeight:M,actionPadding:O,actionDividerColor:oe,actionTextColor:Le}}=ze.value;return{"--n-menu-box-shadow":i,"--n-menu-border-radius":x,"--n-menu-color":p,"--n-menu-height":M,"--n-bezier":a,"--n-action-padding":O,"--n-action-text-color":Le,"--n-action-divider-color":oe}}),le=k?Ln("tree-select",void 0,Qe,e):void 0;return{menuElRef:r,mergedStatus:K,triggerInstRef:d,followerInstRef:t,treeInstRef:s,mergedClsPrefix:f,mergedValue:D,mergedShow:V,namespace:b,adjustedTo:vn(e),isMounted:st(),focused:G,menuPadding:ye,mergedPlaceholder:Be,mergedExpandedKeys:de,treeSelectedKeys:Z,treeCheckedKeys:c,mergedSize:w,mergedDisabled:y,selectedOption:N,selectedOptions:_,pattern:ne,pendingNodeKey:ve,mergedCascade:re,mergedFilter:fe,selectionRenderTag:dn,handleTriggerOrMenuResize:Ge,doUpdateExpandedKeys:Ae,handleMenuLeave:Ue,handleTriggerClick:Ke,handleMenuClickoutside:Me,handleUpdateCheckedKeys:me,handleUpdateIndeterminateKeys:ce,handleTriggerFocus:tn,handleTriggerBlur:ln,handleMenuFocusin:Ee,handleMenuFocusout:an,handleClear:ee,handleDeleteOption:be,handlePatternInput:Xe,handleKeydown:$e,handleTabOut:on,handleMenuMousedown:rn,mergedTheme:ze,cssVars:k?void 0:Qe,themeClass:le==null?void 0:le.themeClass,onRender:le==null?void 0:le.onRender}},render(){const{mergedTheme:e,mergedClsPrefix:t,$slots:d}=this;return v("div",{class:`${t}-tree-select`},v(Tt,null,{default:()=>[v(Ft,null,{default:()=>v(mt,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:t,theme:e.peers.InternalSelection,themeOverrides:e.peerOverrides.InternalSelection,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var s,r;return[(r=(s=this.$slots).arrow)===null||r===void 0?void 0:r.call(s)]}})}),v(Dt,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===vn.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>v(ct,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var s;if(!this.mergedShow)return null;const{mergedClsPrefix:r,checkable:f,multiple:b,menuProps:k,options:m}=this;return(s=this.onRender)===null||s===void 0||s.call(this),ut(v("div",Object.assign({},k,{class:[`${r}-tree-select-menu`,k==null?void 0:k.class,this.themeClass],ref:"menuElRef",style:[(k==null?void 0:k.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),v(Wt,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,filter:this.mergedFilter,data:m,cancelable:b,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:e.peers.Tree,themeOverrides:e.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:f,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>v("div",{class:`${r}-tree-select-menu__empty`},Bn(d.empty,()=>[v(On,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),wt(d.action,w=>w?v("div",{class:`${r}-tree-select-menu__action`,"data-action":!0},w):null),v(bt,{onFocus:this.handleTabOut})),[[Kt,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{cl as N};
