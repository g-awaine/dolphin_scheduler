import{M as P}from"./index.e69e8738.js";import{u as j,bt as h,aL as N,a as l,d as w,at as M,w as i,ba as v,c as m}from"./index.851b5188.js";import{s as c}from"./service.4be3af67.js";import{N as V}from"./Form.9f7fa8c1.js";import{N as p}from"./FormItem.f5b3f80b.js";import{N as f}from"./Input.79ba0d48.js";function B(e,r){return c({url:`/projects/${r}/project-parameter`,method:"get",params:e})}function b(e,r){return c({url:`/projects/${r}/project-parameter`,method:"post",data:e})}function g(e,r){return c({url:`/projects/${r}/project-parameter/${e.code}`,method:"put",data:e})}function E(e,r){return c({url:`/projects/${r}/project-parameter/delete`,method:"post",data:e})}function R(e,r){const{t}=j(),d=h(),a=N({formRef:l(),projectCode:l(Number(d.currentRoute.value.params.projectCode)),model:{code:l(-1),projectParameterName:l(""),projectParameterValue:l("")},saving:!1,rules:{name:{required:!0,trigger:["input","blur"],validator(){if(a.model.projectParameterName==="")return new Error(t("project.parameter.name_tips"))}},value:{required:!0,trigger:["input","blur"],validator(){if(a.model.projectParameterValue==="")return new Error(t("project.parameter.value_tips"))}}}}),n=async o=>{if(!a.saving){a.saving=!0;try{o===0?await s():await u(),a.saving=!1}catch{a.saving=!1}}},s=()=>{const o={projectParameterName:a.model.projectParameterName,projectParameterValue:a.model.projectParameterValue};b(o,a.projectCode).then(()=>{a.model.projectParameterName="",a.model.projectParameterValue="",r.emit("confirmModal",e.showModalRef)})},u=()=>{const o={code:a.model.code,projectParameterName:a.model.projectParameterName,projectParameterValue:a.model.projectParameterValue};g(o,a.projectCode).then(()=>{r.emit("confirmModal",e.showModalRef)})};return{variables:a,handleValidate:n}}const C=w({name:"ParameterModal",props:{showModalRef:{type:Boolean,default:!1},statusRef:{type:Number,default:0},row:{type:Object,default:{}}},emits:["cancelModal","confirmModal"],setup(e,r){var o;const{variables:t,handleValidate:d}=R(e,r),{t:a}=j(),n=()=>{e.statusRef===0?(t.model.projectParameterName="",t.model.projectParameterValue=""):(t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue),r.emit("cancelModal",e.showModalRef)},s=()=>{d(e.statusRef)},u=(o=M())==null?void 0:o.appContext.config.globalProperties.trim;return i(()=>e.showModalRef,()=>{e.showModalRef}),i(()=>e.statusRef,()=>{e.statusRef===0?(t.model.projectParameterName="",t.model.projectParameterValue=""):(t.model.code=e.row.code,t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue)}),i(()=>e.row,()=>{t.model.code=e.row.code,t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue}),{t:a,...v(t),cancelModal:n,confirmModal:s,trim:u}},render(){const{t:e}=this;return m("div",null,[m(P,{title:this.statusRef===0?e("project.parameter.create_parameter"):e("project.parameter.edit_parameter"),show:this.showModalRef,onCancel:this.cancelModal,onConfirm:this.confirmModal,confirmDisabled:!this.model.projectParameterName||!this.model.projectParameterValue,confirmClassName:"btn-submit",cancelClassName:"btn-cancel",confirmLoading:this.saving},{default:()=>m(V,{model:this.model,rules:this.rules,ref:"formRef"},{default:()=>[m(p,{label:e("project.parameter.name"),path:"name"},{default:()=>[m(f,{allowInput:this.trim,placeholder:e("project.parameter.name_tips"),value:this.model.projectParameterName,"onUpdate:value":r=>this.model.projectParameterName=r},null)]}),m(p,{label:e("project.parameter.value"),path:"value"},{default:()=>[m(f,{allowInput:this.trim,placeholder:e("project.parameter.value_tips"),value:this.model.projectParameterValue,"onUpdate:value":r=>this.model.projectParameterValue=r},null)]})]})})])}}),F=Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"}));export{C as P,E as d,F as p,B as q};
