import{u as v,a as p,e as g,bt as R,aL as k,d as S,c as n,G as q,H as O,al as C}from"./index.851b5188.js";import{g as G,F as T}from"./get-elements-by-json.9201707b.js";import{u as x,a as E,b as F,c as L,d as U}from"./index.module.4a3c8d75.js";import"./service.4be3af67.js";import"./task-type.dfd9250b.js";import"./lodash.68b7405b.js";import{q as D,u as V,a as _}from"./index.35726d3e.js";import{w as I}from"./common.ee372ad3.js";import{q as A}from"./index.57e264b5.js";import{l as B}from"./index.b3847370.js";import{N as M}from"./Switch.f95d65b1.js";import{N as j}from"./Divider.d89d86b0.js";import{N as W}from"./Space.f9ece73f.js";import{N as J}from"./Button.4e249408.js";import"./Form.9f7fa8c1.js";import"./FormItem.f5b3f80b.js";import"./use-form-item.bb4d7ada.js";import"./format-length.d7d829b3.js";import"./get.aa32335f.js";import"./resolve-slot.9e6a0162.js";import"./keysOf.ab13e590.js";import"./Grid.3ae564e0.js";import"./index.7a579f81.js";import"./utils.f449ed5c.js";import"./is-browser.45c3bd93.js";import"./VResizeObserver.6721b9ea.js";import"./flatten.05a2e46f.js";import"./get-slot.80096ab3.js";import"./next-frame-once.e5ee25e8.js";import"./Spin.447cad15.js";import"./fade-in.cssr.55dfcced.js";import"./use-compitable.ae5454ac.js";import"./Input.79ba0d48.js";import"./use-locale.f8ac8f2c.js";import"./use-merged-state.e40d3a9f.js";import"./Scrollbar.7a99b971.js";import"./Suffix.21a8a87f.js";import"./Radio.fc32ca3b.js";import"./RadioGroup.c3ead4f3.js";import"./index.2fc51a01.js";import"./DeleteOutlined.07e1d3fe.js";import"./index.e739cd60.js";import"./use-false-until-truthy.5d7093c9.js";import"./InputNumber.cc83334e.js";import"./Add.3164a73d.js";import"./Select.3e0f2c28.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./Selection.28a32045.js";import"./Popover.30015336.js";import"./_baseMap.9542141b.js";import"./index.3ef69258.js";import"./Checkbox.98b84c16.js";import"./TreeSelect.5a0f3466.js";import"./ArrowUpOutlined.284f08d8.js";import"./Icon.afc45566.js";import"./index.2d754617.js";import"./index.71fea87c.js";import"./ui-setting.39219f0f.js";import"./SettingOutlined.e20148d7.js";import"./PauseCircleOutlined.28d888d0.js";import"./CloseCircleOutlined.9e282d8c.js";import"./CheckCircleOutlined.67794958.js";import"./EditOutlined.e0b6da4a.js";import"./index.d671386a.js";function z(){const{t}=v(),r=[];return(()=>{I.forEach(s=>{r.push({label:t(s.code),value:s.id})})})(),{type:"select",field:"warningType",name:t("project.workflow.notification_strategy"),span:12,options:r,validate:{required:!0},value:"NONE"}}function $(){const{t}=v(),r=p([]),a=async()=>{const s=await A();r.value=s.map(o=>({label:o.tenantCode,value:o.tenantCode}))};return g(()=>{a()}),{type:"select",field:"tenant",span:12,name:t("project.workflow.tenant_code"),options:r}}function H(){const{t}=v(),r=p([]),a=async()=>{const s=await B();r.value=s.map(o=>({label:o.groupName,value:o.id}))};return g(()=>{a()}),{type:"select",field:"alertGroups",span:12,name:t("project.workflow.alarm_group"),options:r}}function Q(){const t=R(),{t:r}=v(),a=Number(t.currentRoute.value.params.projectCode),s=p(),o=p([]),c=p([]),l=p({}),u=p({}),f=p(0);u.value={labelPlacement:"left",labelWidth:"auto",size:"large"};const i=k({model:{taskPriority:"MEDIUM",workerGroup:"default",environmentCode:null,failRetryTimes:0,failRetryInterval:1,cpuQuota:-1,memoryMax:-1,timeoutFlag:!1,timeoutNotifyStrategy:["WARN"],timeout:30}}),y=e=>{Object.assign(i.model,e)},w=async()=>{if(a){const e=await D(a);e!=null&&e.preferences&&(y(JSON.parse(e.preferences)),f.value=e.state)}};g(()=>{w()});const N=()=>{const e={projectPreferences:JSON.stringify(i.model)};V(e,a).then(()=>{window.$message.success(r("project.preference.success"))})},P=e=>{_({state:e},a).then(()=>{window.$message.success(r("project.preference.success"))})},b=[x(),$(),E(),F(i.model,!0),...L(),z(),H(),...U()],h=e=>{var m;for(let d of e)(m=d.validate)!=null&&m.required&&(d.validate.required=!1,d.span=12),Object.assign(d,{props:{style:"width: 250px"}});return e};return o.value=h(b),(()=>{const{rules:e,elements:m}=G(o.value,i.model);c.value=m,l.value=e})(),{formRef:s,elementsRef:c,rulesRef:l,model:i.model,stateRef:f,formProps:u,t:r,handleUpdate:N,handleUpdateState:P}}function K(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!C(t)}const pt=S({name:"PreferenceForm",setup(){const{formRef:t,elementsRef:r,rulesRef:a,model:s,stateRef:o,formProps:c,t:l,handleUpdate:u,handleUpdateState:f}=Q();return()=>{let i;return n("div",null,[n("div",{style:{marginLeft:"30px"}},[n(M,{size:"large",round:!1,value:o.value,"onUpdate:value":y=>o.value=y,checkedValue:1,uncheckedValue:0,onUpdateValue:f},{checked:()=>l("project.preference.enabled"),unchecked:()=>l("project.preference.disabled")})]),n("div",null,[n("div",{style:{margin:"30px"}},[l("project.preference.instruction_tips")]),n(j,null,null),n(T,{ref:t,meta:{model:s,disabled:o.value!==1,rules:a.value,elements:r.value,...c.value},layout:{xGap:10},style:{marginLeft:"150px"}},null),n(j,null,null),n(W,{justify:"center"},{default:()=>[q(n(J,{type:"info",onClick:u},K(i=l("project.preference.submit"))?i:{default:()=>[i]}),[[O,o.value]])]})])])}}});export{pt as default};
