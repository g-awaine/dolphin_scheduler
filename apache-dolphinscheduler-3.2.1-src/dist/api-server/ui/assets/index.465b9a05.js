import{u as z,t as w,aL as N,a as m,d as U,bt as M,at as L,e as O,ba as j,c as a}from"./index.851b5188.js";import{d as x,b as v}from"./index.336ca31d.js";import H from"./table-action.426f7fd5.js";import{_ as Q}from"./lodash.68b7405b.js";import{C as n,c as W,D as B}from"./column-width-config.4c11a147.js";import{p as I}from"./common.ee372ad3.js";import{f as q}from"./index.d671386a.js";import F from"./form-modal.c84cf77d.js";import{C as S}from"./index.6c124806.js";import{S as T}from"./index.94a7e931.js";import{S as A}from"./SearchOutlined.3b9a5586.js";import{N as _}from"./Space.f9ece73f.js";import{a as V}from"./Select.3e0f2c28.js";import{N as X}from"./Button.4e249408.js";import{N as E}from"./Icon.afc45566.js";import{N as J,a as K}from"./DataTable.0e9ec324.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./EditOutlined.e0b6da4a.js";import"./PlayCircleOutlined.28a7c420.js";import"./Tooltip.52cb9ce9.js";import"./Popover.30015336.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./_baseMap.9542141b.js";import"./get.aa32335f.js";import"./utils.f449ed5c.js";import"./format-length.d7d829b3.js";import"./resolve-slot.9e6a0162.js";import"./use-merged-state.e40d3a9f.js";import"./use-compitable.ae5454ac.js";import"./next-frame-once.e5ee25e8.js";import"./is-browser.45c3bd93.js";import"./use-form-item.bb4d7ada.js";import"./get-slot.80096ab3.js";import"./index.7a579f81.js";import"./SettingOutlined.e20148d7.js";import"./PauseCircleOutlined.28d888d0.js";import"./CloseCircleOutlined.9e282d8c.js";import"./CheckCircleOutlined.67794958.js";import"./index.e69e8738.js";import"./index.8acb741a.js";import"./keysOf.ab13e590.js";import"./Card.19bc42e2.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./index.3ef69258.js";import"./Form.9f7fa8c1.js";import"./FormItem.f5b3f80b.js";import"./Input.79ba0d48.js";import"./use-locale.f8ac8f2c.js";import"./Suffix.21a8a87f.js";import"./Selection.28a32045.js";import"./ArrowDown.45f9e719.js";import"./Checkbox.98b84c16.js";import"./RadioGroup.c3ead4f3.js";import"./Radio.fc32ca3b.js";import"./Dropdown.4af83811.js";import"./ChevronRight.d6536995.js";import"./use-keyboard.f4d2f0c0.js";import"./Ellipsis.b13f7726.js";import"./Forward.bddcd6d4.js";function R(l=(e,c)=>{},d=()=>{}){const{t:e}=z(),c=[{title:"#",key:"index",render:(i,r)=>r+1,...n.index},{title:e("resource.task_group_queue.project_name"),key:"projectName",...n.name},{title:e("resource.task_group_queue.task_name"),key:"taskName",...n.name},{title:e("resource.task_group_queue.workflow_instance_name"),key:"processInstanceName",...n.name},{title:e("resource.task_group_queue.task_group_name"),key:"taskGroupName",...n.name},{title:e("resource.task_group_queue.priority"),key:"priority",width:120},{title:e("resource.task_group_queue.force_starting_status"),key:"forceStart",...n.state},{title:e("resource.task_group_queue.in_queue"),key:"inQueue",width:120},{title:e("resource.task_group_queue.task_status"),key:"status",...n.state},{title:e("resource.task_group_queue.create_time"),key:"createTime",...n.time},{title:e("resource.task_group_queue.update_time"),key:"updateTime",...n.time},{title:e("resource.task_group_queue.actions"),key:"actions",...n.operation(2),render:i=>w(H,{row:i,onResetTableData:()=>{t.page>1&&t.tableData.length===1&&(t.page-=1),d()},onUpdatePriority:(r,s)=>{l(r,s)}})}],t=N({tableData:[],tableWidth:W(c)||B,page:m(1),pageSize:m(10),groupId:m(3),totalPage:m(1),loadingRef:m(!1)});return{getTableData:i=>{if(t.loadingRef)return;t.loadingRef=!0;const r={pageNo:1,pageSize:2147483647};Promise.all([x(i),v(r)]).then(s=>{const p=s[1].totalList;t.totalPage=s[0].totalPage,t.tableData=s[0].totalList.map((u,f)=>{let o="";if(p){const k=Q.find(p,{id:u.groupId});k&&(o=k.name)}return u.taskGroupName=o,u.createTime=q(I(u.createTime),"yyyy-MM-dd HH:mm:ss"),u.updateTime=q(I(u.updateTime),"yyyy-MM-dd HH:mm:ss"),{...u}})},()=>{}),t.loadingRef=!1},variables:t,columns:c}}const pt=U({name:"taskGroupQueue",setup(){var b;const l=M(),{t:d}=z(),{variables:e,getTableData:c}=R(),t=m(!1),g=m([]),i=m(Number(l.currentRoute.value.params.id)),r=N({groupId:m(),processName:"",instanceName:"",pageSize:10,pageNo:1});let s=N({queueId:0,priority:0});const p=()=>{c({pageSize:e.pageSize,pageNo:e.page,groupId:r.groupId,taskInstanceName:r.instanceName,processInstanceName:r.processName})},u=()=>{t.value=!1},f=()=>{t.value=!1,s={queueId:0,priority:0},p()},o=()=>{e.page=1,p()},k=(h,y)=>{t.value=!0,s.queueId=h,s.priority=y},D=()=>{p()},C=(b=L())==null?void 0:b.appContext.config.globalProperties.trim;return O(()=>{const h={pageNo:1,pageSize:2147483647};i.value&&(r.groupId=i.value),v(h).then(y=>{y.totalList.map(P=>{const G={label:P.name,value:P.id};g.value.push(G)})}),p()}),{...j(e),t:d,onSearch:D,searchParamRef:r,resetTableData:p,onUpdatePageSize:o,updatePriority:k,onCancel:u,onConfirm:f,showModalRef:t,updateItemData:s,taskGroupOptions:g,trim:C}},render(){const{t:l,resetTableData:d,onUpdatePageSize:e,updatePriority:c,onCancel:t,onConfirm:g,onSearch:i,showModalRef:r,updateItemData:s,taskGroupOptions:p,loadingRef:u}=this,{columns:f}=R(c,d);return a(_,{vertical:!0},{default:()=>[a(S,null,{default:()=>[a(_,{justify:"end"},{default:()=>[a(V,{size:"small",options:p,clearable:!0,style:{width:"180px"},value:this.searchParamRef.groupId,"onUpdate:value":o=>this.searchParamRef.groupId=o,placeholder:l("resource.task_group_queue.task_group_name")},null),a(T,{value:this.searchParamRef.processName,"onUpdate:value":o=>this.searchParamRef.processName=o,placeholder:l("resource.task_group_queue.workflow_instance_name"),onSearch:i},null),a(T,{value:this.searchParamRef.instanceName,"onUpdate:value":o=>this.searchParamRef.instanceName=o,placeholder:l("resource.task_group_queue.task_instance_name"),onSearch:i},null),a(X,{size:"small",type:"primary",onClick:i},{default:()=>[a(E,null,{default:()=>[a(A,null,null)]})]})]})]}),a(S,{title:l("resource.task_group_queue.queue")},{default:()=>[a(_,{vertical:!0},{default:()=>[a(J,{loading:u,columns:f,size:"small",data:this.tableData,striped:!0,scrollX:this.tableWidth},null),a(_,{justify:"center"},{default:()=>[a(K,{page:this.page,"onUpdate:page":o=>this.page=o,"page-size":this.pageSize,"onUpdate:page-size":o=>this.pageSize=o,"page-count":this.totalPage,"show-size-picker":!0,"page-sizes":[10,30,50],"show-quick-jumper":!0,onUpdatePage:d,onUpdatePageSize:e},null)]})]})]}),r&&a(F,{show:r,onCancel:t,onConfirm:g,data:s},null)]})}});export{pt as default};
