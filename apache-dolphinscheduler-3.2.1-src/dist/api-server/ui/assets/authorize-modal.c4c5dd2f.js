import{d as j,t as n,bB as Ie,aq as Oe,aC as Ae,an as Ve,au as De,ap as Be,ad as $e,ct as qe,ab as Ee,y as Me,A as q,_ as He,x as We,a as O,N as Ge,z as Q,n as x,g as F,i as A,h as k,f as Z,Q as Ke,m as Qe,l as ne,B as Xe,K as Ye,q as U,aL as Je,by as Ze,u as X,e as et,w as ce,ba as tt,c as g,G as ee,H as te,al as rt}from"./index.851b5188.js";import{e as at}from"./index.605d19c5.js";import{j as ot,k as it}from"./index.56bd039e.js";import{n as st,p as lt,r as nt,s as ct}from"./index.59799c67.js";import{a as ut,b as dt}from"./index.41692750.js";import{r as ht,a as ft,b as mt,c as pt,d as gt,e as bt,f as vt}from"./index.58f13220.js";import{M as zt}from"./index.e69e8738.js";import{D as St,C as H,c as Ct}from"./column-width-config.4c11a147.js";import{S as xt}from"./SearchOutlined.3b9a5586.js";import{u as Rt}from"./use-locale.f8ac8f2c.js";import{N as I}from"./Button.4e249408.js";import{g as yt,N as kt,V as Tt}from"./Selection.28a32045.js";import{a as Pt}from"./Checkbox.98b84c16.js";import{N as Y}from"./Scrollbar.7a99b971.js";import{N as ue}from"./Input.79ba0d48.js";import{u as wt}from"./use-merged-state.e40d3a9f.js";import{u as Ft}from"./use-form-item.bb4d7ada.js";import{d as _t}from"./index.7a579f81.js";import{c as W}from"./resolve-slot.9e6a0162.js";import{N as G}from"./Space.f9ece73f.js";import{N as Nt}from"./Icon.afc45566.js";import{N as jt,a as Lt}from"./DataTable.0e9ec324.js";import{N as Ut}from"./RadioGroup.c3ead4f3.js";import{N as re}from"./RadioButton.cdb434b9.js";import{N as ae}from"./TreeSelect.5a0f3466.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./lodash.68b7405b.js";import"./index.8acb741a.js";import"./keysOf.ab13e590.js";import"./Card.19bc42e2.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./use-false-until-truthy.5d7093c9.js";import"./fade-in.cssr.55dfcced.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./utils.f449ed5c.js";import"./is-browser.45c3bd93.js";import"./index.3ef69258.js";import"./VResizeObserver.6721b9ea.js";import"./Popover.30015336.js";import"./_baseMap.9542141b.js";import"./get.aa32335f.js";import"./format-length.d7d829b3.js";import"./use-compitable.ae5454ac.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.21a8a87f.js";import"./get-slot.80096ab3.js";import"./ArrowDown.45f9e719.js";import"./Radio.fc32ca3b.js";import"./Dropdown.4af83811.js";import"./ChevronRight.d6536995.js";import"./use-keyboard.f4d2f0c0.js";import"./Ellipsis.b13f7726.js";import"./Tooltip.52cb9ce9.js";import"./Select.3e0f2c28.js";import"./Forward.bddcd6d4.js";const It=j({name:"Search",render(){return n("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"enable-background: new 0 0 512 512"},n("path",{d:`M443.5,420.2L336.7,312.4c20.9-26.2,33.5-59.4,33.5-95.5c0-84.5-68.5-153-153.1-153S64,132.5,64,217s68.5,153,153.1,153
  c36.6,0,70.1-12.8,96.5-34.2l106.1,107.1c3.2,3.4,7.6,5.1,11.9,5.1c4.1,0,8.2-1.5,11.3-4.5C449.5,437.2,449.7,426.8,443.5,420.2z
   M217.1,337.1c-32.1,0-62.3-12.5-85-35.2c-22.7-22.7-35.2-52.9-35.2-84.9c0-32.1,12.5-62.3,35.2-84.9c22.7-22.7,52.9-35.2,85-35.2
  c32.1,0,62.3,12.5,85,35.2c22.7,22.7,35.2,52.9,35.2,84.9c0,32.1-12.5,62.3-35.2,84.9C279.4,324.6,249.2,337.1,217.1,337.1z`}))}}),Ot=e=>{const{fontWeight:i,fontSizeLarge:s,fontSizeMedium:l,fontSizeSmall:m,heightLarge:u,heightMedium:h,borderRadius:o,cardColor:p,tableHeaderColor:d,textColor1:R,textColorDisabled:z,textColor2:y,textColor3:T,borderColor:t,hoverColor:a,closeColorHover:c,closeColorPressed:b,closeIconColor:S,closeIconColorHover:v,closeIconColorPressed:r}=e;return Object.assign(Object.assign({},qe),{itemHeightSmall:h,itemHeightMedium:h,itemHeightLarge:u,fontSizeSmall:m,fontSizeMedium:l,fontSizeLarge:s,borderRadius:o,dividerColor:t,borderColor:t,listColor:p,headerColor:Ee(p,d),titleTextColor:R,titleTextColorDisabled:z,extraTextColor:T,extraTextColorDisabled:z,itemTextColor:y,itemTextColorDisabled:z,itemColorPending:a,titleFontWeight:i,closeColorHover:c,closeColorPressed:b,closeIconColor:S,closeIconColorHover:v,closeIconColorPressed:r})},At=Ie({name:"Transfer",common:Oe,peers:{Checkbox:Ae,Scrollbar:Ve,Input:De,Empty:Be,Button:$e},self:Ot}),Vt=At,D=Me("n-transfer"),oe=j({name:"TransferHeader",props:{size:{type:String,required:!0},source:Boolean,onCheckedAll:Function,onClearAll:Function,title:String},setup(e){const{targetOptionsRef:i,canNotSelectAnythingRef:s,canBeClearedRef:l,allCheckedRef:m,mergedThemeRef:u,disabledRef:h,mergedClsPrefixRef:o,srcOptionsLengthRef:p}=q(D),{localeRef:d}=Rt("Transfer");return()=>{const{source:R,onClearAll:z,onCheckedAll:y}=e,{value:T}=u,{value:t}=o,{value:a}=d,c=e.size==="large"?"small":"tiny",{title:b}=e;return n("div",{class:`${t}-transfer-list-header`},b&&n("div",{class:`${t}-transfer-list-header__title`},b),R&&n(I,{class:`${t}-transfer-list-header__button`,theme:T.peers.Button,themeOverrides:T.peerOverrides.Button,size:c,tertiary:!0,onClick:m.value?z:y,disabled:s.value||h.value},{default:()=>m.value?a.unselectAll:a.selectAll}),!R&&l.value&&n(I,{class:`${t}-transfer-list-header__button`,theme:T.peers.Button,themeOverrides:T.peerOverrides.Button,size:c,tertiary:!0,onClick:z,disabled:h.value},{default:()=>a.clearAll}),n("div",{class:`${t}-transfer-list-header__extra`},R?a.total(p.value):a.selected(i.value.length)))}}}),ie=j({name:"NTransferListItem",props:{source:Boolean,label:{type:String,required:!0},value:{type:[String,Number],required:!0},disabled:Boolean,option:{type:Object,required:!0}},setup(e){const{targetValueSetRef:i,mergedClsPrefixRef:s,mergedThemeRef:l,handleItemCheck:m,renderSourceLabelRef:u,renderTargetLabelRef:h}=q(D),o=He(()=>i.value.has(e.value));function p(){e.disabled||m(!o.value,e.value)}return{mergedClsPrefix:s,mergedTheme:l,checked:o,handleClick:p,renderSourceLabel:u,renderTargetLabel:h}},render(){const{disabled:e,mergedTheme:i,mergedClsPrefix:s,label:l,checked:m,source:u,renderSourceLabel:h,renderTargetLabel:o}=this;return n("div",{class:[`${s}-transfer-list-item`,e&&`${s}-transfer-list-item--disabled`,u?`${s}-transfer-list-item--source`:`${s}-transfer-list-item--target`],onClick:u?this.handleClick:void 0},n("div",{class:`${s}-transfer-list-item__background`}),u&&n("div",{class:`${s}-transfer-list-item__checkbox`},n(Pt,{theme:i.peers.Checkbox,themeOverrides:i.peerOverrides.Checkbox,disabled:e,checked:m})),n("div",{class:`${s}-transfer-list-item__label`,title:yt(l)},u?h?h({option:this.option}):l:o?o({option:this.option}):l),!u&&!e&&n(We,{focusable:!1,class:`${s}-transfer-list-item__close`,clsPrefix:s,onClick:this.handleClick}))}}),se=j({name:"TransferList",props:{virtualScroll:{type:Boolean,required:!0},itemSize:{type:Number,required:!0},options:{type:Array,required:!0},disabled:{type:Boolean,required:!0},source:Boolean},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:i}=q(D),s=O(null),l=O(null);function m(){var o;(o=s.value)===null||o===void 0||o.sync()}function u(){const{value:o}=l;if(!o)return null;const{listElRef:p}=o;return p}function h(){const{value:o}=l;if(!o)return null;const{itemsElRef:p}=o;return p}return{mergedTheme:e,mergedClsPrefix:i,scrollerInstRef:s,vlInstRef:l,syncVLScroller:m,scrollContainer:u,scrollContent:h}},render(){const{mergedTheme:e,options:i}=this;if(i.length===0)return n(kt,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty});const{mergedClsPrefix:s,virtualScroll:l,source:m,disabled:u,syncVLScroller:h}=this;return n(Y,{ref:"scrollerInstRef",theme:e.peers.Scrollbar,themeOverrides:e.peerOverrides.Scrollbar,container:l?this.scrollContainer:void 0,content:l?this.scrollContent:void 0},{default:()=>l?n(Tt,{ref:"vlInstRef",style:{height:"100%"},class:`${s}-transfer-list-content`,items:this.options,itemSize:this.itemSize,showScrollbar:!1,onResize:h,onScroll:h,keyField:"value"},{default:({item:o})=>{const{source:p,disabled:d}=this;return n(ie,{source:p,key:o.value,value:o.value,disabled:o.disabled||d,label:o.label,option:o})}}):n("div",{class:`${s}-transfer-list-content`},i.map(o=>n(ie,{source:m,key:o.value,value:o.value,disabled:o.disabled||u,label:o.label,option:o})))})}}),le=j({name:"TransferFilter",props:{value:String,placeholder:String,disabled:Boolean,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:i}=q(D);return{mergedClsPrefix:i,mergedTheme:e}},render(){const{mergedTheme:e,mergedClsPrefix:i}=this;return n("div",{class:`${i}-transfer-filter`},n(ue,{value:this.value,onUpdateValue:this.onUpdateValue,disabled:this.disabled,placeholder:this.placeholder,theme:e.peers.Input,themeOverrides:e.peerOverrides.Input,clearable:!0,size:"small"},{"clear-icon-placeholder":()=>n(Ge,{clsPrefix:i},{default:()=>n(It,null)})}))}});function Dt(e){const i=O(e.defaultValue),s=wt(Q(e,"value"),i),l=x(()=>{const r=new Map;return(e.options||[]).forEach(f=>r.set(f.value,f)),r}),m=x(()=>new Set(s.value||[])),u=x(()=>{const r=l.value,f=[];return(s.value||[]).forEach(P=>{const w=r.get(P);w&&f.push(w)}),f}),h=O(""),o=O(""),p=x(()=>e.sourceFilterable||!!e.filterable),d=x(()=>{if(!p.value)return e.options;const{filter:r}=e;return e.options.filter(f=>r(h.value,f,"source"))}),R=x(()=>{if(!e.targetFilterable)return u.value;const{filter:r}=e;return u.value.filter(f=>r(o.value,f,"target"))}),z=x(()=>{const{value:r}=s;return r===null?new Set:new Set(r)}),y=x(()=>{const r=new Set(z.value);return d.value.forEach(f=>{!f.disabled&&!r.has(f.value)&&r.add(f.value)}),r}),T=x(()=>{const r=new Set(z.value);return d.value.forEach(f=>{!f.disabled&&r.has(f.value)&&r.delete(f.value)}),r}),t=x(()=>{const r=new Set(z.value);return R.value.forEach(f=>{f.disabled||r.delete(f.value)}),r}),a=x(()=>d.value.every(r=>r.disabled)),c=x(()=>{if(!d.value.length)return!1;const r=z.value;return d.value.every(f=>f.disabled||r.has(f.value))}),b=x(()=>R.value.some(r=>!r.disabled));function S(r){h.value=r!=null?r:""}function v(r){o.value=r!=null?r:""}return{uncontrolledValueRef:i,mergedValueRef:s,targetValueSetRef:m,valueSetForCheckAllRef:y,valueSetForUncheckAllRef:T,valueSetForClearRef:t,filteredTgtOptionsRef:R,filteredSrcOptionsRef:d,targetOptionsRef:u,canNotSelectAnythingRef:a,canBeClearedRef:b,allCheckedRef:c,srcPatternRef:h,tgtPatternRef:o,mergedSrcFilterableRef:p,handleSrcFilterUpdateValue:S,handleTgtFilterUpdateValue:v}}const Bt=F("transfer",`
 width: 100%;
 font-size: var(--n-font-size);
 height: 300px;
 display: flex;
 flex-wrap: nowrap;
 word-break: break-word;
`,[A("disabled",[F("transfer-list",[F("transfer-list-header",[k("title",`
 color: var(--n-header-text-color-disabled);
 `),k("extra",`
 color: var(--n-header-extra-text-color-disabled);
 `)])])]),F("transfer-list",`
 flex: 1;
 min-width: 0;
 height: inherit;
 display: flex;
 flex-direction: column;
 background-clip: padding-box;
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-list-color);
 `,[A("source",`
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[k("border","border-right: 1px solid var(--n-divider-color);")]),A("target",`
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[k("border","border-left: none;")]),k("border",`
 padding: 0 12px;
 border: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `),F("transfer-list-header",`
 min-height: var(--n-header-height);
 box-sizing: border-box;
 display: flex;
 padding: 12px 12px 10px 12px;
 align-items: center;
 background-clip: padding-box;
 border-radius: inherit;
 border-bottom-left-radius: 0;
 border-bottom-right-radius: 0;
 line-height: 1.5;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[Z("> *:not(:first-child)",`
 margin-left: 8px;
 `),k("title",`
 flex: 1;
 min-width: 0;
 line-height: 1.5;
 font-size: var(--n-header-font-size);
 font-weight: var(--n-header-font-weight);
 transition: color .3s var(--n-bezier);
 color: var(--n-header-text-color);
 `),k("button",`
 position: relative;
 `),k("extra",`
 transition: color .3s var(--n-bezier);
 font-size: var(--n-extra-font-size);
 margin-right: 0;
 white-space: nowrap;
 color: var(--n-header-extra-text-color);
 `)]),F("transfer-list-body",`
 flex-basis: 0;
 flex-grow: 1;
 box-sizing: border-box;
 position: relative;
 display: flex;
 flex-direction: column;
 border-radius: inherit;
 border-top-left-radius: 0;
 border-top-right-radius: 0;
 `,[F("transfer-filter",`
 padding: 4px 12px 8px 12px;
 box-sizing: border-box;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),F("transfer-list-flex-container",`
 flex: 1;
 position: relative;
 `,[F("scrollbar",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 height: unset;
 `),F("empty",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 `),F("transfer-list-content",`
 padding: 0;
 margin: 0;
 position: relative;
 `,[F("transfer-list-item",`
 padding: 0 12px;
 min-height: var(--n-item-height);
 display: flex;
 align-items: center;
 color: var(--n-item-text-color);
 position: relative;
 transition: color .3s var(--n-bezier);
 `,[k("background",`
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),k("checkbox",`
 position: relative;
 margin-right: 8px;
 `),k("close",`
 opacity: 0;
 pointer-events: none;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),k("label",`
 position: relative;
 min-width: 0;
 flex-grow: 1;
 `),A("source","cursor: pointer;"),A("disabled",`
 cursor: not-allowed;
 color: var(--n-item-text-color-disabled);
 `),Ke("disabled",[Z("&:hover",[k("background","background-color: var(--n-item-color-pending);"),k("close",`
 opacity: 1;
 pointer-events: all;
 `)])])])])])])])]),$t=Object.assign(Object.assign({},ne.props),{value:Array,defaultValue:{type:Array,default:null},options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:void 0},virtualScroll:Boolean,sourceTitle:String,targetTitle:String,filterable:{type:Boolean,default:void 0},sourceFilterable:Boolean,targetFilterable:Boolean,sourceFilterPlaceholder:String,targetFilterPlaceholder:String,filter:{type:Function,default:(e,i)=>e?~(""+i.label).toLowerCase().indexOf((""+e).toLowerCase()):!0},size:String,renderSourceLabel:Function,renderTargetLabel:Function,renderSourceList:Function,renderTargetList:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),K=j({name:"Transfer",props:$t,setup(e){const{mergedClsPrefixRef:i}=Qe(e),s=ne("Transfer","-transfer",Bt,Vt,e,i),l=Ft(e),{mergedSizeRef:m,mergedDisabledRef:u}=l,h=x(()=>{const{value:C}=m,{self:{[U("itemHeight",C)]:N}}=s.value;return _t(N)}),{uncontrolledValueRef:o,mergedValueRef:p,targetValueSetRef:d,valueSetForCheckAllRef:R,valueSetForUncheckAllRef:z,valueSetForClearRef:y,filteredTgtOptionsRef:T,filteredSrcOptionsRef:t,targetOptionsRef:a,canNotSelectAnythingRef:c,canBeClearedRef:b,allCheckedRef:S,srcPatternRef:v,tgtPatternRef:r,mergedSrcFilterableRef:f,handleSrcFilterUpdateValue:P,handleTgtFilterUpdateValue:w}=Dt(e);function _(C){const{onUpdateValue:N,"onUpdate:value":L,onChange:B}=e,{nTriggerFormInput:E,nTriggerFormChange:M}=l;N&&W(N,C),L&&W(L,C),B&&W(B,C),o.value=C,E(),M()}function de(){_([...R.value])}function he(){_([...z.value])}function fe(){_([...y.value])}function J(C,N){_(C?(p.value||[]).concat(N):(p.value||[]).filter(L=>L!==N))}function me(C){_(C)}return Xe(D,{targetValueSetRef:d,mergedClsPrefixRef:i,disabledRef:u,mergedThemeRef:s,targetOptionsRef:a,canNotSelectAnythingRef:c,canBeClearedRef:b,allCheckedRef:S,srcOptionsLengthRef:x(()=>e.options.length),handleItemCheck:J,renderSourceLabelRef:Q(e,"renderSourceLabel"),renderTargetLabelRef:Q(e,"renderTargetLabel")}),{mergedClsPrefix:i,mergedDisabled:u,itemSize:h,isMounted:Ye(),mergedTheme:s,filteredSrcOpts:t,filteredTgtOpts:T,srcPattern:v,tgtPattern:r,mergedSize:m,mergedSrcFilterable:f,handleSrcFilterUpdateValue:P,handleTgtFilterUpdateValue:w,handleSourceCheckAll:de,handleSourceUncheckAll:he,handleTargetClearAll:fe,handleItemCheck:J,handleChecked:me,cssVars:x(()=>{const{value:C}=m,{common:{cubicBezierEaseInOut:N},self:{borderRadius:L,borderColor:B,listColor:E,titleTextColor:M,titleTextColorDisabled:pe,extraTextColor:ge,itemTextColor:be,itemColorPending:ve,itemTextColorDisabled:ze,titleFontWeight:Se,closeColorHover:Ce,closeColorPressed:xe,closeIconColor:Re,closeIconColorHover:ye,closeIconColorPressed:ke,closeIconSize:Te,closeSize:Pe,dividerColor:we,extraTextColorDisabled:Fe,[U("extraFontSize",C)]:_e,[U("fontSize",C)]:Ne,[U("titleFontSize",C)]:je,[U("itemHeight",C)]:Le,[U("headerHeight",C)]:Ue}}=s.value;return{"--n-bezier":N,"--n-border-color":B,"--n-border-radius":L,"--n-extra-font-size":_e,"--n-font-size":Ne,"--n-header-font-size":je,"--n-header-extra-text-color":ge,"--n-header-extra-text-color-disabled":Fe,"--n-header-font-weight":Se,"--n-header-text-color":M,"--n-header-text-color-disabled":pe,"--n-item-color-pending":ve,"--n-item-height":Le,"--n-item-text-color":be,"--n-item-text-color-disabled":ze,"--n-list-color":E,"--n-header-height":Ue,"--n-close-size":Pe,"--n-close-icon-size":Te,"--n-close-color-hover":Ce,"--n-close-color-pressed":xe,"--n-close-icon-color":Re,"--n-close-icon-color-hover":ye,"--n-close-icon-color-pressed":ke,"--n-divider-color":we}})}},render(){const{mergedClsPrefix:e,renderSourceList:i,renderTargetList:s,mergedTheme:l,mergedSrcFilterable:m,targetFilterable:u}=this;return n("div",{class:[`${e}-transfer`,this.mergedDisabled&&`${e}-transfer--disabled`],style:this.cssVars},n("div",{class:`${e}-transfer-list ${e}-transfer-list--source`},n(oe,{source:!0,title:this.sourceTitle,onCheckedAll:this.handleSourceCheckAll,onClearAll:this.handleSourceUncheckAll,size:this.mergedSize}),n("div",{class:`${e}-transfer-list-body`},m?n(le,{onUpdateValue:this.handleSrcFilterUpdateValue,value:this.srcPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,n("div",{class:`${e}-transfer-list-flex-container`},i?n(Y,{theme:l.peers.Scrollbar,themeOverrides:l.peerOverrides.Scrollbar},{default:()=>i({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.srcPattern})}):n(se,{source:!0,options:this.filteredSrcOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),n("div",{class:`${e}-transfer-list__border`})),n("div",{class:`${e}-transfer-list ${e}-transfer-list--target`},n(oe,{onClearAll:this.handleTargetClearAll,size:this.mergedSize,title:this.targetTitle}),n("div",{class:`${e}-transfer-list-body`},u?n(le,{onUpdateValue:this.handleTgtFilterUpdateValue,value:this.tgtPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,n("div",{class:`${e}-transfer-list-flex-container`},s?n(Y,{theme:l.peers.Scrollbar,themeOverrides:l.peerOverrides.Scrollbar},{default:()=>s({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.tgtPattern})}):n(se,{options:this.filteredTgtOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),n("div",{class:`${e}-transfer-list__border`})))}});function qt(){const e=Je({saving:!1,loading:!1,projectIds:"",currentRecord:{},projectWithAuthorizedLevel:[],authorizedProjects:[],unauthorizedProjects:[],authorizedDatasources:[],unauthorizedDatasources:[],authorizedUdfs:[],unauthorizedUdfs:[],authorizedNamespaces:[],unauthorizedNamespaces:[],resourceType:"file",fileResources:[],udfResources:[],authorizedFileResources:[],authorizedUdfResources:[],pagination:{pageSize:5,page:1,totalPage:0},searchVal:"",userId:0}),i=async t=>{if(e.loading)return;e.loading=!0,t&&(e.userId=t);const a=await at({userId:t,searchVal:e.searchVal,pageSize:e.pagination.pageSize,pageNo:e.pagination.page});if(e.loading=!1,!a)throw Error();return e.pagination.totalPage=a.totalPage,e.projectWithAuthorizedLevel=a.totalList,e.projectWithAuthorizedLevel},s=async t=>{e.pagination.page=t,await i(e.userId)},l=async t=>{e.pagination.page=1,e.pagination.pageSize=t,await i(e.userId)},m=async(t,a)=>{await ht({userId:t,projectIds:a}),await i(t)},u=async(t,a)=>{await ft({userId:t,projectIds:a}),await i(t)},h=async(t,a)=>{await mt({userId:t,projectIds:a}),await i(t)},o=async t=>{if(e.loading)return;e.loading=!0;const a=await Promise.all([ot({userId:t}),it({userId:t})]);e.loading=!1,e.authorizedDatasources=a[0].map(c=>c.id),e.unauthorizedDatasources=[...a[0],...a[1]].map(c=>({label:c.name,value:c.id}))},p=async t=>{if(e.loading)return;e.loading=!0;const a=await Promise.all([st({userId:t}),lt({userId:t})]);e.loading=!1,e.authorizedUdfs=a[0].map(c=>c.id),e.unauthorizedUdfs=[...a[0],...a[1]].map(c=>({label:c.funcName,value:c.id}))},d=async t=>{if(e.loading)return;e.loading=!0;const a=await Promise.all([nt({userId:t}),ct({userId:t})]);e.loading=!1,Ze.removeUselessChildren(a[0]);const c=[],b=[];a[0].forEach(r=>{r.type==="FILE"?b.push(r):c.push(r)});const S=[],v=[];a[1].forEach(r=>{r.type==="FILE"?v.push(r.id):S.push(r.id)}),e.fileResources=b,e.udfResources=c,e.authorizedFileResources=v,e.authorizedUdfResources=S},R=async t=>{if(e.loading)return;e.loading=!0;const a=await Promise.all([ut({userId:t}),dt({userId:t})]);e.loading=!1,e.authorizedNamespaces=a[0].map(c=>c.id),e.unauthorizedNamespaces=[...a[0],...a[1]].map(c=>({label:c.namespace,value:c.id}))},z=(t,a)=>{t==="authorize_project"&&i(a),t==="authorize_datasource"&&o(a),t==="authorize_udf"&&p(a),t==="authorize_resource"&&d(a),t==="authorize_namespace"&&R(a)},y=(t,a)=>{let c=[];if(t.length===0)return a&&c.unshift(t),c;const b=(S,v)=>{for(let r=0,f=S.length;r<f;r++){const P=S[r];if(P.id===v){c.unshift(P),b(t,P.pid);break}else P.children&&b(P.children,v)}return c};return c=b(t,a),c};return{state:e,onInit:z,onSave:async(t,a)=>{if(e.saving)return!1;if(e.saving=!0,t==="authorize_datasource"&&await pt({userId:a,datasourceIds:e.authorizedDatasources.join(",")}),t==="authorize_udf"&&await gt({userId:a,udfIds:e.authorizedUdfs.join(",")}),t==="authorize_resource"){let c=[];const b=[];e.authorizedFileResources.forEach(f=>{e.fileResources.forEach(P=>{const w=[];w[0]=P,y(w,f).length>0&&(c=y(w,f).map(_=>_.id),b.push(c.join("-")))})});let S=[];const v=[];e.authorizedUdfResources.forEach(f=>{e.udfResources.forEach(P=>{const w=[];w[0]=P,y(w,f).length>0&&(S=y(w,f).map(_=>_.id),v.push(S.join("-")))})});const r=b.concat(v);await bt({userId:a,resourceIds:r.join(",")})}return t==="authorize_namespace"&&await vt({userId:a,namespaceIds:e.authorizedNamespaces.join(",")}),e.saving=!1,!0},getProjects:i,revokeProjectByIdRequest:m,grantProjectRequest:u,grantProjectWithReadPermRequest:h,requestData:s,handleChangePageSize:l}}const Et="_transfer_kqexw_17",Mt="_pagination_kqexw_21",$={transfer:Et,pagination:Mt},Ht=[{label:"project.list.no_permission",value:0},{label:"project.list.read_permission",value:2},{label:"project.list.all_permission",value:7}];function Wt(){const{t:e}=X(),i=O({columns:[],tableWidth:St}),s=()=>{const l=[{type:"selection",key:"selection",...H.checkbox},{title:e("project.list.project_name"),key:"name",...H.size},{title:e("project.list.authorize_level"),key:"perm",render:m=>Ht.filter(u=>u.value==m.perm).map(u=>e(u.label)),...H.index}];i.value={columns:l,tableWidth:Ct(l)}};return et(()=>{s()}),ce(X().locale,()=>{s()}),{columnsRef:i,createColumns:s}}function V(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!rt(e)}const Gt={show:{type:Boolean,default:!1},userId:{type:Number,default:0},type:{type:String,default:"auth_project"}},Yr=j({name:"authorize-project-modal",props:Gt,emits:["cancel"],setup(e,i){const{t:s}=X(),{state:l,onInit:m,onSave:u,getProjects:h,revokeProjectByIdRequest:o,grantProjectRequest:p,grantProjectWithReadPermRequest:d,requestData:R,handleChangePageSize:z}=qt(),y=()=>{i.emit("cancel")},T=async()=>{await u(e.type,e.userId)&&y()},t=()=>{o(e.userId,l.projectIds)},a=()=>{d(e.userId,l.projectIds)},c=()=>{p(e.userId,l.projectIds)},{columnsRef:b}=Wt(),S=v=>{l.projectIds=v.join()};return ce(()=>e.show,()=>{e.show&&m(e.type,e.userId)}),{t:s,columnsRef:b,rowKey:v=>v.id,...tt(l),onCancel:y,onConfirm:T,getProjects:h,handleCheck:S,requestData:R,handleChangePageSize:z,onRevokeProject:t,onGrantReadPerm:a,onGrantAllPerm:c}},render(e){let i,s,l,m,u;const{t:h}=this,{type:o,userId:p}=e;return g(zt,{show:this.show,title:h(`security.user.${o}`),onCancel:this.onCancel,confirmLoading:this.loading,onConfirm:this.onConfirm,confirmClassName:"btn-submit",cancelClassName:"btn-cancel"},{default:()=>[o==="authorize_project"&&g(G,{vertical:!0},{default:()=>[g(G,null,{default:()=>[g(I,{size:"small",type:"primary",onClick:this.onRevokeProject},V(i=h("security.user.revoke_auth"))?i:{default:()=>[i]}),g(I,{size:"small",type:"primary",onClick:this.onGrantReadPerm},V(s=h("security.user.grant_read"))?s:{default:()=>[s]}),g(I,{size:"small",type:"primary",onClick:this.onGrantAllPerm},V(l=h("security.user.grant_all"))?l:{default:()=>[l]}),g(ue,{size:"small",placeholder:h("project.list.project_tips"),clearable:!0,value:this.searchVal,"onUpdate:value":d=>this.searchVal=d},null),g(I,{size:"small",type:"primary",onClick:()=>this.getProjects(p)},{default:()=>[g(Nt,null,{default:()=>[g(xt,null,null)]})]})]}),g(jt,{virtualScroll:!0,"row-class-name":"items",columns:this.columnsRef.columns,data:this.projectWithAuthorizedLevel,loading:this.loading,"max-height":"250","row-key":this.rowKey,"on-update:checked-row-keys":this.handleCheck},null),g("div",{class:$.pagination},[g(Lt,{page:this.pagination.page,"onUpdate:page":d=>this.pagination.page=d,"page-size":this.pagination.pageSize,"onUpdate:page-size":d=>this.pagination.pageSize=d,"page-count":this.pagination.totalPage,"show-size-picker":!0,"page-sizes":[5,10],"show-quick-jumper":!0,onUpdatePage:this.requestData,onUpdatePageSize:this.handleChangePageSize},null)])]}),o==="authorize_datasource"&&g(K,{virtualScroll:!0,options:this.unauthorizedDatasources,filterable:!0,value:this.authorizedDatasources,"onUpdate:value":d=>this.authorizedDatasources=d,class:$.transfer},null),o==="authorize_udf"&&g(K,{virtualScroll:!0,options:this.unauthorizedUdfs,filterable:!0,value:this.authorizedUdfs,"onUpdate:value":d=>this.authorizedUdfs=d,class:$.transfer},null),o==="authorize_resource"&&g(G,{vertical:!0},{default:()=>[g(Ut,{value:this.resourceType,"onUpdate:value":d=>this.resourceType=d},{default:()=>[g(re,{key:"file",value:"file"},V(m=h("security.user.file_resource"))?m:{default:()=>[m]}),g(re,{key:"udf",value:"udf"},V(u=h("security.user.udf_resource"))?u:{default:()=>[u]})]}),ee(g(ae,{filterable:!0,multiple:!0,cascade:!0,checkable:!0,checkStrategy:"child","key-field":"id","label-field":"fullName",options:this.fileResources,value:this.authorizedFileResources,"onUpdate:value":d=>this.authorizedFileResources=d},null),[[te,this.resourceType==="file"]]),ee(g(ae,{filterable:!0,multiple:!0,cascade:!0,checkable:!0,checkStrategy:"child","key-field":"id","label-field":"fullName",options:this.udfResources,value:this.authorizedUdfResources,"onUpdate:value":d=>this.authorizedUdfResources=d},null),[[te,this.resourceType==="udf"]])]}),o==="authorize_namespace"&&g(K,{virtualScroll:!0,options:this.unauthorizedNamespaces,filterable:!0,value:this.authorizedNamespaces,"onUpdate:value":d=>this.authorizedNamespaces=d,class:$.transfer},null)]})}});export{Yr as AuthorizeModal,Yr as default};
