import{u as g,aL as h,a as f,d as D,e as v,at as C,ba as j,c as r}from"./index.851b5188.js";import{M as k}from"./index.e69e8738.js";import{u as z,c as b}from"./index.336ca31d.js";import{b as S}from"./index.605d19c5.js";import{N as w}from"./Form.9f7fa8c1.js";import{N as s}from"./FormItem.f5b3f80b.js";import{N as c}from"./Input.79ba0d48.js";import{a as N}from"./Select.3e0f2c28.js";import{N as y}from"./InputNumber.cc83334e.js";import"./index.8acb741a.js";import"./Button.4e249408.js";import"./is-browser.45c3bd93.js";import"./use-form-item.bb4d7ada.js";import"./resolve-slot.9e6a0162.js";import"./keysOf.ab13e590.js";import"./Card.19bc42e2.js";import"./index.7a579f81.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./utils.f449ed5c.js";import"./index.3ef69258.js";import"./Space.f9ece73f.js";import"./get-slot.80096ab3.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./lodash.68b7405b.js";import"./format-length.d7d829b3.js";import"./get.aa32335f.js";import"./use-locale.f8ac8f2c.js";import"./use-merged-state.e40d3a9f.js";import"./Suffix.21a8a87f.js";import"./use-compitable.ae5454ac.js";import"./Selection.28a32045.js";import"./Popover.30015336.js";import"./_baseMap.9542141b.js";import"./next-frame-once.e5ee25e8.js";import"./Add.3164a73d.js";function I(){const{t}=g(),o=h({formRef:f(),formData:{id:0,name:"",projectCode:null,groupSize:"",status:1,description:""},saving:!1,rules:{name:{required:!0,trigger:["input","blur"],validator(){if(!o.formData.name)return new Error(t("resource.task_group_option.please_enter_name"))}},groupSize:{required:!0,trigger:["input","blur"],validator(){if(!o.formData.groupSize)return new Error(t("resource.task_group_option.please_enter_resource_pool_size"));if(!/^[1-9]\d*$/.test(o.formData.groupSize))return new Error(t("resource.task_group_option.resource_pool_size")+t("resource.task_group_option.positive_integer_tips"))}},projectCode:{required:!0,trigger:["input","blur"],validator(){if(!o.formData.projectCode)return new Error(t("resource.task_group_option.please_select_project"))}}}});return{state:o,t}}const F={show:{type:Boolean,default:!1},data:{type:Object},status:{type:Number,default:0}},vt=D({name:"FormModal",props:F,emits:["confirm","cancel"],setup(t,{emit:o}){var u;const{state:e,t:p}=I(),i=f([]);v(()=>{S().then(m=>{m.map(l=>{const _={label:l.name,value:l.code};i.value.push(_)})}),t.status===1?(e.formData.id=t.data.id,e.formData.name=t.data.name,e.formData.projectCode=t.data.projectCode,e.formData.groupSize=String(t.data.groupSize),e.formData.status=t.data.status,e.formData.description=t.data.description):e.formData.groupSize="10"});const n=async()=>{if(!e.saving){e.saving=!0;try{t.status===1?await z(e.formData):await b(e.formData),e.saving=!1,o("confirm")}catch{e.saving=!1}}},a=()=>{e.formData.projectCode="",e.formData.description="",o("cancel")},d=(u=C())==null?void 0:u.appContext.config.globalProperties.trim;return{...j(e),t:p,onConfirm:n,onCancel:a,projectOptions:i,trim:d}},render(){const{t,onConfirm:o,onCancel:e,show:p,status:i,projectOptions:n}=this;return r(k,{title:t(i===0?"resource.task_group_option.create":"resource.task_group_option.edit"),show:p,onConfirm:o,onCancel:e,confirmDisabled:!this.formData.name||!this.formData.groupSize||!this.formData.projectCode,confirmLoading:this.saving},{default:()=>[r(w,{rules:this.rules,ref:"formRef"},{default:()=>[r(s,{label:t("resource.task_group_option.name"),path:"name"},{default:()=>[r(c,{allowInput:this.trim,value:this.formData.name,"onUpdate:value":a=>this.formData.name=a,placeholder:t("resource.task_group_option.please_enter_name")},null)]}),this.status===0&&r(s,{label:t("resource.task_group_option.project_name"),path:"projectCode"},{default:()=>[r(N,{options:n,value:this.formData.projectCode,"onUpdate:value":a=>this.formData.projectCode=a,placeholder:t("resource.task_group_option.please_select_project")},null)]}),r(s,{label:t("resource.task_group_option.resource_pool_size"),path:"groupSize"},{default:()=>[r(y,{value:this.formData.groupSize,"onUpdate:value":a=>this.formData.groupSize=a,style:{width:"100%"},min:1,placeholder:t("resource.task_group_option.please_enter_resource_pool_size")},null)]}),r(s,{label:t("resource.task_group_option.desc"),path:"description"},{default:()=>[r(c,{allowInput:this.trim,value:this.formData.description,"onUpdate:value":a=>this.formData.description=a,type:"textarea",placeholder:t("resource.task_group_option.please_enter_desc")},null)]})]})]})}});export{vt as default};
