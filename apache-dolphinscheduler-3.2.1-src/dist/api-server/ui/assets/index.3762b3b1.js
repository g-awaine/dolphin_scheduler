import w from"./detail.b82e5ce0.js";import{C as M}from"./index.6c124806.js";import{bq as D,u as I,t as l,aL as k,d as R,a as C,at as b,e as A,w as L,ba as U,c as a,al as j}from"./index.851b5188.js";import{E as V}from"./EditOutlined.e0b6da4a.js";import{D as x}from"./DeleteOutlined.07e1d3fe.js";import{N as P}from"./Tooltip.52cb9ce9.js";import{N as y}from"./Button.4e249408.js";import{N as v}from"./Icon.afc45566.js";import{N as O}from"./Popconfirm.013915ef.js";import{N as p}from"./Space.f9ece73f.js";import{d as E,a as H}from"./index.9bc4b0ad.js";import{p as z}from"./common.ee372ad3.js";import{f as T}from"./index.d671386a.js";import{S as q}from"./index.94a7e931.js";import{S as B}from"./SearchOutlined.3b9a5586.js";import{N as $,a as F}from"./DataTable.0e9ec324.js";import"./lodash.68b7405b.js";import"./service.4be3af67.js";import"./ui-setting.39219f0f.js";import"./index.e69e8738.js";import"./index.8acb741a.js";import"./keysOf.ab13e590.js";import"./Card.19bc42e2.js";import"./resolve-slot.9e6a0162.js";import"./index.7a579f81.js";import"./index.e739cd60.js";import"./flatten.05a2e46f.js";import"./Scrollbar.7a99b971.js";import"./fade-in.cssr.55dfcced.js";import"./VResizeObserver.6721b9ea.js";import"./use-false-until-truthy.5d7093c9.js";import"./fade-in-scale-up.cssr.5737b1c6.js";import"./utils.f449ed5c.js";import"./is-browser.45c3bd93.js";import"./index.3ef69258.js";import"./get-elements-by-json.9201707b.js";import"./Form.9f7fa8c1.js";import"./FormItem.f5b3f80b.js";import"./use-form-item.bb4d7ada.js";import"./format-length.d7d829b3.js";import"./get.aa32335f.js";import"./Grid.3ae564e0.js";import"./get-slot.80096ab3.js";import"./next-frame-once.e5ee25e8.js";import"./Spin.447cad15.js";import"./use-compitable.ae5454ac.js";import"./Input.79ba0d48.js";import"./use-locale.f8ac8f2c.js";import"./use-merged-state.e40d3a9f.js";import"./Suffix.21a8a87f.js";import"./Radio.fc32ca3b.js";import"./RadioGroup.c3ead4f3.js";import"./index.2fc51a01.js";import"./Switch.f95d65b1.js";import"./InputNumber.cc83334e.js";import"./Add.3164a73d.js";import"./Select.3e0f2c28.js";import"./Selection.28a32045.js";import"./Popover.30015336.js";import"./_baseMap.9542141b.js";import"./Checkbox.98b84c16.js";import"./TreeSelect.5a0f3466.js";import"./SettingOutlined.e20148d7.js";import"./PauseCircleOutlined.28d888d0.js";import"./CloseCircleOutlined.9e282d8c.js";import"./CheckCircleOutlined.67794958.js";import"./ArrowDown.45f9e719.js";import"./Dropdown.4af83811.js";import"./ChevronRight.d6536995.js";import"./use-keyboard.f4d2f0c0.js";import"./Ellipsis.b13f7726.js";import"./Forward.bddcd6d4.js";function G(){return{IS_ADMIN:D().getUserInfo.userType==="ADMIN_USER"}}function J(e){const{t}=I();return{getColumns:()=>[{title:"#",key:"index",render:(n,s)=>s+1},{title:t("security.alarm_instance.alarm_instance_name"),key:"instanceName"},{title:t("security.alarm_instance.alarm_plugin_name"),key:"alertPluginName"},{title:t("security.alarm_instance.create_time"),key:"createTime"},{title:t("security.alarm_instance.update_time"),key:"updateTime"},{title:t("security.alarm_instance.operation"),key:"operation",width:150,render:n=>l(p,null,{default:()=>[l(P,null,{trigger:()=>l(y,{circle:!0,type:"info",size:"small",onClick:()=>void e(n,"edit")},{default:()=>l(v,null,{default:()=>l(V)})}),default:()=>t("security.alarm_instance.edit")}),l(P,null,{trigger:()=>l(O,{onPositiveClick:()=>void e(n,"delete"),negativeText:t("security.alarm_instance.cancel"),positiveText:t("security.alarm_instance.confirm")},{trigger:()=>l(y,{circle:!0,type:"error",size:"small"},{default:()=>l(v,null,{default:()=>l(x)})}),default:()=>t("security.alarm_instance.delete_confirm")}),default:()=>t("security.alarm_instance.delete")})]})}]}}function K(){const e=k({page:1,pageSize:10,itemCount:0,searchVal:"",list:[],loading:!1}),t=async()=>{if(e.loading)return;e.loading=!0;const{totalList:r,total:u}=await H({pageNo:e.page,pageSize:e.pageSize,searchVal:e.searchVal});if(e.loading=!1,!r)throw Error();e.list=r.map(o=>(o.createTime=o.createTime?T(z(o.createTime),"yyyy-MM-dd HH:mm:ss"):"",o.updateTime=o.updateTime?T(z(o.updateTime),"yyyy-MM-dd HH:mm:ss"):"",o)),e.itemCount=u},i=()=>{e.list.length===1&&e.page>1&&--e.page,t()};return{data:e,changePage:r=>{e.page=r,t()},changePageSize:r=>{e.page=1,e.pageSize=r,t()},deleteRecord:async r=>{await E(r),i()},updateList:i}}function Q(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!j(e)}const ft=R({name:"alarm-instance-manage",setup(){var g;const{t:e}=I(),t=C(!1),i=C(),n=C(),{IS_ADMIN:s}=G(),{data:d,changePage:r,changePageSize:u,deleteRecord:o,updateList:_}=K(),{getColumns:f}=J((m,N)=>{N==="edit"?(t.value=!0,i.value=m):o(m.id)}),h=()=>{i.value=null,t.value=!0},S=()=>{t.value=!1,i.value={}},c=(g=b())==null?void 0:g.appContext.config.globalProperties.trim;return A(()=>{r(1),n.value=f()}),L(I().locale,()=>{n.value=f()}),{t:e,IS_ADMIN:s,showDetailModal:t,currentRecord:i,columns:n,...U(d),changePage:r,changePageSize:u,onCreate:h,onCloseModal:S,onUpdatedList:_,trim:c}},render(){const{t:e,IS_ADMIN:t,currentRecord:i,showDetailModal:n,columns:s,list:d,page:r,pageSize:u,itemCount:o,loading:_,changePage:f,changePageSize:h,onCreate:S,onUpdatedList:c,onCloseModal:g}=this;return a(p,{vertical:!0},{default:()=>[a(M,null,{default:()=>{let m;return a(p,{justify:"space-between"},{default:()=>[t&&a(y,{onClick:S,type:"primary",size:"small"},Q(m=e("security.alarm_instance.create_alarm_instance"))?m:{default:()=>[m]}),a(p,{justify:"end",wrap:!1},{default:()=>[a(q,{value:this.searchVal,"onUpdate:value":N=>this.searchVal=N,placeholder:`${e("security.alarm_instance.search_input_tips")}`,onSearch:c},null),a(y,{type:"primary",size:"small",onClick:c},{default:()=>[a(v,null,{default:()=>[a(B,null,null)]})]})]})]})}}),a(M,{title:e("menu.alarm_instance_manage")},{default:()=>[a(p,{vertical:!0},{default:()=>[a($,{columns:s,data:d,loading:_,striped:!0},null),a(p,{justify:"center"},{default:()=>[a(F,{page:r,"page-size":u,"item-count":o,"show-quick-jumper":!0,"on-update:page":f,"on-update:page-size":h},null)]})]})]}),t&&a(w,{show:n,currentRecord:i,onCancel:g,onUpdate:c},null)]})}});export{ft as default};
