[WI-0][TI-0] - [WARN] 2024-05-03 08:08:35.467 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [WARN] 2024-05-03 08:08:46.157 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [INFO] 2024-05-03 08:08:46.160 +0800 o.a.d.s.w.WorkerServer:[634] - No active profile set, falling back to 1 default profile: "default"
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:02.823 +0800 o.s.c.c.s.GenericScope:[283] - BeanFactory id=7e7bf7c6-2cb3-34d2-a0d5-a56161c67d0e
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.106 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.113 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.120 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$392/189820624] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.216 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.345 +0800 o.a.d.c.u.NetUtils:[312] - Get all NetworkInterfaces: [name:eth0 (eth0), name:lo (lo)]
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.709 +0800 o.a.d.s.w.c.WorkerConfig:[98] - 
****************************Worker Configuration**************************************
  listen-port -> 1234
  exec-threads -> 100
  max-heartbeat-interval -> PT10S
  host-weight -> 100
  tenantConfig -> TenantConfig(autoCreateTenantEnabled=true, distributedTenantEnabled=false, defaultTenantEnabled=false)
  server-load-protection -> WorkerServerLoadProtection(enabled=true, maxCpuUsagePercentageThresholds=0.7, maxJVMMemoryUsagePercentageThresholds=0.7, maxSystemMemoryUsagePercentageThresholds=0.7, maxDiskUsagePercentageThresholds=0.7)
  registry-disconnect-strategy -> ConnectStrategyProperties(strategy=WAITING, maxWaitingTime=PT1M40S)
  task-execute-threads-full-policy: REJECT
  address -> 172.18.1.1:1234
  registry-path: /nodes/worker/172.18.1.1:1234
****************************Worker Configuration**************************************
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:06.709 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'workerConfig' of type [org.apache.dolphinscheduler.server.worker.config.WorkerConfig$$EnhancerBySpringCGLIB$$153d90bb] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:07.503 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:07.703 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'kubernetes.manifests-io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:07.785 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration' of type [io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:07.830 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultApiClient' of type [io.kubernetes.client.openapi.ApiClient] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:08.895 +0800 o.e.j.u.log:[170] - Logging initialized @56368ms to org.eclipse.jetty.util.log.Slf4jLog
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:09.915 +0800 o.s.b.w.e.j.JettyServletWebServerFactory:[166] - Server initialized with port: 1235
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:09.920 +0800 o.e.j.s.Server:[375] - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 1.8.0_402-b06
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:10.523 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring embedded WebApplicationContext
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:10.547 +0800 o.s.b.w.s.c.ServletWebServerApplicationContext:[292] - Root WebApplicationContext: initialization completed in 24213 ms
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:12.544 +0800 o.e.j.s.session:[334] - DefaultSessionIdManager workerName=node0
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:12.553 +0800 o.e.j.s.session:[339] - No SessionScavenger set, using defaults
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:12.571 +0800 o.e.j.s.session:[132] - node0 Scavenging every 600000ms
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:12.612 +0800 o.e.j.s.h.ContextHandler:[921] - Started o.s.b.w.e.j.JettyEmbeddedWebAppContext@5403431a{application,/,[file:///tmp/jetty-docbase.1235.4101160957497901049/],AVAILABLE}
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:12.613 +0800 o.e.j.s.Server:[415] - Started @60085ms
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.605 +0800 o.a.c.f.i.CuratorFrameworkImpl:[338] - Starting
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.638 +0800 o.a.z.ZooKeeper:[98] - Client environment:zookeeper.version=3.8.0-5a02a05eddb59aee6ac762f7ea82e92a68eb9c0f, built on 2022-02-25 08:49 UTC
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.639 +0800 o.a.z.ZooKeeper:[98] - Client environment:host.name=77ecb91773e5
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.640 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.version=1.8.0_402
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.640 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.vendor=Temurin
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.640 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.home=/opt/java/openjdk
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.641 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.class.path=/opt/dolphinscheduler/conf:/opt/dolphinscheduler/libs/kerb-client-1.0.1.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/oauth2-oidc-sdk-9.35.jar:/opt/dolphinscheduler/libs/jsqlparser-4.4.jar:/opt/dolphinscheduler/libs/reactive-streams-1.0.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-extensions-5.10.2.jar:/opt/dolphinscheduler/libs/zookeeper-3.8.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-apps-5.10.2.jar:/opt/dolphinscheduler/libs/grpc-api-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pigeon-3.2.1.jar:/opt/dolphinscheduler/libs/client-java-api-13.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-obs-3.2.1.jar:/opt/dolphinscheduler/libs/spring-web-5.3.22.jar:/opt/dolphinscheduler/libs/aws-java-sdk-emr-1.12.300.jar:/opt/dolphinscheduler/libs/spring-context-5.3.22.jar:/opt/dolphinscheduler/libs/gapic-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/jetty-io-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/annotations-13.0.jar:/opt/dolphinscheduler/libs/jpam-1.1.jar:/opt/dolphinscheduler/libs/joda-time-2.10.13.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-autoconfig-2.1.3.jar:/opt/dolphinscheduler/libs/kerb-identity-1.0.1.jar:/opt/dolphinscheduler/libs/vertica-jdbc-12.0.4-0.jar:/opt/dolphinscheduler/libs/grpc-googleapis-1.52.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-kms-2.11.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dvc-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-hana-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-httpclient-okhttp-6.0.0.jar:/opt/dolphinscheduler/libs/jline-2.12.jar:/opt/dolphinscheduler/libs/sshd-core-2.8.0.jar:/opt/dolphinscheduler/libs/jna-platform-5.10.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-sqlserver-3.2.1.jar:/opt/dolphinscheduler/libs/commons-beanutils-1.9.4.jar:/opt/dolphinscheduler/libs/grpc-services-1.41.0.jar:/opt/dolphinscheduler/libs/jmespath-java-1.12.300.jar:/opt/dolphinscheduler/libs/curator-client-5.3.0.jar:/opt/dolphinscheduler/libs/proto-google-common-protos-2.0.1.jar:/opt/dolphinscheduler/libs/mybatis-3.5.10.jar:/opt/dolphinscheduler/libs/jackson-annotations-2.13.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-all-3.2.1.jar:/opt/dolphinscheduler/libs/jakarta.xml.bind-api-2.3.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-jupyter-3.2.1.jar:/opt/dolphinscheduler/libs/mybatis-plus-extension-3.5.2.jar:/opt/dolphinscheduler/libs/j2objc-annotations-1.3.jar:/opt/dolphinscheduler/libs/Java-WebSocket-1.5.1.jar:/opt/dolphinscheduler/libs/azure-storage-common-12.20.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-sagemaker-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-databend-3.2.1.jar:/opt/dolphinscheduler/libs/google-auth-library-oauth2-http-1.15.0.jar:/opt/dolphinscheduler/libs/jetty-security-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-python-3.2.1.jar:/opt/dolphinscheduler/libs/snappy-java-1.1.10.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-batch-5.10.2.jar:/opt/dolphinscheduler/libs/netty-transport-native-epoll-4.1.53.Final-linux-x86_64.jar:/opt/dolphinscheduler/libs/jackson-core-asl-1.9.13.jar:/opt/dolphinscheduler/libs/gson-fire-1.8.5.jar:/opt/dolphinscheduler/libs/clickhouse-jdbc-0.4.6.jar:/opt/dolphinscheduler/libs/grpc-netty-shaded-1.41.0.jar:/opt/dolphinscheduler/libs/caffeine-2.9.3.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-core-4.5.10.jar:/opt/dolphinscheduler/libs/jackson-module-jaxb-annotations-2.13.3.jar:/opt/dolphinscheduler/libs/jetty-http-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jersey-servlet-1.19.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dinky-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_common-0.15.0.jar:/opt/dolphinscheduler/libs/netty-handler-4.1.53.Final.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datafactory-3.2.1.jar:/opt/dolphinscheduler/libs/json-path-2.7.0.jar:/opt/dolphinscheduler/libs/mybatis-plus-annotation-3.5.2.jar:/opt/dolphinscheduler/libs/azure-resourcemanager-datafactory-1.0.0-beta.19.jar:/opt/dolphinscheduler/libs/commons-codec-1.11.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-master-3.2.1.jar:/opt/dolphinscheduler/libs/spring-aop-5.3.22.jar:/opt/dolphinscheduler/libs/kubernetes-model-core-5.10.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-networking-5.10.2.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk7-1.6.21.jar:/opt/dolphinscheduler/libs/kerby-xdr-1.0.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-ram-3.1.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-k8s-3.2.1.jar:/opt/dolphinscheduler/libs/guava-31.1-jre.jar:/opt/dolphinscheduler/libs/netty-codec-dns-4.1.53.Final.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-kubeflow-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-azure-sql-3.2.1.jar:/opt/dolphinscheduler/libs/HikariCP-4.0.3.jar:/opt/dolphinscheduler/libs/hive-metastore-2.3.9.jar:/opt/dolphinscheduler/libs/msal4j-1.13.3.jar:/opt/dolphinscheduler/libs/jackson-core-2.13.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-hive-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mr-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-node-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-common-3.2.1.jar:/opt/dolphinscheduler/libs/jose4j-0.7.8.jar:/opt/dolphinscheduler/libs/jul-to-slf4j-1.7.36.jar:/opt/dolphinscheduler/libs/azure-identity-1.7.1.jar:/opt/dolphinscheduler/libs/spring-boot-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/commons-math3-3.1.1.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-json-provider-2.13.3.jar:/opt/dolphinscheduler/libs/perfmark-api-0.23.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-doris-3.2.1.jar:/opt/dolphinscheduler/libs/httpclient-4.5.13.jar:/opt/dolphinscheduler/libs/hive-service-2.3.9.jar:/opt/dolphinscheduler/libs/kerby-util-1.0.1.jar:/opt/dolphinscheduler/libs/commons-collections-3.2.2.jar:/opt/dolphinscheduler/libs/hadoop-yarn-client-3.2.4.jar:/opt/dolphinscheduler/libs/commons-text-1.8.jar:/opt/dolphinscheduler/libs/dolphinscheduler-worker-3.2.1.jar:/opt/dolphinscheduler/libs/hadoop-yarn-common-3.2.4.jar:/opt/dolphinscheduler/libs/zeppelin-client-0.10.1.jar:/opt/dolphinscheduler/libs/azure-core-management-1.10.1.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-jobclient-3.2.4.jar:/opt/dolphinscheduler/libs/jta-1.1.jar:/opt/dolphinscheduler/libs/annotations-4.1.1.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-alert-3.2.1.jar:/opt/dolphinscheduler/libs/curator-framework-5.3.0.jar:/opt/dolphinscheduler/libs/hive-jdbc-2.3.9.jar:/opt/dolphinscheduler/libs/kyuubi-hive-jdbc-shaded-1.7.0.jar:/opt/dolphinscheduler/libs/client-java-proto-13.0.2.jar:/opt/dolphinscheduler/libs/checker-qual-3.19.0.jar:/opt/dolphinscheduler/libs/jetty-servlet-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/google-cloud-core-grpc-2.10.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-shell-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-rsa-1.0.10.RELEASE.jar:/opt/dolphinscheduler/libs/avro-1.7.7.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-postgresql-3.2.1.jar:/opt/dolphinscheduler/libs/netty-nio-client-2.17.282.jar:/opt/dolphinscheduler/libs/spring-webmvc-5.3.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-mysql-3.2.1.jar:/opt/dolphinscheduler/libs/opentracing-util-0.33.0.jar:/opt/dolphinscheduler/libs/auto-value-1.10.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-all-3.2.1.jar:/opt/dolphinscheduler/libs/jetcd-core-0.5.11.jar:/opt/dolphinscheduler/libs/grpc-context-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datasync-3.2.1.jar:/opt/dolphinscheduler/libs/jackson-dataformat-cbor-2.13.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-gcs-3.2.1.jar:/opt/dolphinscheduler/libs/client-java-extended-13.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-redshift-3.2.1.jar:/opt/dolphinscheduler/libs/opencsv-2.3.jar:/opt/dolphinscheduler/libs/jcip-annotations-1.0-1.jar:/opt/dolphinscheduler/libs/accessors-smart-2.4.8.jar:/opt/dolphinscheduler/libs/hadoop-client-3.2.4.jar:/opt/dolphinscheduler/libs/commons-collections4-4.3.jar:/opt/dolphinscheduler/libs/metrics-core-4.2.11.jar:/opt/dolphinscheduler/libs/netty-resolver-4.1.53.Final.jar:/opt/dolphinscheduler/libs/parquet-hadoop-bundle-1.8.1.jar:/opt/dolphinscheduler/libs/bucket4j-core-6.2.0.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-3.1.3.jar:/opt/dolphinscheduler/libs/mssql-jdbc-11.2.1.jre8.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final.jar:/opt/dolphinscheduler/libs/kubernetes-model-coordination-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-linkis-3.2.1.jar:/opt/dolphinscheduler/libs/commons-net-3.6.jar:/opt/dolphinscheduler/libs/netty-transport-native-kqueue-4.1.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/dolphinscheduler-meter-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-client-api-6.0.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-certificates-5.10.2.jar:/opt/dolphinscheduler/libs/opencensus-api-0.31.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mlflow-3.2.1.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk8-1.6.21.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-jdbc-3.2.1.jar:/opt/dolphinscheduler/libs/audience-annotations-0.12.0.jar:/opt/dolphinscheduler/libs/simpleclient_httpserver-0.15.0.jar:/opt/dolphinscheduler/libs/jetty-xml-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/kerby-asn1-1.0.1.jar:/opt/dolphinscheduler/libs/lang-tag-1.6.jar:/opt/dolphinscheduler/libs/api-common-2.6.0.jar:/opt/dolphinscheduler/libs/HdrHistogram-2.1.12.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-abs-3.2.1.jar:/opt/dolphinscheduler/libs/failsafe-2.4.4.jar:/opt/dolphinscheduler/libs/hbase-noop-htrace-4.1.1.jar:/opt/dolphinscheduler/libs/jamon-runtime-2.3.1.jar:/opt/dolphinscheduler/libs/jetty-util-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/threetenbp-1.6.5.jar:/opt/dolphinscheduler/libs/jakarta.activation-api-1.2.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-common-5.10.2.jar:/opt/dolphinscheduler/libs/okhttp-4.9.3.jar:/opt/dolphinscheduler/libs/profiles-2.17.282.jar:/opt/dolphinscheduler/libs/hadoop-auth-3.2.4.jar:/opt/dolphinscheduler/libs/grpc-netty-1.41.0.jar:/opt/dolphinscheduler/libs/httpcore-nio-4.4.15.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-seatunnel-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-sagemaker-1.12.300.jar:/opt/dolphinscheduler/libs/oshi-core-6.1.1.jar:/opt/dolphinscheduler/libs/bonecp-0.8.0.RELEASE.jar:/opt/dolphinscheduler/libs/jackson-module-parameter-names-2.13.3.jar:/opt/dolphinscheduler/libs/bcutil-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/aws-json-protocol-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-base-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-all-3.2.1.jar:/opt/dolphinscheduler/libs/derby-10.14.2.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-snowflake-3.2.1.jar:/opt/dolphinscheduler/libs/netty-codec-http2-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jetty-continuation-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jackson-mapper-asl-1.9.13.jar:/opt/dolphinscheduler/libs/datanucleus-core-4.1.17.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-osx-aarch_64.jar:/opt/dolphinscheduler/libs/failureaccess-1.0.1.jar:/opt/dolphinscheduler/libs/error_prone_annotations-2.5.1.jar:/opt/dolphinscheduler/libs/kerb-admin-1.0.1.jar:/opt/dolphinscheduler/libs/token-provider-1.0.1.jar:/opt/dolphinscheduler/libs/reactor-netty-core-1.0.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-all-3.2.1.jar:/opt/dolphinscheduler/libs/jakarta.servlet-api-4.0.4.jar:/opt/dolphinscheduler/libs/http-client-spi-2.17.282.jar:/opt/dolphinscheduler/libs/regions-2.17.282.jar:/opt/dolphinscheduler/libs/logback-core-1.2.11.jar:/opt/dolphinscheduler/libs/json-1.8.jar:/opt/dolphinscheduler/libs/gax-grpc-2.23.0.jar:/opt/dolphinscheduler/libs/google-http-client-1.42.3.jar:/opt/dolphinscheduler/libs/hive-serde-2.3.9.jar:/opt/dolphinscheduler/libs/jettison-1.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-http-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-zookeeper-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-crypto-5.7.3.jar:/opt/dolphinscheduler/libs/auth-2.17.282.jar:/opt/dolphinscheduler/libs/proto-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/jetty-server-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/javax.annotation-api-1.3.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-starrocks-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dataquality-3.2.1.jar:/opt/dolphinscheduler/libs/jcl-over-slf4j-1.7.36.jar:/opt/dolphinscheduler/libs/commons-lang3-3.12.0.jar:/opt/dolphinscheduler/libs/tomcat-embed-el-9.0.65.jar:/opt/dolphinscheduler/libs/opentracing-noop-0.33.0.jar:/opt/dolphinscheduler/libs/client-java-13.0.2.jar:/opt/dolphinscheduler/libs/spring-beans-5.3.22.jar:/opt/dolphinscheduler/libs/snakeyaml-1.33.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-ssh-3.2.1.jar:/opt/dolphinscheduler/libs/commons-pool-1.6.jar:/opt/dolphinscheduler/libs/javax.servlet-api-3.1.0.jar:/opt/dolphinscheduler/libs/hadoop-common-3.2.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-apiextensions-5.10.2.jar:/opt/dolphinscheduler/libs/spring-boot-2.7.3.jar:/opt/dolphinscheduler/libs/bcprov-ext-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/spring-boot-starter-2.7.3.jar:/opt/dolphinscheduler/libs/paranamer-2.3.jar:/opt/dolphinscheduler/libs/httpmime-4.5.13.jar:/opt/dolphinscheduler/libs/reactor-core-3.4.22.jar:/opt/dolphinscheduler/libs/azure-core-1.36.0.jar:/opt/dolphinscheduler/libs/bcpkix-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/kubernetes-model-scheduling-5.10.2.jar:/opt/dolphinscheduler/libs/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/dolphinscheduler/libs/websocket-client-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/unirest-java-3.7.04-standalone.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-core-3.2.4.jar:/opt/dolphinscheduler/libs/google-auth-library-credentials-1.15.0.jar:/opt/dolphinscheduler/libs/azure-storage-internal-avro-12.6.0.jar:/opt/dolphinscheduler/libs/jackson-datatype-jdk8-2.13.3.jar:/opt/dolphinscheduler/libs/spring-expression-5.3.22.jar:/opt/dolphinscheduler/libs/aspectjweaver-1.9.7.jar:/opt/dolphinscheduler/libs/websocket-common-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/client-java-api-fluent-13.0.2.jar:/opt/dolphinscheduler/libs/mybatis-plus-3.5.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-athena-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-oss-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-openmldb-3.2.1.jar:/opt/dolphinscheduler/libs/curator-recipes-5.3.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-api-3.2.1.jar:/opt/dolphinscheduler/libs/netty-all-4.1.53.Final.jar:/opt/dolphinscheduler/libs/netty-resolver-dns-4.1.53.Final.jar:/opt/dolphinscheduler/libs/kubernetes-model-autoscaling-5.10.2.jar:/opt/dolphinscheduler/libs/kerb-util-1.0.1.jar:/opt/dolphinscheduler/libs/grpc-alts-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-presto-3.2.1.jar:/opt/dolphinscheduler/libs/kerb-simplekdc-1.0.1.jar:/opt/dolphinscheduler/libs/protobuf-java-util-3.17.2.jar:/opt/dolphinscheduler/libs/azure-core-http-netty-1.13.0.jar:/opt/dolphinscheduler/libs/transaction-api-1.1.jar:/opt/dolphinscheduler/libs/datanucleus-api-jdo-4.2.4.jar:/opt/dolphinscheduler/libs/zeppelin-common-0.10.1.jar:/opt/dolphinscheduler/libs/zt-zip-1.15.jar:/opt/dolphinscheduler/libs/animal-sniffer-annotations-1.19.jar:/opt/dolphinscheduler/libs/google-http-client-jackson2-1.42.3.jar:/opt/dolphinscheduler/libs/netty-buffer-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jsr305-3.0.0.jar:/opt/dolphinscheduler/libs/netty-transport-classes-epoll-4.1.79.Final.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/simpleclient-0.15.0.jar:/opt/dolphinscheduler/libs/aliyun-sdk-oss-3.15.1.jar:/opt/dolphinscheduler/libs/json-utils-2.17.282.jar:/opt/dolphinscheduler/libs/tephra-api-0.6.0.jar:/opt/dolphinscheduler/libs/spring-jdbc-5.3.22.jar:/opt/dolphinscheduler/libs/grpc-xds-1.41.0.jar:/opt/dolphinscheduler/libs/logback-classic-1.2.11.jar:/opt/dolphinscheduler/libs/google-cloud-storage-2.18.0.jar:/opt/dolphinscheduler/libs/micrometer-registry-prometheus-1.9.3.jar:/opt/dolphinscheduler/libs/grpc-core-1.41.0.jar:/opt/dolphinscheduler/libs/aws-java-sdk-kms-1.12.300.jar:/opt/dolphinscheduler/libs/kubernetes-model-rbac-5.10.2.jar:/opt/dolphinscheduler/libs/ini4j-0.5.4.jar:/opt/dolphinscheduler/libs/spring-boot-starter-web-2.7.3.jar:/opt/dolphinscheduler/libs/spring-cloud-commons-3.1.3.jar:/opt/dolphinscheduler/libs/netty-codec-http-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jetty-client-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jetcd-common-0.5.11.jar:/opt/dolphinscheduler/libs/metrics-spi-2.17.282.jar:/opt/dolphinscheduler/libs/utils-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-emr-3.2.1.jar:/opt/dolphinscheduler/libs/protocol-core-2.17.282.jar:/opt/dolphinscheduler/libs/micrometer-core-1.9.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-unix-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.4.11.jar:/opt/dolphinscheduler/libs/annotations-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sql-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-common-3.2.1.jar:/opt/dolphinscheduler/libs/apache-client-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-oceanbase-3.2.1.jar:/opt/dolphinscheduler/libs/jdo-api-3.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datax-3.2.1.jar:/opt/dolphinscheduler/libs/postgresql-42.4.1.jar:/opt/dolphinscheduler/libs/jetty-util-ajax-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/gax-2.23.0.jar:/opt/dolphinscheduler/libs/grpc-stub-1.41.0.jar:/opt/dolphinscheduler/libs/libfb303-0.9.3.jar:/opt/dolphinscheduler/libs/spring-core-5.3.22.jar:/opt/dolphinscheduler/libs/jaxb-api-2.3.1.jar:/opt/dolphinscheduler/libs/hive-service-rpc-2.3.9.jar:/opt/dolphinscheduler/libs/kubernetes-model-flowcontrol-5.10.2.jar:/opt/dolphinscheduler/libs/commons-logging-1.1.1.jar:/opt/dolphinscheduler/libs/mybatis-spring-2.0.7.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-oracle-3.2.1.jar:/opt/dolphinscheduler/libs/opencensus-proto-0.2.0.jar:/opt/dolphinscheduler/libs/grpc-protobuf-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-clickhouse-3.2.1.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-bootstrap-3.1.3.jar:/opt/dolphinscheduler/libs/kubernetes-model-admissionregistration-5.10.2.jar:/opt/dolphinscheduler/libs/grpc-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/esdk-obs-java-bundle-3.23.3.jar:/opt/dolphinscheduler/libs/dnsjava-2.1.7.jar:/opt/dolphinscheduler/libs/asm-9.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-spark-3.2.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-linux-aarch_64.jar:/opt/dolphinscheduler/libs/re2j-1.6.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-vertica-3.2.1.jar:/opt/dolphinscheduler/libs/json-smart-2.4.8.jar:/opt/dolphinscheduler/libs/reactor-netty-http-1.0.22.jar:/opt/dolphinscheduler/libs/google-api-services-storage-v1-rev20220705-2.0.0.jar:/opt/dolphinscheduler/libs/kubernetes-client-6.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-kyuubi-3.2.1.jar:/opt/dolphinscheduler/libs/auto-value-annotations-1.10.1.jar:/opt/dolphinscheduler/libs/commons-cli-1.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-data-quality-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-chunjun-3.2.1.jar:/opt/dolphinscheduler/libs/kerb-server-1.0.1.jar:/opt/dolphinscheduler/libs/content-type-2.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-remoteshell-3.2.1.jar:/opt/dolphinscheduler/libs/opencensus-contrib-http-util-0.31.1.jar:/opt/dolphinscheduler/libs/druid-1.2.20.jar:/opt/dolphinscheduler/libs/javolution-5.5.1.jar:/opt/dolphinscheduler/libs/protobuf-java-3.17.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-db2-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-core-1.12.300.jar:/opt/dolphinscheduler/libs/spring-boot-starter-logging-2.7.3.jar:/opt/dolphinscheduler/libs/kerby-pkix-1.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-procedure-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-etcd-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sqoop-3.2.1.jar:/opt/dolphinscheduler/libs/zookeeper-jute-3.8.0.jar:/opt/dolphinscheduler/libs/netty-resolver-dns-native-macos-4.1.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sagemaker-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-configuration-processor-2.6.1.jar:/opt/dolphinscheduler/libs/hive-common-2.3.9.jar:/opt/dolphinscheduler/libs/kerb-common-1.0.1.jar:/opt/dolphinscheduler/libs/stax-api-1.0.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-storageclass-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-s3-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-jetty-2.7.3.jar:/opt/dolphinscheduler/libs/okio-2.8.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dms-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_common-0.15.0.jar:/opt/dolphinscheduler/libs/sdk-core-2.17.282.jar:/opt/dolphinscheduler/libs/javax.activation-api-1.2.0.jar:/opt/dolphinscheduler/libs/netty-handler-proxy-4.1.53.Final.jar:/opt/dolphinscheduler/libs/kerby-config-1.0.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-classes-2.0.53.Final.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-base-2.13.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-trino-3.2.1.jar:/opt/dolphinscheduler/libs/presto-jdbc-0.238.1.jar:/opt/dolphinscheduler/libs/websocket-api-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-api-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-metrics-5.10.2.jar:/opt/dolphinscheduler/libs/datasync-2.17.282.jar:/opt/dolphinscheduler/libs/hadoop-yarn-api-3.2.4.jar:/opt/dolphinscheduler/libs/google-http-client-apache-v2-1.42.3.jar:/opt/dolphinscheduler/libs/hadoop-annotations-3.2.4.jar:/opt/dolphinscheduler/libs/google-oauth-client-1.34.1.jar:/opt/dolphinscheduler/libs/sshd-common-2.8.0.jar:/opt/dolphinscheduler/libs/LatencyUtils-2.0.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-spark-3.2.1.jar:/opt/dolphinscheduler/libs/slf4j-api-1.7.36.jar:/opt/dolphinscheduler/libs/snowflake-jdbc-3.13.29.jar:/opt/dolphinscheduler/libs/jackson-datatype-jsr310-2.13.3.jar:/opt/dolphinscheduler/libs/trino-jdbc-402.jar:/opt/dolphinscheduler/libs/logging-interceptor-4.9.3.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel_agent-0.15.0.jar:/opt/dolphinscheduler/libs/janino-3.0.16.jar:/opt/dolphinscheduler/libs/jackson-dataformat-yaml-2.13.3.jar:/opt/dolphinscheduler/libs/ion-java-1.0.2.jar:/opt/dolphinscheduler/libs/commons-dbcp-1.4.jar:/opt/dolphinscheduler/libs/jsp-api-2.1.jar:/opt/dolphinscheduler/libs/google-http-client-gson-1.42.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-hivecli-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/google-cloud-core-http-2.10.0.jar:/opt/dolphinscheduler/libs/DmJdbcDriver18-8.1.2.79.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-java-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-dameng-3.2.1.jar:/opt/dolphinscheduler/libs/sshd-sftp-2.8.0.jar:/opt/dolphinscheduler/libs/kerb-crypto-1.0.1.jar:/opt/dolphinscheduler/libs/conscrypt-openjdk-uber-2.5.2.jar:/opt/dolphinscheduler/libs/httpcore-4.4.15.jar:/opt/dolphinscheduler/libs/lz4-java-1.4.0.jar:/opt/dolphinscheduler/libs/guava-retrying-2.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-stream-3.2.1.jar:/opt/dolphinscheduler/libs/spring-tx-5.3.22.jar:/opt/dolphinscheduler/libs/grpc-auth-1.41.0.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/databend-jdbc-0.0.7.jar:/opt/dolphinscheduler/libs/bcprov-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/commons-lang-2.6.jar:/opt/dolphinscheduler/libs/kubernetes-model-policy-5.10.2.jar:/opt/dolphinscheduler/libs/commons-io-2.11.0.jar:/opt/dolphinscheduler/libs/grpc-grpclb-1.41.0.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-linux-x86_64.jar:/opt/dolphinscheduler/libs/opentracing-api-0.33.0.jar:/opt/dolphinscheduler/libs/sshd-scp-2.8.0.jar:/opt/dolphinscheduler/libs/reload4j-1.2.18.3.jar:/opt/dolphinscheduler/libs/netty-tcnative-2.0.48.Final.jar:/opt/dolphinscheduler/libs/jdom2-2.0.6.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-json-2.7.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-epoll-4.1.53.Final.jar:/opt/dolphinscheduler/libs/google-cloud-core-2.10.0.jar:/opt/dolphinscheduler/libs/javax.jdo-3.2.0-m3.jar:/opt/dolphinscheduler/libs/gax-httpjson-0.108.0.jar:/opt/dolphinscheduler/libs/mybatis-plus-core-3.5.2.jar:/opt/dolphinscheduler/libs/auto-service-annotations-1.0.1.jar:/opt/dolphinscheduler/libs/nimbus-jose-jwt-9.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-zeppelin-3.2.1.jar:/opt/dolphinscheduler/libs/commons-compress-1.21.jar:/opt/dolphinscheduler/libs/hadoop-hdfs-client-3.2.4.jar:/opt/dolphinscheduler/libs/msal4j-persistence-extension-1.1.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pytorch-3.2.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-windows-x86_64.jar:/opt/dolphinscheduler/libs/jetty-servlets-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/woodstox-core-6.4.0.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-commons-2.1.3.jar:/opt/dolphinscheduler/libs/grpc-protobuf-lite-1.41.0.jar:/opt/dolphinscheduler/libs/jetty-webapp-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/eventstream-1.0.1.jar:/opt/dolphinscheduler/libs/commons-compiler-3.1.7.jar:/opt/dolphinscheduler/libs/netty-transport-4.1.53.Final.jar:/opt/dolphinscheduler/libs/spring-cloud-context-3.1.3.jar:/opt/dolphinscheduler/libs/aws-java-sdk-dms-1.12.300.jar:/opt/dolphinscheduler/libs/hive-storage-api-2.4.0.jar:/opt/dolphinscheduler/libs/client-java-spring-integration-13.0.2.jar:/opt/dolphinscheduler/libs/spring-boot-starter-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/third-party-jackson-core-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-hdfs-3.2.1.jar:/opt/dolphinscheduler/libs/netty-codec-4.1.53.Final.jar:/opt/dolphinscheduler/libs/google-http-client-appengine-1.42.3.jar:/opt/dolphinscheduler/libs/commons-configuration2-2.1.1.jar:/opt/dolphinscheduler/libs/datanucleus-rdbms-4.1.19.jar:/opt/dolphinscheduler/libs/swagger-annotations-1.6.2.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel-0.15.0.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-common-1.6.21.jar:/opt/dolphinscheduler/libs/aws-core-2.17.282.jar:/opt/dolphinscheduler/libs/kerb-core-1.0.1.jar:/opt/dolphinscheduler/libs/httpasyncclient-4.1.5.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-worker-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-spi-3.2.1.jar:/opt/dolphinscheduler/libs/okhttp-2.7.5.jar:/opt/dolphinscheduler/libs/google-api-client-2.2.0.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-1.6.21.jar:/opt/dolphinscheduler/libs/jakarta.websocket-api-1.1.2.jar:/opt/dolphinscheduler/libs/libthrift-0.9.3.jar:/opt/dolphinscheduler/libs/spring-boot-starter-aop-2.7.3.jar:/opt/dolphinscheduler/libs/netty-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/log4j-1.2-api-2.17.2.jar:/opt/dolphinscheduler/libs/jackson-databind-2.13.4.jar:/opt/dolphinscheduler/libs/jackson-dataformat-xml-2.13.3.jar:/opt/dolphinscheduler/libs/kubernetes-model-events-5.10.2.jar:/opt/dolphinscheduler/libs/gson-2.9.1.jar:/opt/dolphinscheduler/libs/proto-google-iam-v1-1.9.0.jar:/opt/dolphinscheduler/libs/netty-codec-socks-4.1.53.Final.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.3.0.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-common-3.2.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-api-3.2.1.jar:/opt/dolphinscheduler/libs/azure-storage-blob-12.21.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-zeppelin-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-api-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-s3-1.12.300.jar:/opt/dolphinscheduler/libs/stax2-api-4.2.1.jar:/opt/dolphinscheduler/libs/jakarta.annotation-api-1.3.5.jar:/opt/dolphinscheduler/libs/kubernetes-model-discovery-5.10.2.jar:/opt/dolphinscheduler/libs/jna-5.10.0.jar:/opt/dolphinscheduler/libs/spring-jcl-5.3.22.jar
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.641 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.642 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.io.tmpdir=/tmp
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.642 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.compiler=<NA>
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.642 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.name=Linux
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.642 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.arch=amd64
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.643 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.version=6.5.0-28-generic
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.643 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.name=root
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.643 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.home=/root
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.643 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.dir=/opt/dolphinscheduler
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.664 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.free=3210MB
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.676 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.max=3840MB
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.678 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.total=3840MB
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.704 +0800 o.a.z.ZooKeeper:[637] - Initiating client connection, connectString=dolphinscheduler-zookeeper:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@1de08775
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.738 +0800 o.a.z.c.X509Util:[77] - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.775 +0800 o.a.z.ClientCnxnSocket:[239] - jute.maxbuffer value is 1048575 Bytes
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.823 +0800 o.a.z.ClientCnxn:[1732] - zookeeper.request.timeout value is 0. feature enabled=false
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.873 +0800 o.a.c.f.i.CuratorFrameworkImpl:[386] - Default schema
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.897 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.4:2181.
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.911 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:14.933 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.1.1:33938, server: dolphinscheduler-zookeeper/172.18.0.4:2181
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:15.030 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.4:2181, session id = 0x1000001af460000, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:15.046 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: CONNECTED
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:15.483 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:15.484 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:16.346 +0800 o.a.d.s.w.r.WorkerRpcServer:[41] - WorkerRpcServer starting...
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.285 +0800 o.a.d.e.b.NettyRemotingServer:[112] - WorkerRpcServer bind success at port: 1234
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.286 +0800 o.a.d.s.w.r.WorkerRpcServer:[43] - WorkerRpcServer started...
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.455 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.805 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.839 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.859 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.867 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.889 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.892 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.909 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.909 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.945 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.954 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.959 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.962 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.968 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:18.972 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.001 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.002 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.026 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.026 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.032 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.048 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.053 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.054 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.061 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.061 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.063 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.066 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.113 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.114 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.130 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.131 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.141 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.142 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.152 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.152 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.169 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.169 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.171 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.178 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.194 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.194 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.219 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.220 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.222 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.222 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.247 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.248 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.251 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.252 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.281 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.281 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.292 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.302 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.305 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.306 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.328 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.329 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.332 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.332 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.335 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.336 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.402 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.403 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.405 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.405 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.429 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:19.781 +0800 o.a.d.c.u.JSONUtils:[72] - init timezone: sun.util.calendar.ZoneInfo[id="Asia/Shanghai",offset=28800000,dstSavings=0,useDaylight=false,transitions=31,lastRule=null]
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:20.317 +0800 o.a.d.s.w.r.WorkerRegistryClient:[104] - Worker node: 172.18.1.1:1234 registry to ZK /nodes/worker/172.18.1.1:1234 successfully
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.415 +0800 o.a.d.c.m.BaseHeartBeatTask:[48] - Starting WorkerHeartBeatTask...
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.417 +0800 o.a.d.c.m.BaseHeartBeatTask:[50] - Started WorkerHeartBeatTask, heartBeatInterval: 10000...
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.417 +0800 o.a.d.s.w.r.WorkerRegistryClient:[114] - Worker node: 172.18.1.1:1234 registry finished
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.421 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.3435374149659864 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.430 +0800 o.a.d.s.w.m.MessageRetryRunner:[69] - Message retry runner staring
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.577 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionFinishEventSender
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.578 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionInfoUpdateEventSender
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.610 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionRunningEventSender
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:21.611 +0800 o.a.d.s.w.m.MessageRetryRunner:[75] - Message retry runner started
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:22.571 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.3694267515923566 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:23.575 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1551020408163264 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:24.691 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.7222222222222223 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:25.697 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.797752808988764 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:27.500 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.5169491525423728 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:28.506 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.2162162162162162 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:29.769 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.5340314136125655 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:30.846 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.8372093023255813 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:31.860 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:32.916 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.3513513513513513 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:33.928 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.2523809523809524 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:34.955 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1580547112462005 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:35.960 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1715039577836412 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:36.966 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1130225979408572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:37.968 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1661891117478511 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:38.605 +0800 o.s.b.a.e.w.EndpointLinksResolver:[58] - Exposing 3 endpoint(s) beneath base path '/actuator'
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:38.977 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1780415430267062 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.057 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring DispatcherServlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.061 +0800 o.s.w.s.DispatcherServlet:[525] - Initializing Servlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.069 +0800 o.s.w.s.DispatcherServlet:[547] - Completed initialization in 7 ms
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.136 +0800 o.e.j.s.AbstractConnector:[333] - Started ServerConnector@1f45db49{HTTP/1.1, (http/1.1)}{0.0.0.0:1235}
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.139 +0800 o.s.b.w.e.j.JettyWebServer:[172] - Jetty started on port(s) 1235 (http/1.1) with context path '/'
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.214 +0800 o.a.d.s.w.WorkerServer:[61] - Started WorkerServer in 77.02 seconds (JVM running for 86.687)
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:39.981 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.2468085106382978 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:40.984 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0742857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:42.075 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.884297520661157 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:43.179 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.947089947089947 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:44.414 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9772727272727273 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:45.429 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9854545454545454 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:46.455 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0957095709570956 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:47.482 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.2347417840375585 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:48.485 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7613636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:49.549 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8314606741573034 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:50.553 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9728506787330317 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:51.555 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9885714285714285 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:52.560 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0056179775280898 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:53.584 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9685714285714286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:54.596 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8993193301874973 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:55.598 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.841897233201581 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:56.601 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9556213017751479 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:57.606 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9576271186440679 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:58.613 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.979591836734694 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:09:59.618 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9558232931726907 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:00.624 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.803191489361702 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:01.626 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7859424920127797 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:02.636 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8333333333333334 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:03.744 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8797250859106529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:04.757 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7704918032786886 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:05.793 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9248554913294798 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:06.797 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9521276595744681 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:07.805 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8347826086956521 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:08.844 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7698412698412698 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:10.922 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7372549019607842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:11.985 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7914110429447853 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:13.007 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9482758620689655 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:40.205 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7034883720930233 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:10:41.280 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7423728813559322 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:49.282 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7028571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:51.360 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8472222222222221 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:52.417 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8556430446194225 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:53.419 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7797619047619047 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:54.420 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8364197530864198 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:55.422 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9338842975206612 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:56.424 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8135593220338984 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:57.429 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7551020408163265 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:12:58.432 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7804154302670623 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:13:03.474 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:13:07.517 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7696629213483146 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:13:09.631 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.752236727589208 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:27.941 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7871720116618076 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:28.973 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7213114754098361 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:34.837 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2408, taskName=hash_article_data, firstSubmitTime=1714695573923, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=8, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2408'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503081933'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.857 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.870 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.876 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.876 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695574877
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2408
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.886 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2408,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714695573923,
  "startTime" : 1714695574877,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/8/813/2408.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 8,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2408"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503081933"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "813_2408",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:34.902 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:34.997 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8683473389355744 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.002 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.020 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408 check successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.032 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.075 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.079 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.086 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.088 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.089 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.094 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.094 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.101 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.102 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408/py_813_2408.py
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.102 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.138 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.138 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.138 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408/py_813_2408.py
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.139 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.141 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408/813_2408.sh
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:35.153 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 196
[WI-0][TI-2408] - [INFO] 2024-05-03 08:19:35.714 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2408, success=true)
[WI-0][TI-2408] - [INFO] 2024-05-03 08:19:35.730 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2408)
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:36.169 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.173 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408, processId:196 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.178 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.209 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.210 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.210 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.218 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2408
[WI-813][TI-2408] - [INFO] 2024-05-03 08:19:36.221 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2408] - [INFO] 2024-05-03 08:19:36.685 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2408, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:36.916 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2409, taskName=check if it exists in the database, firstSubmitTime=1714695576750, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=8, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2409'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503081936'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@54af772, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.921 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.928 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.933 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695576934
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2409
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2409,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714695576750,
  "startTime" : 1714695576934,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/8/813/2409.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 8,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2409"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503081936"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "813_2409",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.957 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.957 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.957 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2409 check successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:36.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.001 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.002 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.012 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.014 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.015 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.017 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.017 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.017 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
 , localParams : [Property{prop='hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.024 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: HANA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.025 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: HANA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.027 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SQLSERVER
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.027 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SQLSERVER
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.029 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SAGEMAKER
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.029 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SAGEMAKER
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.031 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DATABEND
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.031 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DATABEND
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.081 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: AZURESQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.081 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: AZURESQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.086 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: HIVE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.088 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: HIVE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.090 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DORIS
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.090 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DORIS
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.095 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: POSTGRESQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.096 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: POSTGRESQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.098 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: MYSQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.099 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: MYSQL
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.102 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: REDSHIFT
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.102 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: REDSHIFT
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.105 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SNOWFLAKE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.105 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SNOWFLAKE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.109 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: STARROCKS
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.109 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: STARROCKS
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.112 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SSH
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.113 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SSH
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.115 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ATHENA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.116 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ATHENA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.118 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: PRESTO
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.118 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: PRESTO
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.120 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: OCEANBASE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.121 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: OCEANBASE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.139 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ORACLE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.140 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ORACLE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.147 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: CLICKHOUSE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.147 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: CLICKHOUSE
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.151 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: VERTICA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.151 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: VERTICA
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.154 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: KYUUBI
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.154 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: KYUUBI
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.157 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DB2
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.158 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DB2
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.168 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: TRINO
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.169 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: TRINO
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.171 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SPARK
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.171 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SPARK
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.174 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DAMENG
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.174 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DAMENG
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.176 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ZEPPELIN
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.176 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ZEPPELIN
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.300 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
 successfully.
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.300 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.301 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.302 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.302 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.303 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.328 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: hive
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.330 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: hive
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.330 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: vertica
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.340 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: vertica
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.340 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: doris
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.340 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: doris
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.340 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: ssh
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.341 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: ssh
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.341 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: databend
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.341 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: databend
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.342 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: sqlserver
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.342 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: sqlserver
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.342 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: postgresql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.342 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: postgresql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.343 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: redshift
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.343 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: redshift
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.343 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: spark
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.344 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: spark
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.344 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: oceanbase
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.345 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: oceanbase
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.345 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: starrocks
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.346 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: starrocks
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.346 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: mysql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.346 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: mysql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.346 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: hana
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.347 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: hana
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.347 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: sagemaker
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.347 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: sagemaker
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.347 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: dameng
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.348 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: dameng
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.348 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: snowflake
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.349 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: snowflake
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.350 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: oracle
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.350 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: oracle
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.350 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: kyuubi
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.353 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: kyuubi
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.361 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: zeppelin
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.367 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: zeppelin
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.368 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: trino
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.369 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: trino
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.369 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: db2
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.369 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: db2
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.369 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: clickhouse
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.370 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: clickhouse
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.370 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: azuresql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.370 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: azuresql
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.371 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: athena
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.371 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: athena
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.371 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: presto
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:37.372 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: presto
[WI-0][TI-2409] - [INFO] 2024-05-03 08:19:37.723 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2409, success=true)
[WI-813][TI-2409] - [WARN] 2024-05-03 08:19:38.097 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.337 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.341 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.343 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?
, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.343 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.356 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 1 rows as follows:
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.357 +0800 o.a.d.p.t.s.SqlTask:[263] - row 1 : {"hash":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.360 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.360 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.360 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.361 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2409
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2409
[WI-813][TI-2409] - [INFO] 2024-05-03 08:19:38.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2409] - [INFO] 2024-05-03 08:19:38.672 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2409, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:38.779 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2410, taskName=echo hash, firstSubmitTime=1714695578767, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=8, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo hash","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='echo hash'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2410'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472444468544'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503081938'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.780 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: echo hash to wait queue success
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.784 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695578784
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2410
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2410,
  "taskName" : "echo hash",
  "firstSubmitTime" : 1714695578767,
  "startTime" : 1714695578784,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/8/813/2410.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 8,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo hash\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "echo hash"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2410"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472444468544"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503081938"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2410",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.791 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.791 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2410 check successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.792 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.794 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.795 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.797 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo hash",
  "resourceList" : [ ]
}
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.799 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo hash
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.800 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2410/813_2410.sh
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:38.804 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 217
[WI-0][TI-2410] - [INFO] 2024-05-03 08:19:39.694 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2410, success=true)
[WI-0][TI-2410] - [INFO] 2024-05-03 08:19:39.749 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2410)
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:39.808 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	hash
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.810 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2410, processId:217 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2410
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.820 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_8/813/2410
[WI-813][TI-2410] - [INFO] 2024-05-03 08:19:39.820 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2410] - [INFO] 2024-05-03 08:19:40.689 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2410, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:19:43.052 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7047353760445683 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:07.574 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2411, taskName=hash_article_data, firstSubmitTime=1714695907558, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=9, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2411'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082507'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.575 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.576 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.589 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695907589
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.589 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2411
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.590 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2411,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714695907558,
  "startTime" : 1714695907589,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2411.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 9,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2411"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082507"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2411",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.593 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.593 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.593 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.598 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411 check successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.603 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.604 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.605 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.607 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.616 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.616 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411/py_813_2411.py
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.617 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.618 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.618 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.618 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411/py_813_2411.py
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.618 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.619 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411/813_2411.sh
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:07.624 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 293
[WI-0][TI-2411] - [INFO] 2024-05-03 08:25:08.306 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2411, success=true)
[WI-0][TI-2411] - [INFO] 2024-05-03 08:25:08.326 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2411)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:08.629 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.630 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411, processId:293 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.630 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.630 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.630 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.631 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.638 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.638 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.639 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2411
[WI-813][TI-2411] - [INFO] 2024-05-03 08:25:08.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2411] - [INFO] 2024-05-03 08:25:09.304 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2411, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:09.340 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2412, taskName=check if it exists in the database, firstSubmitTime=1714695909327, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=9, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2412'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082509'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@439c447f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.341 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.343 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.343 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695909343
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2412
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2412,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714695909327,
  "startTime" : 1714695909343,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2412.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 9,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2412"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082509"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2412",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.347 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.347 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.365 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.365 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2412 check successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.367 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.368 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.370 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
 , localParams : [Property{prop='hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.371 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
 successfully.
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.371 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.371 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.372 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.372 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.372 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-813][TI-2412] - [WARN] 2024-05-03 08:25:09.374 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.409 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.411 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.411 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = ?
, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.411 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.413 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 1 rows as follows:
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.413 +0800 o.a.d.p.t.s.SqlTask:[263] - row 1 : {"hash":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.415 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2412] - [ERROR] 2024-05-03 08:25:09.419 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.uploadOutputFiles(TaskFilesTransferUtils.java:75)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.sendTaskResult(WorkerTaskExecutor.java:288)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.afterExecute(WorkerTaskExecutor.java:108)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.afterExecute(DefaultWorkerTaskExecutor.java:59)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:178)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.420 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2412.log
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.420 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2412.log, fetch way: log 
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.421 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.422 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.432 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2412] - [INFO] 2024-05-03 08:25:09.433 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2412] - [INFO] 2024-05-03 08:25:10.318 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2412, success=true)
[WI-0][TI-2412] - [INFO] 2024-05-03 08:25:10.336 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2412, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:11.388 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2413, taskName=check if it exists in the database, firstSubmitTime=1714695911356, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=9, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2413'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082511'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6d932716, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.389 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.389 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695911390
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.391 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2413
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.391 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2413,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714695911356,
  "startTime" : 1714695911390,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2413.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 9,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2413"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082511"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2413",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.392 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.392 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.392 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.396 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.397 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.397 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2413 check successfully
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.398 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.398 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2413] - [ERROR] 2024-05-03 08:25:11.398 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.399 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.411 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2413] - [INFO] 2024-05-03 08:25:11.412 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2413] - [INFO] 2024-05-03 08:25:12.329 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2413, success=true)
[WI-0][TI-2413] - [INFO] 2024-05-03 08:25:12.337 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2413, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:13.466 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2414, taskName=check if it exists in the database, firstSubmitTime=1714695913435, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=9, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2414'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082513'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@14922694, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.468 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.468 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.470 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.470 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695913470
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2414
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.476 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2414,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714695913435,
  "startTime" : 1714695913470,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2414.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 9,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2414"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082513"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2414",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.479 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.480 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.480 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2414 check successfully
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2414] - [ERROR] 2024-05-03 08:25:13.488 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.488 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.491 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2414] - [INFO] 2024-05-03 08:25:13.492 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2414] - [INFO] 2024-05-03 08:25:14.352 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2414, success=true)
[WI-0][TI-2414] - [INFO] 2024-05-03 08:25:14.402 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2414, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:15.422 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2415, taskName=check if it exists in the database, firstSubmitTime=1714695915404, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=9, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2415'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082515'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@698d7500, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.424 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.424 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.426 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.426 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.426 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.426 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714695915426
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.427 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2415
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.427 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2415,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714695915404,
  "startTime" : 1714695915426,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/9/813/2415.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 9,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2415"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082515"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2415",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.428 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.428 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.428 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.437 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.437 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.438 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_9/813/2415 check successfully
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.438 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.439 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2415] - [ERROR] 2024-05-03 08:25:15.439 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.439 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.444 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2415] - [INFO] 2024-05-03 08:25:15.444 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2415] - [INFO] 2024-05-03 08:25:16.380 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2415, success=true)
[WI-0][TI-2415] - [INFO] 2024-05-03 08:25:16.389 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2415, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:25:23.600 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7029411764705882 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:38.539 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7586206896551724 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:44.618 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2416, taskName=hash_article_data, firstSubmitTime=1714696184586, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=10, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2416'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082944'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=OUT, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.620 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.622 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.650 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.650 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.650 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696184656
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2416
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2416,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696184586,
  "startTime" : 1714696184656,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2416.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 10,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2416"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082944"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2416",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.659 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.659 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.659 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.669 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.670 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416 check successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.670 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.675 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.678 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.678 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.678 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.681 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.687 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.687 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416/py_813_2416.py
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.687 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.691 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.692 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.692 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416/py_813_2416.py
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.692 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.692 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416/813_2416.sh
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:44.697 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 366
[WI-0][TI-2416] - [INFO] 2024-05-03 08:29:45.445 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2416, success=true)
[WI-0][TI-2416] - [INFO] 2024-05-03 08:29:45.453 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2416)
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:45.716 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.731 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416, processId:366 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2416
[WI-813][TI-2416] - [INFO] 2024-05-03 08:29:45.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2416] - [INFO] 2024-05-03 08:29:46.431 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2416, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:46.503 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2417, taskName=check if it exists in the database, firstSubmitTime=1714696186491, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=10, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2417'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082946'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@19d4c6f0, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.506 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.506 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696186508
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.511 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2417
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.512 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2417,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696186491,
  "startTime" : 1714696186508,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2417.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 10,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2417"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082946"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2417",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.521 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.521 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.523 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2417 check successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.527 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
 , localParams : [Property{prop='hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.528 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}
 successfully.
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.529 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.529 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.529 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.529 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.529 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-813][TI-2417] - [WARN] 2024-05-03 08:29:46.530 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.553 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.554 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.554 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?
, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.554 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?

[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.556 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 1 rows as follows:
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.559 +0800 o.a.d.p.t.s.SqlTask:[263] - row 1 : {"hash":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2417] - [ERROR] 2024-05-03 08:29:46.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.uploadOutputFiles(TaskFilesTransferUtils.java:75)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.sendTaskResult(WorkerTaskExecutor.java:288)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.afterExecute(WorkerTaskExecutor.java:108)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.afterExecute(DefaultWorkerTaskExecutor.java:59)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:178)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.560 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2417.log
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.560 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2417.log, fetch way: log 
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.561 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.561 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2417] - [INFO] 2024-05-03 08:29:46.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2417] - [INFO] 2024-05-03 08:29:47.443 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2417, success=true)
[WI-0][TI-2417] - [INFO] 2024-05-03 08:29:47.453 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2417, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:48.537 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2418, taskName=check if it exists in the database, firstSubmitTime=1714696188521, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=10, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2418'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082948'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@3fe2ca54, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.538 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.538 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.540 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.540 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696188540
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2418
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2418,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696188521,
  "startTime" : 1714696188540,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2418.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 10,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2418"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082948"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2418",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.541 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.542 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.542 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.545 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.545 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2418 check successfully
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2418] - [ERROR] 2024-05-03 08:29:48.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.551 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2418] - [INFO] 2024-05-03 08:29:48.551 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2418] - [INFO] 2024-05-03 08:29:49.455 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2418, success=true)
[WI-0][TI-2418] - [INFO] 2024-05-03 08:29:49.476 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2418, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:50.547 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2419, taskName=check if it exists in the database, firstSubmitTime=1714696190511, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=10, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2419'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082950'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@49642f0f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.549 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.559 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.559 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696190560
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2419
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2419,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696190511,
  "startTime" : 1714696190560,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2419.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 10,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2419"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082950"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2419",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.570 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.570 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2419 check successfully
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2419] - [ERROR] 2024-05-03 08:29:50.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2419] - [INFO] 2024-05-03 08:29:50.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2419] - [INFO] 2024-05-03 08:29:51.456 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2419, success=true)
[WI-0][TI-2419] - [INFO] 2024-05-03 08:29:51.464 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2419, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:29:52.562 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2420, taskName=check if it exists in the database, firstSubmitTime=1714696192536, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=10, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2420'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503082952'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=OUT, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@568fa248, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"OUT","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.563 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.563 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696192565
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2420
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2420,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696192536,
  "startTime" : 1714696192565,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/10/813/2420.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 10,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2420"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503082952"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2420",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.567 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.567 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.567 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.571 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_10/813/2420 check successfully
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2420] - [ERROR] 2024-05-03 08:29:52.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.577 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.583 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2420] - [INFO] 2024-05-03 08:29:52.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2420] - [INFO] 2024-05-03 08:29:53.474 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2420, success=true)
[WI-0][TI-2420] - [INFO] 2024-05-03 08:29:53.492 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2420, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:29.209 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:30.260 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.711590296495957 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:47.415 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7752161383285303 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:48.429 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7183098591549295 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:54.199 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2421, taskName=hash_article_data, firstSubmitTime=1714696314187, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=12, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2421'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083154'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=OUT, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.211 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.211 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.218 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.219 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.219 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.219 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696314219
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.222 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2421
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.224 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2421,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696314187,
  "startTime" : 1714696314219,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/12/813/2421.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 12,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2421"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083154"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2421",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.225 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.225 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.225 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.229 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.230 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421 check successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.232 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.233 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.233 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.234 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.235 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.235 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.235 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.235 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.236 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.236 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.253 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.253 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421/py_813_2421.py
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.253 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.254 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.254 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.254 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421/py_813_2421.py
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.255 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.255 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421/813_2421.sh
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:54.260 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 406
[WI-0][TI-2421] - [INFO] 2024-05-03 08:31:54.849 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2421, success=true)
[WI-0][TI-2421] - [INFO] 2024-05-03 08:31:54.860 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2421)
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:55.263 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.276 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421, processId:406 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.278 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.282 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.282 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2421
[WI-813][TI-2421] - [INFO] 2024-05-03 08:31:55.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:55.449 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.747093023255814 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2421] - [INFO] 2024-05-03 08:31:55.822 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2421, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:31:55.890 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2422, taskName=check if it exists in the database, firstSubmitTime=1714696315871, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=12, appIds=null, processInstanceId=813, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash as HASH\nFROM article_hashes\nWHERE HASH = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2422'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083155'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='813'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, hash=Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@ab011b7, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.891 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.892 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696315894
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 813_2422
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2422,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696315871,
  "startTime" : 1714696315894,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/12/813/2422.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 12,
  "processInstanceId" : 813,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash as HASH\\nFROM article_hashes\\nWHERE HASH = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2422"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083155"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "813"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "hash" : {
      "prop" : "hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    }
  },
  "taskAppId" : "813_2422",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.903 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.904 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.904 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_12/813/2422 check successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.905 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.905 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.905 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.906 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash as HASH\nFROM article_hashes\nWHERE HASH = ${article_data_hash}\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.906 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"hash","direct":"IN","type":"LIST","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.907 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash as HASH
FROM article_hashes
WHERE HASH = ${article_data_hash}
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.908 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash as HASH
FROM article_hashes
WHERE HASH = ${article_data_hash}
 , localParams : [Property{prop='hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.909 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT hash as HASH
FROM article_hashes
WHERE HASH = ${article_data_hash}
 successfully.
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.909 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash as HASH
FROM article_hashes
WHERE HASH = ?

[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.909 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.909 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.910 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.910 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-813][TI-2422] - [WARN] 2024-05-03 08:31:55.910 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.952 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.955 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.955 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash as HASH
FROM article_hashes
WHERE HASH = ?
, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.955 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash as HASH
FROM article_hashes
WHERE HASH = ?

[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.960 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 1 rows as follows:
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.960 +0800 o.a.d.p.t.s.SqlTask:[263] - row 1 : {"hash":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.960 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.960 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.960 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-813][TI-2422] - [ERROR] 2024-05-03 08:31:55.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='hash', direct=IN, type=LIST, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.uploadOutputFiles(TaskFilesTransferUtils.java:75)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.sendTaskResult(WorkerTaskExecutor.java:288)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.afterExecute(WorkerTaskExecutor.java:108)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.afterExecute(DefaultWorkerTaskExecutor.java:59)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:178)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.961 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/12/813/2422.log
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.961 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/12/813/2422.log, fetch way: log 
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.961 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-813][TI-2422] - [INFO] 2024-05-03 08:31:55.972 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2422] - [INFO] 2024-05-03 08:31:56.846 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2422, success=true)
[WI-0][TI-2422] - [INFO] 2024-05-03 08:31:56.854 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2422, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:36:27.310 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7333333333333334 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:36:28.360 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7210526315789474 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:37:53.819 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7866959489447668 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:37:58.689 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2426, taskName=hash_article_data, firstSubmitTime=1714696678609, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=13, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2426'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083758'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.702 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696678729
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2426
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2426,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696678609,
  "startTime" : 1714696678729,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/13/815/2426.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 13,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2426"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083758"
    }
  },
  "taskAppId" : "815_2426",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.751 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.751 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.751 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.765 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426 check successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.767 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.768 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.768 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.769 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.770 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.771 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426/py_815_2426.py
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.771 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.771 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.772 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.772 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426/py_815_2426.py
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.772 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.772 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426/815_2426.sh
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:58.801 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 493
[WI-0][TI-0] - [INFO] 2024-05-03 08:37:58.919 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7301136363636365 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2426] - [INFO] 2024-05-03 08:37:59.446 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2426, success=true)
[WI-0][TI-2426] - [INFO] 2024-05-03 08:37:59.458 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2426)
[WI-0][TI-0] - [INFO] 2024-05-03 08:37:59.805 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.808 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426, processId:493 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.841 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.841 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.841 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2426
[WI-815][TI-2426] - [INFO] 2024-05-03 08:37:59.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2426] - [INFO] 2024-05-03 08:38:00.452 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2426, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:38:00.516 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2427, taskName=check if it exists in the database, firstSubmitTime=1714696680503, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=13, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2427'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083800'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@65b0608, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.517 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.518 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.520 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.520 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696680520
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.521 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2427
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.521 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2427,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696680503,
  "startTime" : 1714696680520,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/13/815/2427.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 13,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2427"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083800"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2427",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.522 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.522 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.522 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2427 check successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.530 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = ${article_data_hash}\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.531 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.532 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT hash
FROM article_hashes
WHERE hash = ${article_data_hash}
 successfully.
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.535 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = ?

[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.538 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.539 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.539 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.539 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2427] - [WARN] 2024-05-03 08:38:00.540 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.586 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.610 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.611 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = ?
, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.611 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = ?

[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.613 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 1 rows as follows:
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.614 +0800 o.a.d.p.t.s.SqlTask:[263] - row 1 : {"hash":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.618 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.618 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.618 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.619 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.628 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.628 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2427
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.629 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2427
[WI-815][TI-2427] - [INFO] 2024-05-03 08:38:00.629 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2427] - [INFO] 2024-05-03 08:38:01.448 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2427, success=true)
[WI-0][TI-2427] - [INFO] 2024-05-03 08:38:01.459 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2427, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:38:02.574 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2428, taskName=echo hash, firstSubmitTime=1714696682538, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=13, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${hash}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='echo hash'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2428'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472444468544'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083802'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.594 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: echo hash to wait queue success
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.598 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696682601
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2428
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2428,
  "taskName" : "echo hash",
  "firstSubmitTime" : 1714696682538,
  "startTime" : 1714696682601,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/13/815/2428.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 13,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${hash}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "echo hash"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2428"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472444468544"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083802"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2428",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.602 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.602 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.602 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.609 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2428 check successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${hash}",
  "resourceList" : [ ]
}
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.612 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.613 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.613 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo ${hash}
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.613 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.613 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2428/815_2428.sh
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:02.619 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 506
[WI-0][TI-2428] - [INFO] 2024-05-03 08:38:03.480 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2428, success=true)
[WI-0][TI-2428] - [INFO] 2024-05-03 08:38:03.501 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2428)
[WI-0][TI-0] - [INFO] 2024-05-03 08:38:03.621 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.634 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2428, processId:506 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.634 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.634 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.634 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.644 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2428
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_13/815/2428
[WI-815][TI-2428] - [INFO] 2024-05-03 08:38:03.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 08:38:03.978 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7729885057471264 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2428] - [INFO] 2024-05-03 08:38:04.450 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2428, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:38:09.039 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7247956403269755 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:41.896 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7228915662650603 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:46.589 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2429, taskName=hash_article_data, firstSubmitTime=1714696786581, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=14, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2429'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083946'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.593 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.593 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.605 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696786611
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2429
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2429,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696786581,
  "startTime" : 1714696786611,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2429.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 14,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2429"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083946"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2429",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.628 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.628 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.633 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.638 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429 check successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.638 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.643 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.644 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.644 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.644 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"}] successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.653 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.653 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.653 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.656 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.656 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429/py_815_2429.py
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.656 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.657 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.657 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.657 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429/py_815_2429.py
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.657 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.657 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429/815_2429.sh
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:46.668 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 535
[WI-0][TI-2429] - [INFO] 2024-05-03 08:39:46.817 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2429, success=true)
[WI-0][TI-2429] - [INFO] 2024-05-03 08:39:46.824 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2429)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:47.670 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.672 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429, processId:535 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.704 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2429
[WI-815][TI-2429] - [INFO] 2024-05-03 08:39:47.704 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2429] - [INFO] 2024-05-03 08:39:47.802 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2429, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:47.864 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2430, taskName=check if it exists in the database, firstSubmitTime=1714696787839, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=14, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = llll\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2430'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083947'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@54d153bd, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.866 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.866 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.868 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.868 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696787868
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2430
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.869 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2430,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696787839,
  "startTime" : 1714696787868,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2430.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 14,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = llll\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2430"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083947"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2430",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.882 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.883 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.884 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2430 check successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.884 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.884 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.885 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.885 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = llll\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = llll
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.886 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = llll
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.887 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.887 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.892 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.892 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.892 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2430] - [WARN] 2024-05-03 08:39:47.893 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.939 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.949 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.950 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = llll
, sql parameters : {}
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.950 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2430] - [ERROR] 2024-05-03 08:39:47.968 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "llll" does not exist
  Position: 46
[WI-815][TI-2430] - [ERROR] 2024-05-03 08:39:47.969 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2430] - [ERROR] 2024-05-03 08:39:47.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.969 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2430.log
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.969 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2430.log, fetch way: log 
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.970 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.981 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2430] - [INFO] 2024-05-03 08:39:47.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2430] - [INFO] 2024-05-03 08:39:48.792 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2430, success=true)
[WI-0][TI-2430] - [INFO] 2024-05-03 08:39:48.819 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2430, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:49.871 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2431, taskName=check if it exists in the database, firstSubmitTime=1714696789849, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=14, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = llll\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2431'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083949'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@38ebd3f6, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.872 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.874 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.876 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.876 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.876 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.876 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696789876
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2431
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.882 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2431,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696789849,
  "startTime" : 1714696789876,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2431.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 14,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = llll\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2431"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083949"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2431",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.883 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.883 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.884 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.887 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2431 check successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.892 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.893 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = llll\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.900 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = llll
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.900 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = llll
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.901 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.902 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.905 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.906 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.906 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2431] - [WARN] 2024-05-03 08:39:49.907 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.934 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.935 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.936 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = llll
, sql parameters : {}
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.936 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2431] - [ERROR] 2024-05-03 08:39:49.939 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "llll" does not exist
  Position: 46
[WI-815][TI-2431] - [ERROR] 2024-05-03 08:39:49.940 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2431] - [ERROR] 2024-05-03 08:39:49.940 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.940 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2431.log
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.940 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2431.log, fetch way: log 
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.940 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.941 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2431] - [INFO] 2024-05-03 08:39:49.945 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2431] - [INFO] 2024-05-03 08:39:50.806 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2431, success=true)
[WI-0][TI-2431] - [INFO] 2024-05-03 08:39:50.816 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2431, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:51.909 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2432, taskName=check if it exists in the database, firstSubmitTime=1714696791888, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=14, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = llll\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2432'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083951'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6c495708, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.910 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.910 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.914 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696791914
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2432
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2432,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696791888,
  "startTime" : 1714696791914,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2432.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 14,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = llll\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2432"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083951"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2432",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.915 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.915 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.915 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.929 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.930 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.931 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2432 check successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.931 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.934 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = llll\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.936 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.937 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.937 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.937 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = llll
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.937 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = llll
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.938 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.938 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.938 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.938 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.939 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2432] - [WARN] 2024-05-03 08:39:51.939 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.965 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.965 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.966 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = llll
, sql parameters : {}
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.966 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2432] - [ERROR] 2024-05-03 08:39:51.968 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "llll" does not exist
  Position: 46
[WI-815][TI-2432] - [ERROR] 2024-05-03 08:39:51.969 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2432] - [ERROR] 2024-05-03 08:39:51.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.970 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2432.log
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.970 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2432.log, fetch way: log 
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.971 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:51.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:52.000 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2432] - [INFO] 2024-05-03 08:39:52.001 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2432] - [INFO] 2024-05-03 08:39:52.810 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2432, success=true)
[WI-0][TI-2432] - [INFO] 2024-05-03 08:39:52.832 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2432, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:53.945 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2433, taskName=check if it exists in the database, firstSubmitTime=1714696793921, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=14, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = llll\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2433'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503083953'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@a612130, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.947 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.950 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696793951
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2433
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2433,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696793921,
  "startTime" : 1714696793951,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2433.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 14,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = llll\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2433"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503083953"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2433",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.953 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.955 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.960 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_14/815/2433 check successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.972 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = llll\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.973 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.974 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = llll
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.974 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = llll
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.975 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.978 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.980 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.981 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:53.981 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2433] - [WARN] 2024-05-03 08:39:53.981 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.019 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.020 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.020 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = llll
, sql parameters : {}
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.021 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = llll

[WI-815][TI-2433] - [ERROR] 2024-05-03 08:39:54.022 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "llll" does not exist
  Position: 46
[WI-815][TI-2433] - [ERROR] 2024-05-03 08:39:54.023 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2433] - [ERROR] 2024-05-03 08:39:54.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "llll" does not exist
  Position: 46
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.023 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2433.log
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.023 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/14/815/2433.log, fetch way: log 
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.024 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.024 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2433] - [INFO] 2024-05-03 08:39:54.027 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2433] - [INFO] 2024-05-03 08:39:54.828 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2433, success=true)
[WI-0][TI-2433] - [INFO] 2024-05-03 08:39:54.836 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2433, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:57.022 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7091988130563798 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:39:59.091 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8016304347826086 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:00.100 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7672413793103449 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:39.261 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7657142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:48.065 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2435, taskName=hash_article_data, firstSubmitTime=1714696848057, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2435'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084048'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=OUT, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.067 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.067 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696848081
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2434, taskName=hash_article_data, firstSubmitTime=1714696848047, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2434'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084048'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=OUT, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2435
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.082 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.082 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2435,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696848057,
  "startTime" : 1714696848081,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2435.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2435"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084048"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2435",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.085 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.082 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.086 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.090 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.090 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696848090
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.091 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2434
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.094 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2434,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714696848047,
  "startTime" : 1714696848090,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2434.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2434"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084048"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2434",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.097 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.097 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.097 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.097 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435 check successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.097 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.099 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.099 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.101 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.107 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434 check successfully
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435/py_815_2435.py
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.108 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435/py_815_2435.py
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435/815_2435.sh
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.110 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.112 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:48.113 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 564
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.114 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.117 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.117 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434/py_815_2434.py
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.118 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.119 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.119 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.119 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434/py_815_2434.py
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.119 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.119 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434/815_2434.sh
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:48.129 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 568
[WI-0][TI-2435] - [INFO] 2024-05-03 08:40:49.075 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2435, success=true)
[WI-0][TI-2434] - [INFO] 2024-05-03 08:40:49.080 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2434, success=true)
[WI-0][TI-2435] - [INFO] 2024-05-03 08:40:49.090 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2435)
[WI-0][TI-2434] - [INFO] 2024-05-03 08:40:49.095 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2434)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:49.114 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.118 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435, processId:564 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.118 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.118 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.118 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:49.135 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.146 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.149 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2435
[WI-815][TI-2435] - [INFO] 2024-05-03 08:40:49.149 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.149 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434, processId:568 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.150 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2434
[WI-815][TI-2434] - [INFO] 2024-05-03 08:40:49.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2435] - [INFO] 2024-05-03 08:40:50.093 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2435, success=true)
[WI-0][TI-2434] - [INFO] 2024-05-03 08:40:50.097 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2434, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:50.128 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2436, taskName=check if it exists in the database, firstSubmitTime=1714696850117, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2436'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084050'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@2c95562b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.129 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.129 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.130 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.130 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696850131
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2436
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.133 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2436,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696850117,
  "startTime" : 1714696850131,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2436.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = 'llll'\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2436"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084050"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2436",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.138 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.139 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.139 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2436 check successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.139 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.139 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.140 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "artricle_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.141 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.141 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.141 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.141 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = 'llll'
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.141 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = 'llll'
 , localParams : [Property{prop='artricle_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}, Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.142 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = 'llll'

[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.142 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.142 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.142 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.142 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-815][TI-2436] - [WARN] 2024-05-03 08:40:50.142 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.165 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.166 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.166 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = 'llll'
, sql parameters : {}
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.166 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = 'llll'

[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.168 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 0 rows as follows:
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.168 +0800 o.a.d.p.t.s.SqlTask:[288] - sql query results is empty
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.169 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.169 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.169 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2436] - [ERROR] 2024-05-03 08:40:50.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.uploadOutputFiles(TaskFilesTransferUtils.java:75)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.sendTaskResult(WorkerTaskExecutor.java:288)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.afterExecute(WorkerTaskExecutor.java:108)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.afterExecute(DefaultWorkerTaskExecutor.java:59)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:178)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.170 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2436.log
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.170 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2436.log, fetch way: log 
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.171 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.188 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2436] - [INFO] 2024-05-03 08:40:50.188 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2436] - [INFO] 2024-05-03 08:40:51.106 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2436, success=true)
[WI-0][TI-2436] - [INFO] 2024-05-03 08:40:51.112 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2436, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:52.165 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2437, taskName=check if it exists in the database, firstSubmitTime=1714696852151, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=OUT, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2437'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084052'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@44b8ac1b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.167 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.168 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696852169
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2437
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2437,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696852151,
  "startTime" : 1714696852169,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2437.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = 'llll'\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2437"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084052"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2437",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2437 check successfully
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.186 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.196 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2437] - [ERROR] 2024-05-03 08:40:52.196 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.197 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2437] - [INFO] 2024-05-03 08:40:52.203 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2437] - [INFO] 2024-05-03 08:40:53.089 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2437, success=true)
[WI-0][TI-2437] - [INFO] 2024-05-03 08:40:53.110 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2437, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:54.236 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2438, taskName=check if it exists in the database, firstSubmitTime=1714696854196, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=OUT, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2438'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084054'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@19fd4ee4, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.236 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.237 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.238 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.238 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.238 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.238 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696854238
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.238 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2438
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.239 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2438,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696854196,
  "startTime" : 1714696854238,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2438.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = 'llll'\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2438"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084054"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2438",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.239 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.239 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.239 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2438 check successfully
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2438] - [ERROR] 2024-05-03 08:40:54.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2438] - [INFO] 2024-05-03 08:40:54.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2438] - [INFO] 2024-05-03 08:40:55.103 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2438, success=true)
[WI-0][TI-2438] - [INFO] 2024-05-03 08:40:55.131 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2438, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:56.167 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2439, taskName=check if it exists in the database, firstSubmitTime=1714696856144, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=15, appIds=null, processInstanceId=815, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, artricle_hash=Property{prop='artricle_hash', direct=OUT, type=LIST, value='null'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2439'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084056'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='815'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@18c363a, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"artricle_hash","direct":"IN","type":"LIST","value":"null"},{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"artricle_hash","direct":"OUT","type":"LIST","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.168 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.168 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.171 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.172 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714696856172
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.173 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 815_2439
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.173 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2439,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714696856144,
  "startTime" : 1714696856172,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/15/815/2439.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 15,
  "processInstanceId" : 815,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = 'llll'\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "artricle_hash" : {
      "prop" : "artricle_hash",
      "direct" : "OUT",
      "type" : "LIST",
      "value" : "null"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2439"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084056"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "815"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "815_2439",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"artricle_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"},{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"artricle_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.203 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.204 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.204 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_15/815/2439 check successfully
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.204 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-815][TI-2439] - [ERROR] 2024-05-03 08:40:56.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
java.lang.IllegalStateException: Duplicate key Property{prop='artricle_hash', direct=IN, type=LIST, value='null'}
	at java.util.stream.Collectors.lambda$throwingMerger$0(Collectors.java:133)
	at java.util.HashMap.merge(HashMap.java:1255)
	at java.util.stream.Collectors.lambda$toMap$58(Collectors.java:1320)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.server.worker.utils.TaskFilesTransferUtils.downloadUpstreamFiles(TaskFilesTransferUtils.java:142)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.beforeExecute(WorkerTaskExecutor.java:234)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:167)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.209 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-815][TI-2439] - [INFO] 2024-05-03 08:40:56.210 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2439] - [INFO] 2024-05-03 08:40:57.096 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2439, success=true)
[WI-0][TI-2439] - [INFO] 2024-05-03 08:40:57.108 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2439, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:40:59.363 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7743732590529249 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:41:00.384 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8469656992084433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:01.606 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.819484240687679 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:02.662 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9105263157894736 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:15.745 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.858356940509915 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:16.761 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8603988603988603 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:17.762 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7122507122507121 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:18.763 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7060518731988473 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:24.792 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8097982708933718 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:29.647 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2440, taskName=hash_article_data, firstSubmitTime=1714697009634, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=17, appIds=null, processInstanceId=816, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='816'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2440'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084329'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.650 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.650 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.664 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.664 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714697009665
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 816_2440
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2440,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714697009634,
  "startTime" : 1714697009665,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/17/816/2440.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 17,
  "processInstanceId" : 816,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "816"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2440"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084329"
    }
  },
  "taskAppId" : "816_2440",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440 check successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.683 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.684 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.684 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.685 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.685 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.685 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.685 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.685 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.686 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440/py_816_2440.py
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.686 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.688 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.696 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.696 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440/py_816_2440.py
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.696 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.697 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440/816_2440.sh
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:29.706 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 620
[WI-0][TI-2440] - [INFO] 2024-05-03 08:43:30.523 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2440, success=true)
[WI-0][TI-2440] - [INFO] 2024-05-03 08:43:30.574 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2440)
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:30.713 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.715 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440, processId:620 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.716 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.716 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.716 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.716 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2440
[WI-816][TI-2440] - [INFO] 2024-05-03 08:43:30.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2440] - [INFO] 2024-05-03 08:43:31.478 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2440, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:31.522 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2441, taskName=check if it exists in the database, firstSubmitTime=1714697011511, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=17, appIds=null, processInstanceId=816, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_hash","direct":"OUT","type":"LIST","value":""}],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2441'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084331'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='816'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@77caab83, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.525 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.546 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.546 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.546 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714697011546
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 816_2441
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2441,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714697011511,
  "startTime" : 1714697011546,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/17/816/2441.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 17,
  "processInstanceId" : 816,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_hash\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"}],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT hash\\nFROM article_hashes\\nWHERE hash = 'llll'\\n\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2441"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084331"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "816"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "816_2441",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.547 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.547 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.547 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2441 check successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ {
    "prop" : "article_hash",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  } ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT hash\nFROM article_hashes\nWHERE hash = 'llll'\n",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.564 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.565 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT hash
FROM article_hashes
WHERE hash = 'llll'
', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.565 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT hash
FROM article_hashes
WHERE hash = 'llll'
 , localParams : [Property{prop='article_hash', direct=OUT, type=LIST, value=''}],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.566 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT hash
FROM article_hashes
WHERE hash = 'llll'

[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.566 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.566 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.566 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.566 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-816][TI-2441] - [WARN] 2024-05-03 08:43:31.566 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.596 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.597 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.598 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT hash
FROM article_hashes
WHERE hash = 'llll'
, sql parameters : {}
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.598 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT hash
FROM article_hashes
WHERE hash = 'llll'

[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.602 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 0 rows as follows:
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.602 +0800 o.a.d.p.t.s.SqlTask:[288] - sql query results is empty
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.604 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.604 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.604 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2441
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2441
[WI-816][TI-2441] - [INFO] 2024-05-03 08:43:31.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2441] - [INFO] 2024-05-03 08:43:32.518 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2441, success=true)
[WI-0][TI-2441] - [INFO] 2024-05-03 08:43:32.540 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2441, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:33.656 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2442, taskName=echo hash, firstSubmitTime=1714697013646, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=17, appIds=null, processInstanceId=816, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${article_hash}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='echo hash'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2442'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472444468544'}, article_hash=Property{prop='article_hash', direct=IN, type=LIST, value='null'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503084333'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='816'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_hash","direct":"IN","type":"LIST","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.662 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: echo hash to wait queue success
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714697013674
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 816_2442
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2442,
  "taskName" : "echo hash",
  "firstSubmitTime" : 1714697013646,
  "startTime" : 1714697013674,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/17/816/2442.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 17,
  "processInstanceId" : 816,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${article_hash}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "echo hash"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2442"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472444468544"
    },
    "article_hash" : {
      "prop" : "article_hash",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "null"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503084333"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "816"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "816_2442",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"},{\"prop\":\"article_hash\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.675 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.675 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.676 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.685 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2442 check successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${article_hash}",
  "resourceList" : [ ]
}
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"},{"prop":"article_hash","direct":"IN","type":"LIST","value":"null"}] successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.688 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo null
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.689 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2442/816_2442.sh
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:33.702 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 639
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:33.864 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7413793103448275 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2442] - [INFO] 2024-05-03 08:43:34.515 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2442, success=true)
[WI-0][TI-2442] - [INFO] 2024-05-03 08:43:34.528 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2442)
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:34.708 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	null
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.719 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2442, processId:639 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2442
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_17/816/2442
[WI-816][TI-2442] - [INFO] 2024-05-03 08:43:34.730 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2442] - [INFO] 2024-05-03 08:43:35.488 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2442, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 08:43:37.925 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7319884726224783 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:45:13.429 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7020057306590258 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:45:18.465 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7875354107648725 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 08:45:19.475 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7363896848137537 is over then the MaxCpuUsagePercentageThresholds 0.7
