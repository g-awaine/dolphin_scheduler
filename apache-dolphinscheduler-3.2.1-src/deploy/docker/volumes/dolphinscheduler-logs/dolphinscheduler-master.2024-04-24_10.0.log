[WI-0][TI-0] - [INFO] 2024-04-24 10:00:01.604 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:06.620 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:11.645 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 15/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:16.702 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:21.734 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:26.749 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:31.769 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:36.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:41.806 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:46.830 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:51.853 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:00:56.872 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:01.892 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:06.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:11.937 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:16.964 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:21.992 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 17/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:27.008 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:32.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:37.040 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:42.054 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:47.072 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:52.121 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:01:57.140 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:02.159 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:07.184 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:12.210 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:17.240 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:22.257 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:23.466 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:02:23.467 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:24.462 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:27.270 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:32.293 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:37.312 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:42.327 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:47.346 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:52.376 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:02:57.389 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:02.401 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:07.416 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:12.437 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:17.464 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:22.486 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:27.529 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:32.548 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:37.567 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:42.599 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:47.627 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:52.656 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:03:57.671 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:02.682 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:07.695 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:12.710 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:17.745 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:22.765 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:27.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:32.810 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:37.824 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:42.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:47.877 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:52.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:04:57.933 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:02.979 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:07.996 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:13.013 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:17.454 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.12:5678 begin to failover hosts:[172.18.0.12:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:17.493 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.12:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:05:17.493 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:05:17.493 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:17.494 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.12:5678] failover finished, useTime:16ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:18.049 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:23.068 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:28.082 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:33.097 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:38.121 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:43.133 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:48.144 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:53.169 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:05:58.192 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:03.209 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:08.224 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:13.250 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:18.294 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:23.307 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:28.330 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:33.362 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:36.563 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:06:36.563 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:37.565 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:06:37.565 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:38.407 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:43.443 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:48.463 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:53.484 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:06:58.537 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:03.553 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:08.571 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:13.602 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:18.632 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:23.642 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:28.654 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:33.673 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:38.695 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:43.713 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:48.737 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:53.768 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:07:58.781 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:03.796 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:08.817 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:13.832 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:18.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:23.886 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:28.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:33.924 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:38.941 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:43.990 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:49.019 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:54.060 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:08:59.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:04.092 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:09.108 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:14.126 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:19.160 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:24.190 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:29.219 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:34.240 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:39.253 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:44.271 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:49.636 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:54.651 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:09:59.665 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:04.685 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:09.699 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:14.743 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:19.829 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:24.855 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:29.875 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:34.892 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:39.910 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:44.924 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:49.940 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:54.956 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:10:59.994 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:05.009 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:10.026 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:15.043 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:20.076 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:24.896 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:25.101 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:30.124 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:35.139 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:40.156 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:43.965 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8156424581005587 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:11:43.965 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:44.039 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8156424581005587 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:44.975 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666666 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:11:44.978 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:45.073 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666666 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:45.169 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:47.997 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7041420118343196 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:11:47.997 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:48.106 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7041420118343196 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:50.707 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 16/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:55.737 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:00.758 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:05.773 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:10.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:15.834 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:20.847 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:25.862 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:30.878 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:35.898 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:40.921 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:45.942 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:50.986 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:12:56.020 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:01.038 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:06.062 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:11.077 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:16.112 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:21.127 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:22.931 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:13:22.931 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:26.147 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:31.176 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:36.193 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:41.212 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:46.238 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:51.251 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:13:56.288 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:01.331 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:06.410 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:11.437 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:16.478 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:21.496 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:26.524 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:31.543 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:36.570 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:41.594 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:46.614 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:51.663 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:14:56.684 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:01.703 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:06.726 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:11.760 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:16.796 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:17.502 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.12:5678 begin to failover hosts:[172.18.0.12:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:17.537 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.12:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:15:17.537 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:15:17.537 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-04-24 10:15:17.537 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:15:17.538 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-04-24 10:15:17.538 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:15:17.538 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-04-24 10:15:17.539 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:15:17.539 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:17.539 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.12:5678] failover finished, useTime:7ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:21.818 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:26.838 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:31.863 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:36.889 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:41.910 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:46.931 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:51.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:15:56.973 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:01.996 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:06.507 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:07.017 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:12.037 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:17.066 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:22.086 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:27.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:32.137 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:37.160 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:42.195 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:46.636 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7244318181818181 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:16:46.636 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:46.678 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7244318181818181 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:47.231 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:52.243 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:57.264 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:02.289 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:07.303 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:12.331 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:17.376 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:22.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:27.450 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:32.464 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:37.549 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 17/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:42.592 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:47.614 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:47.906 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8714123376623376 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:17:47.908 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:47.931 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8714123376623376 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:52.655 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:53.932 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.985 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.986 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.986 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:53.987 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.988 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:53.988 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.016 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.016 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.019 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.021 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1388, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.035 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.039 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:54.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.045 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.059 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.076 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1388, processInstanceId=566, startTime=1713925074066, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.410 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.415 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.415 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.444 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1388, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.445 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.445 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.453 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.453 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.546 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1388, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.548 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.163 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, processId=3381, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.414 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, processId=3381, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.422 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1388, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.422 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1388, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:54 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log, processId=3381, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:55.422 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.455 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1388, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.456 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.456 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.456 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.456 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.467 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.467 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.469 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.472 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1389, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.476 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.476 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:55.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:17:54 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:17:54 GMT+08:00 2024
Start Time:             Wed Apr 24 10:17:54 GMT+08:00 2024
End Time:               Wed Apr 24 10:17:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:17:55.480 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1389, taskName=check file existence, firstSubmitTime=1713925075470, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1389'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424101755'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.481 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.503 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.506 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:55.506 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.507 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713925075507
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.507 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 566_1389
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.507 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1389,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713925075470,
  "startTime" : 1713925075507,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1389"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424101755"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1389",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:55.513 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1389, processInstanceId=566, startTime=1713925075507, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.514 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.514 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.515 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.515 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.515 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.516 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.523 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.523 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.524 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.524 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.527 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:55 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.527 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.12:5678 successfully
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.527 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:55.527 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.415 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.419 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.420 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:17:56.426 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=219), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 52, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1389] - [ERROR] 2024-04-24 10:17:56.429 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.429 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:55 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:17:56.451 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=220), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 52, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1389] - [WARN] 2024-04-24 10:17:56.454 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1389
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.455 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1389, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.455 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1389, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:55 GMT+08:00 2024, endTime=Wed Apr 24 10:17:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1389.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:56.456 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.471 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1389, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.472 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.472 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.472 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.478 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.480 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1389] - [INFO] 2024-04-24 10:17:56.481 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1390, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.485 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.485 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.485 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:56.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:17:55 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:17:55 GMT+08:00 2024
Start Time:             Wed Apr 24 10:17:55 GMT+08:00 2024
End Time:               Wed Apr 24 10:17:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:17:56.498 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:56.515 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1390, processInstanceId=566, startTime=1713925076490, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.420 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.425 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.426 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.447 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1390, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.447 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.448 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.461 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:57.462 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.499 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1390, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.499 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.565 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=Wed Apr 24 10:17:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, processId=3395, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:57.676 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.421 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=Wed Apr 24 10:17:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, processId=3395, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.454 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1390, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.454 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1390, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:17:56 GMT+08:00 2024, endTime=Wed Apr 24 10:17:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log, processId=3395, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.454 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.512 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1390, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.512 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.512 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.512 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.512 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.569 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.569 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.569 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.576 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.577 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.577 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:58.579 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1391, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.583 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:17:58.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:17:56 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:17:56 GMT+08:00 2024
Start Time:             Wed Apr 24 10:17:56 GMT+08:00 2024
End Time:               Wed Apr 24 10:17:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.599 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.623 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1391, processInstanceId=566, startTime=1713925078615, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.994 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8920454545454546 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:59.013 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8920454545454546 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:17:59.014 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.424 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.428 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.429 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.435 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1391, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.436 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.436 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.458 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:59.459 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1391, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:59.469 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:00.015 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194244604316546 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:00.015 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:00.030 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194244604316546 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:01.018 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7944785276073619 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:01.019 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:01.033 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7944785276073619 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:02.689 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:07.708 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:12.723 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:13.077 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.726950354609929 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:13.078 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:13.086 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.726950354609929 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:13.680 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713918914011, reportTime=1713925093087, cpuUsage=0.7307692307692308, jvmMemoryUsage=0.03448483149210612, memoryUsage=0.6179319077118608, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=2)
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:13.689 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:14.080 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:15.080 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8477011494252874 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:15.081 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:15.134 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8477011494252874 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.800 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=Wed Apr 24 10:18:15 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, processId=3407, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:16.082 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.662 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=Wed Apr 24 10:18:15 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, processId=3407, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.687 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1391, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.693 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1391, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:17:58 GMT+08:00 2024, endTime=Wed Apr 24 10:18:15 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log, processId=3407, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:16.694 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.735 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1391, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.736 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.736 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.736 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.739 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.739 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.739 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.747 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.747 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:16.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:17:58 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:17:58 GMT+08:00 2024
Start Time:             Wed Apr 24 10:17:58 GMT+08:00 2024
End Time:               Wed Apr 24 10:18:15 GMT+08:00 2024

[WI-566][TI-null] - [INFO] 2024-04-24 10:18:16.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=566, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-null] - [INFO] 2024-04-24 10:18:16.761 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-null] - [INFO] 2024-04-24 10:18:16.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-99-20240424101753943
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.12:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:17:53 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:17:53 GMT+08:00 2024
End Time:                  Wed Apr 24 10:18:16 GMT+08:00 2024

[WI-566][TI-0] - [INFO] 2024-04-24 10:18:16.788 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:17.083 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7373134328358208 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:17.083 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:17.189 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7373134328358208 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:17.762 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:18.085 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:19.094 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:20.095 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:21.096 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:22.097 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:22.796 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:18:23.098 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:23.704 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:27.837 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:32.860 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:37.879 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:42.905 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:47.919 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:52.934 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:57.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:02.964 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:06.228 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7692307692307693 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:19:06.228 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:06.324 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7692307692307693 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:07.983 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:13.002 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:18.036 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:23.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:28.108 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:33.130 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:38.149 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:43.169 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:48.185 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:53.200 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:58.215 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:03.233 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:08.249 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:13.282 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:18.353 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:23.387 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:28.418 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:31.504 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7793296089385475 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:31.505 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:31.731 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7793296089385475 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:33.435 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:38.478 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:43.501 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:43.542 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7189349112426036 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:43.544 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:43.853 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7189349112426036 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:43.911 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713918914011, reportTime=1713925243831, cpuUsage=0.7462686567164178, jvmMemoryUsage=0.03457326889038086, memoryUsage=0.588812103174761, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=1)
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:43.918 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:44.544 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:45.546 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:46.548 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:47.550 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:48.537 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:48.554 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:49.558 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718266253869969 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:49.565 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:49.880 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718266253869969 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:50.580 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:51.581 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:52.582 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:53.554 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:20:53.583 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:53.978 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:58.609 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 27/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:03.634 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:08.648 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:13.694 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:18.729 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:23.751 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:28.766 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:33.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:38.797 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:43.825 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:48.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:53.859 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:21:58.882 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:03.903 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:08.922 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:13.938 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:18.992 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:21.972 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7674418604651163 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:22:21.972 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:22.185 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7674418604651163 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:24.005 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:29.027 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:34.045 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:39.059 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:44.078 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:49.093 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:54.105 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:59.139 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:04.177 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:09.190 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:14.206 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:19.264 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:24.284 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:29.295 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:34.330 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:39.348 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:44.365 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:49.385 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:54.419 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:23:59.442 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:04.455 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:09.496 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:14.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:19.572 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:24.589 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:29.601 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:34.619 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:39.655 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:44.678 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:49.705 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:54.735 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:56.451 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7536656891495601 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:24:56.452 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:57.072 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7536656891495601 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:24:59.751 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:04.770 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:09.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:14.805 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:17.549 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.12:5678 begin to failover hosts:[172.18.0.12:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:17.569 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.12:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:17.570 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.12:5678] failover finished, useTime:4ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:19.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:24.889 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:29.996 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 17/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:30.538 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8616352201257862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:25:30.548 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:31.235 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8616352201257862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:35.063 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:40.083 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.106 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1354, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=9, desc='kill'}, startTime=Wed Apr 24 09:22:18 GMT+08:00 2024, endTime=Wed Apr 24 10:25:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_96/561/1354, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/96/561/1354.log, processId=1062, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=561)
[WI-0][TI-0] - [WARN] 2024-04-24 10:25:43.107 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[85] - Cannot find workflowExecuteThread from cacheManager, event: TaskEvent(taskInstanceId=1354, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=9, desc='kill'}, startTime=Wed Apr 24 09:22:18 GMT+08:00 2024, endTime=Wed Apr 24 10:25:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_96/561/1354, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/96/561/1354.log, processId=1062, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=561)
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:45.106 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:50.121 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:29:46.577 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [WARN] 2024-04-24 10:29:51.053 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [INFO] 2024-04-24 10:29:51.071 +0800 o.a.d.s.m.MasterServer:[640] - The following 1 profile is active: "postgresql"
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:02.063 +0800 o.s.c.c.s.GenericScope:[283] - BeanFactory id=99bb9db5-ebe4-3a26-aa79-072006414d6a
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.224 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.271 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.284 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$436/1421101177] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.349 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.456 +0800 o.a.d.c.u.NetUtils:[312] - Get all NetworkInterfaces: [name:eth0 (eth0), name:lo (lo)]
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.583 +0800 o.a.d.s.m.c.MasterConfig:[179] - 
****************************Master Configuration**************************************
  listen-port -> 5678
  fetch-command-num -> 10
  pre-exec-threads -> 10
  exec-threads -> 100
  dispatch-task-number -> 3
  host-selector -> LOWER_WEIGHT
  max-heartbeat-interval -> PT10S
  task-commit-retry-times -> 5
  task-commit-interval -> PT1S
  state-wheel-interval -> PT5S
  server-load-protection -> MasterServerLoadProtection(enabled=true, maxCpuUsagePercentageThresholds=0.7, maxJVMMemoryUsagePercentageThresholds=0.7, maxSystemMemoryUsagePercentageThresholds=0.7, maxDiskUsagePercentageThresholds=0.7)
  failover-interval -> PT10M
  kill-application-when-task-failover -> true
  registry-disconnect-strategy -> ConnectStrategyProperties(strategy=WAITING, maxWaitingTime=PT1M40S)
  master-address -> 172.18.0.9:5678
  master-registry-path: /nodes/master/172.18.0.9:5678
  worker-group-refresh-interval: PT10S
****************************Master Configuration**************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:04.585 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'masterConfig' of type [org.apache.dolphinscheduler.server.master.config.MasterConfig$$EnhancerBySpringCGLIB$$57e05a75] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.542 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.619 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'kubernetes.manifests-io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.664 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration' of type [io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:06.114 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultApiClient' of type [io.kubernetes.client.openapi.ApiClient] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:07.468 +0800 o.e.j.u.log:[170] - Logging initialized @31311ms to org.eclipse.jetty.util.log.Slf4jLog
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.479 +0800 o.s.b.w.e.j.JettyServletWebServerFactory:[166] - Server initialized with port: 5679
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.484 +0800 o.e.j.s.Server:[375] - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 1.8.0_402-b06
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.694 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring embedded WebApplicationContext
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.695 +0800 o.s.b.w.s.c.ServletWebServerApplicationContext:[292] - Root WebApplicationContext: initialization completed in 17471 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.184 +0800 o.e.j.s.session:[334] - DefaultSessionIdManager workerName=node0
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.228 +0800 o.e.j.s.session:[339] - No SessionScavenger set, using defaults
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.237 +0800 o.e.j.s.session:[132] - node0 Scavenging every 660000ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.272 +0800 o.e.j.s.h.ContextHandler:[921] - Started o.s.b.w.e.j.JettyEmbeddedWebAppContext@749f61a3{application,/,[file:///tmp/jetty-docbase.5679.159373627290075188/],AVAILABLE}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.358 +0800 o.e.j.s.Server:[415] - Started @36200ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.898 +0800 o.a.c.f.i.CuratorFrameworkImpl:[338] - Starting
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.937 +0800 o.a.z.ZooKeeper:[98] - Client environment:zookeeper.version=3.8.0-5a02a05eddb59aee6ac762f7ea82e92a68eb9c0f, built on 2022-02-25 08:49 UTC
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.938 +0800 o.a.z.ZooKeeper:[98] - Client environment:host.name=2d1cee8a8dc8
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.938 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.version=1.8.0_402
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.938 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.vendor=Temurin
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.938 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.home=/opt/java/openjdk
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.class.path=/opt/dolphinscheduler/conf:/opt/dolphinscheduler/libs/kerb-client-1.0.1.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/jsqlparser-4.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-extensions-5.10.2.jar:/opt/dolphinscheduler/libs/zookeeper-3.8.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-apps-5.10.2.jar:/opt/dolphinscheduler/libs/grpc-api-1.41.0.jar:/opt/dolphinscheduler/libs/quartz-2.3.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pigeon-3.2.1.jar:/opt/dolphinscheduler/libs/client-java-api-13.0.2.jar:/opt/dolphinscheduler/libs/spring-web-5.3.22.jar:/opt/dolphinscheduler/libs/spring-context-5.3.22.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/jetty-io-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/annotations-13.0.jar:/opt/dolphinscheduler/libs/joda-time-2.10.13.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-autoconfig-2.1.3.jar:/opt/dolphinscheduler/libs/kerb-identity-1.0.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-kms-2.11.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dvc-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-httpclient-okhttp-6.0.0.jar:/opt/dolphinscheduler/libs/jna-platform-5.10.0.jar:/opt/dolphinscheduler/libs/commons-beanutils-1.9.4.jar:/opt/dolphinscheduler/libs/jsch-0.1.55.jar:/opt/dolphinscheduler/libs/jmespath-java-1.12.300.jar:/opt/dolphinscheduler/libs/curator-client-5.3.0.jar:/opt/dolphinscheduler/libs/proto-google-common-protos-2.0.1.jar:/opt/dolphinscheduler/libs/mybatis-3.5.10.jar:/opt/dolphinscheduler/libs/jackson-annotations-2.13.4.jar:/opt/dolphinscheduler/libs/jakarta.xml.bind-api-2.3.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-jupyter-3.2.1.jar:/opt/dolphinscheduler/libs/mybatis-plus-extension-3.5.2.jar:/opt/dolphinscheduler/libs/j2objc-annotations-1.3.jar:/opt/dolphinscheduler/libs/jetty-security-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-python-3.2.1.jar:/opt/dolphinscheduler/libs/snappy-java-1.1.10.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-batch-5.10.2.jar:/opt/dolphinscheduler/libs/gson-fire-1.8.5.jar:/opt/dolphinscheduler/libs/caffeine-2.9.3.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-core-4.5.10.jar:/opt/dolphinscheduler/libs/jackson-module-jaxb-annotations-2.13.3.jar:/opt/dolphinscheduler/libs/jetty-http-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jersey-servlet-1.19.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dinky-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_common-0.15.0.jar:/opt/dolphinscheduler/libs/netty-handler-4.1.53.Final.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datafactory-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-scheduler-api-3.2.1.jar:/opt/dolphinscheduler/libs/json-path-2.7.0.jar:/opt/dolphinscheduler/libs/mybatis-plus-annotation-3.5.2.jar:/opt/dolphinscheduler/libs/commons-codec-1.11.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-master-3.2.1.jar:/opt/dolphinscheduler/libs/spring-aop-5.3.22.jar:/opt/dolphinscheduler/libs/kubernetes-model-core-5.10.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-networking-5.10.2.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk7-1.6.21.jar:/opt/dolphinscheduler/libs/kerby-xdr-1.0.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-ram-3.1.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-k8s-3.2.1.jar:/opt/dolphinscheduler/libs/guava-31.1-jre.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-kubeflow-3.2.1.jar:/opt/dolphinscheduler/libs/HikariCP-4.0.3.jar:/opt/dolphinscheduler/libs/jackson-core-2.13.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mr-3.2.1.jar:/opt/dolphinscheduler/libs/mybatis-plus-boot-starter-3.5.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-node-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-common-3.2.1.jar:/opt/dolphinscheduler/libs/jose4j-0.7.8.jar:/opt/dolphinscheduler/libs/jul-to-slf4j-1.7.36.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-mysql-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/commons-math3-3.1.1.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-json-provider-2.13.3.jar:/opt/dolphinscheduler/libs/perfmark-api-0.23.0.jar:/opt/dolphinscheduler/libs/httpclient-4.5.13.jar:/opt/dolphinscheduler/libs/kerby-util-1.0.1.jar:/opt/dolphinscheduler/libs/commons-collections-3.2.2.jar:/opt/dolphinscheduler/libs/hadoop-yarn-client-3.2.4.jar:/opt/dolphinscheduler/libs/hadoop-yarn-common-3.2.4.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-jobclient-3.2.4.jar:/opt/dolphinscheduler/libs/annotations-4.1.1.4.jar:/opt/dolphinscheduler/libs/curator-framework-5.3.0.jar:/opt/dolphinscheduler/libs/client-java-proto-13.0.2.jar:/opt/dolphinscheduler/libs/checker-qual-3.19.0.jar:/opt/dolphinscheduler/libs/jetty-servlet-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-shell-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-rsa-1.0.10.RELEASE.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-all-prune-3.2.1.jar:/opt/dolphinscheduler/libs/spring-webmvc-5.3.22.jar:/opt/dolphinscheduler/libs/opentracing-util-0.33.0.jar:/opt/dolphinscheduler/libs/jetcd-core-0.5.11.jar:/opt/dolphinscheduler/libs/grpc-context-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datasync-3.2.1.jar:/opt/dolphinscheduler/libs/jackson-dataformat-cbor-2.13.3.jar:/opt/dolphinscheduler/libs/client-java-extended-13.0.2.jar:/opt/dolphinscheduler/libs/jcip-annotations-1.0-1.jar:/opt/dolphinscheduler/libs/accessors-smart-2.4.8.jar:/opt/dolphinscheduler/libs/hadoop-client-3.2.4.jar:/opt/dolphinscheduler/libs/commons-collections4-4.3.jar:/opt/dolphinscheduler/libs/metrics-core-4.2.11.jar:/opt/dolphinscheduler/libs/netty-resolver-4.1.53.Final.jar:/opt/dolphinscheduler/libs/bucket4j-core-6.2.0.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-3.1.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-postgresql-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-coordination-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-linkis-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-meter-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-client-api-6.0.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-certificates-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mlflow-3.2.1.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk8-1.6.21.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-jdbc-3.2.1.jar:/opt/dolphinscheduler/libs/spring-context-support-5.3.22.jar:/opt/dolphinscheduler/libs/audience-annotations-0.12.0.jar:/opt/dolphinscheduler/libs/simpleclient_httpserver-0.15.0.jar:/opt/dolphinscheduler/libs/jetty-xml-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/kerby-asn1-1.0.1.jar:/opt/dolphinscheduler/libs/HdrHistogram-2.1.12.jar:/opt/dolphinscheduler/libs/failsafe-2.4.4.jar:/opt/dolphinscheduler/libs/hbase-noop-htrace-4.1.1.jar:/opt/dolphinscheduler/libs/jetty-util-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jakarta.activation-api-1.2.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-common-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-plugin-all-3.2.1.jar:/opt/dolphinscheduler/libs/okhttp-4.9.3.jar:/opt/dolphinscheduler/libs/hadoop-auth-3.2.4.jar:/opt/dolphinscheduler/libs/grpc-netty-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-seatunnel-3.2.1.jar:/opt/dolphinscheduler/libs/oshi-core-6.1.1.jar:/opt/dolphinscheduler/libs/jackson-module-parameter-names-2.13.3.jar:/opt/dolphinscheduler/libs/bcutil-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-base-3.2.1.jar:/opt/dolphinscheduler/libs/nimbus-jose-jwt-9.8.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-quartz-2.7.3.jar:/opt/dolphinscheduler/libs/jetty-continuation-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/commons-text-1.4.jar:/opt/dolphinscheduler/libs/failureaccess-1.0.1.jar:/opt/dolphinscheduler/libs/error_prone_annotations-2.5.1.jar:/opt/dolphinscheduler/libs/kerb-admin-1.0.1.jar:/opt/dolphinscheduler/libs/token-provider-1.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-all-3.2.1.jar:/opt/dolphinscheduler/libs/jakarta.servlet-api-4.0.4.jar:/opt/dolphinscheduler/libs/logback-core-1.2.11.jar:/opt/dolphinscheduler/libs/jettison-1.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-http-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-zookeeper-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-crypto-5.7.3.jar:/opt/dolphinscheduler/libs/jetty-server-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/javax.annotation-api-1.3.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dataquality-3.2.1.jar:/opt/dolphinscheduler/libs/commons-lang3-3.12.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-h2-3.2.1.jar:/opt/dolphinscheduler/libs/tomcat-embed-el-9.0.65.jar:/opt/dolphinscheduler/libs/opentracing-noop-0.33.0.jar:/opt/dolphinscheduler/libs/client-java-13.0.2.jar:/opt/dolphinscheduler/libs/spring-beans-5.3.22.jar:/opt/dolphinscheduler/libs/snakeyaml-1.33.jar:/opt/dolphinscheduler/libs/javax.servlet-api-3.1.0.jar:/opt/dolphinscheduler/libs/hadoop-common-3.2.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-apiextensions-5.10.2.jar:/opt/dolphinscheduler/libs/spring-boot-2.7.3.jar:/opt/dolphinscheduler/libs/bcprov-ext-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/spring-boot-starter-2.7.3.jar:/opt/dolphinscheduler/libs/bcpkix-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/kubernetes-model-scheduling-5.10.2.jar:/opt/dolphinscheduler/libs/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-core-3.2.4.jar:/opt/dolphinscheduler/libs/jackson-datatype-jdk8-2.13.3.jar:/opt/dolphinscheduler/libs/spring-expression-5.3.22.jar:/opt/dolphinscheduler/libs/aspectjweaver-1.9.7.jar:/opt/dolphinscheduler/libs/client-java-api-fluent-13.0.2.jar:/opt/dolphinscheduler/libs/mybatis-plus-3.5.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-openmldb-3.2.1.jar:/opt/dolphinscheduler/libs/curator-recipes-5.3.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-api-3.2.1.jar:/opt/dolphinscheduler/libs/netty-all-4.1.53.Final.jar:/opt/dolphinscheduler/libs/kubernetes-model-autoscaling-5.10.2.jar:/opt/dolphinscheduler/libs/kerb-util-1.0.1.jar:/opt/dolphinscheduler/libs/kerb-simplekdc-1.0.1.jar:/opt/dolphinscheduler/libs/protobuf-java-util-3.17.2.jar:/opt/dolphinscheduler/libs/animal-sniffer-annotations-1.19.jar:/opt/dolphinscheduler/libs/netty-buffer-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jsr305-3.0.0.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/simpleclient-0.15.0.jar:/opt/dolphinscheduler/libs/aliyun-sdk-oss-3.15.1.jar:/opt/dolphinscheduler/libs/spring-jdbc-5.3.22.jar:/opt/dolphinscheduler/libs/logback-classic-1.2.11.jar:/opt/dolphinscheduler/libs/micrometer-registry-prometheus-1.9.3.jar:/opt/dolphinscheduler/libs/grpc-core-1.41.0.jar:/opt/dolphinscheduler/libs/aws-java-sdk-kms-1.12.300.jar:/opt/dolphinscheduler/libs/kubernetes-model-rbac-5.10.2.jar:/opt/dolphinscheduler/libs/ini4j-0.5.4.jar:/opt/dolphinscheduler/libs/spring-boot-starter-web-2.7.3.jar:/opt/dolphinscheduler/libs/spring-cloud-commons-3.1.3.jar:/opt/dolphinscheduler/libs/jetcd-common-0.5.11.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-emr-3.2.1.jar:/opt/dolphinscheduler/libs/micrometer-core-1.9.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-unix-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.4.11.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sql-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-common-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datax-3.2.1.jar:/opt/dolphinscheduler/libs/postgresql-42.4.1.jar:/opt/dolphinscheduler/libs/jetty-util-ajax-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/grpc-stub-1.41.0.jar:/opt/dolphinscheduler/libs/spring-core-5.3.22.jar:/opt/dolphinscheduler/libs/jaxb-api-2.3.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-flowcontrol-5.10.2.jar:/opt/dolphinscheduler/libs/commons-logging-1.1.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-scheduler-quartz-3.2.1.jar:/opt/dolphinscheduler/libs/mybatis-spring-2.0.7.jar:/opt/dolphinscheduler/libs/grpc-protobuf-1.41.0.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-bootstrap-3.1.3.jar:/opt/dolphinscheduler/libs/kubernetes-model-admissionregistration-5.10.2.jar:/opt/dolphinscheduler/libs/esdk-obs-java-bundle-3.23.3.jar:/opt/dolphinscheduler/libs/dnsjava-2.1.7.jar:/opt/dolphinscheduler/libs/asm-9.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-spark-3.2.1.jar:/opt/dolphinscheduler/libs/json-smart-2.4.8.jar:/opt/dolphinscheduler/libs/kubernetes-client-6.0.0.jar:/opt/dolphinscheduler/libs/commons-cli-1.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-chunjun-3.2.1.jar:/opt/dolphinscheduler/libs/kerb-server-1.0.1.jar:/opt/dolphinscheduler/libs/re2j-1.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-remoteshell-3.2.1.jar:/opt/dolphinscheduler/libs/h2-2.2.220.jar:/opt/dolphinscheduler/libs/protobuf-java-3.17.2.jar:/opt/dolphinscheduler/libs/aws-java-sdk-core-1.12.300.jar:/opt/dolphinscheduler/libs/spring-boot-starter-logging-2.7.3.jar:/opt/dolphinscheduler/libs/kerby-pkix-1.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-procedure-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-etcd-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sqoop-3.2.1.jar:/opt/dolphinscheduler/libs/zookeeper-jute-3.8.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sagemaker-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-configuration-processor-2.6.1.jar:/opt/dolphinscheduler/libs/kerb-common-1.0.1.jar:/opt/dolphinscheduler/libs/stax-api-1.0.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-storageclass-5.10.2.jar:/opt/dolphinscheduler/libs/spring-boot-starter-jdbc-2.7.3.jar:/opt/dolphinscheduler/libs/spring-boot-starter-jetty-2.7.3.jar:/opt/dolphinscheduler/libs/okio-2.8.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dms-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_common-0.15.0.jar:/opt/dolphinscheduler/libs/javax.activation-api-1.2.0.jar:/opt/dolphinscheduler/libs/kerby-config-1.0.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-classes-2.0.53.Final.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-base-2.13.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-api-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-metrics-5.10.2.jar:/opt/dolphinscheduler/libs/hadoop-yarn-api-3.2.4.jar:/opt/dolphinscheduler/libs/hadoop-annotations-3.2.4.jar:/opt/dolphinscheduler/libs/LatencyUtils-2.0.3.jar:/opt/dolphinscheduler/libs/slf4j-api-1.7.36.jar:/opt/dolphinscheduler/libs/jackson-datatype-jsr310-2.13.3.jar:/opt/dolphinscheduler/libs/logging-interceptor-4.9.3.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel_agent-0.15.0.jar:/opt/dolphinscheduler/libs/janino-3.0.16.jar:/opt/dolphinscheduler/libs/jackson-dataformat-yaml-2.13.3.jar:/opt/dolphinscheduler/libs/ion-java-1.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-hivecli-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-scheduler-all-3.2.1.jar:/opt/dolphinscheduler/libs/javax.el-3.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-java-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-cache-2.7.3.jar:/opt/dolphinscheduler/libs/kerb-crypto-1.0.1.jar:/opt/dolphinscheduler/libs/httpcore-4.4.15.jar:/opt/dolphinscheduler/libs/guava-retrying-2.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-stream-3.2.1.jar:/opt/dolphinscheduler/libs/spring-tx-5.3.22.jar:/opt/dolphinscheduler/libs/bcprov-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/kubernetes-model-policy-5.10.2.jar:/opt/dolphinscheduler/libs/commons-io-2.11.0.jar:/opt/dolphinscheduler/libs/grpc-grpclb-1.41.0.jar:/opt/dolphinscheduler/libs/opentracing-api-0.33.0.jar:/opt/dolphinscheduler/libs/reload4j-1.2.18.3.jar:/opt/dolphinscheduler/libs/netty-tcnative-2.0.48.Final.jar:/opt/dolphinscheduler/libs/jdom2-2.0.6.1.jar:/opt/dolphinscheduler/libs/woodstox-core-5.3.0.jar:/opt/dolphinscheduler/libs/spring-boot-starter-json-2.7.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-epoll-4.1.53.Final.jar:/opt/dolphinscheduler/libs/mybatis-plus-core-3.5.2.jar:/opt/dolphinscheduler/libs/auto-service-annotations-1.0.1.jar:/opt/dolphinscheduler/libs/commons-compress-1.21.jar:/opt/dolphinscheduler/libs/hadoop-hdfs-client-3.2.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pytorch-3.2.1.jar:/opt/dolphinscheduler/libs/jetty-servlets-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-commons-2.1.3.jar:/opt/dolphinscheduler/libs/grpc-protobuf-lite-1.41.0.jar:/opt/dolphinscheduler/libs/jetty-webapp-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/commons-compiler-3.1.7.jar:/opt/dolphinscheduler/libs/netty-transport-4.1.53.Final.jar:/opt/dolphinscheduler/libs/spring-cloud-context-3.1.3.jar:/opt/dolphinscheduler/libs/client-java-spring-integration-13.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-master-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/netty-codec-4.1.53.Final.jar:/opt/dolphinscheduler/libs/commons-configuration2-2.1.1.jar:/opt/dolphinscheduler/libs/swagger-annotations-1.6.2.jar:/opt/dolphinscheduler/libs/cron-utils-9.1.6.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel-0.15.0.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-common-1.6.21.jar:/opt/dolphinscheduler/libs/kerb-core-1.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-worker-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-spi-3.2.1.jar:/opt/dolphinscheduler/libs/okhttp-2.7.5.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-1.6.21.jar:/opt/dolphinscheduler/libs/jakarta.websocket-api-1.1.2.jar:/opt/dolphinscheduler/libs/spring-boot-starter-aop-2.7.3.jar:/opt/dolphinscheduler/libs/netty-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jackson-databind-2.13.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-events-5.10.2.jar:/opt/dolphinscheduler/libs/gson-2.9.1.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.3.0.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-common-3.2.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-api-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-service-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-zeppelin-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-dao-api-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-s3-1.12.300.jar:/opt/dolphinscheduler/libs/stax2-api-4.2.1.jar:/opt/dolphinscheduler/libs/jakarta.annotation-api-1.3.5.jar:/opt/dolphinscheduler/libs/kubernetes-model-discovery-5.10.2.jar:/opt/dolphinscheduler/libs/jna-5.10.0.jar:/opt/dolphinscheduler/libs/spring-jcl-5.3.22.jar
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.io.tmpdir=/tmp
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.compiler=<NA>
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.name=Linux
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.939 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.arch=amd64
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.940 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.version=6.5.0-28-generic
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.940 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.name=root
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.940 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.home=/root
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.947 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.dir=/opt/dolphinscheduler
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.947 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.free=3299MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.953 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.max=3840MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.954 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.total=3840MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.956 +0800 o.a.z.ZooKeeper:[637] - Initiating client connection, connectString=dolphinscheduler-zookeeper:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@211da640
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.977 +0800 o.a.z.c.X509Util:[77] - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.008 +0800 o.a.z.ClientCnxnSocket:[239] - jute.maxbuffer value is 1048575 Bytes
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.048 +0800 o.a.z.ClientCnxn:[1732] - zookeeper.request.timeout value is 0. feature enabled=false
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.165 +0800 o.a.c.f.i.CuratorFrameworkImpl:[386] - Default schema
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.226 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.234 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.244 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.9:52562, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.259 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.5:2181, session id = 0x10000918e5c0001, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.382 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: CONNECTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.464 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.547 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.619 +0800 c.z.h.HikariDataSource:[110] - DolphinScheduler - Starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:16.845 +0800 c.z.h.HikariDataSource:[123] - DolphinScheduler - Start completed.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:28.459 +0800 o.a.d.c.u.JSONUtils:[72] - init timezone: sun.util.calendar.ZoneInfo[id="GMT+08:00",offset=28800000,dstSavings=0,useDaylight=false,transitions=0,lastRule=null]
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.143 +0800 o.a.d.s.m.r.ServerNodeManager:[174] - Worker: /nodes/worker/172.18.1.1:1234 added, currentNode : 172.18.1.1:1234
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.543 +0800 o.a.d.s.m.p.q.TaskEventService:[63] - TaskEvent dispatch thread starting
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.645 +0800 o.a.d.s.m.p.q.TaskEventService:[65] - TaskEvent dispatch thread started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.647 +0800 o.a.d.s.m.p.q.TaskEventService:[68] - TaskEvent handle thread staring
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.652 +0800 o.a.d.s.m.p.q.TaskEventService:[70] - TaskEvent handle thread started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.655 +0800 o.a.d.s.m.p.q.TaskEventService:[138] - event handler thread started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.063 +0800 o.q.i.StdSchedulerFactory:[1220] - Using default implementation for ThreadExecutor
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.253 +0800 o.q.c.SchedulerSignalerImpl:[61] - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.268 +0800 o.q.c.QuartzScheduler:[229] - Quartz Scheduler v.2.3.2 created.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.281 +0800 o.s.s.q.LocalDataSourceJobStore:[672] - Using db table-based data access locking (synchronization).
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.283 +0800 o.s.s.q.LocalDataSourceJobStore:[145] - JobStoreCMT initialized.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.366 +0800 o.q.c.QuartzScheduler:[294] - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'DolphinScheduler' with instanceId '2d1cee8a8dc81713925831096'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 25 threads.
  Using job-store 'org.springframework.scheduling.quartz.LocalDataSourceJobStore' - which supports persistence. and is clustered.

[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.369 +0800 o.q.i.StdSchedulerFactory:[1374] - Quartz scheduler 'DolphinScheduler' initialized from an externally provided properties instance.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.374 +0800 o.q.i.StdSchedulerFactory:[1378] - Quartz scheduler version: 2.3.2
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.374 +0800 o.q.c.QuartzScheduler:[2293] - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@b04a6a4
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.693 +0800 o.a.d.s.m.r.MasterRpcServer:[39] - Starting MasterRPCServer...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.153 +0800 o.a.d.e.b.NettyRemotingServer:[112] - MasterRpcServer bind success at port: 5678
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.154 +0800 o.a.d.s.m.r.MasterRpcServer:[41] - Started MasterRPCServer...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.211 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.214 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.216 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.218 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.218 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.221 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.222 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.225 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.225 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.227 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.229 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.230 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.231 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.233 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.233 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.235 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.235 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.237 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.237 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.238 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.239 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.239 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.240 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.245 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.246 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.247 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.247 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.248 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.250 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.254 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.254 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.256 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.256 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.259 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.260 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.286 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.286 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.287 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.288 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.301 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.303 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.307 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.307 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.308 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.309 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.310 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.310 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.312 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.312 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.313 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.313 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.315 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.315 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.321 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.321 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.323 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.323 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.324 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.324 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.326 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.326 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.327 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.327 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.328 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.328 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.335 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.359 +0800 o.a.d.s.m.r.MasterRegistryClient:[158] - Master node : 172.18.0.9:5678 registering to registry center
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.523 +0800 o.a.d.s.m.r.ServerNodeManager:[218] - master node : /nodes/master/172.18.0.9:5678 added.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.531 +0800 o.a.d.c.m.BaseHeartBeatTask:[48] - Starting MasterHeartBeatTask...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.532 +0800 o.a.d.c.m.BaseHeartBeatTask:[50] - Started MasterHeartBeatTask, heartBeatInterval: 10000...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.533 +0800 o.a.d.s.m.r.MasterRegistryClient:[181] - Master node : 172.18.0.9:5678 registered to registry center successfully
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.535 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8384074941451991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.536 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[92] - MasterSchedulerBootstrap starting..
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.541 +0800 o.a.d.s.m.r.WorkflowEventLooper:[74] - WorkflowEventLooper starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.546 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8384074941451991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.546 +0800 o.a.d.s.m.r.WorkflowEventLooper:[76] - WorkflowEventLooper started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.549 +0800 o.a.d.s.m.r.MasterTaskExecutorBootstrap:[38] - MasterTaskExecutorBootstrap starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.550 +0800 o.a.d.s.m.r.GlobalTaskDispatchWaitingQueueLooper:[59] - GlobalTaskDispatchWaitingQueueLooper starting...
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:33.548 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.571 +0800 o.a.d.s.m.r.GlobalTaskDispatchWaitingQueueLooper:[61] - GlobalTaskDispatchWaitingQueueLooper started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.572 +0800 o.a.d.s.m.r.e.AsyncMasterTaskDelayQueueLooper:[53] - AsyncMasterTaskDelayQueueLooper starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.585 +0800 o.a.d.s.m.r.e.AsyncMasterTaskDelayQueueLooper:[55] - AsyncMasterTaskDelayQueueLooper started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.587 +0800 o.a.d.s.m.r.MasterRegistryDataListener:[58] - master node added : /nodes/master/172.18.0.9:5678
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.587 +0800 o.a.d.s.m.r.MasterRegistryDataListener:[73] - worker node added : /nodes/worker/172.18.1.1:1234
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.587 +0800 o.a.d.s.m.r.MasterTaskExecutorBootstrap:[41] - MasterTaskExecutorBootstrap started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.589 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[96] - MasterSchedulerBootstrap started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.590 +0800 o.a.d.s.m.r.EventExecuteService:[56] - Master Event execute service starting
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.606 +0800 o.a.d.s.m.r.EventExecuteService:[58] - Master Event execute service started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.607 +0800 o.a.d.s.m.r.FailoverExecuteThread:[51] - Master failover thread staring
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.609 +0800 o.a.d.s.m.r.FailoverExecuteThread:[53] - Master failover thread stared
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.644 +0800 o.s.s.q.LocalDataSourceJobStore:[3644] - ClusterManager: detected 1 failed or restarted instances.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.645 +0800 o.s.s.q.LocalDataSourceJobStore:[3503] - ClusterManager: Scanning for instance "6caf85fd99691713917822189"'s failed in-progress jobs.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.651 +0800 o.q.c.QuartzScheduler:[547] - Scheduler DolphinScheduler_$_2d1cee8a8dc81713925831096 started.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.652 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[105] - TaskGroupCoordinator starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.654 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[107] - TaskGroupCoordinator started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:34.072 +0800 o.a.d.s.m.p.q.StateEventResponseService:[108] - State event loop service started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:34.267 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 144/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:34.566 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.8473684210526318 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:34.569 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:35.694 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.8958333333333335 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:35.695 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:35.694 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.8958333333333335 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:36.697 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:36.698 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:36.718 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:36.884 +0800 o.s.b.a.e.w.EndpointLinksResolver:[58] - Exposing 3 endpoint(s) beneath base path '/actuator'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.113 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring DispatcherServlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.113 +0800 o.s.w.s.DispatcherServlet:[525] - Initializing Servlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.130 +0800 o.s.w.s.DispatcherServlet:[547] - Completed initialization in 17 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.170 +0800 o.e.j.s.AbstractConnector:[333] - Started ServerConnector@2c08c787{HTTP/1.1, (http/1.1)}{0.0.0.0:5679}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.171 +0800 o.s.b.w.e.j.JettyWebServer:[172] - Jetty started on port(s) 5679 (http/1.1) with context path '/'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.279 +0800 o.a.d.s.m.MasterServer:[61] - Started MasterServer in 58.574 seconds (JVM running for 61.122)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.711 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.7570621468926555 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:37.712 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.720 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.7570621468926555 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:38.716 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7933884297520661 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:38.717 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:38.721 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7933884297520661 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:39.311 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713925838833, cpuUsage=0.8264150943396227, jvmMemoryUsage=0.032172807057698566, memoryUsage=0.5033654836505814, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:39.316 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:39.340 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:39.719 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:40.794 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8687258687258688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:40.795 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8687258687258688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:40.797 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:41.801 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9488636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:41.801 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:41.810 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9488636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:43.011 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.709090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:43.012 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.709090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:43.012 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.047 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8629441624365483 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.048 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8629441624365483 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:44.049 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.052 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.9:5678 begin to failover hosts:[172.18.0.12:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.173 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.12:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:44.183 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:44.281 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:44.282 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:44.308 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:44.309 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:44.321 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:44.322 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:44.351 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.352 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.12:5678] failover finished, useTime:208ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.466 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 27/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:45.050 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0273972602739725 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:45.050 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:46.064 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8853868194842407 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:46.069 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:46.079 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8853868194842407 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:47.134 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8412698412698413 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:47.135 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8412698412698413 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:47.135 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:48.137 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:49.139 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:49.370 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:49.489 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.151 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 4, cost: 6ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.390 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:50.391 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:50.393 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.393 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.390 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.390 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:50.397 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:50.397 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:50.397 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-508][TI-0] - [INFO] 2024-04-24 10:30:50.397 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 10, recover flag: YES
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:50.398 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:50.399 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:50.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-511][TI-0] - [INFO] 2024-04-24 10:30:50.400 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 7, recover flag: YES
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:50.399 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:50.400 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:50.404 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:50.405 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:50.404 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:50.415 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-510][TI-0] - [INFO] 2024-04-24 10:30:50.415 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 7, recover flag: YES
[WI-511][TI-1256] - [INFO] 2024-04-24 10:30:50.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:50.425 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:50.425 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-448][TI-0] - [INFO] 2024-04-24 10:30:50.428 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 12, recover flag: YES
[WI-508][TI-1255] - [INFO] 2024-04-24 10:30:50.431 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-510][TI-1257] - [INFO] 2024-04-24 10:30:50.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-510][TI-1257] - [INFO] 2024-04-24 10:30:50.453 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-448][TI-1080] - [INFO] 2024-04-24 10:30:50.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-510][TI-1252] - [INFO] 2024-04-24 10:30:50.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1256] - [INFO] 2024-04-24 10:30:50.463 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-511][TI-1254] - [INFO] 2024-04-24 10:30:50.463 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-510][TI-1252] - [INFO] 2024-04-24 10:30:50.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-510][TI-1249] - [INFO] 2024-04-24 10:30:50.466 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-510][TI-1249] - [INFO] 2024-04-24 10:30:50.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-510][TI-1241] - [INFO] 2024-04-24 10:30:50.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1254] - [INFO] 2024-04-24 10:30:50.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-511][TI-1248] - [INFO] 2024-04-24 10:30:50.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1255] - [INFO] 2024-04-24 10:30:50.479 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-508][TI-1253] - [INFO] 2024-04-24 10:30:50.480 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1248] - [INFO] 2024-04-24 10:30:50.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-511][TI-1243] - [INFO] 2024-04-24 10:30:50.481 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1080] - [INFO] 2024-04-24 10:30:50.479 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-448][TI-1067] - [INFO] 2024-04-24 10:30:50.482 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-510][TI-1241] - [INFO] 2024-04-24 10:30:50.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.487 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.487 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-508][TI-1253] - [INFO] 2024-04-24 10:30:50.490 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1247] - [INFO] 2024-04-24 10:30:50.491 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1067] - [INFO] 2024-04-24 10:30:50.493 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-448][TI-1066] - [INFO] 2024-04-24 10:30:50.493 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1243] - [INFO] 2024-04-24 10:30:50.494 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.495 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.495 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-448][TI-1066] - [INFO] 2024-04-24 10:30:50.504 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1247] - [INFO] 2024-04-24 10:30:50.504 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-448][TI-1065] - [INFO] 2024-04-24 10:30:50.511 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1246] - [INFO] 2024-04-24 10:30:50.511 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1065] - [INFO] 2024-04-24 10:30:50.518 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1246] - [INFO] 2024-04-24 10:30:50.529 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1242] - [INFO] 2024-04-24 10:30:50.529 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1242] - [WARN] 2024-04-24 10:30:50.530 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[803] - Have same taskCode taskInstance when init task queue, need to check taskExecutionStatus, taskCode:13340113777664
[WI-508][TI-1242] - [INFO] 2024-04-24 10:30:50.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.535 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.535 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.535 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.535 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.538 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.541 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.518 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:50.543 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.550 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.551 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.551 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.562 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.564 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:30:50.564 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:51.167 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9688385269121813 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:51.396 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9688385269121813 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:51.396 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:54.200 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7280453257790368 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:54.429 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7280453257790368 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:54.429 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:54.579 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:55.211 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7094017094017094 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:55.430 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7094017094017094 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:55.431 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:58.447 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 9ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:58.687 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.689 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.690 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.691 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.709 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.710 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.716 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.721 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1392, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:58.740 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.741 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.741 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:30:58.746 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:58.747 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.236 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9189189189189189 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:59.382 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713925859223, cpuUsage=0.8125, jvmMemoryUsage=0.032966931660970054, memoryUsage=0.5026908360063405, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:59.396 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.567 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.631 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.633 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.636 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1392, processInstanceId=566, startTime=1713925859536, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.645 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.646 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.680 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1392, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.681 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.681 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.690 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9189189189189189 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:30:59.690 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.739 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.TaskRetryStateEventHandler for eventType: TASK_RETRY
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.741 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.TaskStateEventHandler for eventType: TASK_STATE_CHANGE
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.742 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.TaskTimeoutStateEventHandler for eventType: TASK_TIMEOUT
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.743 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.WorkflowBlockStateEventHandler for eventType: PROCESS_BLOCKED
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.744 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.WorkflowStateEventHandler for eventType: PROCESS_STATE_CHANGE
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.745 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.WorkflowSubmitFailStateEventHandler for eventType: PROCESS_SUBMIT_FAILED
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.748 +0800 o.a.d.s.m.e.StateEventHandlerManager:[37] - Initialize StateEventHandler: org.apache.dolphinscheduler.server.master.event.WorkflowTimeoutStateEventHandler for eventType: PROCESS_TIMEOUT
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.750 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1392, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.752 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.635 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:00.673 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:00.691 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.866 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=Wed Apr 24 10:31:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, processId=86, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.636 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=Wed Apr 24 10:31:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, processId=86, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.663 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1392, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.664 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1392, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:30:59 GMT+08:00 2024, endTime=Wed Apr 24 10:31:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log, processId=86, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:01.664 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.679 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1392, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.680 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.682 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.683 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:01.692 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.713 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:01.716 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1393, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:01.725 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:30:58 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:30:58 GMT+08:00 2024
Start Time:             Wed Apr 24 10:30:59 GMT+08:00 2024
End Time:               Wed Apr 24 10:31:00 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:31:01.784 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1393, taskName=check file existence, firstSubmitTime=1713925861714, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1393'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103101'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.789 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.794 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:01.813 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.815 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.817 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.817 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713925861817
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.818 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 566_1393
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1393,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713925861714,
  "startTime" : 1713925861817,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1393"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103101"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1393",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.825 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:01.830 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1393, processInstanceId=566, startTime=1713925861817, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.831 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.835 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.836 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.848 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.850 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:01.851 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.091 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.092 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.186 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.188 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.189 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.189 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.190 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.190 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.196 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:31:01 GMT+08:00 2024, endTime=Wed Apr 24 10:31:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.199 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.200 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.201 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.643 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.650 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.650 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:31:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:31:02.659 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=8), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 53, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1393] - [ERROR] 2024-04-24 10:31:02.662 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:31:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.662 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:31:01 GMT+08:00 2024, endTime=Wed Apr 24 10:31:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:31:02.673 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=9), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 53, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1393] - [WARN] 2024-04-24 10:31:02.675 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1393
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.688 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1393, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.688 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1393, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:31:01 GMT+08:00 2024, endTime=Wed Apr 24 10:31:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1393.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:02.688 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:02.694 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.744 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1393, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.745 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.745 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.745 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.762 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.766 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1393] - [INFO] 2024-04-24 10:31:02.770 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1394, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:02.775 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.775 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [ERROR] 2024-04-24 10:31:02.775 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: move to processing failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.776 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.777 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.778 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.778 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:31:02.778 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:31:01 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:31:01 GMT+08:00 2024
Start Time:             Wed Apr 24 10:31:01 GMT+08:00 2024
End Time:               Wed Apr 24 10:31:02 GMT+08:00 2024

[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.644 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1394, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Wed Apr 24 10:31:02 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1394] - [WARN] 2024-04-24 10:31:03.653 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1394
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.654 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1394, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.654 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1394, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Wed Apr 24 10:31:02 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:03.654 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:03.695 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1394, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.758 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.758 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.758 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: spark preprocessing depend result : FAILED
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.786 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.786 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1394] - [INFO] 2024-04-24 10:31:03.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:31:02 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:31:02 GMT+08:00 2024
Start Time:             null
End Time:               Wed Apr 24 10:31:02 GMT+08:00 2024

[WI-566][TI-null] - [INFO] 2024-04-24 10:31:03.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=566, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-null] - [INFO] 2024-04-24 10:31:03.789 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-null] - [INFO] 2024-04-24 10:31:03.806 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-99-20240424101753943
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:30:58 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:30:58 GMT+08:00 2024
End Time:                  Wed Apr 24 10:31:03 GMT+08:00 2024

[WI-566][TI-0] - [INFO] 2024-04-24 10:31:03.808 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:04.688 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:04.699 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:05.700 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:06.707 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:07.708 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:08.714 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:09.418 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:09.717 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:14.747 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:19.770 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:24.791 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:29.836 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:34.923 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:39.976 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:45.016 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:49.541 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7335243553008596 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:49.604 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713925909477, cpuUsage=0.7335243553008597, jvmMemoryUsage=0.03391574223836263, memoryUsage=0.4997820766819664, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:49.612 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:49.905 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7335243553008596 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:49.906 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:50.034 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:50.581 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.777158774373259 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:50.909 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.777158774373259 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:50.909 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:51.910 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:52.912 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:53.926 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:54.930 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:55.059 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:55.932 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:56.933 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:57.934 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:31:58.935 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:59.646 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:00.107 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:02.983 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 17ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.129 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.130 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.130 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.134 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=566)
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.135 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 3
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.135 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 3, recover flag: NO
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.141 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.144 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.156 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.163 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.166 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1395, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.174 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.178 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.178 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:03.179 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.179 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.184 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.204 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1395, processInstanceId=566, startTime=1713925923188, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.777 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.789 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.790 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.807 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1395, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.808 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.809 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.829 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.829 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.884 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1395, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.898 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.189 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=Wed Apr 24 10:32:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, processId=115, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:05.264 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.161 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=Wed Apr 24 10:32:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, processId=115, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.175 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1395, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.175 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1395, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:03 GMT+08:00 2024, endTime=Wed Apr 24 10:32:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log, processId=115, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:06.175 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.265 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1395, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.265 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.265 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.266 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.266 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.275 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.279 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:06.281 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1396, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.286 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.288 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:06.296 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:32:03 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:32:03 GMT+08:00 2024
Start Time:             Wed Apr 24 10:32:03 GMT+08:00 2024
End Time:               Wed Apr 24 10:32:05 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:32:06.311 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1396, taskName=check file existence, firstSubmitTime=1713925926279, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1396'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103206'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.312 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.316 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:06.317 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.318 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.318 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713925926318
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.318 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 566_1396
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.319 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1396,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713925926279,
  "startTime" : 1713925926318,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1396"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103206"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1396",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:06.327 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1396, processInstanceId=566, startTime=1713925926318, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.329 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.329 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.330 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.330 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.331 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.331 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.331 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.332 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.333 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.333 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.333 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.333 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.337 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:06 GMT+08:00 2024, endTime=Wed Apr 24 10:32:06 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.340 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.340 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:06.340 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.163 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.170 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.171 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:32:07.179 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=18), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 53, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1396] - [ERROR] 2024-04-24 10:32:07.183 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.184 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:06 GMT+08:00 2024, endTime=Wed Apr 24 10:32:06 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:32:07.190 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=19), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 77, 53, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-566][TI-1396] - [WARN] 2024-04-24 10:32:07.214 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1396
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.214 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1396, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.215 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1396, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:06 GMT+08:00 2024, endTime=Wed Apr 24 10:32:06 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1396.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:07.215 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.284 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1396, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.286 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.286 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.286 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.286 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.304 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.308 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1396] - [INFO] 2024-04-24 10:32:07.311 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1397, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.316 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:07.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:32:06 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:32:06 GMT+08:00 2024
Start Time:             Wed Apr 24 10:32:06 GMT+08:00 2024
End Time:               Wed Apr 24 10:32:06 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:32:07.336 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:07.346 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1397, processInstanceId=566, startTime=1713925927334, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.164 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.172 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.172 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.182 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1397, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.183 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.183 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.191 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:08.192 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.192 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1397, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.193 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.397 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=Wed Apr 24 10:32:08 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, processId=132, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.167 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=Wed Apr 24 10:32:08 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, processId=132, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.187 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1397, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.187 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1397, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:32:07 GMT+08:00 2024, endTime=Wed Apr 24 10:32:08 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log, processId=132, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:09.187 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.217 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1397, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.217 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.218 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.218 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.218 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.254 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.254 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.254 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.267 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.270 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.271 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:566, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:09.274 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1398, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:566, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.282 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.282 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.282 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.283 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.283 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.283 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-566][TI-0] - [INFO] 2024-04-24 10:32:09.283 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:32:07 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:32:07 GMT+08:00 2024
Start Time:             Wed Apr 24 10:32:07 GMT+08:00 2024
End Time:               Wed Apr 24 10:32:08 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:32:09.287 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:09.295 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1398, processInstanceId=566, startTime=1713925929286, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.184 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.190 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.190 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.200 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1398, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.201 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.202 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1398, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.257 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:10.258 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:10.331 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.424 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=Wed Apr 24 10:32:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, processId=150, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.190 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=Wed Apr 24 10:32:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, processId=150, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.208 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=566, taskInstanceId=1398, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.212 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1398, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:32:09 GMT+08:00 2024, endTime=Wed Apr 24 10:32:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log, processId=150, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=566)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:11.212 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-566] persist events succeeded
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.266 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=566, taskInstanceId=1398, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.266 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.266 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.267 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.267 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.269 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.269 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.269 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.269 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.269 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:11.281 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-99-20240424101753943
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:32:09 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:32:09 GMT+08:00 2024
Start Time:             Wed Apr 24 10:32:09 GMT+08:00 2024
End Time:               Wed Apr 24 10:32:10 GMT+08:00 2024

[WI-566][TI-null] - [INFO] 2024-04-24 10:32:11.282 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=566, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-566][TI-null] - [INFO] 2024-04-24 10:32:11.283 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-566][TI-null] - [INFO] 2024-04-24 10:32:11.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-99-20240424101753943
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 3
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:32:03 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:32:03 GMT+08:00 2024
End Time:                  Wed Apr 24 10:32:11 GMT+08:00 2024

[WI-566][TI-0] - [INFO] 2024-04-24 10:32:11.288 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:15.362 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:20.395 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:25.417 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:30.433 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:32.283 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7017543859649122 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:32.312 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7017543859649122 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:32:32.313 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:33.314 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7163742690058479 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:32:33.314 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:33.344 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7163742690058479 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:35.491 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:40.513 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:45.543 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:50.599 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:55.622 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:57.435 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8554913294797688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:32:57.442 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:57.451 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8554913294797688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:00.641 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:05.660 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:10.688 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:15.731 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:20.759 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 16/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:25.561 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7640449438202248 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:33:25.566 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:25.631 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7640449438202248 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:25.790 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:30.811 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:35.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:40.872 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:45.896 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:50.926 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:33:55.958 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:00.977 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:05.994 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:11.023 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:16.039 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:19.807 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7677419354838709 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:19.808 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:19.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7677419354838709 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:20.023 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713926059938, cpuUsage=0.7278481012658228, jvmMemoryUsage=0.034128729502360025, memoryUsage=0.506016950298372, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:20.028 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:20.810 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:21.079 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:21.813 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:22.814 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:23.816 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:24.819 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:25.827 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:26.109 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:26.836 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134328358208955 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:26.836 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:26.942 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134328358208955 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:27.855 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:28.860 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:29.861 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:30.037 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:31.165 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:35.906 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:35.907 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:35.964 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:36.220 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:41.243 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:46.257 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:51.289 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:56.307 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:57.074 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:34:57.077 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:01.127 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7074350649350649 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:01.141 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7074350649350649 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:01.142 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:01.346 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:02.147 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8873626373626373 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:02.167 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:02.154 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8873626373626373 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:03.172 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8825136612021858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:03.174 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:03.178 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:06.366 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:11.393 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.236 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 8ms, current slot: 0, total slot size: 1
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.275 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.275 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=567)
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.276 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=567)
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.280 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=567)
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.280 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.280 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.281 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.288 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.291 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:567, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.295 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1399, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:567, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.333 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.336 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.336 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:15.336 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.336 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.359 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.393 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1399, processInstanceId=567, startTime=1713926115372, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.599 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.610 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.610 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.625 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1399, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.626 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.626 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1399, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.644 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.644 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.644 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.409 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.464 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, processId=211, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.601 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, processId=211, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.623 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1399, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.624 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1399, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:15 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log, processId=211, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.624 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.657 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1399, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.657 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.658 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.658 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.658 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.666 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.668 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:567, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.670 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1400, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:567, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.674 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.674 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.675 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.675 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.675 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.675 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:16.675 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-100-20240424103515249
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:35:15 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:35:15 GMT+08:00 2024
Start Time:             Wed Apr 24 10:35:15 GMT+08:00 2024
End Time:               Wed Apr 24 10:35:16 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.678 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1400, taskName=check file existence, firstSubmitTime=1713926116668, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=100, appIds=null, processInstanceId=567, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1400'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103516'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='567'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.679 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.687 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.690 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.690 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713926116691
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 567_1400
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.692 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1400,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713926116668,
  "startTime" : 1713926116691,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 100,
  "processInstanceId" : 567,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1400"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103516"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "567"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "567_1400",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.693 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.693 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.694 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.706 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1400, processInstanceId=567, startTime=1713926116691, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.720 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.723 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.725 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.725 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.725 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.726 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.726 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.726 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.726 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.726 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.727 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.728 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.728 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.735 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:16 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.738 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.738 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:16.739 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.603 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.609 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.610 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:16 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:35:17.634 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=35), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-567][TI-1400] - [ERROR] 2024-04-24 10:35:17.638 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:16 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.639 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:16 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:35:17.647 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=36), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-567][TI-1400] - [WARN] 2024-04-24 10:35:17.659 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1400
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.659 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1400, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.660 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1400, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:16 GMT+08:00 2024, endTime=Wed Apr 24 10:35:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1400.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:17.661 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.679 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1400, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.679 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.680 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.681 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.681 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.690 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.690 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.692 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:567, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1400] - [INFO] 2024-04-24 10:35:17.696 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1401, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:567, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.722 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:17.750 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.748 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.751 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.751 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.751 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:17.751 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-100-20240424103515249
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:35:16 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:35:16 GMT+08:00 2024
Start Time:             Wed Apr 24 10:35:16 GMT+08:00 2024
End Time:               Wed Apr 24 10:35:16 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:35:17.785 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:18.602 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713926118597)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.604 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.616 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.616 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.639 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.639 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.639 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.649 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.650 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.664 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.664 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.664 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:18.691 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.712 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.715 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.842 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=Wed Apr 24 10:35:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=225, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.606 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=Wed Apr 24 10:35:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=225, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.618 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.619 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1401, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:35:17 GMT+08:00 2024, endTime=Wed Apr 24 10:35:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, processId=225, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:19.619 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.625 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1401, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.626 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.626 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.626 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.626 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.635 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.636 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.636 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.641 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.645 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.647 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:567, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:19.650 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1402, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:567, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.670 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.671 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.671 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.671 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.671 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.672 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-567][TI-0] - [INFO] 2024-04-24 10:35:19.672 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-100-20240424103515249
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:35:17 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:35:17 GMT+08:00 2024
Start Time:             Wed Apr 24 10:35:17 GMT+08:00 2024
End Time:               Wed Apr 24 10:35:18 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:35:19.677 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:19.685 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1402, processInstanceId=567, startTime=1713926119680, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.608 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.615 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.615 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.626 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1402, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.626 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.626 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.645 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.646 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.653 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:20.654 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1402, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:20.679 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:21.247 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7429577464788732 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:21.377 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7429577464788732 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:21.379 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:21.436 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:22.275 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7857142857142857 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:22.394 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7857142857142857 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:22.394 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:26.514 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:28.305 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:28.407 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:28.408 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:29.365 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7871621621621621 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:29.414 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7871621621621621 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:29.415 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:30.251 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713926128479, cpuUsage=0.8888888888888888, jvmMemoryUsage=0.034162108103434244, memoryUsage=0.5321931993608643, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=1)
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:30.267 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:30.444 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:31.391 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8396501457725948 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:31.446 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8396501457725948 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:31.447 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:31.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 30/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:32.449 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9269841269841269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:32.449 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:32.476 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9269841269841269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:33.458 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8554216867469879 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:33.460 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:33.479 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8554216867469879 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:34.462 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:35.466 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:36.467 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:36.624 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:37.468 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.960 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=Wed Apr 24 10:35:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, processId=237, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:38.470 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.660 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=Wed Apr 24 10:35:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, processId=237, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.669 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=567, taskInstanceId=1402, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.670 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1402, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:35:19 GMT+08:00 2024, endTime=Wed Apr 24 10:35:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log, processId=237, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=567)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:38.670 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-567] persist events succeeded
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=567, taskInstanceId=1402, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.700 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.700 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.700 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:38.708 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-100-20240424103515249
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:35:19 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:35:19 GMT+08:00 2024
Start Time:             Wed Apr 24 10:35:19 GMT+08:00 2024
End Time:               Wed Apr 24 10:35:37 GMT+08:00 2024

[WI-567][TI-null] - [INFO] 2024-04-24 10:35:38.709 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=567, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-567][TI-null] - [INFO] 2024-04-24 10:35:38.709 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-567][TI-null] - [INFO] 2024-04-24 10:35:38.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-100-20240424103515249
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:35:15 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:35:15 GMT+08:00 2024
End Time:                  Wed Apr 24 10:35:38 GMT+08:00 2024

[WI-567][TI-0] - [INFO] 2024-04-24 10:35:38.712 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:39.473 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:40.279 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:40.477 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7586206896551724 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:35:40.477 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:40.504 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7586206896551724 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:41.643 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:46.663 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:51.704 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:56.728 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:01.748 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:06.767 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:11.786 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:16.809 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:21.835 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:26.853 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:31.875 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:36.931 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:41.954 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:46.983 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:52.003 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:36:57.042 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:02.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:07.086 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:12.105 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:14.893 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:17.133 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:22.258 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:27.297 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:32.345 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:37.373 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:42.414 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:47.439 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:52.465 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:37:57.490 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:02.523 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:07.551 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:12.576 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:17.603 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:22.634 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:27.651 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:32.701 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:37.721 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:42.749 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:47.762 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:52.781 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:38:57.797 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:02.818 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:07.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:12.855 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:17.873 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:22.902 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:27.920 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:32.972 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:37.991 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:43.018 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:48.035 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:53.053 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:39:58.088 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:03.124 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:08.146 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:13.170 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:18.198 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:23.228 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:28.250 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:33.289 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:38.307 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:43.326 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:44.499 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.9:5678 begin to failover hosts:[172.18.0.9:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:44.534 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.9:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:44.535 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.9:5678] failover finished, useTime:8ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:48.358 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:53.380 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:40:58.397 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:03.433 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:08.503 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:12.076 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7031700288184438 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:41:12.077 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:12.100 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7031700288184438 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:13.531 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:18.552 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:23.576 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:28.600 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:33.657 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:38.694 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:43.707 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:48.729 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:53.744 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:58.774 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:03.794 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:08.812 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:12.453 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.014367816091954 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:12.454 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.6820809248554913 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:42:12.455 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:13.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:18.861 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.495 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 3ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.530 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.530 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.531 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.534 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.534 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.540 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.540 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.545 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:568, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.553 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1403, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:568, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.560 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.560 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.561 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:21.561 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.561 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.611 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1403, processInstanceId=568, startTime=1713926541599, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.617 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.806 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.820 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1403, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.821 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.821 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [WARN] 2024-04-24 10:42:21.821 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.821 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.821 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.830 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.831 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1403, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.867 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.679 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=Wed Apr 24 10:42:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, processId=468, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.807 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=Wed Apr 24 10:42:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, processId=468, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.815 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1403, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.816 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1403, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:21 GMT+08:00 2024, endTime=Wed Apr 24 10:42:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log, processId=468, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:22.816 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.884 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1403, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.885 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.887 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.888 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.913 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.914 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.917 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:568, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.919 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1404, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:568, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.950 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:22.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-101-20240424104221497
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:42:21 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:42:21 GMT+08:00 2024
Start Time:             Wed Apr 24 10:42:21 GMT+08:00 2024
End Time:               Wed Apr 24 10:42:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:42:22.958 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1404, taskName=check file existence, firstSubmitTime=1713926542917, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=101, appIds=null, processInstanceId=568, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1404'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104222'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='568'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.960 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.962 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:22.970 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.975 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.975 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.975 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713926542975
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:22.990 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 568_1404
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.008 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1404,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713926542917,
  "startTime" : 1713926542975,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 101,
  "processInstanceId" : 568,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1404"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104222"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "568"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "568_1404",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.011 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.011 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.011 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.028 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1404, processInstanceId=568, startTime=1713926542975, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.035 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.036 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.036 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.036 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.042 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.042 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.043 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.043 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.046 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.048 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.050 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.050 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.050 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:22 GMT+08:00 2024, endTime=Wed Apr 24 10:42:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.058 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.058 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.059 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.809 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.815 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.815 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:42:23.829 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=55), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-568][TI-1404] - [ERROR] 2024-04-24 10:42:23.831 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.832 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:22 GMT+08:00 2024, endTime=Wed Apr 24 10:42:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:42:23.839 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=56), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-568][TI-1404] - [WARN] 2024-04-24 10:42:23.840 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1404
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.841 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1404, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1404, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:22 GMT+08:00 2024, endTime=Wed Apr 24 10:42:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1404.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.843 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.876 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.899 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1404, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.900 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.900 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.900 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.901 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.922 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.923 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.923 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.925 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:568, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:42:23.931 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1405, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:568, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.939 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.939 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.939 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.939 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:23.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-101-20240424104221497
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:42:22 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:42:22 GMT+08:00 2024
Start Time:             Wed Apr 24 10:42:22 GMT+08:00 2024
End Time:               Wed Apr 24 10:42:23 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.950 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.969 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1405, processInstanceId=568, startTime=1713926543947, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.838 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.839 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.845 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1405, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.845 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.845 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.855 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:24.855 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.910 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1405, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.910 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.987 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=Wed Apr 24 10:42:24 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, processId=482, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.812 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=Wed Apr 24 10:42:24 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, processId=482, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.821 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1405, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.822 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1405, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:42:23 GMT+08:00 2024, endTime=Wed Apr 24 10:42:24 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log, processId=482, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:25.822 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.923 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1405, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.923 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.924 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.925 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.925 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.937 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.938 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.939 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.945 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.946 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:568, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:25.948 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1406, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:568, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.952 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.953 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.953 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.953 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.953 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.954 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-568][TI-0] - [INFO] 2024-04-24 10:42:25.954 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-101-20240424104221497
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:42:23 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:42:23 GMT+08:00 2024
Start Time:             Wed Apr 24 10:42:23 GMT+08:00 2024
End Time:               Wed Apr 24 10:42:24 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:42:25.962 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:25.971 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1406, processInstanceId=568, startTime=1713926545967, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.812 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.823 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.823 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.831 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.832 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.833 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.833 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:26.842 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.038 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=Wed Apr 24 10:42:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=494, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.815 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=Wed Apr 24 10:42:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=494, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.825 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.825 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:42:25 GMT+08:00 2024, endTime=Wed Apr 24 10:42:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=494, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:28.825 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.871 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.873 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.873 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.874 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.874 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.877 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.877 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.877 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.877 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.877 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.883 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-101-20240424104221497
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:42:25 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:42:25 GMT+08:00 2024
Start Time:             Wed Apr 24 10:42:25 GMT+08:00 2024
End Time:               Wed Apr 24 10:42:28 GMT+08:00 2024

[WI-568][TI-null] - [INFO] 2024-04-24 10:42:28.883 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=568, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-null] - [INFO] 2024-04-24 10:42:28.883 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-null] - [INFO] 2024-04-24 10:42:28.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-101-20240424104221497
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:42:21 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:42:21 GMT+08:00 2024
End Time:                  Wed Apr 24 10:42:28 GMT+08:00 2024

[WI-568][TI-0] - [INFO] 2024-04-24 10:42:28.887 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:28.891 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:32.602 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0027397260273974 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:42:32.608 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:33.915 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:38.943 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:43.981 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:48.995 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:54.008 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:57.690 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:59.031 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:04.061 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:09.096 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:14.118 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:19.138 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:24.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:29.208 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:34.232 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:39.261 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:44.277 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:49.306 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:54.325 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:57.475 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7225433526011561 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:57.479 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7225433526011561 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:43:57.490 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:59.357 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:04.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:09.432 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.531 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 5ms, current slot: 0, total slot size: 1
[WI-568][TI-0] - [INFO] 2024-04-24 10:44:11.582 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.582 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:44:11.583 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:44:11.584 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=568)
[WI-568][TI-0] - [INFO] 2024-04-24 10:44:11.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-568][TI-0] - [INFO] 2024-04-24 10:44:11.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.588 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.597 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-568][TI-1405] - [INFO] 2024-04-24 10:44:11.598 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:44:11.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-568][TI-1404] - [INFO] 2024-04-24 10:44:11.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1404] - [INFO] 2024-04-24 10:44:11.618 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-568][TI-1403] - [INFO] 2024-04-24 10:44:11.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:44:11.624 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:1406, task code:13210058002752
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.659 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.666 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.667 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:568, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.670 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1406, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:568, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-1406] - [INFO] 2024-04-24 10:44:11.688 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.692 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.705 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.715 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1406, processInstanceId=568, startTime=1713926651707, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.411 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.425 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.426 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.463 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.463 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.463 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.521 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:12.534 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.540 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.540 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:12.588 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7150684931506849 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:12.591 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7150684931506849 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:12.591 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.750 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=Wed Apr 24 10:44:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=554, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.407 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=Wed Apr 24 10:44:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=554, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.438 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.443 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1406, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:11 GMT+08:00 2024, endTime=Wed Apr 24 10:44:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, processId=554, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=568)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:13.446 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-568] persist events succeeded
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.470 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=568, taskInstanceId=1406, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.470 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.470 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.470 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.471 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.472 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:13.492 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-101-20240424104221497
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:42:25 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:42:25 GMT+08:00 2024
Start Time:             Wed Apr 24 10:44:11 GMT+08:00 2024
End Time:               Wed Apr 24 10:44:12 GMT+08:00 2024

[WI-568][TI-null] - [INFO] 2024-04-24 10:44:13.496 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=568, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-568][TI-null] - [INFO] 2024-04-24 10:44:13.496 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-568][TI-null] - [INFO] 2024-04-24 10:44:13.503 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-101-20240424104221497
Command Type:              EXECUTE_TASK
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:44:11 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:42:21 GMT+08:00 2024
End Time:                  Wed Apr 24 10:44:13 GMT+08:00 2024

[WI-568][TI-0] - [INFO] 2024-04-24 10:44:13.504 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:13.593 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9320113314447591 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:13.602 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:13.641 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9320113314447591 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:14.449 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:14.605 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7590361445783133 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:14.605 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:14.642 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7590361445783133 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:19.487 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 22/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:24.505 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:29.545 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:34.568 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:38.756 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:38.757 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:39.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:39.755 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:42.771 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7305389221556887 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:42.773 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:42.788 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7305389221556887 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:43.774 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7812500000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:43.775 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:43.799 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7812500000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:44.615 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.663 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.801 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.829 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=569)
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.829 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.828 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=569)
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.830 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=569)
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.830 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.847 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.848 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.871 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.876 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:569, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.879 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1407, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:569, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.936 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:49.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.941 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.950 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.958 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1407, processInstanceId=569, startTime=1713926689952, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.508 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.579 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.596 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1407, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.597 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.597 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.602 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:50.602 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1407, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:50.606 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.054 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, processId=578, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.509 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, processId=578, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.591 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1407, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.591 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1407, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:49 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log, processId=578, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:51.591 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.636 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1407, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.637 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.637 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.637 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.637 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.649 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:569, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.651 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1408, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:569, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:51.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-102-20240424104449810
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:44:49 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:44:49 GMT+08:00 2024
Start Time:             Wed Apr 24 10:44:49 GMT+08:00 2024
End Time:               Wed Apr 24 10:44:51 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:44:51.667 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1408, taskName=check file existence, firstSubmitTime=1713926691650, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=102, appIds=null, processInstanceId=569, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1408'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104451'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='569'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.668 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.675 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.677 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.677 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.677 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713926691677
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.678 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 569_1408
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.678 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1408,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713926691650,
  "startTime" : 1713926691677,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 102,
  "processInstanceId" : 569,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1408"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104451"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "569"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "569_1408",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:51.679 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:51.681 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1408, processInstanceId=569, startTime=1713926691677, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.683 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.684 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.684 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.684 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.684 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.684 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.685 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.685 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.685 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.686 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.686 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.687 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.687 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.687 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.688 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.688 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.690 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:51 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.692 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:51.692 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.511 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.531 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.532 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:44:52.539 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=76), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-569][TI-1408] - [ERROR] 2024-04-24 10:44:52.541 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.541 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:51 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:44:52.545 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=77), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 119, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-569][TI-1408] - [WARN] 2024-04-24 10:44:52.552 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1408
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.553 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1408, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.553 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1408, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:51 GMT+08:00 2024, endTime=Wed Apr 24 10:44:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1408.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:52.553 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1408, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.661 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.662 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.662 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.680 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.683 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:569, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1408] - [INFO] 2024-04-24 10:44:52.685 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1409, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:569, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.691 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.693 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:52.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-102-20240424104449810
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:44:51 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:44:51 GMT+08:00 2024
Start Time:             Wed Apr 24 10:44:51 GMT+08:00 2024
End Time:               Wed Apr 24 10:44:51 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:44:52.696 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:52.703 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1409, processInstanceId=569, startTime=1713926692700, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.525 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.593 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1409, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.594 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.594 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.604 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:53.605 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.706 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1409, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.707 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.781 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=Wed Apr 24 10:44:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, processId=591, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.537 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=Wed Apr 24 10:44:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, processId=591, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.575 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1409, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1409, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:44:52 GMT+08:00 2024, endTime=Wed Apr 24 10:44:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log, processId=591, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.576 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1409, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.633 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.634 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.634 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.645 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.646 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:569, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:54.648 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1410, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:569, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.654 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.654 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.654 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.654 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.654 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.655 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-569][TI-0] - [INFO] 2024-04-24 10:44:54.655 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-102-20240424104449810
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:44:52 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:44:52 GMT+08:00 2024
Start Time:             Wed Apr 24 10:44:52 GMT+08:00 2024
End Time:               Wed Apr 24 10:44:53 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.671 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.676 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1410, processInstanceId=569, startTime=1713926694673, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.692 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.853 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7196531791907514 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.870 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7196531791907514 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:54.870 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.565 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.605 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.606 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.657 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1410, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.658 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.659 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1410, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.668 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:55.717 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:55.717 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:55.864 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774193548387096 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:55.870 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774193548387096 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:44:55.871 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.738 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=Wed Apr 24 10:44:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, processId=603, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=Wed Apr 24 10:44:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, processId=603, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.586 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=569, taskInstanceId=1410, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.586 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1410, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:44:54 GMT+08:00 2024, endTime=Wed Apr 24 10:44:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log, processId=603, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=569)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:58.586 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-569] persist events succeeded
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=569, taskInstanceId=1410, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.672 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.672 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.673 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.673 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.680 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:58.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-102-20240424104449810
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:44:54 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:44:54 GMT+08:00 2024
Start Time:             Wed Apr 24 10:44:54 GMT+08:00 2024
End Time:               Wed Apr 24 10:44:57 GMT+08:00 2024

[WI-569][TI-null] - [INFO] 2024-04-24 10:44:58.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=569, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-569][TI-null] - [INFO] 2024-04-24 10:44:58.701 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-569][TI-null] - [INFO] 2024-04-24 10:44:58.703 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-102-20240424104449810
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:44:49 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:44:49 GMT+08:00 2024
End Time:                  Wed Apr 24 10:44:58 GMT+08:00 2024

[WI-569][TI-0] - [INFO] 2024-04-24 10:44:58.704 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:59.713 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:04.738 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:09.762 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:14.795 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:19.818 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:24.869 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:29.895 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:32.042 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7357357357357357 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:32.069 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7357357357357357 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:45:32.072 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:34.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:40.011 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:45.035 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:50.101 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:50.117 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7431192660550459 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:50.133 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7431192660550459 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:45:50.133 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:55.143 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7393767705382437 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:55.149 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7393767705382437 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:45:55.149 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:55.159 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.180 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 16ms, current slot: 0, total slot size: 1
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.198 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=570)
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.201 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.206 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=570)
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.215 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=570)
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.218 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.231 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.231 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.241 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:570, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.256 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1411, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:570, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.266 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.267 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.267 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:57.267 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.267 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.270 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.291 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1411, processInstanceId=570, startTime=1713926757275, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.740 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.746 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.755 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1411, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.755 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.756 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.764 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.765 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.828 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1411, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.829 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.351 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, processId=658, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.746 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, processId=658, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.758 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1411, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1411, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:57 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log, processId=658, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:58.759 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.847 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1411, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.848 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.848 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.848 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.848 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.857 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.858 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.858 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.861 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:570, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.865 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1412, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:570, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.869 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.869 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:58.870 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-103-20240424104557183
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:45:57 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:45:57 GMT+08:00 2024
Start Time:             Wed Apr 24 10:45:57 GMT+08:00 2024
End Time:               Wed Apr 24 10:45:58 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:45:58.871 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1412, taskName=check file existence, firstSubmitTime=1713926758861, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=103, appIds=null, processInstanceId=570, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1412'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104558'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='570'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.873 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.873 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.891 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:58.893 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.894 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.894 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.895 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713926758895
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.895 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 570_1412
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.895 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1412,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713926758861,
  "startTime" : 1713926758895,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 103,
  "processInstanceId" : 570,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1412"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104558"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "570"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "570_1412",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.896 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.896 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:58.898 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1412, processInstanceId=570, startTime=1713926758895, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.900 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.901 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.902 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.902 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.903 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.903 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.903 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.904 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.904 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.904 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.904 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.905 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.905 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.905 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.905 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.905 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.907 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:58 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.915 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.915 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:58.916 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.749 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.763 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.763 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:45:59.770 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=93), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 120, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-570][TI-1412] - [ERROR] 2024-04-24 10:45:59.773 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.774 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:58 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:45:59.782 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=94), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 120, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-570][TI-1412] - [WARN] 2024-04-24 10:45:59.787 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1412
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.794 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1412, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.795 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1412, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:58 GMT+08:00 2024, endTime=Wed Apr 24 10:45:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1412.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:59.795 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1412, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.866 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.867 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.867 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.867 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.876 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.882 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.882 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.884 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:570, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1412] - [INFO] 2024-04-24 10:45:59.886 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1413, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:570, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.892 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.893 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.893 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.893 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.894 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.894 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:45:59.894 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-103-20240424104557183
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:45:58 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:45:58 GMT+08:00 2024
Start Time:             Wed Apr 24 10:45:58 GMT+08:00 2024
End Time:               Wed Apr 24 10:45:58 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:45:59.925 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:59.933 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1413, processInstanceId=570, startTime=1713926759922, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:00.182 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.751 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.768 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1413, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.769 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.769 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.793 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:00.793 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.795 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1413, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.795 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.956 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=Wed Apr 24 10:46:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, processId=672, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.753 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=Wed Apr 24 10:46:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, processId=672, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.765 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1413, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.765 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1413, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:45:59 GMT+08:00 2024, endTime=Wed Apr 24 10:46:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log, processId=672, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:01.765 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1413, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.821 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.821 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.821 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.832 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.836 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.836 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:570, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:01.839 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1414, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:570, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.846 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.847 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.851 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-570][TI-0] - [INFO] 2024-04-24 10:46:01.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-103-20240424104557183
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:45:59 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:45:59 GMT+08:00 2024
Start Time:             Wed Apr 24 10:45:59 GMT+08:00 2024
End Time:               Wed Apr 24 10:46:00 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:46:01.863 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:01.875 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1414, processInstanceId=570, startTime=1713926761869, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.757 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.763 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.763 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.771 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1414, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.771 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.780 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:02.781 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.838 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1414, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:02.838 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.916 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=Wed Apr 24 10:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, processId=684, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=Wed Apr 24 10:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, processId=684, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.767 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=570, taskInstanceId=1414, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.767 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1414, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:46:01 GMT+08:00 2024, endTime=Wed Apr 24 10:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log, processId=684, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=570)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:04.768 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-570] persist events succeeded
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.794 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=570, taskInstanceId=1414, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.795 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.795 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.795 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.795 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:04.805 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-103-20240424104557183
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:46:01 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:46:01 GMT+08:00 2024
Start Time:             Wed Apr 24 10:46:01 GMT+08:00 2024
End Time:               Wed Apr 24 10:46:03 GMT+08:00 2024

[WI-570][TI-null] - [INFO] 2024-04-24 10:46:04.806 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=570, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-570][TI-null] - [INFO] 2024-04-24 10:46:04.806 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-570][TI-null] - [INFO] 2024-04-24 10:46:04.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-103-20240424104557183
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:45:57 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:45:57 GMT+08:00 2024
End Time:                  Wed Apr 24 10:46:04 GMT+08:00 2024

[WI-570][TI-0] - [INFO] 2024-04-24 10:46:04.809 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:05.218 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:10.246 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:13.361 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:46:13.361 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:15.287 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:20.306 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:25.330 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:30.346 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:35.384 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:40.409 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:45.427 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:50.442 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:55.460 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:00.480 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:05.501 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:10.517 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:15.536 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:20.553 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:25.575 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.608 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.633 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 35/ms
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.643 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.643 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=571)
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.644 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=571)
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.647 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=571)
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.670 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.671 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.690 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.690 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.693 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:571, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.698 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1415, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:571, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.704 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:30.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.705 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.712 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.725 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1415, processInstanceId=571, startTime=1713926850720, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.471 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.484 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.484 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.493 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1415, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.509 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:31.510 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.536 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1415, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.537 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.784 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=Wed Apr 24 10:47:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, processId=746, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.471 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=Wed Apr 24 10:47:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, processId=746, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.479 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1415, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.479 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1415, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:30 GMT+08:00 2024, endTime=Wed Apr 24 10:47:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log, processId=746, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.480 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.553 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1415, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.554 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.554 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.554 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.580 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.580 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.581 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.583 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:571, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:32.586 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1416, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:571, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:32.594 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-104-20240424104730624
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:47:30 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:47:30 GMT+08:00 2024
Start Time:             Wed Apr 24 10:47:30 GMT+08:00 2024
End Time:               Wed Apr 24 10:47:31 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.610 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1416, taskName=check file existence, firstSubmitTime=1713926852584, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=104, appIds=null, processInstanceId=571, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1416'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104732'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='571'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.617 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.618 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.625 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.625 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.625 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.625 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713926852625
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.626 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 571_1416
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.626 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1416,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713926852584,
  "startTime" : 1713926852625,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 104,
  "processInstanceId" : 571,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1416"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104732"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "571"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "571_1416",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.628 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1416, processInstanceId=571, startTime=1713926852625, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.632 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.632 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.633 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.633 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.633 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.633 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.634 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.634 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.634 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.634 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.634 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.635 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.635 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.636 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.637 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.637 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.638 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:32 GMT+08:00 2024, endTime=Wed Apr 24 10:47:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.646 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.647 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:32.647 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.653 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7471264367816092 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:47:32.654 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.684 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7471264367816092 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.473 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:47:33.480 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=110), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-571][TI-1416] - [ERROR] 2024-04-24 10:47:33.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.496 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.496 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:32 GMT+08:00 2024, endTime=Wed Apr 24 10:47:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:47:33.504 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=111), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-571][TI-1416] - [WARN] 2024-04-24 10:47:33.507 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1416
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.507 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1416, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.507 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1416, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:32 GMT+08:00 2024, endTime=Wed Apr 24 10:47:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1416.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:33.507 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.567 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1416, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.567 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.567 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.567 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.567 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.598 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.599 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.601 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:571, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1416] - [INFO] 2024-04-24 10:47:33.603 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1417, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:571, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.614 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.614 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:33.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-104-20240424104730624
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:47:32 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:47:32 GMT+08:00 2024
Start Time:             Wed Apr 24 10:47:32 GMT+08:00 2024
End Time:               Wed Apr 24 10:47:32 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:47:33.654 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1417, processInstanceId=571, startTime=1713926853620, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.482 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.486 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.486 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.493 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1417, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.510 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:34.510 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.658 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1417, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.659 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.737 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=Wed Apr 24 10:47:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, processId=760, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=Wed Apr 24 10:47:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, processId=760, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.493 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1417, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.493 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1417, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:47:33 GMT+08:00 2024, endTime=Wed Apr 24 10:47:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log, processId=760, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:35.493 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.577 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1417, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.578 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.578 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.578 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.578 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.587 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.588 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:571, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:35.590 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1418, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:571, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.596 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-571][TI-0] - [INFO] 2024-04-24 10:47:35.597 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-104-20240424104730624
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:47:33 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:47:33 GMT+08:00 2024
Start Time:             Wed Apr 24 10:47:33 GMT+08:00 2024
End Time:               Wed Apr 24 10:47:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:35.618 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1418, processInstanceId=571, startTime=1713926855602, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:35.682 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.502 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.507 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.507 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.516 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1418, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:36.523 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.618 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1418, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:36.618 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:40.703 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.677 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=Wed Apr 24 10:47:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, processId=772, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.525 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=Wed Apr 24 10:47:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, processId=772, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.543 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=571, taskInstanceId=1418, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.543 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1418, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:47:35 GMT+08:00 2024, endTime=Wed Apr 24 10:47:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log, processId=772, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=571)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:42.543 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-571] persist events succeeded
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.600 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=571, taskInstanceId=1418, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.600 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.600 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.601 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.601 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.629 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.629 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.629 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:42.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-104-20240424104730624
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:47:35 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:47:35 GMT+08:00 2024
Start Time:             Wed Apr 24 10:47:35 GMT+08:00 2024
End Time:               Wed Apr 24 10:47:41 GMT+08:00 2024

[WI-571][TI-null] - [INFO] 2024-04-24 10:47:42.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=571, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-571][TI-null] - [INFO] 2024-04-24 10:47:42.635 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-571][TI-null] - [INFO] 2024-04-24 10:47:42.637 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-104-20240424104730624
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:47:30 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:47:30 GMT+08:00 2024
End Time:                  Wed Apr 24 10:47:42 GMT+08:00 2024

[WI-571][TI-0] - [INFO] 2024-04-24 10:47:42.638 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:45.753 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:50.774 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:55.808 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:00.824 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:05.842 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:10.859 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:15.881 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:20.906 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:25.936 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:30.960 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:35.995 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:41.026 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:46.054 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:51.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:48:56.092 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:01.153 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 22/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:06.187 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:11.217 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:16.254 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:21.270 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:26.284 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:31.299 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:36.334 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:41.353 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:46.378 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:51.406 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:56.425 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:58.692 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7192982456140351 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:58.709 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7192982456140351 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:49:58.713 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:01.521 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 58/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:06.542 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:11.555 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:16.572 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:21.620 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:26.638 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:31.652 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:36.677 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:41.691 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:44.570 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.9:5678 begin to failover hosts:[172.18.0.9:5678]
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.9:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:44.685 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.9:5678] failover finished, useTime:10ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:46.726 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:51.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 15/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:56.826 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:50:59.957 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:50:59.958 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:01.848 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:04.990 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:51:04.992 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:05.989 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:05.994 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9024390243902439 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:51:05.994 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:06.905 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.007 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.037 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=572)
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.037 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.037 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=572)
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.038 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=572)
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.039 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.040 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.040 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.047 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.047 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.049 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:572, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.051 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1419, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:572, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.054 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:09.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.055 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.082 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.111 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1419, processInstanceId=572, startTime=1713927069106, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.815 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.838 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.840 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.874 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1419, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.874 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.874 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.882 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.883 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.924 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1419, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.929 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.201 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, processId=861, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.819 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, processId=861, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.826 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1419, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.826 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1419, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:09 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log, processId=861, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:10.827 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1419, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.846 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.846 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.846 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.846 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.861 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.863 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:572, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.867 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1420, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:572, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.872 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.872 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.873 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.873 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.874 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.874 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:10.881 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1420, taskName=check file existence, firstSubmitTime=1713927070866, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=105, appIds=null, processInstanceId=572, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1420'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105110'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='572'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.881 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.881 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:10.881 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-105-20240424105109008
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:51:09 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:51:09 GMT+08:00 2024
Start Time:             Wed Apr 24 10:51:09 GMT+08:00 2024
End Time:               Wed Apr 24 10:51:10 GMT+08:00 2024

[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.909 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.910 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.911 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.911 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927070911
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.912 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 572_1420
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.912 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1420,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927070866,
  "startTime" : 1713927070911,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 105,
  "processInstanceId" : 572,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1420"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105110"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "572"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "572_1420",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:10.916 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:10.918 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1420, processInstanceId=572, startTime=1713927070911, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.919 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.920 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.930 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:10 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.937 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.937 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:10.937 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.819 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.825 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.826 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:10 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:51:11.848 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=127), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-572][TI-1420] - [ERROR] 2024-04-24 10:51:11.851 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:10 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.852 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:10 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:51:11.857 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=128), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-572][TI-1420] - [WARN] 2024-04-24 10:51:11.858 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1420
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.859 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1420, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.859 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1420, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:10 GMT+08:00 2024, endTime=Wed Apr 24 10:51:10 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1420.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:11.859 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:11.928 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.958 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1420, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.958 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.958 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.958 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.958 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.975 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.976 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.976 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.978 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:572, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1420] - [INFO] 2024-04-24 10:51:11.980 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1421, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:572, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.984 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.985 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.985 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.986 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:11.993 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-105-20240424105109008
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:51:10 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:51:10 GMT+08:00 2024
Start Time:             Wed Apr 24 10:51:10 GMT+08:00 2024
End Time:               Wed Apr 24 10:51:10 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:51:11.993 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1421, processInstanceId=572, startTime=1713927071991, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:11.994 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.822 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.832 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1421, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.832 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.832 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [WARN] 2024-04-24 10:51:12.832 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.833 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.833 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:12.842 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.868 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1421, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.868 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.027 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=Wed Apr 24 10:51:13 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, processId=875, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.822 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=Wed Apr 24 10:51:13 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, processId=875, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.844 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1421, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.846 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1421, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:51:11 GMT+08:00 2024, endTime=Wed Apr 24 10:51:13 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log, processId=875, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:13.846 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.899 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1421, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.899 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.900 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.900 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.900 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.908 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.909 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.910 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.928 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.937 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.938 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:572, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.943 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1422, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:572, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.974 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.974 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.975 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.975 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.976 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.976 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-572][TI-0] - [INFO] 2024-04-24 10:51:13.976 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-105-20240424105109008
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:51:11 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:51:11 GMT+08:00 2024
Start Time:             Wed Apr 24 10:51:11 GMT+08:00 2024
End Time:               Wed Apr 24 10:51:13 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:51:13.979 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:14.003 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1422, processInstanceId=572, startTime=1713927073979, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.823 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.828 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.828 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.839 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1422, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.839 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.839 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.849 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:14.849 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.938 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1422, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.938 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:15.030 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8571428571428571 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:15.072 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8571428571428571 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:51:15.073 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:16.077 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.024822695035461 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:16.966 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:17.087 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:51:17.090 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.103 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=Wed Apr 24 10:51:17 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, processId=887, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.828 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=Wed Apr 24 10:51:17 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, processId=887, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.841 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=572, taskInstanceId=1422, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1422, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:51:13 GMT+08:00 2024, endTime=Wed Apr 24 10:51:17 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log, processId=887, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=572)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:17.842 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-572] persist events succeeded
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=572, taskInstanceId=1422, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.921 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.921 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.921 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.922 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.933 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.934 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.934 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.934 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.934 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-105-20240424105109008
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:51:13 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:51:13 GMT+08:00 2024
Start Time:             Wed Apr 24 10:51:13 GMT+08:00 2024
End Time:               Wed Apr 24 10:51:17 GMT+08:00 2024

[WI-572][TI-null] - [INFO] 2024-04-24 10:51:17.941 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=572, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-572][TI-null] - [INFO] 2024-04-24 10:51:17.942 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-572][TI-null] - [INFO] 2024-04-24 10:51:17.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-105-20240424105109008
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:51:09 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:51:09 GMT+08:00 2024
End Time:                  Wed Apr 24 10:51:17 GMT+08:00 2024

[WI-572][TI-0] - [INFO] 2024-04-24 10:51:17.946 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:21.998 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:27.017 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:32.046 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:33.157 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492795389048991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:51:33.158 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:33.167 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492795389048991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:37.095 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:42.109 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:47.128 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:52.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:57.245 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:02.273 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:07.302 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:09.309 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:12.315 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:13.322 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.736842105263158 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:52:13.323 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:13.352 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.736842105263158 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:17.336 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:22.368 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.378 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 3ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.385 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.399 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=573)
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.399 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.399 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=573)
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.401 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=573)
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.401 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.401 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.402 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.404 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.405 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.406 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:573, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.408 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1423, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:573, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.421 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:27.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.422 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.428 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.433 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1423, processInstanceId=573, startTime=1713927147430, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.947 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.954 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.955 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.985 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1423, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.985 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.986 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.993 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.993 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.075 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1423, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.076 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.480 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=Wed Apr 24 10:52:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, processId=946, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.954 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=Wed Apr 24 10:52:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, processId=946, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.968 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1423, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.969 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1423, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:27 GMT+08:00 2024, endTime=Wed Apr 24 10:52:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log, processId=946, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:28.969 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.989 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1423, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.989 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.989 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.990 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.990 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.999 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.999 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:29.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:29.001 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:573, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:29.002 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1424, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:573, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.016 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:29.022 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1424, taskName=check file existence, firstSubmitTime=1713927149001, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=106, appIds=null, processInstanceId=573, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1424'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105229'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='573'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.023 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:29.022 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-106-20240424105227382
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:52:27 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:52:27 GMT+08:00 2024
Start Time:             Wed Apr 24 10:52:27 GMT+08:00 2024
End Time:               Wed Apr 24 10:52:28 GMT+08:00 2024

[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.023 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.028 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:29.028 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.030 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.030 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927149030
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.031 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 573_1424
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.032 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1424,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927149001,
  "startTime" : 1713927149030,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 106,
  "processInstanceId" : 573,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1424"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105229"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "573"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "573_1424",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.032 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.033 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.033 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:29.035 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1424, processInstanceId=573, startTime=1713927149030, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.036 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.037 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.037 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.038 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.043 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.047 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.047 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.047 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.048 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.048 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.049 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.051 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:29 GMT+08:00 2024, endTime=Wed Apr 24 10:52:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.053 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.054 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.955 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.971 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.972 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:52:29.981 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=144), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-573][TI-1424] - [ERROR] 2024-04-24 10:52:29.983 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.983 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:29 GMT+08:00 2024, endTime=Wed Apr 24 10:52:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:52:29.987 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=145), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-573][TI-1424] - [WARN] 2024-04-24 10:52:29.992 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1424
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.992 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1424, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:29.992 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1424, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:29 GMT+08:00 2024, endTime=Wed Apr 24 10:52:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1424.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:29.993 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.003 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1424, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.004 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.005 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.005 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.020 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.021 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.021 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.022 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:573, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1424] - [INFO] 2024-04-24 10:52:30.025 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1425, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:573, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.033 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.035 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:30.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-106-20240424105227382
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:52:29 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:52:29 GMT+08:00 2024
Start Time:             Wed Apr 24 10:52:29 GMT+08:00 2024
End Time:               Wed Apr 24 10:52:29 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:52:30.045 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1425, processInstanceId=573, startTime=1713927150042, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:30.045 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.957 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.966 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1425, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.981 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.981 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [WARN] 2024-04-24 10:52:30.983 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.983 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.983 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.994 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:30.995 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.013 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1425, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.014 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.083 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=Wed Apr 24 10:52:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, processId=960, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.972 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=Wed Apr 24 10:52:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, processId=960, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.981 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1425, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.981 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1425, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:52:30 GMT+08:00 2024, endTime=Wed Apr 24 10:52:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log, processId=960, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:31.982 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.037 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1425, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.037 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.038 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.038 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.046 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.046 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.049 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.050 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.051 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:573, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:32.052 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1426, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:573, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.057 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.058 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:32.062 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-573][TI-0] - [INFO] 2024-04-24 10:52:32.062 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-106-20240424105227382
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:52:30 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:52:30 GMT+08:00 2024
Start Time:             Wed Apr 24 10:52:30 GMT+08:00 2024
End Time:               Wed Apr 24 10:52:31 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:52:32.066 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1426, processInstanceId=573, startTime=1713927152064, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:32.414 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.973 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.977 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.977 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.984 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1426, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.985 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.985 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:33.000 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:33.000 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:33.050 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1426, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:33.050 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:34.430 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7032640949554896 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:52:34.432 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:34.454 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7032640949554896 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:37.462 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.109 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=Wed Apr 24 10:52:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, processId=972, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.988 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=Wed Apr 24 10:52:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, processId=972, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.999 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=573, taskInstanceId=1426, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.000 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1426, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:52:32 GMT+08:00 2024, endTime=Wed Apr 24 10:52:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log, processId=972, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=573)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:39.000 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-573] persist events succeeded
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=573, taskInstanceId=1426, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.005 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.005 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.005 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.007 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.008 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.008 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.008 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.008 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:39.014 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-106-20240424105227382
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:52:32 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:52:32 GMT+08:00 2024
Start Time:             Wed Apr 24 10:52:32 GMT+08:00 2024
End Time:               Wed Apr 24 10:52:38 GMT+08:00 2024

[WI-573][TI-null] - [INFO] 2024-04-24 10:52:39.014 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=573, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-573][TI-null] - [INFO] 2024-04-24 10:52:39.014 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-573][TI-null] - [INFO] 2024-04-24 10:52:39.017 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-106-20240424105227382
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:52:27 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:52:27 GMT+08:00 2024
End Time:                  Wed Apr 24 10:52:39 GMT+08:00 2024

[WI-573][TI-0] - [INFO] 2024-04-24 10:52:39.017 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:42.476 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:47.491 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:52.513 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:57.531 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:02.549 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:07.566 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:12.583 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:17.602 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:22.621 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:27.648 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:31.680 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:32.693 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:37.707 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:42.722 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:47.754 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:52.780 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:53:57.811 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:02.828 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:07.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:12.858 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:17.873 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:22.896 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:27.918 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:32.966 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:37.984 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:43.015 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:48.037 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:53.053 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:54:58.078 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:03.095 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:08.115 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:13.135 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:18.182 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 15/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:23.226 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:24.075 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8783783783783783 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:24.075 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:24.296 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8783783783783783 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:27.109 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7478260869565218 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:27.115 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:27.371 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7478260869565218 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:28.296 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:33.327 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:38.383 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:43.157 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7507598784194529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:43.158 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:43.397 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:43.447 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7507598784194529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:43.470 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713927343021, cpuUsage=0.7034883720930233, jvmMemoryUsage=0.03453874588012695, memoryUsage=0.5307858442102785, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:43.480 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:44.159 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:45.161 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:46.163 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:47.165 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:48.166 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:48.409 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:49.169 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:50.171 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:51.173 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:52.185 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:55:53.187 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:53.423 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:53.500 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.201 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 9ms, current slot: 0, total slot size: 1
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.232 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=574)
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.232 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.232 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=574)
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.233 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=574)
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.233 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.233 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.234 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.245 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.255 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.269 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:574, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.276 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1427, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:574, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.285 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.285 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.285 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:54.285 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.286 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.296 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.309 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1427, processInstanceId=574, startTime=1713927354304, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.732 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.746 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.747 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.757 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1427, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.758 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.768 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.769 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.835 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1427, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.840 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.346 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, processId=1059, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.733 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, processId=1059, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.739 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1427, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.740 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1427, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:54 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log, processId=1059, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.740 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.750 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1427, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.750 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.751 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.751 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.751 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.760 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:574, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.769 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1428, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:574, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.773 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.773 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:55.775 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-107-20240424105554209
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:54 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:54 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:54 GMT+08:00 2024
End Time:               Wed Apr 24 10:55:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.778 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1428, taskName=check file existence, firstSubmitTime=1713927355761, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=574, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1428'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105555'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='574'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.788 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.788 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.809 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.809 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927355809
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.810 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 574_1428
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1428,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927355761,
  "startTime" : 1713927355809,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 574,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1428"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105555"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "574"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "574_1428",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.813 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1428, processInstanceId=574, startTime=1713927355809, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.819 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.820 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.821 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.822 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.822 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.831 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:55 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.834 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.835 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:55.835 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.735 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.740 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.740 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:55:56.745 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=161), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-574][TI-1428] - [ERROR] 2024-04-24 10:55:56.747 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.747 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:55 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:55:56.750 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=162), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-574][TI-1428] - [WARN] 2024-04-24 10:55:56.753 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1428
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.754 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1428, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.754 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1428, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:55 GMT+08:00 2024, endTime=Wed Apr 24 10:55:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1428.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:56.754 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1428, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.759 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.761 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.761 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.771 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:574, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1428] - [INFO] 2024-04-24 10:55:56.772 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1429, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:574, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.782 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:56.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-107-20240424105554209
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:55 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:55 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:55 GMT+08:00 2024
End Time:               Wed Apr 24 10:55:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:55:56.805 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:56.814 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1429, processInstanceId=574, startTime=1713927356807, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.736 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.742 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.742 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.753 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1429, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.754 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.754 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.762 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:57.762 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1429, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.797 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.852 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=Wed Apr 24 10:55:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, processId=1073, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.254 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 11ms, current slot: 0, total slot size: 1
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.270 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=575)
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.270 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.270 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=575)
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.277 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=575)
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.279 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.280 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.280 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.287 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.290 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:575, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.300 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1430, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:575, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.306 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.306 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.306 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:58.306 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.306 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.314 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.318 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1430, processInstanceId=575, startTime=1713927358314, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.438 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.737 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=Wed Apr 24 10:55:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, processId=1073, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.751 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.760 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1429, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.760 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1429, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:56 GMT+08:00 2024, endTime=Wed Apr 24 10:55:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log, processId=1073, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.760 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.767 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.767 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.778 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1430, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.781 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.781 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.788 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.789 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.812 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1429, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.813 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.813 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1430, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.817 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.817 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.819 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.829 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.830 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.830 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.831 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.832 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.833 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:574, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:58.835 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1431, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:574, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.838 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-574][TI-0] - [INFO] 2024-04-24 10:55:58.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-107-20240424105554209
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:56 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:56 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:56 GMT+08:00 2024
End Time:               Wed Apr 24 10:55:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.846 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.848 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1431, processInstanceId=574, startTime=1713927358845, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.344 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, processId=1085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.756 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.776 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, processId=1085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.790 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.790 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1431, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.829 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1430, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.831 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1430, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log, processId=1085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.831 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.831 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.831 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.843 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1430, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.844 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.843 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1431, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.844 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:59.844 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.844 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.844 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.887 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.889 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:575, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.898 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1432, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:575, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.908 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.909 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1432, taskName=check file existence, firstSubmitTime=1713927359897, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=575, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1432'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105559'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='575'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.913 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.915 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.917 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.917 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.917 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927359917
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 575_1432
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1432,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927359897,
  "startTime" : 1713927359917,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 575,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1432"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105559"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "575"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "575_1432",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.918 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.919 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-575][TI-0] - [INFO] 2024-04-24 10:55:59.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-107-20240424105558256
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:58 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:58 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:58 GMT+08:00 2024
End Time:               Wed Apr 24 10:55:59 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.921 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1432, processInstanceId=575, startTime=1713927359917, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.923 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.923 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.924 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.925 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.926 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:59 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.927 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.927 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-575][TI-1432] - [INFO] 2024-04-24 10:55:59.927 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.281 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7680608365019012 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:56:00.281 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.545 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7680608365019012 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.776 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.784 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.784 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:56:00.791 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=177), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 122, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-575][TI-1432] - [ERROR] 2024-04-24 10:56:00.792 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:55:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.793 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:59 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:56:00.799 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=178), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 122, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-575][TI-1432] - [WARN] 2024-04-24 10:56:00.808 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1432
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.808 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1432, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.808 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1432, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:55:59 GMT+08:00 2024, endTime=Wed Apr 24 10:55:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1432.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.808 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.898 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1432, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.898 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.899 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.899 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.899 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.904 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.905 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.905 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.906 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:575, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1432] - [INFO] 2024-04-24 10:56:00.913 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1433, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:575, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.919 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.919 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:00.920 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-107-20240424105558256
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:59 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:59 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:59 GMT+08:00 2024
End Time:               Wed Apr 24 10:55:59 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.929 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.943 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1433, processInstanceId=575, startTime=1713927360939, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.777 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.788 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.788 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.795 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1433, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.795 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.795 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.800 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:01.801 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.805 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1433, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.806 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.992 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=Wed Apr 24 10:56:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, processId=1140, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.779 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=Wed Apr 24 10:56:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, processId=1140, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.787 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1433, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.787 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1433, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:56:00 GMT+08:00 2024, endTime=Wed Apr 24 10:56:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log, processId=1140, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:02.788 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1433, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.825 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.825 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.825 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.825 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.832 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.836 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.839 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.841 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:575, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:02.843 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1434, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:575, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.847 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:02.852 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.850 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-575][TI-0] - [INFO] 2024-04-24 10:56:02.853 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-107-20240424105558256
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:56:00 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:56:00 GMT+08:00 2024
Start Time:             Wed Apr 24 10:56:00 GMT+08:00 2024
End Time:               Wed Apr 24 10:56:01 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:56:02.860 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1434, processInstanceId=575, startTime=1713927362855, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:03.468 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.783 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.786 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.787 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.797 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1434, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.797 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.797 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.803 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:03.804 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.857 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1434, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:03.857 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:04.305 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8818181818181817 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:56:04.305 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:04.587 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8818181818181817 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:05.308 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8892857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:56:05.308 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:05.632 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8892857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:08.478 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:13.510 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:18.534 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:23.550 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:28.606 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 24/ms
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:56:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, processId=1098, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.822 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:56:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, processId=1098, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.834 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=574, taskInstanceId=1431, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.834 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1431, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:55:58 GMT+08:00 2024, endTime=Wed Apr 24 10:56:31 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log, processId=1098, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=574)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:31.834 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-574] persist events succeeded
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.905 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=574, taskInstanceId=1431, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.905 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.905 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.906 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.906 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.912 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.913 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.913 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.913 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.913 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.921 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-107-20240424105554209
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:55:58 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:55:58 GMT+08:00 2024
Start Time:             Wed Apr 24 10:55:58 GMT+08:00 2024
End Time:               Wed Apr 24 10:56:31 GMT+08:00 2024

[WI-574][TI-null] - [INFO] 2024-04-24 10:56:31.923 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=574, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-574][TI-null] - [INFO] 2024-04-24 10:56:31.923 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-574][TI-null] - [INFO] 2024-04-24 10:56:31.925 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-107-20240424105554209
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:55:54 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:55:54 GMT+08:00 2024
End Time:                  Wed Apr 24 10:56:31 GMT+08:00 2024

[WI-574][TI-0] - [INFO] 2024-04-24 10:56:31.926 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:33.641 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=Wed Apr 24 10:56:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, processId=1155, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:38.661 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.828 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=Wed Apr 24 10:56:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, processId=1155, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.839 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=575, taskInstanceId=1434, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.840 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1434, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:56:02 GMT+08:00 2024, endTime=Wed Apr 24 10:56:38 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log, processId=1155, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=575)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:38.840 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-575] persist events succeeded
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=575, taskInstanceId=1434, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.842 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.842 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.842 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.864 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-107-20240424105558256
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:56:02 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:56:02 GMT+08:00 2024
Start Time:             Wed Apr 24 10:56:02 GMT+08:00 2024
End Time:               Wed Apr 24 10:56:38 GMT+08:00 2024

[WI-575][TI-null] - [INFO] 2024-04-24 10:56:38.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=575, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-575][TI-null] - [INFO] 2024-04-24 10:56:38.865 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-575][TI-null] - [INFO] 2024-04-24 10:56:38.867 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-107-20240424105558256
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:55:58 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:55:58 GMT+08:00 2024
End Time:                  Wed Apr 24 10:56:38 GMT+08:00 2024

[WI-575][TI-0] - [INFO] 2024-04-24 10:56:38.867 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:43.713 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:48.746 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:53.765 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:58.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:03.823 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:08.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:13.863 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:18.906 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:23.924 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:28.940 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:33.984 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:39.004 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:44.023 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:49.042 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:54.060 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:59.080 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:04.119 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:09.136 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:14.152 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:18.859 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7627627627627627 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:58:18.859 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:19.054 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7627627627627627 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:19.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:24.249 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:29.300 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:29.896 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8401253918495298 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:58:29.896 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:30.106 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8401253918495298 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.906 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.919 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=576)
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.920 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.919 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=576)
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.921 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=576)
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.921 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.921 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.921 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.926 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.927 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.929 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:576, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.930 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1435, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:576, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.934 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.935 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.935 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:32.935 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.935 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.941 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.947 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1435, processInstanceId=576, startTime=1713927512944, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.078 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.083 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.083 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.096 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1435, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.096 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.096 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.098 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1435, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.099 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.102 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:33.102 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.963 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=Wed Apr 24 10:58:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, processId=1235, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.080 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=Wed Apr 24 10:58:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, processId=1235, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.094 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1435, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.094 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1435, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:32 GMT+08:00 2024, endTime=Wed Apr 24 10:58:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log, processId=1235, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:34.095 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.109 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1435, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.109 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.109 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.110 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.110 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.120 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.120 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.123 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:576, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:34.126 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1436, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:576, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.131 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.131 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.132 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.132 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:34.132 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1436, taskName=check file existence, firstSubmitTime=1713927514124, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=108, appIds=null, processInstanceId=576, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1436'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105834'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='576'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.132 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.133 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:34.133 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-108-20240424105832908
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:58:32 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:58:32 GMT+08:00 2024
Start Time:             Wed Apr 24 10:58:32 GMT+08:00 2024
End Time:               Wed Apr 24 10:58:33 GMT+08:00 2024

[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.133 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.133 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:34.155 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927514156
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 576_1436
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.157 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1436,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927514124,
  "startTime" : 1713927514156,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 108,
  "processInstanceId" : 576,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1436"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105834"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "576"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "576_1436",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:34.159 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1436, processInstanceId=576, startTime=1713927514156, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.166 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:34 GMT+08:00 2024, endTime=Wed Apr 24 10:58:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.167 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.167 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:34.168 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:34.333 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.081 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.085 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.085 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:58:35.092 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=195), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 122, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-576][TI-1436] - [ERROR] 2024-04-24 10:58:35.112 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.115 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:34 GMT+08:00 2024, endTime=Wed Apr 24 10:58:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:58:35.135 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=196), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 122, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-576][TI-1436] - [WARN] 2024-04-24 10:58:35.137 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1436
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.137 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1436, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.137 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1436, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:34 GMT+08:00 2024, endTime=Wed Apr 24 10:58:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1436.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:35.138 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.236 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1436, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.236 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.236 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.237 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.237 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.244 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.244 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.244 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.245 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:576, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1436] - [INFO] 2024-04-24 10:58:35.257 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1437, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:576, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.261 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:35.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-108-20240424105832908
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:58:34 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:58:34 GMT+08:00 2024
Start Time:             Wed Apr 24 10:58:34 GMT+08:00 2024
End Time:               Wed Apr 24 10:58:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:58:35.270 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:35.271 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1437, processInstanceId=576, startTime=1713927515267, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.083 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.091 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.091 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.108 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1437, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.109 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.110 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.116 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:36.119 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1437, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.152 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.326 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=Wed Apr 24 10:58:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, processId=1249, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.084 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=Wed Apr 24 10:58:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, processId=1249, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.093 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1437, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.093 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1437, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:58:35 GMT+08:00 2024, endTime=Wed Apr 24 10:58:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log, processId=1249, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:37.093 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.177 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1437, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.178 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.178 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.178 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.178 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.184 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.185 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.185 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.186 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.191 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.191 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:576, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:37.192 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1438, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:576, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.197 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-576][TI-0] - [INFO] 2024-04-24 10:58:37.199 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-108-20240424105832908
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:58:35 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:58:35 GMT+08:00 2024
Start Time:             Wed Apr 24 10:58:35 GMT+08:00 2024
End Time:               Wed Apr 24 10:58:36 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:58:37.248 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:37.257 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1438, processInstanceId=576, startTime=1713927517254, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.085 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.092 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.093 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.102 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1438, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.102 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.102 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.110 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:38.111 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.117 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1438, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:38.118 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.299 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=Wed Apr 24 10:58:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, processId=1261, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:39.365 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.098 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=Wed Apr 24 10:58:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, processId=1261, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.126 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=576, taskInstanceId=1438, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.126 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1438, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:58:37 GMT+08:00 2024, endTime=Wed Apr 24 10:58:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log, processId=1261, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=576)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:40.126 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-576] persist events succeeded
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.156 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=576, taskInstanceId=1438, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.157 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.157 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.157 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:40.164 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-108-20240424105832908
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:58:37 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:58:37 GMT+08:00 2024
Start Time:             Wed Apr 24 10:58:37 GMT+08:00 2024
End Time:               Wed Apr 24 10:58:39 GMT+08:00 2024

[WI-576][TI-null] - [INFO] 2024-04-24 10:58:40.165 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=576, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-576][TI-null] - [INFO] 2024-04-24 10:58:40.165 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-576][TI-null] - [INFO] 2024-04-24 10:58:40.167 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-108-20240424105832908
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:58:32 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:58:32 GMT+08:00 2024
End Time:                  Wed Apr 24 10:58:40 GMT+08:00 2024

[WI-576][TI-0] - [INFO] 2024-04-24 10:58:40.167 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:44.393 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:49.432 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:54.470 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:59.485 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:04.518 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:05.055 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774480712166172 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:05.055 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:05.233 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774480712166172 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:09.531 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:14.547 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:19.118 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7371428571428571 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:19.118 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:19.357 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7371428571428571 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:19.561 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:21.126 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492063492063492 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:21.129 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:21.382 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492063492063492 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:24.571 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.151 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.189 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=577)
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.190 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=577)
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.191 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.191 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=577)
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.193 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.193 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.193 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.207 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.208 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.212 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:577, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.223 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1439, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:577, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.237 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.237 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.238 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:25.238 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.238 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.258 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.262 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1439, processInstanceId=577, startTime=1713927565259, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.195 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.198 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.199 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.216 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1439, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.216 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.217 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.235 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:26.235 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.280 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1439, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.281 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.293 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=Wed Apr 24 10:59:26 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, processId=1317, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.196 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=Wed Apr 24 10:59:26 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, processId=1317, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.214 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1439, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.215 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1439, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:25 GMT+08:00 2024, endTime=Wed Apr 24 10:59:26 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log, processId=1317, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:27.215 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.296 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1439, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.296 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.296 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.297 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.297 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.304 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.306 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:577, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:27.307 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1440, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:577, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:27.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-109-20240424105925152
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:59:25 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:59:25 GMT+08:00 2024
Start Time:             Wed Apr 24 10:59:25 GMT+08:00 2024
End Time:               Wed Apr 24 10:59:26 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:59:27.312 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1440, taskName=check file existence, firstSubmitTime=1713927567306, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.9:5678, host=172.18.0.9:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=109, appIds=null, processInstanceId=577, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1440'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105927'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='577'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.313 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.313 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:27.319 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.9:5678.
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.338 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.338 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1713927567338
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.338 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 577_1440
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.338 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 1440,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1713927567306,
  "startTime" : 1713927567338,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.0.9:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 109,
  "processInstanceId" : 577,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != \\\"null\\\"\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1440"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105927"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "577"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "577_1440",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:27.340 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1440, processInstanceId=577, startTime=1713927567338, taskInstanceHost=172.18.0.9:5678, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.341 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.9:5678
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.341 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != \"null\"",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.345 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.346 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.347 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != "null" 
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.347 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/reddit/processing/500-20240423.json"
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.347 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/reddit/processing/500-20240423.json" != "null" successfully
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.348 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/reddit/processing/500-20240423.json" != "null" successfully: true
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.349 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.349 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.351 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:27 GMT+08:00 2024, endTime=Wed Apr 24 10:59:27 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.352 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.9:5678 successfully
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.352 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:27.352 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.198 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.217 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.218 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:59:28.221 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=212), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 48, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-577][TI-1440] - [ERROR] 2024-04-24 10:59:28.224 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:27 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.224 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:27 GMT+08:00 2024, endTime=Wed Apr 24 10:59:27 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [ERROR] 2024-04-24 10:59:28.229 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=213), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 84, 81, 48, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-577][TI-1440] - [WARN] 2024-04-24 10:59:28.230 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 1440
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.231 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1440, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.231 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1440, workerAddress=172.18.0.9:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:27 GMT+08:00 2024, endTime=Wed Apr 24 10:59:27 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1440.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:28.231 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.320 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1440, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.321 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.322 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.322 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.333 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13340390094208
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.334 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13340390094208, dependTaskCodes: [13348933988640, 13340113777664]
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.334 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.336 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:577, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1440] - [INFO] 2024-04-24 10:59:28.341 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1441, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:577, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.347 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.347 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.349 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.349 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.349 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:28.349 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-109-20240424105925152
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.9:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:59:27 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:59:27 GMT+08:00 2024
Start Time:             Wed Apr 24 10:59:27 GMT+08:00 2024
End Time:               Wed Apr 24 10:59:27 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:28.361 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1441, processInstanceId=577, startTime=1713927568358, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.215 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.237 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.241 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.258 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1441, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.282 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:29.287 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.338 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1441, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.339 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.414 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=Wed Apr 24 10:59:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, processId=1330, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:29.595 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.235 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=Wed Apr 24 10:59:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, processId=1330, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.244 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1441, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.244 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1441, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Wed Apr 24 10:59:28 GMT+08:00 2024, endTime=Wed Apr 24 10:59:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log, processId=1330, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:30.245 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.252 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1441, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.253 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.253 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.253 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:spark preprocessing, task id:null, task code:13210058002752
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13210058002752, dependTaskCodes: [13348933988640, 13340390094208, 13340113777664]
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task spark preprocessing is success, so ready to submit to execute
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.262 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.263 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.263 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : spark preprocessing, processInstance id:577, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:30.265 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:1442, taskInstanceName: spark preprocessing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:577, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.270 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.270 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.270 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.270 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340390094208 state:TaskExecutionStatus{code=7, desc='success'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.270 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.272 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-577][TI-0] - [INFO] 2024-04-24 10:59:30.273 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_post-109-20240424105925152
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:59:28 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:59:28 GMT+08:00 2024
Start Time:             Wed Apr 24 10:59:28 GMT+08:00 2024
End Time:               Wed Apr 24 10:59:29 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-04-24 10:59:30.274 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task spark preprocessing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:30.278 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=1442, processInstanceId=577, startTime=1713927570275, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.237 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.253 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.254 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.267 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1442, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.267 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.268 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.274 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=null, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:31.274 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1442, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:31.322 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:34.645 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:37.252 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:37.252 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:37.456 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:39.658 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:43.520 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7361111111111112 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:43.520 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:43.841 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7361111111111112 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:43.888 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1713925815974, reportTime=1713927583497, cpuUsage=0.7421203438395416, jvmMemoryUsage=0.034545516967773436, memoryUsage=0.5739104032933463, diskUsage=0.0, serverStatus=BUSY, processId=8, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=1)
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:43.895 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:44.524 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:44.690 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.513 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=Wed Apr 24 10:59:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, processId=1342, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:45.526 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.485 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=Wed Apr 24 10:59:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, processId=1342, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.497 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=577, taskInstanceId=1442, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.497 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=1442, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Wed Apr 24 10:59:30 GMT+08:00 2024, endTime=Wed Apr 24 10:59:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log, processId=1342, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], cacheTaskInstanceId=0, processInstanceId=577)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:46.497 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-577] persist events succeeded
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:46.530 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.581 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=577, taskInstanceId=1442, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.581 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.581 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.581 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.581 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13210058002752 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.583 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:46.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              spark preprocessing
Workflow Instance Name: preprocess_post-109-20240424105925152
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Wed Apr 24 10:59:30 GMT+08:00 2024
Submit Time:            Wed Apr 24 10:59:30 GMT+08:00 2024
Start Time:             Wed Apr 24 10:59:30 GMT+08:00 2024
End Time:               Wed Apr 24 10:59:45 GMT+08:00 2024

[WI-577][TI-null] - [INFO] 2024-04-24 10:59:46.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=577, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-577][TI-null] - [INFO] 2024-04-24 10:59:46.589 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-577][TI-null] - [INFO] 2024-04-24 10:59:46.591 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-109-20240424105925152
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.9:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Wed Apr 24 10:59:25 GMT+08:00 2024
Work Group:                default
Start Time:                Wed Apr 24 10:59:25 GMT+08:00 2024
End Time:                  Wed Apr 24 10:59:46 GMT+08:00 2024

[WI-577][TI-0] - [INFO] 2024-04-24 10:59:46.591 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:47.533 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:48.543 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:49.545 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:49.750 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:50.546 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:51.548 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:52.549 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-04-24 10:59:53.551 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:53.902 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:54.776 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:59.796 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
