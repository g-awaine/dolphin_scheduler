[WI-0][TI-0] - [INFO] 2024-05-06 04:00:47.160 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8209459459459459 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:48.099 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3818, taskName=consume filtered data, firstSubmitTime=1714939248090, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1021, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3818'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040048'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1021'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.101 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.110 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.110 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939248110
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1021_3818
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3818,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714939248090,
  "startTime" : 1714939248110,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1021/3818.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1021,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"is_message_empty\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n    --bootstrap-server kafka:9092 \\\\\\n    --topic gnews_filtered \\\\\\n    --max-messages 1 \\\\\\n    --from-beginning \\\\\\n    --group filtered_data_consumer)\\n\\n\\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \\nif [ -z \\\"${filtered_data_message}\\\" ]; then\\n    filtered_data_message=null\\n    is_message_empty=1\\nelse\\n    is_message_empty=0\\nfi\\n\\necho \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\\necho \\\"#{setValue(is_message_empty=${is_message_empty})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3818"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040048"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1021"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1021_3818",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.112 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.112 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.112 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.115 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.115 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1021/3818 check successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "is_message_empty",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"",
  "resourceList" : [ ]
}
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.118 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.118 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.118 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
    --bootstrap-server kafka:9092 \
    --topic gnews_filtered \
    --max-messages 1 \
    --from-beginning \
    --group filtered_data_consumer)


# check if the message is empty. If message is empty, then set is_message_empty to 1 
if [ -z "${filtered_data_message}" ]; then
    filtered_data_message=null
    is_message_empty=1
else
    is_message_empty=0
fi

echo "#{setValue(filtered_data_message=${filtered_data_message})}"
echo "#{setValue(is_message_empty=${is_message_empty})}"
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.119 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.119 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1021/3818/1021_3818.sh
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:48.132 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 7294
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:48.201 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7236024844720497 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3818] - [INFO] 2024-05-06 04:00:49.018 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3818, success=true)
[WI-0][TI-3818] - [INFO] 2024-05-06 04:00:49.052 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3818)
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:49.132 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:50.211 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7281430270925456 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:51.238 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7937127424826269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:55.259 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7976190476190477 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:56.149 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Processed a total of 1 messages
[WI-0][TI-0] - [INFO] 2024-05-06 04:00:57.150 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(filtered_data_message={
	  "authors": ["premiumplatinum"],
	  "content": "singapore is stupid",
	  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	  "type": "post",
	  "datetime": "2024-04-21 22:10:42"
	})}
	#{setValue(is_message_empty=0)}
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.152 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1021/3818, processId:7294 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1021/3818
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1021/3818
[WI-1021][TI-3818] - [INFO] 2024-05-06 04:00:57.158 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3818] - [INFO] 2024-05-06 04:00:58.021 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3818, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:01.297 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7750759878419453 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:19.476 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7012195121951219 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:21.554 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7883435582822086 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:23.610 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7999999999999999 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:24.642 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.76 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:33.685 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8145896656534953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:36.523 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3824, taskName=consume filtered data, firstSubmitTime=1714939296513, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1022, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3824'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040136'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1022'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.524 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939296526
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1022_3824
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3824,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714939296513,
  "startTime" : 1714939296526,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1022/3824.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1022,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"is_message_empty\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n    --bootstrap-server kafka:9092 \\\\\\n    --topic gnews_filtered \\\\\\n    --max-messages 1 \\\\\\n    --from-beginning \\\\\\n    --group filtered_data_consumer)\\n\\n\\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \\nif [ -z \\\"${filtered_data_message}\\\" ]; then\\n    filtered_data_message=null\\n    is_message_empty=1\\nelse\\n    is_message_empty=0\\nfi\\n\\necho \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\\necho \\\"#{setValue(is_message_empty=${is_message_empty})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3824"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040136"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1022"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1022_3824",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.534 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3824 check successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.536 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "is_message_empty",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"",
  "resourceList" : [ ]
}
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.537 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.537 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.537 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.538 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.539 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.539 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
    --bootstrap-server kafka:9092 \
    --topic gnews_filtered \
    --max-messages 1 \
    --from-beginning \
    --group filtered_data_consumer)


# check if the message is empty. If message is empty, then set is_message_empty to 1 
if [ -z "${filtered_data_message}" ]; then
    filtered_data_message=null
    is_message_empty=1
else
    is_message_empty=0
fi

echo "#{setValue(filtered_data_message=${filtered_data_message})}"
echo "#{setValue(is_message_empty=${is_message_empty})}"
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.539 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.540 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3824/1022_3824.sh
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:36.543 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 7711
[WI-0][TI-3824] - [INFO] 2024-05-06 04:01:37.266 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3824, success=true)
[WI-0][TI-3824] - [INFO] 2024-05-06 04:01:37.275 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3824)
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:37.546 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:38.828 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.901060070671378 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:39.845 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7642045454545454 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:40.845 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7787356321839081 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:49.865 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7203389830508474 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:54.918 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7142857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:58.598 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Processed a total of 1 messages
[WI-0][TI-0] - [INFO] 2024-05-06 04:01:59.606 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(filtered_data_message={
		"authors": [
			"premiumplatinum"
		],
		"content": "singapore is stupid",
		"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
		"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
		"type": "post",
		"datetime": "2024-04-21 22:10:42"
	})}
	#{setValue(is_message_empty=0)}
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.610 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3824, processId:7711 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.625 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.634 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3824
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.636 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3824
[WI-1022][TI-3824] - [INFO] 2024-05-06 04:01:59.636 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3824] - [INFO] 2024-05-06 04:02:00.361 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3824, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:01.485 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3826, taskName=parse the message, firstSubmitTime=1714939321474, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1022, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = ${filtered_data_message}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, is_message_empty=Property{prop='is_message_empty', direct=IN, type=VARCHAR, value='0'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3826'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value='{
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040201'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1022'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.486 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.487 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.489 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.489 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.489 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939321489
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.489 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1022_3826
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.489 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3826,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714939321474,
  "startTime" : 1714939321489,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1022/3826.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1022,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = ${filtered_data_message}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "is_message_empty" : {
      "prop" : "is_message_empty",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "0"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3826"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040201"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1022"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1022_3826",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"is_message_empty\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"0\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"premiumplatinum\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"singapore is stupid\\\",\\n\\t\\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n\\t\\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n\\t\\\"type\\\": \\\"post\\\",\\n\\t\\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.492 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.492 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.493 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.499 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.502 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826 check successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.502 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.504 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = ${filtered_data_message}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.504 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.505 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"}] successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.505 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = ${filtered_data_message}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.506 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.506 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826/py_1022_3826.py
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.506 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.507 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.508 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.509 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826/py_1022_3826.py
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.510 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.510 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826/1022_3826.sh
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:01.515 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 8121
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:01.982 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7888563049853372 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3826] - [INFO] 2024-05-06 04:02:02.393 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3826, success=true)
[WI-0][TI-3826] - [INFO] 2024-05-06 04:02:02.407 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3826)
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:02.515 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={"premiumplatinum"})}
	#{setValue(content=singapore is stupid)}
	#{setValue(url=https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/)}
	#{setValue(context=21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist)}
	#{setValue(type=post)}
	#{setValue(datetime=2024-04-21 22:10:42)}
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.516 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826, processId:8121 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1022/3826
[WI-1022][TI-3826] - [INFO] 2024-05-06 04:02:02.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:03.031 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7397260273972603 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3826] - [INFO] 2024-05-06 04:02:03.381 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3826, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:51.187 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7894736842105262 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:02:52.196 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7881619937694704 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:03.104 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3831, taskName=consume filtered data, firstSubmitTime=1714939383091, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1023, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3831'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040303'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1023'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.105 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.111 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.111 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939383112
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1023_3831
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3831,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714939383091,
  "startTime" : 1714939383112,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1023/3831.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1023,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"is_message_empty\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n    --bootstrap-server kafka:9092 \\\\\\n    --topic gnews_filtered \\\\\\n    --max-messages 1 \\\\\\n    --from-beginning \\\\\\n    --group filtered_data_consumer)\\n\\n\\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \\nif [ -z \\\"${filtered_data_message}\\\" ]; then\\n    filtered_data_message=null\\n    is_message_empty=1\\nelse\\n    is_message_empty=0\\nfi\\n\\necho \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\\necho \\\"#{setValue(is_message_empty=${is_message_empty})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3831"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040303"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1023"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1023_3831",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.117 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.117 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3831 check successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.119 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "is_message_empty",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic gnews_filtered \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer)\n\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"${filtered_data_message}\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"",
  "resourceList" : [ ]
}
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.121 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.121 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.121 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
filtered_data_message=$(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
    --bootstrap-server kafka:9092 \
    --topic gnews_filtered \
    --max-messages 1 \
    --from-beginning \
    --group filtered_data_consumer)


# check if the message is empty. If message is empty, then set is_message_empty to 1 
if [ -z "${filtered_data_message}" ]; then
    filtered_data_message=null
    is_message_empty=1
else
    is_message_empty=0
fi

echo "#{setValue(filtered_data_message=${filtered_data_message})}"
echo "#{setValue(is_message_empty=${is_message_empty})}"
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.121 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.121 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3831/1023_3831.sh
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:03.126 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 8144
[WI-0][TI-3831] - [INFO] 2024-05-06 04:03:03.461 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3831, success=true)
[WI-0][TI-3831] - [INFO] 2024-05-06 04:03:03.468 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3831)
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:04.126 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:16.139 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Processed a total of 1 messages
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:17.141 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(filtered_data_message={
		"authors": [
			"premiumplatinum"
		],
		"content": "singapore is stupid",
		"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
		"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
		"type": "post",
		"datetime": "2024-04-21 22:10:42"
	})}
	#{setValue(is_message_empty=0)}
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.142 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3831, processId:8144 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.149 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.155 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3831
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3831
[WI-1023][TI-3831] - [INFO] 2024-05-06 04:03:17.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3831] - [INFO] 2024-05-06 04:03:17.501 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3831, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:18.287 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7959605440832591 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:18.585 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3833, taskName=parse the message, firstSubmitTime=1714939398573, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1023, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = ${filtered_data_message}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, is_message_empty=Property{prop='is_message_empty', direct=IN, type=VARCHAR, value='0'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3833'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value='{
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040318'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1023'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.585 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.586 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939398588
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1023_3833
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3833,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714939398573,
  "startTime" : 1714939398588,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1023/3833.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1023,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = ${filtered_data_message}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "is_message_empty" : {
      "prop" : "is_message_empty",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "0"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3833"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040318"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1023"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1023_3833",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"is_message_empty\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"0\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"premiumplatinum\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"singapore is stupid\\\",\\n\\t\\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n\\t\\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n\\t\\\"type\\\": \\\"post\\\",\\n\\t\\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.589 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.589 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.589 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.592 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.593 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.595 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833 check successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.597 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = ${filtered_data_message}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"}] successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.597 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.598 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.598 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.598 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = ${filtered_data_message}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.599 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.600 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833/py_1023_3833.py
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.600 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.601 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.601 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.601 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833/py_1023_3833.py
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.601 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.601 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833/1023_3833.sh
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:18.617 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 8549
[WI-0][TI-3833] - [INFO] 2024-05-06 04:03:19.488 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3833, success=true)
[WI-0][TI-3833] - [INFO] 2024-05-06 04:03:19.499 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3833)
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:19.620 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={"premiumplatinum"})}
	#{setValue(content=singapore is stupid)}
	#{setValue(url=https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/)}
	#{setValue(context=21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist)}
	#{setValue(type=post)}
	#{setValue(datetime=2024-04-21 22:10:42)}
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.625 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833, processId:8549 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.625 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.625 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.625 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.631 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.634 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3833
[WI-1023][TI-3833] - [INFO] 2024-05-06 04:03:19.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3833] - [INFO] 2024-05-06 04:03:20.496 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3833, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:20.643 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3834, taskName=persist in postgresql, firstSubmitTime=1714939400602, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=67, appIds=null, processInstanceId=1023, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, is_message_empty=Property{prop='is_message_empty', direct=IN, type=VARCHAR, value='0'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3834'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='post'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value='{
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}'}, content=Property{prop='content', direct=IN, type=VARCHAR, value='singapore is stupid'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506040320'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-04-21 22:10:42'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1023'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{"premiumplatinum"}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@62d80f27, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-04-21 22:10:42"},{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"post"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"},{"prop":"content","direct":"IN","type":"VARCHAR","value":"singapore is stupid"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"premiumplatinum\"}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.653 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.653 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.680 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714939400680
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1023_3834
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3834,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714939400602,
  "startTime" : 1714939400680,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/67/1023/3834.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 67,
  "processInstanceId" : 1023,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "is_message_empty" : {
      "prop" : "is_message_empty",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "0"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3834"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "post"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "singapore is stupid"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506040320"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-04-21 22:10:42"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1023"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\"premiumplatinum\"}"
    }
  },
  "taskAppId" : "1023_3834",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-04-21 22:10:42\"},{\"prop\":\"is_message_empty\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"0\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"post\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"premiumplatinum\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"singapore is stupid\\\",\\n\\t\\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n\\t\\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n\\t\\\"type\\\": \\\"post\\\",\\n\\t\\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"singapore is stupid\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\\"premiumplatinum\\\"}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.682 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.682 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.709 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3834 check successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.737 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-04-21 22:10:42"},{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"post"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": [\n\t\t\"premiumplatinum\"\n\t],\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"},{"prop":"content","direct":"IN","type":"VARCHAR","value":"singapore is stupid"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"premiumplatinum\"}"}] successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.738 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.738 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-04-21 22:10:42'}, Property{prop='is_message_empty', direct=IN, type=VARCHAR, value='0'}, Property{prop='context', direct=IN, type=VARCHAR, value='21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist'}, Property{prop='type', direct=IN, type=VARCHAR, value='post'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value='{
	"authors": [
		"premiumplatinum"
	],
	"content": "singapore is stupid",
	"url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
	"context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
	"type": "post",
	"datetime": "2024-04-21 22:10:42"
}'}, Property{prop='content', direct=IN, type=VARCHAR, value='singapore is stupid'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{"premiumplatinum"}'}] ,query max result limit  0
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.739 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.740 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)

[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.740 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{"premiumplatinum"}(VARCHAR)singapore is stupid(VARCHAR)https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/(VARCHAR)21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist(VARCHAR)post(VARCHAR)2024-04-21 22:10:42(TIMESTAMP)
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.740 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1023][TI-3834] - [WARN] 2024-05-06 04:03:20.740 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.860 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{"premiumplatinum"}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='singapore is stupid'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='post'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-04-21 22:10:42'}}
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.904 +0800 o.a.d.p.t.s.SqlTask:[328] - main statement execute update result: 1, for sql: INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)

[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.914 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.914 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3834
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_67/1023/3834
[WI-1023][TI-3834] - [INFO] 2024-05-06 04:03:20.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:21.388 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8245614035087719 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3834] - [INFO] 2024-05-06 04:03:21.497 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3834, success=true)
[WI-0][TI-3834] - [INFO] 2024-05-06 04:03:21.506 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3834, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 04:03:22.402 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7102272727272727 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:12:30.918 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7784710351377018 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:12:33.994 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7275541795665634 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:14:24.099 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7777777777777777 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:36:48.413 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7685459940652819 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:36:50.465 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8211143695014662 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:36:51.478 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7377622377622377 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:36:56.646 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7349397590361446 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:36:57.669 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7854984894259819 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:37:29.829 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7204968944099379 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:38:48.180 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8283132530120483 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:40:09.607 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8251533742331287 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:41:34.032 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8926474752241623 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 04:41:46.113 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8696808510638298 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:46.519 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper/172.18.0.4:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:74)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1282)
[WI-0][TI-0] - [INFO] 2024-05-06 04:41:46.620 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: SUSPENDED
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:46.621 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[50] - Registry suspended
[WI-0][TI-0] - [INFO] 2024-05-06 04:41:46.622 +0800 o.a.d.s.w.r.WorkerConnectionStateListener:[42] - Worker received a SUSPENDED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:47.623 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper: Temporary failure in name resolution
	at java.net.Inet4AddressImpl.lookupAllHostAddr(Native Method)
	at java.net.InetAddress$2.lookupAllHostAddr(InetAddress.java:867)
	at java.net.InetAddress.getAddressesFromNameService(InetAddress.java:1302)
	at java.net.InetAddress$NameServiceAddresses.get(InetAddress.java:815)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:47.772 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:48.874 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:49.098 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:50.210 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:50.675 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:50.782 +0800 o.a.c.r.ExponentialBackoffRetry:[74] - Sleep extension too large (840). Pinning to 300
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:51.782 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:52.431 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:52.532 +0800 o.a.c.r.ExponentialBackoffRetry:[74] - Sleep extension too large (1860). Pinning to 300
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:53.533 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:54.313 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:54.415 +0800 o.a.d.c.m.BaseHeartBeatTask:[71] - WorkerHeartBeatTask task execute failed
org.apache.dolphinscheduler.registry.api.RegistryException: Failed to put registry key: /nodes/worker/172.18.1.1:1234
	at org.apache.dolphinscheduler.plugin.registry.zookeeper.ZookeeperRegistry.put(ZookeeperRegistry.java:191)
	at org.apache.dolphinscheduler.registry.api.RegistryClient.persistEphemeral(RegistryClient.java:173)
	at org.apache.dolphinscheduler.server.worker.task.WorkerHeartBeatTask.writeHeartBeat(WorkerHeartBeatTask.java:86)
	at org.apache.dolphinscheduler.server.worker.task.WorkerHeartBeatTask.writeHeartBeat(WorkerHeartBeatTask.java:37)
	at org.apache.dolphinscheduler.common.model.BaseHeartBeatTask.run(BaseHeartBeatTask.java:67)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /dolphinscheduler/nodes/worker/172.18.1.1:1234
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:1450)
	at org.apache.curator.framework.imps.CreateBuilderImpl$18.call(CreateBuilderImpl.java:1216)
	at org.apache.curator.framework.imps.CreateBuilderImpl$18.call(CreateBuilderImpl.java:1193)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:93)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:1190)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:605)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:595)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:48)
	at org.apache.dolphinscheduler.plugin.registry.zookeeper.ZookeeperRegistry.put(ZookeeperRegistry.java:189)
	... 4 common frames omitted
[WI-0][TI-0] - [ERROR] 2024-05-06 04:41:55.418 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-06 04:41:55.651 +0800 o.a.z.ClientCnxn:[1292] - Session 0x10000020921002f for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
