[WI-0][TI-0] - [INFO] 2024-04-23 08:00:01.584 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:00:01 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:00:01 INFO FileSourceStrategy: Post-Scan Filters: 
[WI-0][TI-0] - [INFO] 2024-04-23 08:00:02.017 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.755043227665706 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:00:02.597 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:00:02 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:00:02 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:00:02 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:38747 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:00:02 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:00:02 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
	24/04/23 08:00:02 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:00:02 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:00:02 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:00:02 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:00:02 INFO DAGScheduler: Missing parents: List()
[WI-0][TI-0] - [INFO] 2024-04-23 08:00:03.042 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7614942528735632 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:00:03.598 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:00:02 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:00:02 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:00:02 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:00:02 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:38747 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:00:02 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:00:02 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:00:02 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
	24/04/23 08:00:02 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.18.0.8, executor 0, partition 0, PROCESS_LOCAL, 8478 bytes) 
[WI-0][TI-0] - [INFO] 2024-04-23 08:00:38.141 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7014084507042253 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:12.642 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1024, taskName=search for intake JSON files, firstSubmitTime=1713830772604, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=444, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"},{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"${REDDIT_HOME}/processing/386-20240422.json"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1024'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080612'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='444'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.646 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.647 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.650 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.650 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.650 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.650 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830772650
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.650 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 444_1024
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.651 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1024,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713830772604,
  "startTime" : 1713830772650,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1024.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 444,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"},{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"${REDDIT_HOME}/processing/386-20240422.json\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1024"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080612"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "444"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "444_1024",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.663 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.663 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1024 check successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.667 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.673 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.677 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.678 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/in -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}"
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.678 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.678 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1024/444_1024.sh
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:12.682 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 398
[WI-0][TI-1024] - [INFO] 2024-04-23 08:06:13.162 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1024, success=true)
[WI-0][TI-1024] - [INFO] 2024-04-23 08:06:13.172 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1024)
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:13.685 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.687 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1024, processId:398 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.687 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.687 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.693 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1024
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1024
[WI-444][TI-1024] - [INFO] 2024-04-23 08:06:13.714 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1024] - [INFO] 2024-04-23 08:06:14.159 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1024, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:15.247 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1026, taskName=move to processing, firstSubmitTime=1713830775240, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=444, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"},{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"${REDDIT_HOME}/processing/386-20240422.json"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [\"${folder}\"!=\"processing\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1026'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080615'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='444'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.249 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.249 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.252 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.255 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830775255
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.256 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 444_1026
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.256 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1026,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713830775240,
  "startTime" : 1713830775255,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1026.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 444,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"},{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"${REDDIT_HOME}/processing/386-20240422.json\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif [\\\"${folder}\\\"!=\\\"processing\\\"]; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1026"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080615"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "444"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "444_1026",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.278 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026 check successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.284 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.284 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.285 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.285 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [\"${folder}\"!=\"processing\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.287 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.288 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.288 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if ["in"!="processing"]; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.288 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.288 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026/444_1026.sh
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:15.294 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 412
[WI-0][TI-1026] - [INFO] 2024-04-23 08:06:16.165 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1026, success=true)
[WI-0][TI-1026] - [INFO] 2024-04-23 08:06:16.173 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1026)
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:16.296 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026/444_1026.sh: line 7: [in!=processing]: command not found
	JSON is already in processing
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.298 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026, processId:412 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.299 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.299 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.299 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.299 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.309 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.310 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1026
[WI-444][TI-1026] - [INFO] 2024-04-23 08:06:16.310 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1026] - [INFO] 2024-04-23 08:06:17.167 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1026, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:17.268 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1027, taskName=spark preprocessing, firstSubmitTime=1713830777257, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=444, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"},{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"${REDDIT_HOME}/processing/386-20240422.json"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1027'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080617'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='444'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.269 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.270 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830777271
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 444_1027
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1027,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713830777257,
  "startTime" : 1713830777271,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 444,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"},{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"${REDDIT_HOME}/processing/386-20240422.json\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1027"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080617"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "444"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "444_1027",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.274 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.289 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.290 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.292 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027 check successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.292 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027/spark_reddit_preprocessing.py)})
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.328 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.331 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.331 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.333 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.333 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.336 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.337 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.337 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027/444_1027.sh
[WI-444][TI-1027] - [INFO] 2024-04-23 08:06:17.369 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 423
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:17.369 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1027] - [INFO] 2024-04-23 08:06:18.228 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1027, success=true)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:06:18.255 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1027)
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:18.443 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7812499999999999 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:21.384 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:20 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:22.395 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:21 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:06:21 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:06:21 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:06:21 INFO ResourceUtils: ==============================================================
	24/04/23 08:06:21 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:06:21 INFO ResourceUtils: ==============================================================
	24/04/23 08:06:21 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:06:21 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:06:21 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:06:21 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:06:22 INFO SecurityManager: Changing view acls to: default
	24/04/23 08:06:22 INFO SecurityManager: Changing modify acls to: default
	24/04/23 08:06:22 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:06:22 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:06:22 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:22.490 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7970588235294118 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:22.908 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1023)
[WI-0][TI-1023] - [ERROR] 2024-04-23 08:06:22.939 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:22.940 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/68/443/1023.log
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:22.940 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/68/443/1023.log, fetch way: log 
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:22.941 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:22.942 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 206
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:23.397 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:23 INFO Utils: Successfully started service 'sparkDriver' on port 36011.
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:23.521 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.961111111111111 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:24.398 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:23 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:06:23 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:06:23 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:06:23 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:06:23 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:06:23 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-fdfffcd7-0675-4a61-ac64-59b3968dea3d
	24/04/23 08:06:23 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:06:23 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/23 08:06:23 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/23 08:06:24 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:06:24 INFO Utils: Successfully started service 'SparkUI' on port 4041.
	24/04/23 08:06:24 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:36011/files/386-20240422.json with timestamp 1713830781780
	24/04/23 08:06:24 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-b7a82535-d44d-4a71-9850-3b316497cd57/userFiles-65bb4c52-6907-4129-839c-443944c54088/386-20240422.json
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:25.400 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:24 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
	24/04/23 08:06:24 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 159 ms (0 ms spent in bootstraps)
	24/04/23 08:06:24 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423000624-0001
	24/04/23 08:06:24 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38191.
	24/04/23 08:06:24 INFO NettyBlockTransferService: Server created on 84078e67aaf6:38191
	24/04/23 08:06:24 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:06:24 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 38191, None)
	24/04/23 08:06:24 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:38191 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 38191, None)
	24/04/23 08:06:24 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 38191, None)
	24/04/23 08:06:24 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 38191, None)
	24/04/23 08:06:25 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:25.551 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7300351582119539 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:26.402 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	386-20240422.json
	json file /tmp/spark-b7a82535-d44d-4a71-9850-3b316497cd57/userFiles-65bb4c52-6907-4129-839c-443944c54088/386-20240422.json
	24/04/23 08:06:25 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:06:25 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:26.582 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9208211143695014 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:27.587 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9311377245508982 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:27.944 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 443_1023, pid: 206
[WI-0][TI-1023] - [INFO] 2024-04-23 08:06:27.944 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1023
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:28.405 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:28 INFO InMemoryFileIndex: It took 29 ms to list leaf files for 1 paths.
	24/04/23 08:06:28 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:28.594 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8422619047619048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:29.596 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7507987220447284 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:30.598 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7832369942196531 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:31.611 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8575498575498576 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:32.616 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9105431309904154 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:33.485 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:32 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:06:32 INFO FileSourceStrategy: Post-Scan Filters: 
	24/04/23 08:06:33 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:06:33 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:06:33 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:38191 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:06:33 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:06:33 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:33.623 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8527397260273973 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:34.497 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:33 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:06:33 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:06:33 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:06:33 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:06:33 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:06:33 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:06:33 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:06:33 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:06:33 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:38191 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:06:33 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:06:33 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:06:33 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:06:49.550 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:06:49 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:07:04.584 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:07:04 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:07:19.614 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:07:19 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:07:34.626 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:07:34 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:07:49.648 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:07:49 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:08:04.689 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:08:04 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:08:19.706 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:08:19 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:08:34.731 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:08:34 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:08:49.813 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:08:49 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:08:59.019 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1027)
[WI-0][TI-1027] - [ERROR] 2024-04-23 08:08:59.033 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1027] - [INFO] 2024-04-23 08:08:59.034 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log
[WI-0][TI-1027] - [INFO] 2024-04-23 08:08:59.036 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, fetch way: log 
[WI-0][TI-1027] - [INFO] 2024-04-23 08:08:59.041 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1027] - [INFO] 2024-04-23 08:08:59.041 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 423
[WI-0][TI-0] - [ERROR] 2024-04-23 08:09:04.007 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:09:04.063 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 444_1027, pid: 423
[WI-0][TI-1027] - [INFO] 2024-04-23 08:09:04.063 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1027
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.951 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, processId:423 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.957 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027
[WI-444][TI-1027] - [INFO] 2024-04-23 08:09:04.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:16.590 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1028, taskName=search for intake JSON files, firstSubmitTime=1713830956582, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=445, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1028'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080916'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='445'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.591 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.591 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.595 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830956596
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 445_1028
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1028,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713830956582,
  "startTime" : 1713830956596,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1028.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 445,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1028"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080916"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "445"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "445_1028",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.597 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.598 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.598 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.603 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.603 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1028 check successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.603 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.604 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.604 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.604 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.605 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.605 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.607 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.607 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.608 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.608 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.608 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.608 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.608 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1028/445_1028.sh
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:16.611 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 568
[WI-0][TI-1028] - [INFO] 2024-04-23 08:09:16.676 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1028, success=true)
[WI-0][TI-1028] - [INFO] 2024-04-23 08:09:16.683 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1028)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:17.616 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.623 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1028, processId:568 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.623 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.631 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.631 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.631 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1028
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1028
[WI-445][TI-1028] - [INFO] 2024-04-23 08:09:17.633 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1028] - [INFO] 2024-04-23 08:09:17.677 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1028, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:18.809 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1030, taskName=move to processing, firstSubmitTime=1713830958800, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=445, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [\"${folder}\"!=\"processing\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1030'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080918'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='445'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.810 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830958813
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 445_1030
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1030,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713830958800,
  "startTime" : 1713830958813,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1030.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 445,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif [\\\"${folder}\\\"!=\\\"processing\\\"]; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1030"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080918"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "445"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "445_1030",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.814 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.814 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.814 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.844 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030 check successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [\"${folder}\"!=\"processing\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.852 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.854 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.854 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.854 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if ["processing"!="processing"]; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.858 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.858 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030/445_1030.sh
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:18.866 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 581
[WI-0][TI-1030] - [INFO] 2024-04-23 08:09:19.697 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1030, success=true)
[WI-0][TI-1030] - [INFO] 2024-04-23 08:09:19.718 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1030)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:19.870 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030/445_1030.sh: line 7: [processing!=processing]: command not found
	JSON is already in processing
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.873 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030, processId:581 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.874 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.874 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.874 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1030
[WI-445][TI-1030] - [INFO] 2024-04-23 08:09:19.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1030] - [INFO] 2024-04-23 08:09:20.678 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1030, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:20.733 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1031, taskName=spark preprocessing, firstSubmitTime=1713830960722, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=68, appIds=null, processInstanceId=445, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1031'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423080920'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='445'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.736 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.737 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713830960739
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 445_1031
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1031,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713830960722,
  "startTime" : 1713830960739,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 68,
  "processInstanceId" : 445,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1031"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423080920"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "445"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "445_1031",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.742 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031 check successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.744 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031/spark_reddit_preprocessing.py)})
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.748 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.748 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.748 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.748 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.748 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031/445_1031.sh
[WI-445][TI-1031] - [INFO] 2024-04-23 08:09:20.751 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 592
[WI-0][TI-1031] - [INFO] 2024-04-23 08:09:21.684 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1031, success=true)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:09:21.692 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1031)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:21.757 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:22.773 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:22 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:23.826 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:23 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:09:23 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:09:23 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:09:23 INFO ResourceUtils: ==============================================================
	24/04/23 08:09:23 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:09:23 INFO ResourceUtils: ==============================================================
	24/04/23 08:09:23 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:09:23 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:09:23 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:09:23 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:09:23 INFO SecurityManager: Changing view acls to: default
	24/04/23 08:09:23 INFO SecurityManager: Changing modify acls to: default
	24/04/23 08:09:23 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:09:23 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:09:23 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
	24/04/23 08:09:23 INFO Utils: Successfully started service 'sparkDriver' on port 40183.
	24/04/23 08:09:23 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:09:23 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:09:23 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:09:23 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:09:23 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:09:23 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-d4d4ebaf-747f-4a0d-9eea-101a4fa88236
	24/04/23 08:09:23 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:09:23 INFO SparkEnv: Registering OutputCommitCoordinator
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:24.827 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:23 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/23 08:09:23 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:09:23 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
	24/04/23 08:09:23 INFO Utils: Successfully started service 'SparkUI' on port 4042.
	24/04/23 08:09:24 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:40183/files/386-20240422.json with timestamp 1713830963030
	24/04/23 08:09:24 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-7e3f3b76-91f1-4baa-ba38-2c9ea678f863/userFiles-cd988816-da0d-4004-ad2d-882bb4b03ff7/386-20240422.json
	24/04/23 08:09:24 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
	24/04/23 08:09:24 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 36 ms (0 ms spent in bootstraps)
	24/04/23 08:09:24 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423000924-0002
	24/04/23 08:09:24 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38713.
	24/04/23 08:09:24 INFO NettyBlockTransferService: Server created on 84078e67aaf6:38713
	24/04/23 08:09:24 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:09:24 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 38713, None)
	24/04/23 08:09:24 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:38713 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 38713, None)
	24/04/23 08:09:24 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 38713, None)
	24/04/23 08:09:24 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 38713, None)
	24/04/23 08:09:24 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:25.832 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	386-20240422.json
	json file /tmp/spark-7e3f3b76-91f1-4baa-ba38-2c9ea678f863/userFiles-cd988816-da0d-4004-ad2d-882bb4b03ff7/386-20240422.json
	24/04/23 08:09:24 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:09:24 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:26.841 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:26 INFO InMemoryFileIndex: It took 40 ms to list leaf files for 1 paths.
	24/04/23 08:09:26 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:28.844 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:28 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:09:28 INFO FileSourceStrategy: Post-Scan Filters: 
	24/04/23 08:09:28 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:29.847 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:28 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:09:28 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:38713 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:09:28 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:09:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
	24/04/23 08:09:29 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:09:29 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:09:29 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:09:29 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:09:29 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:09:29 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:09:29 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:09:29 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:09:29 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:38713 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:09:29 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:09:29 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:09:29 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:44.891 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:44 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:09:59.490 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:09:59 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:10:14.528 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:10:14 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:10:29.643 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:10:29 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:10:44.701 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:10:44 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:10:59.746 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:10:59 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:11:14.793 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:11:14 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:11:29.831 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:11:29 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:11:44.892 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:11:44 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:11:59.949 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:11:59 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:12:03.187 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1031)
[WI-0][TI-1031] - [ERROR] 2024-04-23 08:12:03.190 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:03.190 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:03.191 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, fetch way: log 
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:03.191 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:03.191 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 592
[WI-0][TI-1027] - [INFO] 2024-04-23 08:12:05.757 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:12:05.762 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831125756)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:08.206 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 445_1031, pid: 592
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:08.207 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1031
[WI-0][TI-0] - [INFO] 2024-04-23 08:12:11.404 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8033866118056654 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [ERROR] 2024-04-23 08:12:14.262 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.976 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, processId:592 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.978 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031
[WI-445][TI-1031] - [INFO] 2024-04-23 08:12:14.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:15.770 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:12:15.774 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831135770)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:17:06.259 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831125756)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:17:06.275 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831426259)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:17:16.300 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831135770)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:17:16.304 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831436300)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:22:06.506 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831426259)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:22:06.514 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831726506)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:22:16.531 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831436300)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:22:16.538 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831736531)
[WI-0][TI-0] - [INFO] 2024-04-23 08:22:31.955 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1032, taskName=search for intake JSON files, firstSubmitTime=1713831751921, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=69, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1032'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082231'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.960 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.969 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713831751970
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1032
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1032,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713831751921,
  "startTime" : 1713831751970,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/69/446/1032.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 69,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1032"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082231"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1032",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.985 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1032 check successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.991 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.992 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.992 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.993 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.993 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.994 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.995 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:31.995 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1032/446_1032.sh
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:32.000 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 853
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.565 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1032, processInstanceId=446, startTime=1713831751970, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/69/446/1032.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.575 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1032, processInstanceId=446, startTime=1713831751970, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/69/446/1032.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713831752560)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.592 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1032, processInstanceId=446, startTime=1713831751970, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.614 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1032, success=true)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.618 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1032, processInstanceId=446, startTime=1713831751970, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713831752560)
[WI-0][TI-1032] - [WARN] 2024-04-23 08:22:32.621 +0800 o.a.d.s.w.m.MessageRetryRunner:[139] - Retry send message to master error
java.util.ConcurrentModificationException: null
	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:911)
	at java.util.ArrayList$Itr.next(ArrayList.java:861)
	at org.apache.dolphinscheduler.server.worker.message.MessageRetryRunner.run(MessageRetryRunner.java:127)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.649 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1032)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.660 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1032, success=true)
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:32.670 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1032)
[WI-0][TI-0] - [INFO] 2024-04-23 08:22:33.001 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.003 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1032, processId:853 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.004 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.010 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.011 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.011 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1032
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.011 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1032
[WI-446][TI-1032] - [INFO] 2024-04-23 08:22:33.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1032] - [INFO] 2024-04-23 08:22:33.580 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1032, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:22:34.723 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1034, taskName=move to processing, firstSubmitTime=1713831754705, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=69, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1034'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082234'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.726 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.727 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.730 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713831754731
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1034
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1034,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713831754705,
  "startTime" : 1713831754731,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/69/446/1034.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 69,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1034"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082234"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1034",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1034 check successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.741 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.742 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.744 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.745 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.745 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if ! grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.746 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.746 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1034/446_1034.sh
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:34.749 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 867
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:35.623 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1034, success=true)
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:35.625 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1034, processInstanceId=446, startTime=1713831754731, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:35.627 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1034, processInstanceId=446, startTime=1713831754731, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713831755625)
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:35.632 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1034)
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:35.646 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1034)
[WI-0][TI-0] - [INFO] 2024-04-23 08:22:35.753 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	mv: '/local_storage/reddit/processing/386-20240422.json' and '/local_storage/reddit/processing/386-20240422.json' are the same file
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.755 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1034, processId:867 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.756 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.756 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.756 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1034
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.785 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_69/446/1034
[WI-446][TI-1034] - [INFO] 2024-04-23 08:22:35.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1034] - [INFO] 2024-04-23 08:22:36.602 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1034, success=true)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:27:07.058 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831726506)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:27:07.070 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832027058)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:27:17.082 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713831736531)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:27:17.088 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832037082)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:07.804 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8028169014084507 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:26.497 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1036, taskName=search for intake JSON files, firstSubmitTime=1713832106483, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1036'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082826'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.503 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.503 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.509 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.509 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832106509
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.510 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1036
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.511 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1036,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713832106483,
  "startTime" : 1713832106509,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1036.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1036"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082826"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1036",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1036 check successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.524 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.528 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.528 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.528 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}"
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.528 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.528 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1036/446_1036.sh
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:26.558 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 951
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:26.558 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:26.939 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7784090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:27.209 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1036, processInstanceId=446, startTime=1713832106509, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1036.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:27.213 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1036, success=true)
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:27.218 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1036, processInstanceId=446, startTime=1713832106509, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1036.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713832107201)
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:27.225 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1036)
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:27.239 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1036, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:27.562 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.563 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1036, processId:951 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.569 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.569 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1036
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.569 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1036
[WI-446][TI-1036] - [INFO] 2024-04-23 08:28:27.569 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1036] - [INFO] 2024-04-23 08:28:28.207 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1036, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:29.314 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1038, taskName=move to processing, firstSubmitTime=1713832109305, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1038'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082829'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.316 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.316 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832109318
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1038
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1038,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713832109305,
  "startTime" : 1713832109318,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1038.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif [! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"]; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1038"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082829"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1038",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.319 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.319 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.319 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038 check successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.330 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.330 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.330 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.330 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.331 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.332 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.332 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.332 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if [! grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"]; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.332 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.333 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038/446_1038.sh
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:29.342 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 965
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:30.221 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1038, success=true)
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:30.221 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1038, processInstanceId=446, startTime=1713832109318, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1038.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:30.235 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1038, processInstanceId=446, startTime=1713832109318, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1038.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713832110219)
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:30.239 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1038)
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:30.250 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1038, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:30.345 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038/446_1038.sh: line 7: [!: command not found
	JSON is already in processing
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.354 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038, processId:965 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.357 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.357 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.357 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.357 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.360 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.361 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.361 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.361 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1038
[WI-446][TI-1038] - [INFO] 2024-04-23 08:28:30.362 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1038] - [INFO] 2024-04-23 08:28:31.220 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1038, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:31.257 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1039, taskName=spark preprocessing, firstSubmitTime=1713832111248, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1039'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082831'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.258 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.258 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.260 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.260 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832111260
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1039
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.261 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1039,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713832111248,
  "startTime" : 1713832111260,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1039"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082831"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1039",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.262 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.262 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.262 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039 check successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039/spark_reddit_preprocessing.py)})
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.268 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.268 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.268 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.269 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.269 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.270 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.270 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.270 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039/446_1039.sh
[WI-446][TI-1039] - [INFO] 2024-04-23 08:28:31.274 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 976
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:32.214 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1039, success=true)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:32.225 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1039)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:32.275 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:33.277 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:34.282 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:33 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:28:33 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:28:33 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:28:34 INFO ResourceUtils: ==============================================================
	24/04/23 08:28:34 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:28:34 INFO ResourceUtils: ==============================================================
	24/04/23 08:28:34 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:28:34 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:28:34 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:28:34 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:28:34 INFO SecurityManager: Changing view acls to: default
	24/04/23 08:28:34 INFO SecurityManager: Changing modify acls to: default
	24/04/23 08:28:34 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:28:34 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:28:34 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:35.036 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8011527377521614 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:35.289 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:34 INFO Utils: Successfully started service 'sparkDriver' on port 42221.
	24/04/23 08:28:35 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:28:35 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:28:35 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:28:35 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:28:35 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:28:35 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-753d8acf-64e0-44ec-a363-8c75b2211860
	24/04/23 08:28:35 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:28:35 INFO SparkEnv: Registering OutputCommitCoordinator
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:36.055 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7058823529411764 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:36.291 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:35 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/23 08:28:35 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:28:35 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
	24/04/23 08:28:35 WARN Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
	24/04/23 08:28:35 INFO Utils: Successfully started service 'SparkUI' on port 4043.
	24/04/23 08:28:35 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:42221/files/386-20240422.json with timestamp 1713832113962
	24/04/23 08:28:35 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-4f9333e1-c158-4c6f-aa0a-2ef6634c6f63/userFiles-bdca6ccd-f629-48a6-a052-347b5e271d1e/386-20240422.json
	24/04/23 08:28:36 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
	24/04/23 08:28:36 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 72 ms (0 ms spent in bootstraps)
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:37.066 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8347107438016529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:37.298 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:36 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423002836-0003
	24/04/23 08:28:36 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45299.
	24/04/23 08:28:36 INFO NettyBlockTransferService: Server created on 84078e67aaf6:45299
	24/04/23 08:28:36 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:28:36 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 45299, None)
	24/04/23 08:28:36 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:45299 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 45299, None)
	24/04/23 08:28:36 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 45299, None)
	24/04/23 08:28:36 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 45299, None)
	24/04/23 08:28:36 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:38.068 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.921259842519685 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:38.304 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	386-20240422.json
	json file /tmp/spark-4f9333e1-c158-4c6f-aa0a-2ef6634c6f63/userFiles-bdca6ccd-f629-48a6-a052-347b5e271d1e/386-20240422.json
	24/04/23 08:28:37 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:28:37 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:39.070 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8347107438016529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:39.319 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:39 INFO InMemoryFileIndex: It took 34 ms to list leaf files for 1 paths.
	24/04/23 08:28:39 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:40.072 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8016304347826086 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:41.078 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7515151515151515 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:42.080 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7605633802816901 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:43.085 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7557554075987942 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:43.339 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:43 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:28:43 INFO FileSourceStrategy: Post-Scan Filters: 
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:44.152 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8620689655172414 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:44.344 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:43 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:28:44 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:28:44 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:45299 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:28:44 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:28:44 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:45.345 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:28:44 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:28:44 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:28:44 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:28:44 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:28:44 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:28:44 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:28:44 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:28:44 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:28:44 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:45299 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:28:44 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:28:44 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:28:44 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:28:59.282 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1039)
[WI-0][TI-1039] - [ERROR] 2024-04-23 08:28:59.295 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:59.300 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:59.301 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, fetch way: log 
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:59.302 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1039] - [INFO] 2024-04-23 08:28:59.302 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 976
[WI-0][TI-0] - [ERROR] 2024-04-23 08:28:59.750 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:29:04.306 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 446_1039, pid: 976
[WI-0][TI-1039] - [INFO] 2024-04-23 08:29:04.307 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1039
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.309 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, processId:976 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.310 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039
[WI-446][TI-1039] - [INFO] 2024-04-23 08:29:04.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1039] - [INFO] 2024-04-23 08:29:05.292 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:29:05.308 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832145289)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:06.240 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7008547008547009 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:07.250 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7542372881355932 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:20.288 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7492877492877492 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:21.717 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1040, taskName=search for intake JSON files, firstSubmitTime=1713832161678, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1040'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082921'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.718 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.727 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832161728
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1040
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1040,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713832161678,
  "startTime" : 1713832161728,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1040.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1040"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082921"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1040",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1040 check successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.739 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}"
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.741 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1040/446_1040.sh
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:21.754 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1095
[WI-0][TI-1040] - [INFO] 2024-04-23 08:29:22.292 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1040, success=true)
[WI-0][TI-1040] - [INFO] 2024-04-23 08:29:22.303 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1040)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:22.758 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.759 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1040, processId:1095 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.761 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.765 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1040
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1040
[WI-446][TI-1040] - [INFO] 2024-04-23 08:29:22.767 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1040] - [INFO] 2024-04-23 08:29:23.292 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1040, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:24.450 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1042, taskName=move to processing, firstSubmitTime=1713832164414, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1042'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082924'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.462 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.495 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832164520
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1042
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1042,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713832164414,
  "startTime" : 1713832164520,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1042.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif [! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"]; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1042"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082924"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1042",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042 check successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.577 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.579 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.579 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.579 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if [! grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"]; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.579 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.581 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042/446_1042.sh
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:24.614 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1108
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:24.619 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1042] - [INFO] 2024-04-23 08:29:25.297 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1042, success=true)
[WI-0][TI-1042] - [INFO] 2024-04-23 08:29:25.307 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1042)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:25.655 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042/446_1042.sh: line 7: [!: command not found
	JSON is already in processing
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.657 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042, processId:1108 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.685 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1042
[WI-446][TI-1042] - [INFO] 2024-04-23 08:29:25.690 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1042] - [INFO] 2024-04-23 08:29:26.307 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1042, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:26.363 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1043, taskName=spark preprocessing, firstSubmitTime=1713832166350, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=70, appIds=null, processInstanceId=446, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1043'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423082926'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='446'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.364 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.365 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.367 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832166368
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 446_1043
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1043,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713832166350,
  "startTime" : 1713832166368,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 70,
  "processInstanceId" : 446,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1043"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423082926"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "446"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "446_1043",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.388 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.389 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043 check successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.392 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043/spark_reddit_preprocessing.py)})
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.392 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.393 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.393 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.394 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.394 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.397 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.398 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.398 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.398 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.398 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.399 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043/446_1043.sh
[WI-446][TI-1043] - [INFO] 2024-04-23 08:29:26.405 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1119
[WI-0][TI-1043] - [INFO] 2024-04-23 08:29:27.310 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1043, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:27.321 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7450980392156863 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1043] - [INFO] 2024-04-23 08:29:27.327 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1043)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:27.409 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:28.332 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9034090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:29.339 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9441340782122905 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:30.341 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.927170868347339 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:31.448 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:30 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:32.454 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:31 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:29:31 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:29:31 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:29:31 INFO ResourceUtils: ==============================================================
	24/04/23 08:29:31 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:29:31 INFO ResourceUtils: ==============================================================
	24/04/23 08:29:31 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:29:31 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:29:31 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:29:31 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:29:32 INFO SecurityManager: Changing view acls to: default
	24/04/23 08:29:32 INFO SecurityManager: Changing modify acls to: default
	24/04/23 08:29:32 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:29:32 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:29:32 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:32.491 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.742296918767507 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:33.466 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:32 INFO Utils: Successfully started service 'sparkDriver' on port 35521.
	24/04/23 08:29:33 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:29:33 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:29:33 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:29:33 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:29:33 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:29:33 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7c9db95a-856c-48e7-9f1d-bb7525b74f8d
	24/04/23 08:29:33 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:29:33 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/23 08:29:33 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:34.473 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:33 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:29:33 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
	24/04/23 08:29:33 WARN Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
	24/04/23 08:29:33 WARN Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
	24/04/23 08:29:33 INFO Utils: Successfully started service 'SparkUI' on port 4044.
	24/04/23 08:29:33 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:35521/files/386-20240422.json with timestamp 1713832171688
	24/04/23 08:29:33 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-8c0f70d8-eb3e-4fe9-adbe-35b261b74c84/userFiles-fac23b97-2912-4d06-88ec-b71bd0ffd93f/386-20240422.json
	24/04/23 08:29:34 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:34.525 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.924198250728863 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:35.478 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:34 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 219 ms (0 ms spent in bootstraps)
	24/04/23 08:29:34 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423002934-0004
	24/04/23 08:29:35 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 35199.
	24/04/23 08:29:35 INFO NettyBlockTransferService: Server created on 84078e67aaf6:35199
	24/04/23 08:29:35 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:29:35 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 35199, None)
	24/04/23 08:29:35 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:35199 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 35199, None)
	24/04/23 08:29:35 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 35199, None)
	24/04/23 08:29:35 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 35199, None)
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:35.575 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8410958904109589 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:36.480 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:35 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
	386-20240422.json
	json file /tmp/spark-8c0f70d8-eb3e-4fe9-adbe-35b261b74c84/userFiles-fac23b97-2912-4d06-88ec-b71bd0ffd93f/386-20240422.json
	24/04/23 08:29:35 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:29:35 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:38.485 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:37 INFO InMemoryFileIndex: It took 52 ms to list leaf files for 1 paths.
	24/04/23 08:29:37 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:41.499 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:41 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:29:41 INFO FileSourceStrategy: Post-Scan Filters: 
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:42.503 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:41 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:29:41 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:29:41 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:35199 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:29:41 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:29:41 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
	24/04/23 08:29:41 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:29:41 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:29:41 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:29:41 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:29:41 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:29:41 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:29:42 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:29:42 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:29:42 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:35199 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:29:42 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:29:42 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:29:42 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:29:57.521 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:29:57 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:30:03.648 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1043)
[WI-0][TI-1043] - [ERROR] 2024-04-23 08:30:03.652 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:03.654 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:03.654 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, fetch way: log 
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:03.655 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:03.655 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 1119
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:08.667 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 446_1043, pid: 1119
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:08.670 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1043
[WI-0][TI-0] - [ERROR] 2024-04-23 08:30:12.159 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.542 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, processId:1119 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.544 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043
[WI-446][TI-1043] - [INFO] 2024-04-23 08:30:12.549 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:13.481 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:30:13.504 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832213481)
[WI-0][TI-0] - [INFO] 2024-04-23 08:30:16.777 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7050561797752808 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:30:19.809 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.744927536231884 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:30:20.841 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7036011080332409 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:04.129 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1044, taskName=search for intake JSON files, firstSubmitTime=1713832264123, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=72, appIds=null, processInstanceId=447, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1044'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083104'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='447'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.131 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.132 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.133 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.134 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.134 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832264134
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.134 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 447_1044
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.134 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1044,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713832264123,
  "startTime" : 1713832264134,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1044.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 72,
  "processInstanceId" : 447,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1044"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083104"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "447"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "447_1044",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.135 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.135 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.135 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.141 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.143 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044 check successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.143 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.143 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.144 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.144 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.145 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.145 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.145 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.148 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.149 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.149 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.149 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.149 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044/447_1044.sh
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:04.152 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1242
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.586 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1044, processInstanceId=447, startTime=1713832264134, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1044.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.595 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1044, processInstanceId=447, startTime=1713832264134, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1044.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713832264586)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.596 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1044, processInstanceId=447, startTime=1713832264134, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.602 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1044, processInstanceId=447, startTime=1713832264134, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713832264586)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.606 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1044, success=true)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.614 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1044)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.620 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1044, success=true)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:04.635 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1044)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:05.155 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.157 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044, processId:1242 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.158 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.159 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.159 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.165 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.167 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044
[WI-447][TI-1044] - [INFO] 2024-04-23 08:31:05.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:05.605 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1044, processInstanceId=447, status=7, startTime=1713832264134, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1044.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044, endTime=1713832265159, processId=1242, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:05.613 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1044, success=true)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:05.632 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1044, processInstanceId=447, status=7, startTime=1713832264134, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1044.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1044, endTime=1713832265159, processId=1242, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832265605)
[WI-0][TI-1044] - [WARN] 2024-04-23 08:31:05.635 +0800 o.a.d.s.w.m.MessageRetryRunner:[139] - Retry send message to master error
java.util.ConcurrentModificationException: null
	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:911)
	at java.util.ArrayList$Itr.next(ArrayList.java:861)
	at org.apache.dolphinscheduler.server.worker.message.MessageRetryRunner.run(MessageRetryRunner.java:127)
[WI-0][TI-1044] - [INFO] 2024-04-23 08:31:06.599 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1044, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:06.689 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1046, taskName=move to processing, firstSubmitTime=1713832266682, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=72, appIds=null, processInstanceId=447, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1046'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083106'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='447'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.691 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832266696
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 447_1046
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1046,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713832266682,
  "startTime" : 1713832266696,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1046.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 72,
  "processInstanceId" : 447,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif [! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"]; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1046"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083106"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "447"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "447_1046",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.698 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.698 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.698 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.702 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046 check successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif [! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"]; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.703 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.704 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if [! grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"]; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.705 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.705 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046/447_1046.sh
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:06.709 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1255
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:07.642 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1046, processInstanceId=447, startTime=1713832266696, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1046.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:07.656 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1046, success=true)
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:07.657 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1046, processInstanceId=447, startTime=1713832266696, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1046.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713832267641)
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:07.665 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1046)
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:07.707 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1046, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:07.722 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046/447_1046.sh: line 7: [!: command not found
	JSON is already in processing
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.750 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046, processId:1255 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.750 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.750 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.750 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.750 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.787 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1046
[WI-447][TI-1046] - [INFO] 2024-04-23 08:31:07.787 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:08.019 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.778688524590164 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1046] - [INFO] 2024-04-23 08:31:08.616 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1046, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:08.806 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1047, taskName=spark preprocessing, firstSubmitTime=1713832268795, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=72, appIds=null, processInstanceId=447, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1047'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083108'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='447'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.807 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.815 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.815 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.815 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.816 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832268816
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.816 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 447_1047
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.817 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1047,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713832268795,
  "startTime" : 1713832268816,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 72,
  "processInstanceId" : 447,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1047"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083108"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "447"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "447_1047",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.817 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.818 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.818 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.838 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.838 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.839 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047 check successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.839 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.840 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047/spark_reddit_preprocessing.py)})
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.841 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.841 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.841 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.842 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.842 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.842 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.843 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.843 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.843 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.843 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.843 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047/447_1047.sh
[WI-447][TI-1047] - [INFO] 2024-04-23 08:31:08.878 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1266
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:08.878 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:09.038 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7044198895027625 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:09.635 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1047, success=true)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:09.649 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1047)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:10.053 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8057324840764332 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:11.055 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7862595419847328 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:11.935 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:12.059 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8576923076923078 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:12.985 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:12 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:31:12 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:31:12 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:31:12 INFO ResourceUtils: ==============================================================
	24/04/23 08:31:12 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:31:12 INFO ResourceUtils: ==============================================================
	24/04/23 08:31:12 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:31:12 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:31:12 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:31:12 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:31:12 INFO SecurityManager: Changing view acls to: default
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:13.994 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:12 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:31:12 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:31:12 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
	24/04/23 08:31:13 INFO Utils: Successfully started service 'sparkDriver' on port 38483.
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:14.093 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7302052785923754 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:14.995 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:14 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:31:14 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:31:14 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:31:14 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:31:14 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:31:14 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-f95c5c20-935f-49c9-9525-1002a8092f67
	24/04/23 08:31:14 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:31:14 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/23 08:31:14 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/23 08:31:14 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:31:14 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
	24/04/23 08:31:14 WARN Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
	24/04/23 08:31:14 WARN Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
	24/04/23 08:31:14 WARN Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
	24/04/23 08:31:14 INFO Utils: Successfully started service 'SparkUI' on port 4045.
	24/04/23 08:31:14 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:38483/files/386-20240422.json with timestamp 1713832272813
	24/04/23 08:31:14 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-e80c2dab-1980-4f87-b16c-c862e5b7006e/userFiles-adf9ad0b-8a98-45bd-849a-56ec255de0d7/386-20240422.json
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:15.126 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8238636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:16.019 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:15 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
	24/04/23 08:31:15 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 101 ms (0 ms spent in bootstraps)
	24/04/23 08:31:15 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423003115-0005
	24/04/23 08:31:15 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 46555.
	24/04/23 08:31:15 INFO NettyBlockTransferService: Server created on 84078e67aaf6:46555
	24/04/23 08:31:15 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:31:15 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 46555, None)
	24/04/23 08:31:15 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:46555 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 46555, None)
	24/04/23 08:31:15 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 46555, None)
	24/04/23 08:31:15 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 46555, None)
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:16.127 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.831081081081081 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:17.075 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:16 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:17.130 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9136904761904762 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:18.076 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	386-20240422.json
	json file /tmp/spark-e80c2dab-1980-4f87-b16c-c862e5b7006e/userFiles-adf9ad0b-8a98-45bd-849a-56ec255de0d7/386-20240422.json
	24/04/23 08:31:17 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:31:17 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:19.077 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:18 INFO InMemoryFileIndex: It took 60 ms to list leaf files for 1 paths.
	24/04/23 08:31:19 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:22.083 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:22 INFO FileSourceStrategy: Pushed Filters: 
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:23.089 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:22 INFO FileSourceStrategy: Post-Scan Filters: 
	24/04/23 08:31:22 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:31:22 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:31:22 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:46555 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:31:22 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:31:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
	24/04/23 08:31:22 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:31:22 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:31:22 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:31:22 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:31:22 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:31:22 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:31:23 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:31:23 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:31:23 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:46555 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:31:23 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:24.092 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:31:23 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:39.116 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:38 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:53.138 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:31:53 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:31:54.049 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[55] - Receive TaskInstanceKillRequest: TaskInstanceKillRequest(taskInstanceId=1047)
[WI-0][TI-1047] - [ERROR] 2024-04-23 08:31:54.054 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[139] - kill task error
java.io.IOException: Cannot run program "pstree": error=2, No such file or directory
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.runCommand(AbstractShell.java:138)
	at org.apache.dolphinscheduler.common.shell.AbstractShell.run(AbstractShell.java:118)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execute(ShellExecutor.java:125)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:103)
	at org.apache.dolphinscheduler.common.shell.ShellExecutor.execCommand(ShellExecutor.java:86)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeShell(OSUtils.java:345)
	at org.apache.dolphinscheduler.common.utils.OSUtils.exeCmd(OSUtils.java:334)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ProcessUtils.getPidsStr(ProcessUtils.java:129)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.killProcess(TaskInstanceKillOperationFunction.java:130)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.doKill(TaskInstanceKillOperationFunction.java:96)
	at org.apache.dolphinscheduler.server.worker.runner.operator.TaskInstanceKillOperationFunction.operate(TaskInstanceKillOperationFunction.java:69)
	at org.apache.dolphinscheduler.server.worker.rpc.TaskInstanceOperatorImpl.killTask(TaskInstanceOperatorImpl.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.dolphinscheduler.extract.base.server.ServerMethodInvokerImpl.invoke(ServerMethodInvokerImpl.java:41)
	at org.apache.dolphinscheduler.extract.base.server.JdkDynamicServerHandler.lambda$processReceived$0(JdkDynamicServerHandler.java:108)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: error=2, No such file or directory
	at java.lang.UNIXProcess.forkAndExec(Native Method)
	at java.lang.UNIXProcess.<init>(UNIXProcess.java:247)
	at java.lang.ProcessImpl.start(ProcessImpl.java:134)
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
	... 21 common frames omitted
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:54.055 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:54.055 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, fetch way: log 
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:54.055 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:54.055 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[220] - Begin to kill process process, pid is : 1266
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:59.058 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[225] - Success kill task: 447_1047, pid: 1266
[WI-0][TI-1047] - [INFO] 2024-04-23 08:31:59.059 +0800 o.a.d.s.w.r.o.TaskInstanceKillOperationFunction:[119] - kill task by cancelApplication, taskInstanceId: 1047
[WI-0][TI-1027] - [INFO] 2024-04-23 08:32:07.779 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832027058)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:32:07.798 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832327779)
[WI-0][TI-0] - [ERROR] 2024-04-23 08:32:08.137 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.163 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, processId:1266 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.164 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.164 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.189 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.189 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.189 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.190 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047
[WI-447][TI-1047] - [INFO] 2024-04-23 08:32:08.192 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1047] - [INFO] 2024-04-23 08:32:08.801 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:32:08.804 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832328800)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:32:17.810 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832037082)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:32:17.820 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832337810)
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:27.750 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1048, taskName=search for intake JSON files, firstSubmitTime=1713832347740, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=73, appIds=null, processInstanceId=448, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1048'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083227'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='448'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.753 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832347780
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 448_1048
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1048,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713832347740,
  "startTime" : 1713832347780,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/73/448/1048.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 73,
  "processInstanceId" : 448,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1048"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083227"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "448"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "448_1048",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.788 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.789 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1048 check successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.795 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.798 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.799 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.800 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.800 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1048/448_1048.sh
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:27.804 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1388
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.837 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1048, processInstanceId=448, startTime=1713832347780, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/73/448/1048.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.861 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1048, processInstanceId=448, startTime=1713832347780, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/73/448/1048.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713832347832)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.871 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1048, processInstanceId=448, startTime=1713832347780, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.894 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1048, success=true)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.887 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1048, processInstanceId=448, startTime=1713832347780, workflowInstanceHost=172.18.0.11:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713832347832)
[WI-0][TI-1048] - [WARN] 2024-04-23 08:32:27.902 +0800 o.a.d.s.w.m.MessageRetryRunner:[139] - Retry send message to master error
java.util.ConcurrentModificationException: null
	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:911)
	at java.util.ArrayList$Itr.next(ArrayList.java:861)
	at org.apache.dolphinscheduler.server.worker.message.MessageRetryRunner.run(MessageRetryRunner.java:127)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.903 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1048)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.918 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1048, success=true)
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:27.947 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1048)
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:28.805 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.807 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1048, processId:1388 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.808 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.808 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.808 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.808 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.812 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.812 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1048
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.812 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1048
[WI-448][TI-1048] - [INFO] 2024-04-23 08:32:28.812 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1048] - [INFO] 2024-04-23 08:32:28.827 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1048, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:29.935 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1050, taskName=move to processing, firstSubmitTime=1713832349899, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=73, appIds=null, processInstanceId=448, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1050'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083229'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='448'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.937 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.937 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.941 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.941 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832349941
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.941 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 448_1050
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1050,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713832349899,
  "startTime" : 1713832349941,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/73/448/1050.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 73,
  "processInstanceId" : 448,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1050"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083229"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "448"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "448_1050",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.959 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.975 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.976 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1050 check successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.978 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.983 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.984 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.984 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.984 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.985 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.985 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.985 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if ! grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.986 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:29.986 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1050/448_1050.sh
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:30.001 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1401
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:30.009 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1050] - [INFO] 2024-04-23 08:32:30.846 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1050, success=true)
[WI-0][TI-1050] - [INFO] 2024-04-23 08:32:30.867 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1050)
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:31.014 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	mv: '/local_storage/reddit/processing/386-20240422.json' and '/local_storage/reddit/processing/386-20240422.json' are the same file
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.015 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1050, processId:1401 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1050
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_73/448/1050
[WI-448][TI-1050] - [INFO] 2024-04-23 08:32:31.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1050] - [INFO] 2024-04-23 08:32:31.842 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1050, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:32:51.860 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7443181818181818 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1039] - [INFO] 2024-04-23 08:34:05.368 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832145289)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:34:05.372 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832445368)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:35:14.164 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832213481)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:35:14.168 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832514164)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:09.615 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8050139275766016 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:13.747 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1051, taskName=search for intake JSON files, firstSubmitTime=1713832573723, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=74, appIds=null, processInstanceId=448, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1051'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083613'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='448'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.750 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.750 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.766 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.766 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.767 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832573767
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.767 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 448_1051
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.768 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1051,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713832573723,
  "startTime" : 1713832573767,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/74/448/1051.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 74,
  "processInstanceId" : 448,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1051"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083613"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "448"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "448_1051",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.768 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.768 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.768 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.775 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.776 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.778 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1051 check successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.778 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.782 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.782 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.784 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.785 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.785 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.786 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.786 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}"
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.786 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.786 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1051/448_1051.sh
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:13.793 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1457
[WI-0][TI-1051] - [INFO] 2024-04-23 08:36:14.242 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1051, success=true)
[WI-0][TI-1051] - [INFO] 2024-04-23 08:36:14.262 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1051)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:14.796 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/386-20240422.json)}
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.797 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1051, processId:1457 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.799 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.804 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1051
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.804 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1051
[WI-448][TI-1051] - [INFO] 2024-04-23 08:36:14.804 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1051] - [INFO] 2024-04-23 08:36:15.244 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1051, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:16.400 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1053, taskName=move to processing, firstSubmitTime=1713832576385, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=74, appIds=null, processInstanceId=448, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1053'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083616'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='448'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.401 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.401 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.408 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832576409
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 448_1053
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1053,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713832576385,
  "startTime" : 1713832576409,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/74/448/1053.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 74,
  "processInstanceId" : 448,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nif grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${reddit_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1053"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083616"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "448"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "448_1053",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.409 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.410 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1053 check successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.416 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.416 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.416 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nif grep -q \"${REDDIT_HOME}/processing\" <<< \"${reddit_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi",
  "resourceList" : [ ]
}
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.417 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.417 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
if grep -q "/local_storage/reddit/processing" <<< "${reddit_file_dir}"; then
    mv /local_storage/reddit/processing/386-20240422.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.419 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1053/448_1053.sh
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:16.424 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1471
[WI-0][TI-1053] - [INFO] 2024-04-23 08:36:17.256 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1053, success=true)
[WI-0][TI-1053] - [INFO] 2024-04-23 08:36:17.264 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1053)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:17.430 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.438 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1053, processId:1471 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.440 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.440 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.440 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.441 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.444 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.444 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.445 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1053
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.445 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1053
[WI-448][TI-1053] - [INFO] 2024-04-23 08:36:17.445 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1053] - [INFO] 2024-04-23 08:36:18.257 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1053, success=true)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:18.346 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1054, taskName=spark preprocessing, firstSubmitTime=1713832578338, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=74, appIds=null, processInstanceId=448, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240423'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1054'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240423083618'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='448'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/386-20240422.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240422'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.350 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.351 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.352 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.352 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713832578352
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 448_1054
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1054,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713832578338,
  "startTime" : 1713832578352,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240423/13201021801792/74/448/1054.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 74,
  "processInstanceId" : 448,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master spark://spark-master:7077 \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=512M \\\\\\n    --conf spark.executor.instances=2 \\\\\\n    --conf spark.executor.cores=2 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --files ${raw_file_dir} \\\\\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1054"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423083618"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "448"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/386-20240422.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240422"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "448_1054",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/386-20240422.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.353 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.353 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.354 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.365 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1054 check successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1054/spark_reddit_preprocessing.py)})
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.368 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master spark://spark-master:7077 \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=512M \\\n    --conf spark.executor.instances=2 \\\n    --conf spark.executor.cores=2 \\\n    --conf spark.executor.memory=1G \\\n    --files ${raw_file_dir} \\\n    --name reddit_preprocessing spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}] successfully
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export HADOOP_CONF_DIR=/opt/hadoop-3.4.0/etc/hadoop
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master spark://spark-master:7077 \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=512M \
    --conf spark.executor.instances=2 \
    --conf spark.executor.cores=2 \
    --conf spark.executor.memory=1G \
    --files /local_storage/reddit/processing/386-20240422.json \
    --name reddit_preprocessing spark_reddit_preprocessing.py

[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.369 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1054/448_1054.sh
[WI-448][TI-1054] - [INFO] 2024-04-23 08:36:18.384 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1488
[WI-0][TI-1054] - [INFO] 2024-04-23 08:36:19.266 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1054, success=true)
[WI-0][TI-1054] - [INFO] 2024-04-23 08:36:19.281 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1054)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:19.388 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:21.395 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:22.544 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:21 INFO SparkContext: Running Spark version 3.5.1
	24/04/23 08:36:21 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/23 08:36:21 INFO SparkContext: Java version 1.8.0_402
	24/04/23 08:36:22 INFO ResourceUtils: ==============================================================
	24/04/23 08:36:22 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/23 08:36:22 INFO ResourceUtils: ==============================================================
	24/04/23 08:36:22 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/23 08:36:22 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/23 08:36:22 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
	24/04/23 08:36:22 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/23 08:36:22 INFO SecurityManager: Changing view acls to: default
	24/04/23 08:36:22 INFO SecurityManager: Changing modify acls to: default
	24/04/23 08:36:22 INFO SecurityManager: Changing view acls groups to: 
	24/04/23 08:36:22 INFO SecurityManager: Changing modify acls groups to: 
	24/04/23 08:36:22 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:23.552 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:22 INFO Utils: Successfully started service 'sparkDriver' on port 46867.
	24/04/23 08:36:22 INFO SparkEnv: Registering MapOutputTracker
	24/04/23 08:36:22 INFO SparkEnv: Registering BlockManagerMaster
	24/04/23 08:36:22 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/23 08:36:22 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/23 08:36:22 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/23 08:36:22 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7f561a5b-c41c-45d1-8fb5-50f50ccccc79
	24/04/23 08:36:22 INFO MemoryStore: MemoryStore started with capacity 93.3 MiB
	24/04/23 08:36:22 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/23 08:36:23 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4042. Attempting port 4043.
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4043. Attempting port 4044.
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4044. Attempting port 4045.
	24/04/23 08:36:23 WARN Utils: Service 'SparkUI' could not bind on port 4045. Attempting port 4046.
	24/04/23 08:36:23 INFO Utils: Successfully started service 'SparkUI' on port 4046.
	24/04/23 08:36:23 INFO SparkContext: Added file file:///local_storage/reddit/processing/386-20240422.json at spark://84078e67aaf6:46867/files/386-20240422.json with timestamp 1713832581939
	24/04/23 08:36:23 INFO Utils: Copying /local_storage/reddit/processing/386-20240422.json to /tmp/spark-6f45b81c-493e-41af-bb01-9380183e4cec/userFiles-f44d30cd-ea84-4e3c-8b53-347071d7a76d/386-20240422.json
	24/04/23 08:36:23 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
	24/04/23 08:36:23 INFO TransportClientFactory: Successfully created connection to spark-master/172.18.0.6:7077 after 45 ms (0 ms spent in bootstraps)
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:24.554 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:23 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240423003623-0006
	24/04/23 08:36:23 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42029.
	24/04/23 08:36:23 INFO NettyBlockTransferService: Server created on 84078e67aaf6:42029
	24/04/23 08:36:23 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/23 08:36:23 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 84078e67aaf6, 42029, None)
	24/04/23 08:36:23 INFO BlockManagerMasterEndpoint: Registering block manager 84078e67aaf6:42029 with 93.3 MiB RAM, BlockManagerId(driver, 84078e67aaf6, 42029, None)
	24/04/23 08:36:23 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 84078e67aaf6, 42029, None)
	24/04/23 08:36:23 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 84078e67aaf6, 42029, None)
	24/04/23 08:36:24 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:24.725 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8103448275862069 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:25.555 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	386-20240422.json
	json file /tmp/spark-6f45b81c-493e-41af-bb01-9380183e4cec/userFiles-f44d30cd-ea84-4e3c-8b53-347071d7a76d/386-20240422.json
	24/04/23 08:36:24 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/23 08:36:24 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_74/448/1054/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:26.557 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:26 INFO InMemoryFileIndex: It took 67 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:27.558 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:26 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:30.563 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:30 INFO FileSourceStrategy: Pushed Filters: 
	24/04/23 08:36:30 INFO FileSourceStrategy: Post-Scan Filters: 
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:31.573 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:30 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 351.5 KiB, free 93.0 MiB)
	24/04/23 08:36:30 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.6 KiB, free 92.9 MiB)
	24/04/23 08:36:30 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 84078e67aaf6:42029 (size: 34.6 KiB, free: 93.3 MiB)
	24/04/23 08:36:30 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
	24/04/23 08:36:30 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
	24/04/23 08:36:30 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/23 08:36:30 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/23 08:36:30 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/23 08:36:30 INFO DAGScheduler: Parents of final stage: List()
	24/04/23 08:36:30 INFO DAGScheduler: Missing parents: List()
	24/04/23 08:36:30 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/23 08:36:31 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.5 KiB, free 92.9 MiB)
	24/04/23 08:36:31 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.8 KiB, free 92.9 MiB)
	24/04/23 08:36:31 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 84078e67aaf6:42029 (size: 7.8 KiB, free: 93.3 MiB)
	24/04/23 08:36:31 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/23 08:36:31 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/23 08:36:31 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:35.772 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.737609329446064 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:36:46.596 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:36:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:37:01.633 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:37:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1027] - [INFO] 2024-04-23 08:37:08.509 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832327779)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:37:08.512 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832628508)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:37:09.515 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832328800)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:37:09.522 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832629515)
[WI-0][TI-0] - [INFO] 2024-04-23 08:37:16.665 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:37:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1031] - [INFO] 2024-04-23 08:37:18.532 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832337810)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:37:18.544 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832638532)
[WI-0][TI-0] - [INFO] 2024-04-23 08:37:31.690 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:37:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:37:46.722 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:37:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:01.110 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7027027027027027 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:01.754 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:38:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:04.137 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8853868194842407 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:05.169 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8948717948717948 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:06.173 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9473684210526316 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:07.176 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7935452339809045 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:11.187 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9076517150395778 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:12.199 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8770491803278688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:13.200 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7372881355932204 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:14.204 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.709662314297917 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:15.206 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7107103743429493 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:16.207 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7116822805277562 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:16.768 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:38:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:17.211 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7113589745833012 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:18.218 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7114583921553969 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:19.219 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7101194362944128 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:20.220 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7105737745988898 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:21.222 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.711148805835891 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:22.230 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7112675104169732 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:23.231 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.711644700685504 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:24.232 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7119819250900524 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:25.235 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7123746244998302 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:26.236 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7123074182210936 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:27.238 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.71225174438072 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:28.239 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7116568296292997 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:29.242 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7076200785319285 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:30.245 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7075723580973227 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:31.247 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7067277064047981 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:31.786 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:38:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:32.256 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7065624743999752 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:33.257 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7069008918153887 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:34.258 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7026360768076302 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:35.259 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7020594548894755 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:36.272 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7018441164283163 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:37.274 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7022519273090526 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:38.276 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7013506076004337 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:39.277 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7016413045812413 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:40.279 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7018451106040373 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:41.280 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7018826904462895 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:42.289 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7016538311953253 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:43.291 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7017661730517933 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:44.293 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7003170625209274 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:38:46.808 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:38:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:39:01.832 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:39:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1039] - [INFO] 2024-04-23 08:39:05.925 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832445368)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:39:05.928 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832745925)
[WI-0][TI-0] - [INFO] 2024-04-23 08:39:16.861 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:39:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:39:31.939 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:39:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:39:46.964 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:39:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:40:02.028 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:40:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1043] - [INFO] 2024-04-23 08:40:14.187 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832514164)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:40:14.192 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832814186)
[WI-0][TI-0] - [INFO] 2024-04-23 08:40:17.079 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:40:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:40:32.147 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:40:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:40:46.206 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:40:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:41:01.230 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:41:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:41:16.260 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:41:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:41:21.020 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7001758895685516 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:41:31.287 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:41:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:41:46.307 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:41:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:42:01.341 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:42:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1027] - [INFO] 2024-04-23 08:42:08.716 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832628508)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:42:08.723 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832928716)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:42:09.724 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832629515)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:42:09.728 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832929724)
[WI-0][TI-0] - [INFO] 2024-04-23 08:42:16.362 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:42:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1031] - [INFO] 2024-04-23 08:42:18.761 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832638532)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:42:18.768 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832938761)
[WI-0][TI-0] - [INFO] 2024-04-23 08:42:31.381 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:42:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:42:46.398 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:42:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:43:01.517 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:43:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:43:16.562 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:43:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:43:31.593 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:43:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:43:46.717 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:43:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:44:01.746 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:44:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1039] - [INFO] 2024-04-23 08:44:06.182 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832745925)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:44:06.187 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833046182)
[WI-0][TI-0] - [INFO] 2024-04-23 08:44:16.773 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:44:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:44:31.834 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:44:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:44:46.858 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:44:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:45:01.907 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:45:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1043] - [INFO] 2024-04-23 08:45:14.335 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832814186)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:45:14.341 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833114335)
[WI-0][TI-0] - [INFO] 2024-04-23 08:45:16.977 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:45:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:45:32.044 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:45:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:45:47.084 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:45:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:46:02.351 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:46:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:46:16.371 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:46:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:46:31.400 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:46:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:46:46.429 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:46:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:47:01.455 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:47:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1027] - [INFO] 2024-04-23 08:47:08.882 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832928716)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:47:08.886 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833228882)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:47:09.887 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832929724)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:47:09.896 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833229887)
[WI-0][TI-0] - [INFO] 2024-04-23 08:47:16.516 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:47:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1031] - [INFO] 2024-04-23 08:47:18.932 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713832938761)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:47:18.935 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833238932)
[WI-0][TI-0] - [INFO] 2024-04-23 08:47:31.541 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:47:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:47:46.567 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:47:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:48:01.622 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:48:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:48:16.691 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:48:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:48:31.723 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:48:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:48:46.790 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:48:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:49:01.866 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:49:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1039] - [INFO] 2024-04-23 08:49:06.769 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833046182)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:49:06.773 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833346769)
[WI-0][TI-0] - [INFO] 2024-04-23 08:49:16.894 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:49:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:49:32.028 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:49:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:49:47.057 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:49:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:02.097 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:50:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1043] - [INFO] 2024-04-23 08:50:14.896 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833114335)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:50:14.899 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833414896)
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:17.136 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:50:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:23.758 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7012323006896398 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:24.768 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7075133040594979 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:25.770 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7128480509781496 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:26.771 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7064902972426338 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:27.772 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.70535534623959 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:28.774 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7053525625475713 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:29.775 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[65] - Worker OverLoad: the SystemMemoryUsedPercentage: 0.7047125122184196 is over then the MaxSystemMemoryUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:32.210 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:50:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:50:46.238 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:50:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:51:01.280 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:51:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:51:16.316 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:51:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:51:31.521 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:51:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:51:46.567 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:51:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:52:01.625 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:52:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1027] - [INFO] 2024-04-23 08:52:09.281 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833228882)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:52:09.293 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833529281)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:52:10.295 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833229887)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:52:10.300 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833530295)
[WI-0][TI-0] - [INFO] 2024-04-23 08:52:16.690 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:52:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1031] - [INFO] 2024-04-23 08:52:19.318 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833238932)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:52:19.325 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833539318)
[WI-0][TI-0] - [INFO] 2024-04-23 08:52:31.753 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:52:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:52:46.783 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:52:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:53:01.816 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:53:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:53:16.854 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:53:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:53:31.892 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:53:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:53:46.912 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:53:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:54:01.926 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:54:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1039] - [INFO] 2024-04-23 08:54:07.683 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833346769)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:54:07.686 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833647683)
[WI-0][TI-0] - [INFO] 2024-04-23 08:54:16.946 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:54:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:54:31.966 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:54:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:54:33.976 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7983651226158038 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-23 08:54:47.004 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:54:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:55:02.022 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:55:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1043] - [INFO] 2024-04-23 08:55:15.844 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833414896)
[WI-0][TI-1043] - [INFO] 2024-04-23 08:55:15.853 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1043, processInstanceId=446, status=9, startTime=1713832166368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1043.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1043, endTime=1713832212544, processId=1119, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833715844)
[WI-0][TI-0] - [INFO] 2024-04-23 08:55:17.035 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:55:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:55:32.049 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:55:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:55:47.079 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:55:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:56:02.129 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:56:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:56:17.158 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:56:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:56:32.188 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:56:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:56:46.212 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:56:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:57:01.289 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:57:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1027] - [INFO] 2024-04-23 08:57:10.103 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833529281)
[WI-0][TI-1027] - [INFO] 2024-04-23 08:57:10.111 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1027, processInstanceId=444, status=9, startTime=1713830777271, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/444/1027.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/444/1027, endTime=1713830944952, processId=423, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833830103)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:57:11.113 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833530295)
[WI-0][TI-1047] - [INFO] 2024-04-23 08:57:11.117 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1047, processInstanceId=447, status=9, startTime=1713832268816, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/72/447/1047.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_72/447/1047, endTime=1713832328164, processId=1266, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833831113)
[WI-0][TI-0] - [INFO] 2024-04-23 08:57:16.298 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:57:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1031] - [INFO] 2024-04-23 08:57:20.132 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833539318)
[WI-0][TI-1031] - [INFO] 2024-04-23 08:57:20.140 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1031, processInstanceId=445, status=9, startTime=1713830960739, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/68/445/1031.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_68/445/1031, endTime=1713831134978, processId=592, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833840132)
[WI-0][TI-0] - [INFO] 2024-04-23 08:57:31.534 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:57:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:57:46.568 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:57:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:58:01.629 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:58:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:58:16.735 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:58:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:58:31.794 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:58:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:58:46.810 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:58:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:59:01.840 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:59:01 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-1039] - [INFO] 2024-04-23 08:59:07.876 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833647683)
[WI-0][TI-1039] - [INFO] 2024-04-23 08:59:07.881 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionFinishEvent(taskInstanceId=1039, processInstanceId=446, status=9, startTime=1713832111260, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, logPath=/opt/dolphinscheduler/logs/20240423/13201021801792/70/446/1039.log, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_70/446/1039, endTime=1713832144310, processId=976, appIds=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}], eventCreateTime=0, eventSendTime=1713833947876)
[WI-0][TI-0] - [INFO] 2024-04-23 08:59:16.882 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:59:16 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:59:31.956 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:59:31 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
[WI-0][TI-0] - [INFO] 2024-04-23 08:59:46.539 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/23 08:59:46 WARN TaskSchedulerImpl: Initial job has not accepted any resources; check your cluster UI to ensure that workers are registered and have sufficient resources
