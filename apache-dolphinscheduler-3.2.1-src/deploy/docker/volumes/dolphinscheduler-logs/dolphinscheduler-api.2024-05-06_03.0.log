[ERROR] 2024-05-06 03:13:29.675 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:13:29.676 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:13:29.715 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:13:36.396 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:13:36.397 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:13:36.407 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:13:55.955 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:13:55.957 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:13:55.959 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:14:11.640 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:14:11.642 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:14:11.644 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:14:18.351 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:14:18.352 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:14:18.358 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:14:23.957 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:14:23.958 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:14:23.962 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:15:00.814 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5403] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:15:00.815 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:15:00.828 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[INFO] 2024-05-06 03:15:31.997 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[858] - The task has not changed, so skip
[INFO] 2024-05-06 03:15:31.998 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:59.
[INFO] 2024-05-06 03:15:32.004 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:60.
[INFO] 2024-05-06 03:15:32.008 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:60.
[ERROR] 2024-05-06 03:19:26.190 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5341] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:19:26.192 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:19:26.194 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:19:37.512 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5874 chars]; line: 1, column: 5341] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:19:37.513 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:19:37.516 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:19:49.523 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --boot"[truncated 5803 chars]; line: 1, column: 5270] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:19:49.523 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:19:49.524 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:20:03.690 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --boot"[truncated 5781 chars]; line: 1, column: 5270] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:20:03.694 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:20:03.700 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[ERROR] 2024-05-06 03:20:35.972 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --boot"[truncated 5085 chars]; line: 1, column: 4574] (through reference chain: java.util.ArrayList[3]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:20:35.973 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \n# if [ -z \"$filtered_data_message\" ]; then\n#     filtered_data_message=null\n#     is_message_empty=1\n# else\n#     is_message_empty=0\n# fi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\n# echo \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"code":13426451158240,"delayTime":"0","description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","environmentCode":13054701835136,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"parse the message","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskPriority":"MEDIUM","taskType":"PYTHON","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":35,"id":919},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:20:35.979 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \n# if [ -z \"$filtered_data_message\" ]; then\n#     filtered_data_message=null\n#     is_message_empty=1\n# else\n#     is_message_empty=0\n# fi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\n# echo \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"code":13426451158240,"delayTime":"0","description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","environmentCode":13054701835136,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"parse the message","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskPriority":"MEDIUM","taskType":"PYTHON","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":35,"id":919},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504639412320,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504644500704,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"","nextNode":13426451158240}],"nextNode":13504639412320}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[INFO] 2024-05-06 03:20:57.070 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:60.
[INFO] 2024-05-06 03:20:57.079 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:61.
[INFO] 2024-05-06 03:20:57.104 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:61.
[ERROR] 2024-05-06 03:22:18.352 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `int` from String "0.1": not a valid `int` value
 at [Source: (String)"[{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data"[truncated 5872 chars]; line: 1, column: 6026] (through reference chain: java.util.ArrayList[4]->org.apache.dolphinscheduler.dao.entity.TaskDefinitionLog["failRetryInterval"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1991)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:1219)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:768)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseIntPrimitive(StdDeserializer.java:747)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:529)
	at com.fasterxml.jackson.databind.deser.std.NumberDeserializers$IntegerDeserializer.deserialize(NumberDeserializers.java:506)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:355)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.generateTaskDefinitionList(ProcessDefinitionServiceImpl.java:419)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl.updateProcessDefinition(ProcessDefinitionServiceImpl.java:777)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$FastClassBySpringCGLIB$$e8e34ed9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.apache.dolphinscheduler.api.service.impl.ProcessDefinitionServiceImpl$$EnhancerBySpringCGLIB$$8bdbbf0b.updateProcessDefinition(<generated>)
	at org.apache.dolphinscheduler.api.controller.ProcessDefinitionController.updateProcessDefinition(ProcessDefinitionController.java:248)
	at sun.reflect.GeneratedMethodAccessor799.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:920)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:520)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:90)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:22:18.354 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[421] - Generate task definition list failed, the given taskDefinitionJson is invalided: [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}]
[ERROR] 2024-05-06 03:22:18.356 +0800 o.a.d.a.e.ApiExceptionHandler:[40] - org.apache.dolphinscheduler.api.controller.ProcessDefinitionController#updateProcessDefinition[12 args] Meet a ServiceException: data [{"code":13433255983872,"delayTime":"0","description":"Read the filtered data from the filtered data Kafka topics.","environmentCode":13314181162272,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"consume filtered data","taskGroupId":null,"taskGroupPriority":null,"taskParams":{"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""},{"prop":"is_message_empty","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n    --bootstrap-server kafka:9092 \\\n    --topic ${input_topic} \\\n    --max-messages 1 \\\n    --from-beginning \\\n    --group filtered_data_consumer \\\n    --timeout-ms 15000)\n\n# check if the message is empty. If message is empty, then set is_message_empty to 1 \nif [ -z \"$filtered_data_message\" ]; then\n    filtered_data_message=null\n    is_message_empty=1\nelse\n    is_message_empty=0\nfi\n\necho \"#{setValue(filtered_data_message=${filtered_data_message})}\"\necho \"#{setValue(is_message_empty=${is_message_empty})}\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","version":7,"id":899},{"id":919,"code":13426451158240,"name":"parse the message","version":35,"description":"Parse the message to extract each individual value and pass them as parameters to the downstream SQL node for the parameterized query.","projectCode":13010050770016,"userId":1,"taskType":"PYTHON","taskParams":{"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]},"taskParamList":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"taskParamMap":{"datetime":"","context":"","type":"","content":"","url":"","authors":""},"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 01:19:14","updateTime":"2024-05-06 02:13:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:13:26","dependence":""},{"id":920,"code":13427698681952,"name":"persist in postgresql","version":20,"description":"Insert the data entries into the filtered_data_persistence table","projectCode":13010050770016,"userId":1,"taskType":"SQL","taskParams":{"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10},"taskParamList":[],"taskParamMap":null,"flag":"YES","isCache":"NO","taskPriority":"MEDIUM","userName":null,"projectName":null,"workerGroup":"default","environmentCode":13054701835136,"failRetryTimes":3,"failRetryInterval":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":null,"timeout":0,"delayTime":0,"resourceIds":null,"createTime":"2024-04-29 03:59:14","updateTime":"2024-05-06 02:31:26","modifyBy":null,"taskGroupId":0,"taskGroupPriority":0,"cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH","operator":1,"operateTime":"2024-05-06 02:31:26","dependence":""},{"code":13504574550240,"delayTime":"0","description":"Checks if the message is empty. \n\nEmpty:\nWorkflow ends\n\nNot empty:\nParse the message and persist in database","environmentCode":13054701835136,"failRetryInterval":"0","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"check if message empty","taskParams":{"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":13426451158240}],"nextNode":13504600516704}},"taskPriority":"MEDIUM","taskType":"SWITCH","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"},{"code":13504600516704,"delayTime":"0","description":"Ends workflow when a new message has not come in yet","environmentCode":13054701835136,"failRetryInterval":"0.1","failRetryTimes":"3","flag":"YES","isCache":"NO","name":"end workflow","taskParams":{"localParams":[],"rawScript":"echo \"End Workflow\"","resourceList":[]},"taskPriority":"MEDIUM","taskType":"SHELL","timeout":0,"timeoutFlag":"CLOSE","timeoutNotifyStrategy":"","workerGroup":"default","cpuQuota":-1,"memoryMax":-1,"taskExecuteType":"BATCH"}] not valid
[INFO] 2024-05-06 03:22:28.175 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:61.
[INFO] 2024-05-06 03:22:28.180 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:62.
[INFO] 2024-05-06 03:22:28.188 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:62.
[INFO] 2024-05-06 03:22:42.024 +0800 o.a.d.a.s.i.ProjectPreferenceServiceImpl:[97] - Project preference is updated and id is :2
[INFO] 2024-05-06 03:34:28.448 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:62.
[INFO] 2024-05-06 03:34:28.451 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:63.
[INFO] 2024-05-06 03:34:28.456 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:63.
[INFO] 2024-05-06 03:34:42.308 +0800 o.a.d.a.s.i.ExecutorServiceImpl:[278] - Create command complete, processDefinitionCode:13426477386080, commandCount:1.
[ERROR] 2024-05-06 03:36:30.865 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[INFO] 2024-05-06 03:36:46.622 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3805, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/63/1017/3805.log
[INFO] 2024-05-06 03:36:46.726 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3805, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/63/1017/3805.log
[INFO] 2024-05-06 03:45:59.173 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:63.
[INFO] 2024-05-06 03:45:59.178 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:64.
[INFO] 2024-05-06 03:45:59.185 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:64.
[INFO] 2024-05-06 03:46:03.520 +0800 o.a.d.a.s.i.ExecutorServiceImpl:[278] - Create command complete, processDefinitionCode:13426477386080, commandCount:1.
[ERROR] 2024-05-06 03:46:37.490 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:46:37.495 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[INFO] 2024-05-06 03:46:44.857 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3808, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/64/1018/3808.log
[INFO] 2024-05-06 03:46:45.092 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3808, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/64/1018/3808.log
[INFO] 2024-05-06 03:51:51.139 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:64.
[INFO] 2024-05-06 03:51:51.142 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:65.
[INFO] 2024-05-06 03:51:51.151 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:65.
[INFO] 2024-05-06 03:51:55.583 +0800 o.a.d.a.s.i.ExecutorServiceImpl:[278] - Create command complete, processDefinitionCode:13426477386080, commandCount:1.
[ERROR] 2024-05-06 03:52:20.870 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:52:20.872 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:52:20.875 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[INFO] 2024-05-06 03:52:29.331 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3811, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/65/1019/3811.log
[INFO] 2024-05-06 03:52:29.468 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3811, taskInstanceName:consume filtered data, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/65/1019/3811.log
[INFO] 2024-05-06 03:54:26.966 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[888] - Process definition needs to be updated, projectCode:13010050770016, processCode:13426477386080, processVersion:65.
[INFO] 2024-05-06 03:54:26.971 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[898] - Update process definition complete, processCode:13426477386080, processVersion:66.
[INFO] 2024-05-06 03:54:26.998 +0800 o.a.d.a.s.i.ProcessDefinitionServiceImpl:[906] - Update process task relations complete, projectCode:13010050770016, processCode:13426477386080, processVersion:66.
[ERROR] 2024-05-06 03:54:40.365 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:40.367 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:40.371 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:46.338 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:46.367 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:46.372 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:51.768 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:51.780 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:54:51.782 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[INFO] 2024-05-06 03:55:04.544 +0800 o.a.d.a.s.i.ExecutorServiceImpl:[278] - Create command complete, processDefinitionCode:13426477386080, commandCount:1.
[ERROR] 2024-05-06 03:55:10.399 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:55:10.401 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:55:10.403 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:55:18.567 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": \"premiumplatinum\",\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n\t\"datetime\": \"2024-04-21 22:10:42\"\n}"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":0,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"0"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"{\n\t\"authors\": \"premiumplatinum\",\n\t\"content\": \"singapore is stupid\",\n\t\"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n\t\"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n\t\"type\": \"post\",\n"[truncated 273 chars]; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:55:18.569 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[ERROR] 2024-05-06 03:55:18.570 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"is_message_empty","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":"null"}],"dependRelation":null,"relation":null,"nextNode":[13504600516704],"resultConditionLocation":1,"dependTaskList":[{"condition":"${is_message_empty}==0","nextNode":[13426451158240]},{"condition":null,"nextNode":[13504600516704]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at sun.reflect.GeneratedMethodAccessor510.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.commons.beanutils.BeanMap.get(BeanMap.java:415)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:606)
	at org.apache.commons.beanutils.BeanMap$12.next(BeanMap.java:600)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1044)
	at org.apache.dolphinscheduler.common.utils.CollectionUtils.getListByExclusion(CollectionUtils.java:65)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl.queryTaskListPaging(TaskInstanceServiceImpl.java:203)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$FastClassBySpringCGLIB$$a1a6235.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at org.apache.dolphinscheduler.api.service.impl.TaskInstanceServiceImpl$$EnhancerBySpringCGLIB$$80e9f29f.queryTaskListPaging(<generated>)
	at org.apache.dolphinscheduler.api.controller.TaskInstanceController.queryTaskListPaging(TaskInstanceController.java:119)
	at sun.reflect.GeneratedMethodAccessor768.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:497)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:584)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.lang.Thread.run(Thread.java:750)
[INFO] 2024-05-06 03:56:44.358 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3817, taskInstanceName:persist in postgresql, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/66/1020/3817.log
[INFO] 2024-05-06 03:56:44.562 +0800 o.a.d.a.s.i.LoggerServiceImpl:[189] - Query task instance log, taskInstanceId:3817, taskInstanceName:persist in postgresql, host: 172.18.1.1:1234, logPath:/opt/dolphinscheduler/logs/20240506/13426477386080/66/1020/3817.log
