[WI-0][TI-0] - [INFO] 2024-05-04 02:00:01.465 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7138461538461539 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:01.483 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:01.935 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7138461538461539 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:03.325 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:05.493 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7645348837209303 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:05.494 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:05.988 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7645348837209303 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:08.342 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:13.383 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:18.397 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:23.435 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:24.591 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7323076923076923 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:24.591 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:25.127 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7323076923076923 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:28.475 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:30.612 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9072463768115941 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:30.613 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:31.171 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9072463768115941 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:31.617 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7292213308164228 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:31.618 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:32.197 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7292213308164228 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:33.547 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:33.649 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8698060941828255 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:33.649 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:34.249 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8698060941828255 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:34.651 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7129909365558912 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:34.651 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:35.262 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7129909365558912 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:38.606 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:38.680 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8294797687861273 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:38.684 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:39.302 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8294797687861273 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:41.696 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.720 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.721 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.721 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:41.721 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 11
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 11, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.727 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.728 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.735 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.737 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.739 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2779, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:41.748 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.748 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.749 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:41.749 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:41.749 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:41.755 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:41.772 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2779, processInstanceId=884, startTime=1714759241761, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.014 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.028 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.034 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.060 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2779, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.060 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.060 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.069 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:42.069 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.110 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2779, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.111 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:42.808 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=Sat May 04 02:00:42 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2779, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, processId=1621, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.014 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=Sat May 04 02:00:42 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2779, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, processId=1621, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.022 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2779, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.022 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2779, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:41 GMT+08:00 2024, endTime=Sat May 04 02:00:42 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2779, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2779.log, processId=1621, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:43.022 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.023 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2779, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.024 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.024 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.024 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.024 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.030 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.032 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2779] - [INFO] 2024-05-04 02:00:43.034 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2780, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.037 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:00:41 GMT+08:00 2024
Submit Time:            Sat May 04 02:00:41 GMT+08:00 2024
Start Time:             Sat May 04 02:00:41 GMT+08:00 2024
End Time:               Sat May 04 02:00:42 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:00:43.038 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2780, taskName=switch, firstSubmitTime=1714759243032, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=14, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2780'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504020043'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_stor/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.039 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.052 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759243053
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2780
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2780,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759243032,
  "startTime" : 1714759243053,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 14,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2780"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504020043"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_stor/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2780",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_stor/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:43.051 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:43.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2780, processInstanceId=884, startTime=1714759243053, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.058 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.058 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.058 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.059 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}] successfully
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.059 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.059 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.059 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.059 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.060 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"'local_stor/'"
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.060 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"'local_stor/'" == "local_storage" successfully
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.073 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "'local_stor/'" == "local_storage" successfully: false
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.074 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.074 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.074 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.074 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.074 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.075 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.076 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:43 GMT+08:00 2024, endTime=Sat May 04 02:00:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.078 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.079 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:43.079 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:43.641 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.015 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.018 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.018 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:00:44.021 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=506), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2780] - [ERROR] 2024-05-04 02:00:44.021 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.021 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:43 GMT+08:00 2024, endTime=Sat May 04 02:00:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:00:44.024 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=507), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2780] - [WARN] 2024-05-04 02:00:44.025 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2780
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.025 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2780, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.025 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2780, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:43 GMT+08:00 2024, endTime=Sat May 04 02:00:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2780.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:44.025 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2780, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.058 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.058 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.058 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.058 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.064 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.065 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.065 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.065 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2780] - [INFO] 2024-05-04 02:00:44.066 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2781, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:44.074 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.074 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.074 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.074 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.075 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.075 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:00:44.075 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:00:43 GMT+08:00 2024
Submit Time:            Sat May 04 02:00:43 GMT+08:00 2024
Start Time:             Sat May 04 02:00:43 GMT+08:00 2024
End Time:               Sat May 04 02:00:43 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:00:44.082 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:44.088 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2781, processInstanceId=884, startTime=1714759244084, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.015 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.020 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.020 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.026 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2781, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.026 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.026 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.040 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2781, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.040 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.040 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:45.040 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:45.127 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=Sat May 04 02:00:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2781, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, processId=1632, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.015 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=Sat May 04 02:00:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2781, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, processId=1632, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.021 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2781, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.021 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2781, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:00:44 GMT+08:00 2024, endTime=Sat May 04 02:00:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_14/884/2781, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/14/884/2781.log, processId=1632, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_stor/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:46.021 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.022 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2781, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.022 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.023 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.023 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.023 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.027 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.027 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.033 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.034 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2781] - [INFO] 2024-05-04 02:00:46.034 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:00:44 GMT+08:00 2024
Submit Time:            Sat May 04 02:00:44 GMT+08:00 2024
Start Time:             Sat May 04 02:00:44 GMT+08:00 2024
End Time:               Sat May 04 02:00:45 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:00:46.034 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:00:46.034 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:00:46.035 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 11
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:00:41 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:00:41 GMT+08:00 2024
End Time:                  Sat May 04 02:00:46 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:00:46.036 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:48.799 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:53.816 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:58.832 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:00:59.818 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7220856885393626 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:00:59.822 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:00.583 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7220856885393626 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:00.823 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7736389684813754 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:01:00.824 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:01.597 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7736389684813754 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:03.846 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:08.872 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:13.901 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:18.927 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:23.943 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:28.971 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:33.987 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:39.000 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:44.018 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:49.035 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:54.050 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:01:59.060 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:04.077 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:09.133 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:14.212 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:19.224 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:24.255 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:29.269 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:34.288 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:39.308 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:44.344 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:44.406 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.809667673716012 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:44.412 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:45.237 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.809667673716012 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:49.364 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:53.478 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7363160049119933 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:53.502 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:54.323 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7363160049119933 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:54.388 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:57.530 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7436708860759493 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:57.530 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:58.351 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7436708860759493 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:58.537 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7507507507507508 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:58.537 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:58.955 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714759377836, cpuUsage=0.7830188679245282, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5567541998447894, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:58.958 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:59.373 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7507507507507508 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:59.420 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:02:59.537 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7028571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:02:59.538 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:00.374 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7028571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:00.539 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:01.546 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7005988023952096 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:01.560 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:02.395 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7005988023952096 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:02.561 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:03.562 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:04.488 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 31/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:04.572 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:05.577 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:06.579 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7198795180722892 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:06.579 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:07.449 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7198795180722892 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:07.584 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7843749999999999 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:07.585 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:08.480 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7843749999999999 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:08.586 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:08.964 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714759386944, cpuUsage=0.791044776119403, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5623215827751535, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:08.968 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:09.587 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:09.645 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:10.588 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:11.590 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:12.593 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:13.607 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:14.609 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:14.658 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:15.611 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:16.618 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:17.620 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:03:18.622 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:18.988 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.632 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 6ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.649 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.649 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.649 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.649 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.650 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 12
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.650 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 12, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.653 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.653 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.657 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.662 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.666 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2782, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:19.681 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.681 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.682 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:19.682 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.682 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.690 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 16/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.696 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:19.706 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2782, processInstanceId=884, startTime=1714759399698, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.508 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.515 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.525 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2782, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.525 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.526 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.535 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:20.535 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.617 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2782, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.618 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:20.758 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=Sat May 04 02:03:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2782, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, processId=1674, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.509 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=Sat May 04 02:03:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2782, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, processId=1674, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.519 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2782, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.520 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2782, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:19 GMT+08:00 2024, endTime=Sat May 04 02:03:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2782, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2782.log, processId=1674, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:21.520 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.528 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2782, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.528 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.528 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.528 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.529 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.538 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.539 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.539 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.541 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2782] - [INFO] 2024-05-04 02:03:21.543 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2783, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:21.554 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:03:19 GMT+08:00 2024
Submit Time:            Sat May 04 02:03:19 GMT+08:00 2024
Start Time:             Sat May 04 02:03:19 GMT+08:00 2024
End Time:               Sat May 04 02:03:20 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:03:21.558 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2783, taskName=switch, firstSubmitTime=1714759401542, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=15, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2783'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504020321'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_store.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.559 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.564 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.564 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.564 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.564 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759401564
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.564 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2783
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.565 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2783,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759401542,
  "startTime" : 1714759401564,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 15,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2783"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504020321"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_store.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2783",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_store.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:21.566 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:21.567 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2783, processInstanceId=884, startTime=1714759401564, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.567 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}] successfully
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.568 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"'local_store.json'"
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.569 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"'local_store.json'" == "local_storage" successfully
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.574 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "'local_store.json'" == "local_storage" successfully: false
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.574 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.575 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.575 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.576 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:21 GMT+08:00 2024, endTime=Sat May 04 02:03:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.577 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.578 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:21.578 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.511 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.523 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:03:22.528 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=519), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2783] - [ERROR] 2024-05-04 02:03:22.529 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.529 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:21 GMT+08:00 2024, endTime=Sat May 04 02:03:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:03:22.533 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=520), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2783] - [WARN] 2024-05-04 02:03:22.534 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2783
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.534 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2783, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.534 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2783, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:21 GMT+08:00 2024, endTime=Sat May 04 02:03:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2783.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:22.534 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.574 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2783, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.574 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.574 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.575 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.575 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.588 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.592 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2783] - [INFO] 2024-05-04 02:03:22.594 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2784, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:22.601 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:03:22.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:03:21 GMT+08:00 2024
Submit Time:            Sat May 04 02:03:21 GMT+08:00 2024
Start Time:             Sat May 04 02:03:21 GMT+08:00 2024
End Time:               Sat May 04 02:03:21 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:03:22.623 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:22.631 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2784, processInstanceId=884, startTime=1714759402611, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.529 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.536 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.536 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.583 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2784, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.584 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.585 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.613 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2784, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.617 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.627 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:23.629 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:23.711 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=Sat May 04 02:03:23 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2784, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, processId=1685, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.531 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=Sat May 04 02:03:23 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2784, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, processId=1685, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.546 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2784, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.547 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2784, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:03:22 GMT+08:00 2024, endTime=Sat May 04 02:03:23 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_15/884/2784, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/15/884/2784.log, processId=1685, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:24.547 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2784, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.591 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.591 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.592 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.592 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.607 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.616 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.616 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2784] - [INFO] 2024-05-04 02:03:24.618 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:03:22 GMT+08:00 2024
Submit Time:            Sat May 04 02:03:22 GMT+08:00 2024
Start Time:             Sat May 04 02:03:22 GMT+08:00 2024
End Time:               Sat May 04 02:03:23 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:03:24.618 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:03:24.618 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:03:24.635 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 12
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:03:19 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:03:19 GMT+08:00 2024
End Time:                  Sat May 04 02:03:24 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:03:24.636 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:24.722 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:29.743 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:34.763 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:39.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:44.795 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:49.811 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:54.859 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:03:59.884 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:02.554 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9166666666666666 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:04:02.569 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:03.525 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9166666666666666 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:04.899 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:10.004 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:15.045 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:20.062 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:25.076 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:30.087 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:33.660 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:33.703 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:04:33.704 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:04:33.704 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 02:04:33.704 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:04:33.705 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 02:04:33.705 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:04:33.705 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 02:04:33.705 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:04:33.706 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:33.706 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:9ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:35.109 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:40.128 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:45.160 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:50.175 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:04:55.245 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:00.315 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:01.071 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7363636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:01.072 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:01.799 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7363636363636364 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:03.089 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7946428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:03.089 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:03.906 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7946428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:05.092 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7966101694915254 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:05.093 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:05.361 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:05.949 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7966101694915254 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:06.095 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8785310734463277 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:06.095 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:06.958 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8785310734463277 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:10.110 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7597765363128491 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:10.111 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:10.572 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:10.977 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7597765363128491 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:11.112 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.899135446685879 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:05:11.112 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:12.021 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.899135446685879 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:15.629 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:20.653 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:25.666 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:30.712 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:35.738 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:40.758 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:45.769 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:50.810 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:05:55.826 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:00.891 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:05.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:10.967 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:15.987 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:21.005 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:26.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:31.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:36.085 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:38.827 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:39.296 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:39.833 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:40.835 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:41.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:41.844 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:42.845 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:43.846 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:44.853 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:45.860 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:46.127 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:46.865 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:47.870 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:06:48.871 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:49.347 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:51.142 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:06:56.162 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:01.174 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:06.192 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:07.939 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:07:07.939 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:11.252 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:16.270 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:21.286 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:26.025 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7673716012084593 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:26.035 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7673716012084593 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:07:26.036 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:26.300 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:28.039 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.739766081871345 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:07:28.040 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:28.085 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.739766081871345 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:30.094 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.739946380697051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:07:30.095 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:30.165 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.739946380697051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:31.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:36.520 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:41.535 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:46.548 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:51.568 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:07:56.589 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:01.602 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:06.644 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:08.366 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7317784256559766 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:08.437 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7317784256559766 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:08.438 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:11.418 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7439759036144578 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:11.453 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7439759036144578 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:11.453 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:11.729 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:12.432 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8813559322033898 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:12.454 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8813559322033898 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:12.454 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:13.434 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.886986301369863 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:13.457 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.886986301369863 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:13.457 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:14.435 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327327327327328 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:14.457 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327327327327328 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:14.458 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:15.442 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7529325513196481 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:15.459 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7529325513196481 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:15.459 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:16.444 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8262271062271062 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:16.463 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8262271062271062 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:16.468 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:16.809 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 36/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:17.449 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9802658648520336 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:17.469 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9802658648520336 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:17.471 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:18.450 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7983197358197358 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:18.473 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7983197358197358 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:18.474 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.475 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.499 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.499 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.499 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.500 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.500 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 13
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.500 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 13, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.506 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.507 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.509 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.510 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2785, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.515 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.515 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.517 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:19.517 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.517 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.522 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.529 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2785, processInstanceId=884, startTime=1714759699525, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:19.531 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714759691489, cpuUsage=0.7388724035608308, jvmMemoryUsage=0.034368101755777994, memoryUsage=0.557589307284344, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.557 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.561 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.562 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.573 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2785, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:19.581 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2785, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:19.664 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:20.564 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=Sat May 04 02:08:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_17/884/2785, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, processId=1754, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=Sat May 04 02:08:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_17/884/2785, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, processId=1754, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.598 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2785, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.598 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2785, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:19 GMT+08:00 2024, endTime=Sat May 04 02:08:20 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_17/884/2785, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2785.log, processId=1754, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:21.598 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.615 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2785, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.616 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.616 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.616 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.617 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.635 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.635 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.637 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2785] - [INFO] 2024-05-04 02:08:21.641 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2786, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.662 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:21.664 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2786, taskName=switch, firstSubmitTime=1714759701637, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=17, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2786'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504020821'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local/local_store.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.664 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.666 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:21.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:19 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:19 GMT+08:00 2024
Start Time:             Sat May 04 02:08:19 GMT+08:00 2024
End Time:               Sat May 04 02:08:20 GMT+08:00 2024

[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.665 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:21.674 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.675 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.758 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.758 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759701758
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.758 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2786
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.771 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2786,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759701637,
  "startTime" : 1714759701758,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 17,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2786"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504020821"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local/local_store.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2786",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local/local_store.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.775 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.775 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.777 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:21.785 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2786, processInstanceId=884, startTime=1714759701758, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.801 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.801 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.802 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}] successfully
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.803 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.804 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local/local_store.json"
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local/local_store.json" == "local_storage" successfully
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.818 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local/local_store.json" == "local_storage" successfully: false
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.818 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.819 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.820 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.846 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:21 GMT+08:00 2024, endTime=Sat May 04 02:08:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.857 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.857 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:21.858 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:21.871 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:22.467 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7990068381634646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:22.504 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7990068381634646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:22.504 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.566 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.571 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:08:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:22.578 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=532), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2786] - [ERROR] 2024-05-04 02:08:22.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:08:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:21 GMT+08:00 2024, endTime=Sat May 04 02:08:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:22.593 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=533), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 52, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2786] - [WARN] 2024-05-04 02:08:22.596 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2786
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.597 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2786, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.597 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2786, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:08:21 GMT+08:00 2024, endTime=Sat May 04 02:08:21 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/17/884/2786.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:22.597 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.667 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2786, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.667 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.667 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.668 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.668 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.688 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.692 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2786] - [INFO] 2024-05-04 02:08:22.695 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2787, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:22.701 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:22.701 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: zxc failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:22.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:21 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:21 GMT+08:00 2024
Start Time:             Sat May 04 02:08:21 GMT+08:00 2024
End Time:               Sat May 04 02:08:21 GMT+08:00 2024

[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.566 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2787, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:22 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2787] - [WARN] 2024-05-04 02:08:23.573 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2787
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.573 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2787, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2787, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:22 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:23.574 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2787, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.585 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.585 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.585 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.587 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.588 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.588 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.591 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2787] - [INFO] 2024-05-04 02:08:23.595 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2788, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:23.611 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:23.611 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: zxc failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:23.615 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:23.615 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:23.615 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:23.615 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:22 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:22 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:08:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:08:24.504 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7113095238095237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:24.508 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7113095238095237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:24.509 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2788, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:23 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2788] - [WARN] 2024-05-04 02:08:24.575 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2788
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.575 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2788, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.576 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2788, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:23 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:24.576 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2788, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.626 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2788] - [INFO] 2024-05-04 02:08:24.629 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2789, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:24.641 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:24.641 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: zxc failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:24.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:24.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:24.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:24.643 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:23 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:23 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:08:23 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:08:25.510 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7259036144578314 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:25.511 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:25.521 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7259036144578314 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2789, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:24 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2789] - [WARN] 2024-05-04 02:08:25.575 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2789
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.575 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2789, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2789, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:24 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:25.576 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.637 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2789, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.640 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.640 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.640 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.649 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.650 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.651 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.662 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2789] - [INFO] 2024-05-04 02:08:25.665 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2790, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:25.696 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:25.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:25.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:25.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:08:25.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:24 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:24 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:08:24 GMT+08:00 2024

[WI-0][TI-0] - [ERROR] 2024-05-04 02:08:25.697 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: zxc failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:26.513 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7746478873239436 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:08:26.513 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:26.522 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7746478873239436 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2790, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:25 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2790] - [WARN] 2024-05-04 02:08:26.573 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2790
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.574 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2790, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.574 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2790, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:08:25 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local/local_store.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:26.574 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2790, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.649 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.649 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.649 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.649 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.651 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.652 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.652 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.652 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.652 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2790] - [INFO] 2024-05-04 02:08:26.657 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:08:25 GMT+08:00 2024
Submit Time:            Sat May 04 02:08:25 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:08:25 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:08:26.657 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:08:26.658 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:08:26.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 13
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:08:19 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:08:19 GMT+08:00 2024
End Time:                  Sat May 04 02:08:26 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:08:26.660 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:26.885 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:31.896 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:34.540 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7507762635846127 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:36.910 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:41.992 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:47.105 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:52.177 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:08:57.194 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:02.221 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:07.235 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:12.256 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:17.271 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:22.298 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:27.314 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:32.340 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:37.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:42.373 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:47.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:52.408 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:09:57.430 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:02.450 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:07.464 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:12.518 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:17.534 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:22.552 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:27.574 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:32.600 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:37.615 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:42.641 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:47.673 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:52.688 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:10:57.706 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:02.723 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:05.751 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0357142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:11:05.752 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:06.669 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0357142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:07.744 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:11:10.012 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714759869690, cpuUsage=0.7543352601156069, jvmMemoryUsage=0.034368101755777994, memoryUsage=0.5545403697895509, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:12.823 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:17.859 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:22.875 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:27.901 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:32.994 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:38.055 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:40.930 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718475073313783 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:11:40.931 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:41.871 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718475073313783 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:43.133 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:48.158 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:53.188 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:11:58.239 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:03.252 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:08.271 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:13.305 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:18.084 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8121387283236995 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:18.095 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8121387283236995 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:18.097 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:18.325 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:20.118 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:20.167 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:21.137 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:22.154 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:23.156 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9002849002849004 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:23.157 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:23.185 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9002849002849004 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:23.347 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:24.162 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7086834733893557 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:24.168 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:24.206 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7086834733893557 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:25.170 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:26.170 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7228571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:26.170 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:26.226 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7228571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:27.171 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:28.176 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.81875 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:28.177 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:28.351 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.81875 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:28.425 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:29.178 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:30.179 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:33.208 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.76875 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:33.219 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:33.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.76875 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:33.468 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:34.220 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7565982404692082 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:34.221 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:34.461 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7565982404692082 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:35.223 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7390029325513197 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:35.223 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:35.461 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7390029325513197 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:36.228 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.282 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:36.282 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.282 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.284 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.284 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 14
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.284 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 14, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.290 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.290 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.296 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.296 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.298 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.301 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2791, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:36.310 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:36.311 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.312 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.314 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:36.314 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:36.315 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:36.319 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2791, processInstanceId=884, startTime=1714759956312, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.018 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.027 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.028 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.036 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2791, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.037 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.037 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.067 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:37.074 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.097 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2791, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.097 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:37.284 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7967032967032968 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:37.284 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:37.392 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=Sat May 04 02:12:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2791, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, processId=1818, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:37.476 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7967032967032968 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.028 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=Sat May 04 02:12:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2791, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, processId=1818, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.038 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2791, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.038 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2791, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:36 GMT+08:00 2024, endTime=Sat May 04 02:12:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2791, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2791.log, processId=1818, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:38.038 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.139 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2791, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.140 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.140 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.140 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.149 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.150 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.150 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.151 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2791] - [INFO] 2024-05-04 02:12:38.153 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2792, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:38.157 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:36 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:36 GMT+08:00 2024
Start Time:             Sat May 04 02:12:36 GMT+08:00 2024
End Time:               Sat May 04 02:12:37 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:12:38.160 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2792, taskName=switch, firstSubmitTime=1714759958152, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=18, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2792'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504021238'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.161 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.164 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:38.163 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.165 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.165 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.165 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759958165
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.165 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2792
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.166 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2792,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759958152,
  "startTime" : 1714759958165,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 18,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2792"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504021238"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2792",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.166 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.166 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.166 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:38.168 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2792, processInstanceId=884, startTime=1714759958165, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.169 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.169 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}] successfully
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in.json"
[WI-884][TI-2792] - [ERROR] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2792] - [ERROR] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2792] - [WARN] 2024-05-04 02:12:38.170 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.172 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:38 GMT+08:00 2024, endTime=Sat May 04 02:12:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.173 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.173 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.173 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:38.173 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:38.507 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.029 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.035 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.035 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:39.038 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=541), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2792] - [ERROR] 2024-05-04 02:12:39.040 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.040 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:38 GMT+08:00 2024, endTime=Sat May 04 02:12:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:39.044 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=542), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2792] - [WARN] 2024-05-04 02:12:39.044 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2792
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.044 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2792, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.045 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2792, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:38 GMT+08:00 2024, endTime=Sat May 04 02:12:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2792.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:39.045 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.123 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2792, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.124 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.124 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.124 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.124 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.124 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.125 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.125 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.125 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.127 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2792] - [INFO] 2024-05-04 02:12:39.129 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2793, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.137 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:39.137 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:39.138 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:39.138 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:39.139 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:38 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:38 GMT+08:00 2024
Start Time:             Sat May 04 02:12:38 GMT+08:00 2024
End Time:               Sat May 04 02:12:38 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:12:39.139 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2793, taskName=switch, firstSubmitTime=1714759959127, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=18, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2793'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504021239'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.139 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.139 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:39.144 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.146 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759959147
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2793
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2793,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759959127,
  "startTime" : 1714759959147,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 18,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2793"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504021239"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2793",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:39.149 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2793, processInstanceId=884, startTime=1714759959147, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.150 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}] successfully
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.152 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.152 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in.json"
[WI-884][TI-2793] - [ERROR] 2024-05-04 02:12:39.152 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2793] - [ERROR] 2024-05-04 02:12:39.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2793] - [WARN] 2024-05-04 02:12:39.153 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.154 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:39 GMT+08:00 2024, endTime=Sat May 04 02:12:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.155 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.155 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:39.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.035 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.042 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.042 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:40.047 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=546), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2793] - [ERROR] 2024-05-04 02:12:40.049 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.049 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:39 GMT+08:00 2024, endTime=Sat May 04 02:12:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:40.053 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=547), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2793] - [WARN] 2024-05-04 02:12:40.054 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2793
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.055 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2793, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.055 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2793, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:39 GMT+08:00 2024, endTime=Sat May 04 02:12:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2793.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:40.055 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.141 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2793, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.142 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.142 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.142 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.144 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.145 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.145 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.146 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2793] - [INFO] 2024-05-04 02:12:40.148 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2794, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.159 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:40.159 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:40.159 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2794, taskName=switch, firstSubmitTime=1714759960147, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=18, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2794'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504021240'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:40.160 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:39 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:39 GMT+08:00 2024
Start Time:             Sat May 04 02:12:39 GMT+08:00 2024
End Time:               Sat May 04 02:12:39 GMT+08:00 2024

[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.160 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.160 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.162 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.167 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759960167
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:40.168 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.167 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2794
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.168 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2794,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759960147,
  "startTime" : 1714759960167,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 18,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2794"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504021240"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2794",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:40.171 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2794, processInstanceId=884, startTime=1714759960167, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.172 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.173 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.173 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}] successfully
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.174 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in.json"
[WI-884][TI-2794] - [ERROR] 2024-05-04 02:12:40.175 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.176 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.176 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2794] - [ERROR] 2024-05-04 02:12:40.176 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2794] - [WARN] 2024-05-04 02:12:40.176 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.177 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:40 GMT+08:00 2024, endTime=Sat May 04 02:12:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.177 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.178 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.178 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:40.178 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.050 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.064 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.070 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:41.077 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=551), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2794] - [ERROR] 2024-05-04 02:12:41.078 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.079 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:40 GMT+08:00 2024, endTime=Sat May 04 02:12:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:41.083 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=552), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2794] - [WARN] 2024-05-04 02:12:41.093 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2794
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.094 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2794, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.094 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2794, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:40 GMT+08:00 2024, endTime=Sat May 04 02:12:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2794.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:41.094 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.164 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2794, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.165 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.165 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.165 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.165 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.165 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.166 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.167 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.167 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.168 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2794] - [INFO] 2024-05-04 02:12:41.169 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2795, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.185 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:41.185 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:41.186 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:41.186 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:41.187 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:40 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:40 GMT+08:00 2024
Start Time:             Sat May 04 02:12:40 GMT+08:00 2024
End Time:               Sat May 04 02:12:40 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:12:41.188 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2795, taskName=switch, firstSubmitTime=1714759961168, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=18, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2795'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504021241'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.190 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.190 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:41.202 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.205 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.206 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.218 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.223 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759961223
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.225 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2795
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.226 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2795,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759961168,
  "startTime" : 1714759961223,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 18,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2795"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504021241"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2795",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.229 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.230 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.233 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:41.236 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2795, processInstanceId=884, startTime=1714759961223, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.239 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.239 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.240 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.264 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}] successfully
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.265 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in.json"
[WI-884][TI-2795] - [ERROR] 2024-05-04 02:12:41.266 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2795] - [ERROR] 2024-05-04 02:12:41.267 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2795] - [WARN] 2024-05-04 02:12:41.267 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.276 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:41 GMT+08:00 2024, endTime=Sat May 04 02:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.279 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.279 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.280 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:41.280 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.056 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.064 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.065 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:42.078 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=556), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2795] - [ERROR] 2024-05-04 02:12:42.081 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.081 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:41 GMT+08:00 2024, endTime=Sat May 04 02:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:12:42.095 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=557), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2795] - [WARN] 2024-05-04 02:12:42.098 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2795
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.098 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2795, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.098 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2795, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:12:41 GMT+08:00 2024, endTime=Sat May 04 02:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2795.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:42.099 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.186 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2795, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.187 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.187 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.187 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.187 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.190 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.191 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.191 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.193 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2795] - [INFO] 2024-05-04 02:12:42.196 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2796, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:42.205 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.205 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.205 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.205 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.206 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.206 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:12:42.206 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:41 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:41 GMT+08:00 2024
Start Time:             Sat May 04 02:12:41 GMT+08:00 2024
End Time:               Sat May 04 02:12:41 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:12:42.216 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:42.219 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2796, processInstanceId=884, startTime=1714759962216, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:42.299 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7176470588235293 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:42.300 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:42.557 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7176470588235293 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.056 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.063 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.064 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.086 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2796, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.088 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.088 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.097 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:43.098 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.111 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2796, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.112 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:43.276 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=Sat May 04 02:12:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2796, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, processId=1829, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:43.630 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.057 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=Sat May 04 02:12:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2796, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, processId=1829, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.069 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2796, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.069 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2796, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:12:42 GMT+08:00 2024, endTime=Sat May 04 02:12:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_18/884/2796, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/18/884/2796.log, processId=1829, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:44.069 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2796, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.154 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.155 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.155 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.155 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.164 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.165 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.173 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.173 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2796] - [INFO] 2024-05-04 02:12:44.173 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:12:42 GMT+08:00 2024
Submit Time:            Sat May 04 02:12:42 GMT+08:00 2024
Start Time:             Sat May 04 02:12:42 GMT+08:00 2024
End Time:               Sat May 04 02:12:43 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:12:44.174 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:12:44.174 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:12:44.176 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 14
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:12:36 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:12:36 GMT+08:00 2024
End Time:                  Sat May 04 02:12:44 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:12:44.176 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:48.699 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 37/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:52.342 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7820806680881308 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:52.342 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:52.697 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7820806680881308 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:53.344 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7343641076056842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:53.344 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:53.720 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:53.767 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7343641076056842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:54.351 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194444444444444 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:12:54.351 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:54.769 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194444444444444 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:12:58.746 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:03.771 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:08.825 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:13.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:15.759 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.2708333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:13:15.760 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:16.754 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.2708333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:18.964 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:23.980 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:29.000 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:32.881 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7742751394056583 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:13:32.881 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:32.885 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7742751394056583 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:34.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:39.045 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:44.058 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:49.080 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:54.091 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:13:59.123 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:04.157 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:09.178 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:14.189 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:19.200 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:24.312 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:29.423 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:33.729 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:33.746 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:14:33.746 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:14:33.746 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:33.747 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:4ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:34.461 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:35.730 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:39.472 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:44.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:49.545 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:54.553 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:14:59.577 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:04.599 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:09.631 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:14.649 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:19.668 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:24.682 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:29.703 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:34.727 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:39.745 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:44.760 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:49.783 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:54.799 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:55.316 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:15:55.316 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:15:59.814 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:04.830 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:09.915 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:14.933 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:19.953 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:24.967 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:29.998 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:35.019 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:40.034 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:45.143 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:16:50.165 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:13.477 +0800 c.z.h.p.HikariPool:[788] - DolphinScheduler - Thread starvation or clock leap detected (housekeeper delta=5m44s293ms277Âµs897ns).
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:13.512 +0800 o.a.z.ClientCnxn:[1249] - Client session timed out, have not heard from server in 320566ms for session id 0x1000001aa320000
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:13.768 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001aa320000 for server dolphinscheduler-zookeeper/172.18.0.5:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
org.apache.zookeeper.ClientCnxn$SessionTimeoutException: Client session timed out, have not heard from server in 320566ms for session id 0x1000001aa320000
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1250)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:13.885 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: SUSPENDED
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:13.886 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[50] - Registry suspended
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:13.887 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a SUSPENDED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.293 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.293 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.470 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0261571186386464 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.471 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.482 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.11:40228, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.578 +0800 o.a.z.ClientCnxn:[1429] - Unable to reconnect to ZooKeeper service, session 0x1000001aa320000 has expired
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.581 +0800 o.a.c.ConnectionState:[316] - Session expired event received
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.596 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001aa320000 for server dolphinscheduler-zookeeper/172.18.0.5:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
org.apache.zookeeper.ClientCnxn$SessionExpiredException: Unable to reconnect to ZooKeeper service, session 0x1000001aa320000 has expired
	at org.apache.zookeeper.ClientCnxn$SendThread.onConnected(ClientCnxn.java:1430)
	at org.apache.zookeeper.ClientCnxnSocket.readConnectResult(ClientCnxnSocket.java:154)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:86)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1282)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.609 +0800 o.a.z.ZooKeeper:[637] - Initiating client connection, connectString=dolphinscheduler-zookeeper:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@2ec92631
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.610 +0800 o.a.z.ClientCnxnSocket:[239] - jute.maxbuffer value is 1048575 Bytes
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.610 +0800 o.a.z.ClientCnxn:[1732] - zookeeper.request.timeout value is 0. feature enabled=false
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.690 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: LOST
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.691 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[42] - Registry disconnected
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.691 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a DISCONNECTED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.691 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[117] - Master clear workflow event queue due to lost registry connection
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.691 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[119] - Master clear process instance cache due to lost registry connection
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:15.692 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[121] - Master clear all state wheel task due to lost registry connection
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.692 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[66] - Master disconnect from registry will try to reconnect in 100 s
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.694 +0800 o.a.z.ClientCnxn:[568] - EventThread shut down for session: 0x1000001aa320000
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.820 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.821 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.958 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.11:40234, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.971 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.5:2181, session id = 0x1000001aa320008, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.996 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: RECONNECTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:15.999 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[46] - Registry reconnected
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:16.000 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a RECONNECTED event from registry, the current server state is WAITING
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:16.000 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[97] - Recover from waiting success, the current server status is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:16.284 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:16.477 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:16.478 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0252808988764046 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:16.479 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:17.031 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0252808988764046 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:17.485 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9333333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:17.485 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:18.071 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9333333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:18.491 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9144542772861358 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:18.494 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:19.076 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9144542772861358 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:21.514 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:26.538 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:31.567 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:36.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:37.557 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7457142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:37.558 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:38.143 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7457142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:39.573 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7861445783132529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:39.573 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:40.220 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7861445783132529 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:41.633 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:44.601 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7395498392282959 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:44.606 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:45.252 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7395498392282959 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:45.611 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8704819277108433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:45.612 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:46.299 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8704819277108433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:46.506 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714760564995, cpuUsage=0.76, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5649913417253678, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:46.528 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:46.613 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7294832826747721 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:46.614 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:46.694 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:47.311 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7294832826747721 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:47.615 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.742603550295858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:47.615 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:48.312 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.742603550295858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:48.620 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:49.621 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:50.623 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:51.624 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:51.722 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:52.625 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:53.626 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:54.628 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:22:55.629 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.540 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.633 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.659 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.659 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.660 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.661 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 15
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 15, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.664 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.664 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.666 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.667 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2797, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:56.671 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.672 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.676 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:56.677 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.677 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.689 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.694 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2797, processInstanceId=884, startTime=1714760576692, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:56.736 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.578 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.584 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.584 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.590 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2797, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.591 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.591 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.597 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:57.598 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.624 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2797, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.625 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:57.715 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=Sat May 04 02:22:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2797, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, processId=1903, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.590 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=Sat May 04 02:22:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2797, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, processId=1903, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.624 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2797, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.625 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2797, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:56 GMT+08:00 2024, endTime=Sat May 04 02:22:57 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2797, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2797.log, processId=1903, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:58.625 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.662 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2797, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.662 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.662 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.663 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.663 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.695 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.702 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2797] - [INFO] 2024-05-04 02:22:58.706 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2798, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:58.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:22:56 GMT+08:00 2024
Submit Time:            Sat May 04 02:22:56 GMT+08:00 2024
Start Time:             Sat May 04 02:22:56 GMT+08:00 2024
End Time:               Sat May 04 02:22:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:22:58.754 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2798, taskName=switch, firstSubmitTime=1714760578703, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=19, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2798'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504022258'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storagews/in.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.755 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.794 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:58.789 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.794 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714760578795
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2798
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2798,
  "taskName" : "switch",
  "firstSubmitTime" : 1714760578703,
  "startTime" : 1714760578795,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 19,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2798"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504022258"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storagews/in.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2798",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storagews/in.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:58.798 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2798, processInstanceId=884, startTime=1714760578795, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.802 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.803 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}] successfully
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.804 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storagews/in.json"
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storagews/in.json" == "local_storage" successfully
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.813 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storagews/in.json" == "local_storage" successfully: false
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.815 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.816 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.816 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.817 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.817 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.818 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:58 GMT+08:00 2024, endTime=Sat May 04 02:22:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.821 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.821 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:58.822 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.619 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.636 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.637 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:22:59.648 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=569), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2798] - [ERROR] 2024-05-04 02:22:59.652 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.653 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:58 GMT+08:00 2024, endTime=Sat May 04 02:22:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:22:59.657 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=570), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 53, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2798] - [WARN] 2024-05-04 02:22:59.681 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2798
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.684 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2798, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2798, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:58 GMT+08:00 2024, endTime=Sat May 04 02:22:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2798.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:59.684 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2798, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.782 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.782 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.783 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.794 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.796 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.799 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2798] - [INFO] 2024-05-04 02:22:59.802 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2799, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:22:59.809 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:22:59.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:22:58 GMT+08:00 2024
Submit Time:            Sat May 04 02:22:58 GMT+08:00 2024
Start Time:             Sat May 04 02:22:58 GMT+08:00 2024
End Time:               Sat May 04 02:22:58 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:22:59.877 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:22:59.895 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2799, processInstanceId=884, startTime=1714760579890, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.618 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.638 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.638 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.646 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2799, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.647 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.647 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.671 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:00.672 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2799, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.705 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:00.971 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=Sat May 04 02:23:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2799, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, processId=1914, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.633 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=Sat May 04 02:23:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2799, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, processId=1914, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.655 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2799, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.655 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2799, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:22:59 GMT+08:00 2024, endTime=Sat May 04 02:23:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_19/884/2799, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/19/884/2799.log, processId=1914, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storagews/in.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:01.655 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2799, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.720 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.721 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.721 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.721 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.741 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.750 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2799] - [INFO] 2024-05-04 02:23:01.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:22:59 GMT+08:00 2024
Submit Time:            Sat May 04 02:22:59 GMT+08:00 2024
Start Time:             Sat May 04 02:22:59 GMT+08:00 2024
End Time:               Sat May 04 02:23:00 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:23:01.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:23:01.756 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:01.778 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 22/ms
[WI-884][TI-null] - [INFO] 2024-05-04 02:23:01.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 15
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:22:56 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:22:56 GMT+08:00 2024
End Time:                  Sat May 04 02:23:01 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:23:01.785 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:06.719 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8081761006289309 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:06.726 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:06.823 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:07.358 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8081761006289309 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:07.730 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7189349112426037 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:07.730 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:08.419 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7189349112426037 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:08.731 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7703081232492996 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:08.731 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:11.328 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7860046736451232 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:11.333 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:11.340 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7860046736451232 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:11.884 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:16.910 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:21.997 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:27.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:32.041 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:37.057 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:42.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:47.140 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:48.421 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9409876310074592 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:48.422 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:48.632 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9409876310074592 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:50.441 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718562874251497 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:23:50.442 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:50.784 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.718562874251497 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:52.190 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:23:57.218 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:02.239 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:07.281 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:12.306 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:24:16.689 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714760655782, cpuUsage=0.7310126582278481, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5568146457166047, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:17.345 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:22.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:27.403 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:32.415 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:33.756 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:33.796 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:33.796 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:33.801 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:33.802 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:33.807 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:33.807 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:33.812 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:33.812 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:33.817 +0800 o.a.d.s.m.s.MasterFailoverService:[141] - WorkflowInstance failover finished
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:33.817 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:26ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.594 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 4, cost: 1ms, current slot: 0, total slot size: 1
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:34.619 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:34.619 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:34.620 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.619 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:34.620 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-508][TI-0] - [INFO] 2024-05-04 02:24:34.623 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 39, recover flag: YES
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.625 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.626 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:34.626 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:34.627 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-510][TI-0] - [INFO] 2024-05-04 02:24:34.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 36, recover flag: YES
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:34.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-448][TI-0] - [INFO] 2024-05-04 02:24:34.630 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 41, recover flag: YES
[WI-510][TI-1257] - [INFO] 2024-05-04 02:24:34.631 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-508][TI-1255] - [INFO] 2024-05-04 02:24:34.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-510][TI-1257] - [INFO] 2024-05-04 02:24:34.639 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-510][TI-1252] - [INFO] 2024-05-04 02:24:34.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1080] - [INFO] 2024-05-04 02:24:34.677 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-508][TI-1255] - [INFO] 2024-05-04 02:24:34.680 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-508][TI-1253] - [INFO] 2024-05-04 02:24:34.684 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-510][TI-1252] - [INFO] 2024-05-04 02:24:34.684 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2019] - This workInstance will be recover by this execution
[WI-511][TI-0] - [INFO] 2024-05-04 02:24:34.704 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 36, recover flag: YES
[WI-508][TI-1253] - [INFO] 2024-05-04 02:24:34.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1247] - [INFO] 2024-05-04 02:24:34.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1247] - [INFO] 2024-05-04 02:24:34.706 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1246] - [INFO] 2024-05-04 02:24:34.706 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1246] - [INFO] 2024-05-04 02:24:34.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-508][TI-1242] - [INFO] 2024-05-04 02:24:34.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-508][TI-1242] - [WARN] 2024-05-04 02:24:34.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[803] - Have same taskCode taskInstance when init task queue, need to check taskExecutionStatus, taskCode:13340113777664
[WI-511][TI-1256] - [INFO] 2024-05-04 02:24:34.708 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13210058002752, taskInstanceStatus: TaskExecutionStatus{code=1, desc='running'}
[WI-508][TI-1242] - [INFO] 2024-05-04 02:24:34.709 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.709 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.709 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-511][TI-1256] - [INFO] 2024-05-04 02:24:34.711 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-511][TI-1254] - [INFO] 2024-05-04 02:24:34.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1254] - [INFO] 2024-05-04 02:24:34.713 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-511][TI-1248] - [INFO] 2024-05-04 02:24:34.713 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.713 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-511][TI-1248] - [INFO] 2024-05-04 02:24:34.715 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-511][TI-1243] - [INFO] 2024-05-04 02:24:34.715 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.716 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=508)
[WI-510][TI-1249] - [INFO] 2024-05-04 02:24:34.685 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1080] - [INFO] 2024-05-04 02:24:34.684 +0800 o.a.d.s.p.ProcessServiceImpl:[1308] - updated resource info {"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}
[WI-448][TI-1067] - [INFO] 2024-05-04 02:24:34.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340390094208, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-511][TI-1243] - [INFO] 2024-05-04 02:24:34.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-510][TI-1249] - [INFO] 2024-05-04 02:24:34.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-510][TI-1241] - [INFO] 2024-05-04 02:24:34.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.726 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.727 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=511)
[WI-510][TI-1241] - [INFO] 2024-05-04 02:24:34.725 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.727 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.727 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-448][TI-1067] - [INFO] 2024-05-04 02:24:34.728 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-448][TI-1066] - [INFO] 2024-05-04 02:24:34.728 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13348933988640, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.728 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.729 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.729 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=510)
[WI-448][TI-1066] - [INFO] 2024-05-04 02:24:34.731 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-448][TI-1065] - [INFO] 2024-05-04 02:24:34.731 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[798] - Check the taskInstance from a exist workflowInstance, existTaskInstanceCode: 13340113777664, taskInstanceStatus: TaskExecutionStatus{code=7, desc='success'}
[WI-448][TI-1065] - [INFO] 2024-05-04 02:24:34.733 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[821] - TaskInstance is already complete.
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.733 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [13348933988640, 13340390094208, 13340113777664], errorTaskMap: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:34.733 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.737 +0800 o.a.d.c.u.JSONUtils:[148] - Parse object exception, jsonStr: {"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}, class: class org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Array value (token `JsonToken.START_ARRAY`)
 at [Source: (String)"{"localParams":null,"varPool":[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/386-20240422.json"}],"dependRelation":null,"relation":null,"nextNode":[13348985859488],"resultConditionLocation":0,"dependTaskList":[{"condition":"${raw_file_dir} != \"null\"","nextNode":[13340390094208]},{"condition":null,"nextNode":[13348985859488]}]}"; line: 1, column: 32] (through reference chain: org.apache.dolphinscheduler.plugin.task.api.parameters.SwitchParameters["varPool"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._deserializeFromArray(StdDeserializer.java:222)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:46)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:314)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3597)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.parseObject(JSONUtils.java:146)
	at org.apache.dolphinscheduler.dao.entity.TaskInstance.getSwitchDependency(TaskInstance.java:329)
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:423)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.737 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[697] - Start workflow error
java.lang.NullPointerException: null
	at org.apache.dolphinscheduler.service.utils.DagHelper.skipTaskNode4Switch(DagHelper.java:424)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parseSwitchTask(DagHelper.java:413)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:312)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.service.utils.DagHelper.parsePostNodes(DagHelper.java:331)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.submitPostNode(WorkflowExecuteRunnable.java:1275)
	at org.apache.dolphinscheduler.server.master.runner.WorkflowExecuteRunnable.startWorkflow(WorkflowExecuteRunnable.java:691)
	at org.apache.dolphinscheduler.server.master.runner.IWorkflowExecuteRunnable.call(IWorkflowExecuteRunnable.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:24:34.737 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[71] - Failed to submit the workflow instance, will send fail state event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=448)
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:37.430 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:42.445 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:47.461 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:52.476 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:24:57.489 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:02.501 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:07.513 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:12.591 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:17.632 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:22.662 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:27.673 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:32.686 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:37.699 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:42.713 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:47.727 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:52.747 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:25:57.767 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:02.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:07.805 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:12.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:17.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:22.868 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:27.880 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:32.893 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:37.906 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:42.926 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:47.936 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:52.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:26:57.959 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:02.974 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:07.987 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:13.017 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:18.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:23.041 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:28.052 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:33.068 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:38.095 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:43.112 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:27:48.127 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:12.113 +0800 o.a.z.ClientCnxn:[1249] - Client session timed out, have not heard from server in 23982ms for session id 0x1000001aa320008
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:12.114 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001aa320008 for server dolphinscheduler-zookeeper/172.18.0.5:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
org.apache.zookeeper.ClientCnxn$SessionTimeoutException: Client session timed out, have not heard from server in 23982ms for session id 0x1000001aa320008
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1250)
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:12.223 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: SUSPENDED
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:12.224 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[50] - Registry suspended
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:12.224 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a SUSPENDED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.749 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.750 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.751 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.11:57790, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.756 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.5:2181, session id = 0x1000001aa320008, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.757 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: RECONNECTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.758 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[46] - Registry reconnected
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.759 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a RECONNECTED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.759 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[93] - no need to reconnect, as the current server status is running
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.802 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:13.849 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:18.231 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9682080924855492 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:18.231 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:18.817 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9682080924855492 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:18.876 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:20.251 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9603399433427763 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:20.251 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:20.871 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9603399433427763 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:23.901 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:26.278 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.725609756097561 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:26.278 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:26.941 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.725609756097561 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:27.280 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7888563049853372 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:28:27.281 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:27.992 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7888563049853372 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:28.917 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:34.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:39.134 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:44.145 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:49.160 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:54.194 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:28:59.226 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:04.247 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:09.282 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:14.297 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:19.310 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:24.322 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:29.337 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:34.348 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:39.361 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:44.376 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:49.389 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:51.122 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8319327731092436 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:29:51.122 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:51.269 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8319327731092436 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:54.405 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:29:59.430 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:04.511 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:09.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:14.537 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:19.552 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:24.564 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:29.574 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:34.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:39.994 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:45.008 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:50.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:30:55.037 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:00.056 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:05.070 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:10.091 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:15.102 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:20.115 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:25.130 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:30.140 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:35.167 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:40.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:45.193 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:50.208 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:31:54.301 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714761114222, cpuUsage=0.8106508875739645, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5674626632411355, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:54.421 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8119402985074626 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:31:54.422 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:55.228 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8119402985074626 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:55.288 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:55.423 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7267080745341614 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:31:55.423 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:56.322 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7267080745341614 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:56.431 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8184438040345821 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:31:56.431 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:57.357 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8184438040345821 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:57.433 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7591463414634146 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:31:57.433 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:31:58.359 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7591463414634146 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:00.383 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:03.488 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7201251427889451 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:03.489 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:04.422 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7201251427889451 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:04.490 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7352112676056338 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:04.490 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:06.076 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:07.934 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8488372093023255 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:07.935 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:08.059 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8488372093023255 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:11.136 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:16.156 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:21.185 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:26.203 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:31.222 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:36.247 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:41.285 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:46.309 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:51.332 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:56.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:57.188 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8481012658227849 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:57.188 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:57.298 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8481012658227849 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:58.191 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8392857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:58.192 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:58.322 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8392857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:59.193 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8532110091743119 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:32:59.193 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:32:59.324 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8532110091743119 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:01.423 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:04.206 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7325227963525835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:04.206 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:04.352 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7325227963525835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:04.444 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:05.211 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:06.212 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:06.444 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:07.214 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:08.215 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:09.217 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:10.219 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:11.220 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:11.463 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:12.222 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:13.223 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:14.230 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:14.457 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:16.479 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:18.265 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7761194029850746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:18.265 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:18.403 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7761194029850746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:20.273 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 4ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.298 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.299 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.299 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.299 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 16
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.299 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 16, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.304 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:20.310 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.357 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.358 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.368 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.387 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2800, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:20.415 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.415 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.416 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:20.416 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:20.416 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:20.437 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:20.453 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2800, processInstanceId=884, startTime=1714761200436, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.123 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.127 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.128 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.135 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2800, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.135 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.135 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.141 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:21.142 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2800, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.152 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:21.494 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:21.542 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=Sat May 04 02:33:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2800, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, processId=2045, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.158 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=Sat May 04 02:33:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2800, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, processId=2045, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.167 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2800, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.168 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2800, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:20 GMT+08:00 2024, endTime=Sat May 04 02:33:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2800, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2800.log, processId=2045, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:22.168 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.263 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2800, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.264 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.264 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.264 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.277 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.279 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2800] - [INFO] 2024-05-04 02:33:22.281 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2801, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.290 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.290 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.291 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2801, taskName=switch, firstSubmitTime=1714761202279, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=21, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2801'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023322'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:20 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:20 GMT+08:00 2024
Start Time:             Sat May 04 02:33:20 GMT+08:00 2024
End Time:               Sat May 04 02:33:21 GMT+08:00 2024

[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.292 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.295 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.305 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.305 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.305 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.305 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761202305
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.305 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2801
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.306 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2801,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761202279,
  "startTime" : 1714761202305,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 21,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2801"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023322"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2801",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:22.307 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2801, processInstanceId=884, startTime=1714761202305, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:22.308 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.308 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2801] - [ERROR] 2024-05-04 02:33:22.309 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.310 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2801] - [ERROR] 2024-05-04 02:33:22.310 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2801] - [WARN] 2024-05-04 02:33:22.310 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.312 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:22 GMT+08:00 2024, endTime=Sat May 04 02:33:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.315 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.315 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.315 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:22.315 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.160 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:23.168 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=582), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2801] - [ERROR] 2024-05-04 02:33:23.185 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.185 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.198 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.198 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:22 GMT+08:00 2024, endTime=Sat May 04 02:33:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:23.213 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=583), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2801] - [WARN] 2024-05-04 02:33:23.216 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2801
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.216 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2801, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.217 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2801, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:22 GMT+08:00 2024, endTime=Sat May 04 02:33:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2801.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:23.217 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.297 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2801, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.298 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.298 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.298 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.298 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.298 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.301 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.305 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2801] - [INFO] 2024-05-04 02:33:23.309 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2802, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.321 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:23.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:23.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:23.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:23.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:22 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:22 GMT+08:00 2024
Start Time:             Sat May 04 02:33:22 GMT+08:00 2024
End Time:               Sat May 04 02:33:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:33:23.323 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2802, taskName=switch, firstSubmitTime=1714761203305, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=21, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2802'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023323'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.323 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.324 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.328 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.328 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761203328
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.328 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2802
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:23.344 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.344 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2802,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761203305,
  "startTime" : 1714761203328,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 21,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2802"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023323"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2802",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:23.347 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2802, processInstanceId=884, startTime=1714761203328, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.349 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.349 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2802] - [ERROR] 2024-05-04 02:33:23.349 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.350 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2802] - [ERROR] 2024-05-04 02:33:23.350 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2802] - [WARN] 2024-05-04 02:33:23.350 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.351 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:23 GMT+08:00 2024, endTime=Sat May 04 02:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.358 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.358 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.358 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:23.358 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.161 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.165 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.166 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:24.170 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=587), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2802] - [ERROR] 2024-05-04 02:33:24.171 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.172 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:23 GMT+08:00 2024, endTime=Sat May 04 02:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:24.175 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=588), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2802] - [WARN] 2024-05-04 02:33:24.176 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2802
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.177 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2802, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.177 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2802, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:23 GMT+08:00 2024, endTime=Sat May 04 02:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2802.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:24.177 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.246 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2802, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.247 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.247 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.247 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.247 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.248 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.251 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2802] - [INFO] 2024-05-04 02:33:24.253 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2803, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.261 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:24.261 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:24.263 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2803, taskName=switch, firstSubmitTime=1714761204252, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=21, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2803'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023324'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:24.262 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:24.263 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:24.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:23 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:23 GMT+08:00 2024
Start Time:             Sat May 04 02:33:23 GMT+08:00 2024
End Time:               Sat May 04 02:33:23 GMT+08:00 2024

[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.264 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.265 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.287 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:24.285 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.287 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.287 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.288 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761204288
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.288 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2803
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.288 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2803,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761204252,
  "startTime" : 1714761204288,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 21,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2803"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023324"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2803",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.290 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.290 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.290 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:24.292 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2803, processInstanceId=884, startTime=1714761204288, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.292 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.293 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.294 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.294 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2803] - [ERROR] 2024-05-04 02:33:24.294 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.294 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.295 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.295 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2803] - [ERROR] 2024-05-04 02:33:24.295 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2803] - [WARN] 2024-05-04 02:33:24.295 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.300 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:24 GMT+08:00 2024, endTime=Sat May 04 02:33:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.300 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.301 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.302 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:24.302 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.161 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.168 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.168 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:25.170 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=592), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2803] - [ERROR] 2024-05-04 02:33:25.171 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.171 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:24 GMT+08:00 2024, endTime=Sat May 04 02:33:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:25.174 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=593), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2803] - [WARN] 2024-05-04 02:33:25.175 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2803
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.175 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2803, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.175 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2803, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:24 GMT+08:00 2024, endTime=Sat May 04 02:33:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2803.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:25.176 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.257 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2803, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.258 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.258 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.258 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.260 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2803] - [INFO] 2024-05-04 02:33:25.261 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2804, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.276 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:25.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:25.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:25.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:25.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:24 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:24 GMT+08:00 2024
Start Time:             Sat May 04 02:33:24 GMT+08:00 2024
End Time:               Sat May 04 02:33:24 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:33:25.277 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2804, taskName=switch, firstSubmitTime=1714761205260, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=21, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2804'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023325'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.278 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.279 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761205284
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2804
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:25.281 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.284 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2804,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761205260,
  "startTime" : 1714761205284,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 21,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2804"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023325"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2804",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.285 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.285 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.285 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:25.286 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2804, processInstanceId=884, startTime=1714761205284, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.287 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.288 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.288 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2804] - [ERROR] 2024-05-04 02:33:25.289 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.290 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2804] - [ERROR] 2024-05-04 02:33:25.290 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2804] - [WARN] 2024-05-04 02:33:25.290 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.292 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:25 GMT+08:00 2024, endTime=Sat May 04 02:33:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:25.293 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.180 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.218 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.221 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:26.233 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=597), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2804] - [ERROR] 2024-05-04 02:33:26.238 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.239 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:25 GMT+08:00 2024, endTime=Sat May 04 02:33:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:33:26.264 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=598), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2804] - [WARN] 2024-05-04 02:33:26.267 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2804
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.267 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2804, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.267 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2804, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:33:25 GMT+08:00 2024, endTime=Sat May 04 02:33:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2804.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:26.267 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.291 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2804, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.297 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.303 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.303 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.303 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.319 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.324 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2804] - [INFO] 2024-05-04 02:33:26.325 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2805, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:26.343 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.344 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.344 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.344 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.345 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.345 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:33:26.345 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:25 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:25 GMT+08:00 2024
Start Time:             Sat May 04 02:33:25 GMT+08:00 2024
End Time:               Sat May 04 02:33:25 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:33:26.380 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:26.403 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2805, processInstanceId=884, startTime=1714761206383, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:26.543 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.196 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.202 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.202 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.213 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2805, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.213 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.214 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.239 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:27.240 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2805, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.308 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:27.513 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=Sat May 04 02:33:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2805, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, processId=2063, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.196 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=Sat May 04 02:33:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2805, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, processId=2063, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.212 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2805, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.213 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2805, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:33:26 GMT+08:00 2024, endTime=Sat May 04 02:33:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_21/884/2805, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/21/884/2805.log, processId=2063, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:28.213 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.224 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2805, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.224 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.225 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.225 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.225 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.268 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.268 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.288 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2805] - [INFO] 2024-05-04 02:33:28.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:33:26 GMT+08:00 2024
Submit Time:            Sat May 04 02:33:26 GMT+08:00 2024
Start Time:             Sat May 04 02:33:26 GMT+08:00 2024
End Time:               Sat May 04 02:33:27 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:33:28.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:33:28.290 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:33:28.295 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 16
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:33:20 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:33:20 GMT+08:00 2024
End Time:                  Sat May 04 02:33:28 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:33:28.296 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:30.386 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7807807807807808 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:30.386 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:30.524 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7807807807807808 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:31.387 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7161290322580646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:31.387 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:31.573 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7161290322580646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:31.622 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 31/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:32.389 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.838150289017341 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:33:32.389 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:32.574 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.838150289017341 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:36.660 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:41.677 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:46.697 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:51.765 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:33:56.778 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:01.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:06.802 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:11.841 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:16.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:21.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:22.969 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7287903139397836 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:22.969 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:22.969 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7287903139397836 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:23.971 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8275862068965517 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:23.971 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:24.014 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8275862068965517 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:24.652 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714761262987, cpuUsage=0.7318811643972367, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5706637095909902, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:24.674 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:24.974 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:25.980 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7358490566037735 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:25.981 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:26.054 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7358490566037735 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:26.994 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8633720930232558 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:27.013 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:27.027 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 48/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:27.079 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8633720930232558 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:28.048 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9146341463414634 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:28.048 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:28.113 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9146341463414634 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:29.050 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:30.056 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:31.063 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:32.068 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:32.073 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:33.069 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:33.827 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:33.870 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:34:33.871 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:34:33.871 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 02:34:33.871 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:34:33.871 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 02:34:33.872 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:34:33.872 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 02:34:33.872 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:34:33.873 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:33.873 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:17ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:34:34.071 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:34.717 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.072 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 0ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.087 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.087 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.088 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.088 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.088 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 17
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.088 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 17, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.091 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.091 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.094 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.098 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.100 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.118 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2806, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.136 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.136 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.136 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:35.136 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.136 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.160 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.182 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2806, processInstanceId=884, startTime=1714761275174, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.332 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.338 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.338 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.347 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2806, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.347 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.348 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.353 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:35.353 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.379 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2806, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:35.380 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.226 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2806, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, processId=2085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.334 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2806, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, processId=2085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.346 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2806, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.346 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2806, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:35 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2806, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2806.log, processId=2085, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:36.346 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.389 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2806, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.389 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.389 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.389 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.389 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.396 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.397 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.397 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.399 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2806] - [INFO] 2024-05-04 02:34:36.401 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2807, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.405 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.407 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:36.406 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2807, taskName=switch, firstSubmitTime=1714761276399, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=22, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == \"local_storage\"","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2807'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023436'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:36.407 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:35 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:35 GMT+08:00 2024
Start Time:             Sat May 04 02:34:35 GMT+08:00 2024
End Time:               Sat May 04 02:34:36 GMT+08:00 2024

[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.407 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.407 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.414 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.417 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.417 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:36.415 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.418 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761276418
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.418 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2807
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.418 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2807,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761276399,
  "startTime" : 1714761276418,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 22,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == \\\"local_storage\\\"\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2807"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023436"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2807",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:36.420 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2807, processInstanceId=884, startTime=1714761276418, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.421 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.421 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == \"local_storage\"",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.421 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == "local_storage" 
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2807] - [ERROR] 2024-05-04 02:34:36.422 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.423 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.423 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2807] - [ERROR] 2024-05-04 02:34:36.423 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2807] - [WARN] 2024-05-04 02:34:36.423 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.425 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:36 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.426 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.427 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.427 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:36.427 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:37.089 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.345 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.350 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.350 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:37.353 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=610), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2807] - [ERROR] 2024-05-04 02:34:37.355 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.355 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:36 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:37.360 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=611), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2807] - [WARN] 2024-05-04 02:34:37.361 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2807
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.361 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2807, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.361 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2807, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:36 GMT+08:00 2024, endTime=Sat May 04 02:34:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2807.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:37.361 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2807, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.398 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.400 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2807] - [INFO] 2024-05-04 02:34:37.402 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2808, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.407 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:37.407 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:37.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:37.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:37.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:36 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:36 GMT+08:00 2024
Start Time:             Sat May 04 02:34:36 GMT+08:00 2024
End Time:               Sat May 04 02:34:36 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:34:37.408 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2808, taskName=switch, firstSubmitTime=1714761277400, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=22, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == \"local_storage\"","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2808'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023437'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.409 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.409 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.417 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:37.411 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.424 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.424 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.425 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761277425
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.425 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2808
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.426 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2808,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761277400,
  "startTime" : 1714761277425,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 22,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == \\\"local_storage\\\"\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2808"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023437"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2808",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.427 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.427 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.428 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:37.429 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2808, processInstanceId=884, startTime=1714761277425, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.430 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.430 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == \"local_storage\"",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.431 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.431 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.432 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == "local_storage" 
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.432 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2808] - [ERROR] 2024-05-04 02:34:37.432 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.432 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.432 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.432 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2808] - [ERROR] 2024-05-04 02:34:37.432 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2808] - [WARN] 2024-05-04 02:34:37.433 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.433 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:37 GMT+08:00 2024, endTime=Sat May 04 02:34:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.434 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.435 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.435 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:37.435 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.346 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.352 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.352 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:38.356 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=615), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2808] - [ERROR] 2024-05-04 02:34:38.357 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.357 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:37 GMT+08:00 2024, endTime=Sat May 04 02:34:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:38.360 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=616), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2808] - [WARN] 2024-05-04 02:34:38.361 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2808
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.361 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2808, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.361 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2808, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:37 GMT+08:00 2024, endTime=Sat May 04 02:34:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2808.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:38.361 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2808, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.423 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.423 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.423 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.423 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.423 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.428 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2808] - [INFO] 2024-05-04 02:34:38.430 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2809, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.441 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:38.442 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:38.443 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:38.443 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:38.444 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:37 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:37 GMT+08:00 2024
Start Time:             Sat May 04 02:34:37 GMT+08:00 2024
End Time:               Sat May 04 02:34:37 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:34:38.444 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2809, taskName=switch, firstSubmitTime=1714761278429, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=22, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == \"local_storage\"","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2809'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023438'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.444 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.445 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761278450
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.450 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2809
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2809,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761278429,
  "startTime" : 1714761278450,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 22,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == \\\"local_storage\\\"\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2809"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023438"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2809",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.451 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.451 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.451 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:38.452 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2809, processInstanceId=884, startTime=1714761278450, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.452 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == \"local_storage\"",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.453 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == "local_storage" 
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.454 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2809] - [ERROR] 2024-05-04 02:34:38.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2809] - [ERROR] 2024-05-04 02:34:38.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2809] - [WARN] 2024-05-04 02:34:38.454 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.455 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:38 GMT+08:00 2024, endTime=Sat May 04 02:34:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:38.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.351 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:39.361 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=620), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2809] - [ERROR] 2024-05-04 02:34:39.363 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.363 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:38 GMT+08:00 2024, endTime=Sat May 04 02:34:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:39.366 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=621), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 119, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2809] - [WARN] 2024-05-04 02:34:39.367 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2809
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.367 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2809, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.368 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2809, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:38 GMT+08:00 2024, endTime=Sat May 04 02:34:38 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2809.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:39.368 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2809, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.433 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.435 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.435 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.437 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2809] - [INFO] 2024-05-04 02:34:39.438 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2810, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.445 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:39.445 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:39.445 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:39.445 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:39.446 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:38 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:38 GMT+08:00 2024
Start Time:             Sat May 04 02:34:38 GMT+08:00 2024
End Time:               Sat May 04 02:34:38 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:34:39.447 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2810, taskName=switch, firstSubmitTime=1714761279437, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=22, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == \"local_storage\"","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2810'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023439'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.448 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.448 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.451 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.453 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.453 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.453 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761279453
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.453 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2810
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2810,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761279437,
  "startTime" : 1714761279453,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 22,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == \\\"local_storage\\\"\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2810"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023439"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2810",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:39.455 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:39.456 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2810, processInstanceId=884, startTime=1714761279453, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.458 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == \"local_storage\"",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.458 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.458 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == "local_storage" 
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2810] - [ERROR] 2024-05-04 02:34:39.459 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2810] - [ERROR] 2024-05-04 02:34:39.459 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == "local_storage"
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2810] - [WARN] 2024-05-04 02:34:39.459 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.460 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:39 GMT+08:00 2024, endTime=Sat May 04 02:34:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.461 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.462 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.462 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:39.462 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.352 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.358 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.358 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:40.363 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=625), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2810] - [ERROR] 2024-05-04 02:34:40.375 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.375 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:39 GMT+08:00 2024, endTime=Sat May 04 02:34:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:34:40.381 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=626), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2810] - [WARN] 2024-05-04 02:34:40.382 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2810
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.382 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2810, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2810, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:34:39 GMT+08:00 2024, endTime=Sat May 04 02:34:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2810.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:40.382 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2810, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.465 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.465 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.465 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.465 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.469 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2810] - [INFO] 2024-05-04 02:34:40.471 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2811, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:40.476 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:34:40.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:39 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:39 GMT+08:00 2024
Start Time:             Sat May 04 02:34:39 GMT+08:00 2024
End Time:               Sat May 04 02:34:39 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:34:40.486 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2811, processInstanceId=884, startTime=1714761280484, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:40.486 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2811, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [WARN] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.368 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:41.369 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.371 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2811, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.372 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:41.498 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=Sat May 04 02:34:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2811, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, processId=2096, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:42.114 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.359 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=Sat May 04 02:34:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2811, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, processId=2096, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.369 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2811, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.370 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2811, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:34:40 GMT+08:00 2024, endTime=Sat May 04 02:34:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_22/884/2811, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/22/884/2811.log, processId=2096, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:42.370 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.385 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2811, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.387 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.390 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.393 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.393 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.404 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.405 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2811] - [INFO] 2024-05-04 02:34:42.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:34:40 GMT+08:00 2024
Submit Time:            Sat May 04 02:34:40 GMT+08:00 2024
Start Time:             Sat May 04 02:34:40 GMT+08:00 2024
End Time:               Sat May 04 02:34:41 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:34:42.414 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:34:42.415 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:34:42.418 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 17
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:34:35 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:34:35 GMT+08:00 2024
End Time:                  Sat May 04 02:34:42 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:34:42.418 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:47.139 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:52.155 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:34:57.172 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:02.212 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:07.248 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:12.272 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:17.288 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:22.347 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:27.362 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:32.374 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:37.388 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:42.405 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:47.419 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:52.462 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 22/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:57.492 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:59.314 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7591278078434279 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:35:59.320 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:35:59.409 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7591278078434279 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:00.321 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7290011682242991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:36:00.321 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:00.462 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7290011682242991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:01.322 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7303370786516854 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:36:01.322 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:01.463 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7303370786516854 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:02.533 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 20/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:07.574 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:12.612 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:17.624 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:22.639 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:27.656 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:32.667 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:37.721 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:42.747 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:43.558 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7062491168574254 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:36:43.558 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:43.659 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7062491168574254 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:47.797 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:52.826 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:36:54.945 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714761414810, cpuUsage=0.7129032258064516, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5693476200332731, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:36:57.854 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:02.620 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7994100294985251 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:02.620 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:02.750 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7994100294985251 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:02.894 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:06.628 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7637540453074433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:06.628 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:06.857 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7637540453074433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:07.632 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.773006134969325 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:07.632 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:07.909 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.773006134969325 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:07.936 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:10.638 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7228915662650602 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:10.638 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:10.923 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7228915662650602 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:11.643 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.667 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.668 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.668 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 18
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.669 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 18, recover flag: NO
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:11.668 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.680 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.680 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.682 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.682 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.683 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.684 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2812, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:11.687 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:11.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:11.700 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:11.708 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:11.719 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2812, processInstanceId=884, startTime=1714761431715, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.669 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.686 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2812, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.692 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:12.693 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.750 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=Sat May 04 02:37:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2812, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, processId=2135, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2812, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:12.785 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:12.983 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.671 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=Sat May 04 02:37:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2812, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, processId=2135, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.687 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2812, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.688 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2812, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:11 GMT+08:00 2024, endTime=Sat May 04 02:37:12 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2812, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2812.log, processId=2135, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:13.688 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.734 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2812, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.735 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.735 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.735 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.735 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.747 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.748 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.749 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.751 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2812] - [INFO] 2024-05-04 02:37:13.754 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2813, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.762 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.762 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:13.763 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:11 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:11 GMT+08:00 2024
Start Time:             Sat May 04 02:37:11 GMT+08:00 2024
End Time:               Sat May 04 02:37:12 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:37:13.764 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2813, taskName=switch, firstSubmitTime=1714761433751, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=23, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2813'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023713'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.764 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:13.882 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.887 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.888 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761433889
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2813
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2813,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761433751,
  "startTime" : 1714761433889,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 23,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2813"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023713"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2813",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.891 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.891 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:13.892 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2813, processInstanceId=884, startTime=1714761433889, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.893 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.897 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.898 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2813] - [ERROR] 2024-05-04 02:37:13.899 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2813] - [ERROR] 2024-05-04 02:37:13.899 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2813] - [WARN] 2024-05-04 02:37:13.899 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.900 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:13 GMT+08:00 2024, endTime=Sat May 04 02:37:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.900 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.901 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.901 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:13.901 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.671 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.679 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.679 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:14.684 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=638), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2813] - [ERROR] 2024-05-04 02:37:14.685 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.685 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:13 GMT+08:00 2024, endTime=Sat May 04 02:37:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:14.689 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=639), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2813] - [WARN] 2024-05-04 02:37:14.691 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2813
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.692 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2813, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.692 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2813, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:13 GMT+08:00 2024, endTime=Sat May 04 02:37:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2813.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:14.692 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.752 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2813, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.752 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.752 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.752 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.753 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.753 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.756 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2813] - [INFO] 2024-05-04 02:37:14.759 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2814, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.767 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:14.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:14.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:14.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:14.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:13 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:13 GMT+08:00 2024
Start Time:             Sat May 04 02:37:13 GMT+08:00 2024
End Time:               Sat May 04 02:37:13 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:37:14.768 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2814, taskName=switch, firstSubmitTime=1714761434756, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=23, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2814'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023714'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.768 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.768 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:14.770 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.772 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.773 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.773 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761434773
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.773 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2814
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2814,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761434756,
  "startTime" : 1714761434773,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 23,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2814"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023714"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2814",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:14.776 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2814, processInstanceId=884, startTime=1714761434773, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.777 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.778 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.778 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.779 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.779 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.780 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.781 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2814] - [ERROR] 2024-05-04 02:37:14.782 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2814] - [ERROR] 2024-05-04 02:37:14.783 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2814] - [WARN] 2024-05-04 02:37:14.783 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.786 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:14 GMT+08:00 2024, endTime=Sat May 04 02:37:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.791 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.792 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.792 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:14.792 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.677 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.678 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:14 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:15.683 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=643), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2814] - [ERROR] 2024-05-04 02:37:15.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:14 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:14 GMT+08:00 2024, endTime=Sat May 04 02:37:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:15.688 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=644), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2814] - [WARN] 2024-05-04 02:37:15.689 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2814
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.690 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2814, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2814, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:14 GMT+08:00 2024, endTime=Sat May 04 02:37:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2814.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:15.690 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2814, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.766 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.767 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.767 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.769 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.769 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.770 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2814] - [INFO] 2024-05-04 02:37:15.772 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2815, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.779 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:15.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:15.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:15.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:15.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:14 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:14 GMT+08:00 2024
Start Time:             Sat May 04 02:37:14 GMT+08:00 2024
End Time:               Sat May 04 02:37:14 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:37:15.781 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2815, taskName=switch, firstSubmitTime=1714761435771, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=23, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2815'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023715'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.781 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:15.783 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.787 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.794 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.794 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.794 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761435795
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2815
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2815,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761435771,
  "startTime" : 1714761435795,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 23,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2815"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023715"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2815",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:15.797 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2815, processInstanceId=884, startTime=1714761435795, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.799 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.799 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.799 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.799 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2815] - [ERROR] 2024-05-04 02:37:15.800 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2815] - [ERROR] 2024-05-04 02:37:15.800 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2815] - [WARN] 2024-05-04 02:37:15.801 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.803 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:15 GMT+08:00 2024, endTime=Sat May 04 02:37:15 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:15.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.677 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.678 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:16.681 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=648), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2815] - [ERROR] 2024-05-04 02:37:16.682 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:15 GMT+08:00 2024, endTime=Sat May 04 02:37:15 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:16.687 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=649), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2815] - [WARN] 2024-05-04 02:37:16.687 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2815
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.688 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2815, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.688 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2815, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:15 GMT+08:00 2024, endTime=Sat May 04 02:37:15 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2815.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:16.688 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2815, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.780 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.781 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.781 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.782 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.785 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2815] - [INFO] 2024-05-04 02:37:16.787 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2816, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.797 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:16.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:16.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:16.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:16.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:15 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:15 GMT+08:00 2024
Start Time:             Sat May 04 02:37:15 GMT+08:00 2024
End Time:               Sat May 04 02:37:15 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:37:16.800 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2816, taskName=switch, firstSubmitTime=1714761436786, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=23, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2816'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023716'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/google_news/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.801 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.801 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.806 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.807 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761436810
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2816
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:16.810 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2816,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761436786,
  "startTime" : 1714761436810,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 23,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2816"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023716"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2816",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/google_news/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:16.812 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2816, processInstanceId=884, startTime=1714761436810, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.813 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.814 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.815 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.815 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}] successfully
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.817 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.817 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/google_news/in/830-20240503110322.json"
[WI-884][TI-2816] - [ERROR] 2024-05-04 02:37:16.818 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.818 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.818 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.819 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2816] - [ERROR] 2024-05-04 02:37:16.819 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2816] - [WARN] 2024-05-04 02:37:16.819 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.821 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:16 GMT+08:00 2024, endTime=Sat May 04 02:37:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.822 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:16.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:16 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:17.687 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=653), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2816] - [ERROR] 2024-05-04 02:37:17.688 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:16 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.689 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:16 GMT+08:00 2024, endTime=Sat May 04 02:37:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:37:17.695 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=654), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2816] - [WARN] 2024-05-04 02:37:17.696 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2816
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.696 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2816, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.697 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2816, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:37:16 GMT+08:00 2024, endTime=Sat May 04 02:37:16 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2816.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:17.697 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.796 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2816, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.799 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.799 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.799 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.804 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.804 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.806 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2816] - [INFO] 2024-05-04 02:37:17.808 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2817, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:17.816 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:37:17.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:16 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:16 GMT+08:00 2024
Start Time:             Sat May 04 02:37:16 GMT+08:00 2024
End Time:               Sat May 04 02:37:16 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:37:17.821 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:17.825 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2817, processInstanceId=884, startTime=1714761437822, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:17.999 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.682 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.691 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2817, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.692 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.693 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.700 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:18.700 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2817, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.720 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:18.875 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=Sat May 04 02:37:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2817, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, processId=2146, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:19.975 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=Sat May 04 02:37:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2817, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, processId=2146, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.037 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2817, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.037 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2817, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:37:17 GMT+08:00 2024, endTime=Sat May 04 02:37:18 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_23/884/2817, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/23/884/2817.log, processId=2146, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/google_news/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:20.037 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.095 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2817, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.096 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.096 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.096 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.097 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2817] - [INFO] 2024-05-04 02:37:20.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:37:17 GMT+08:00 2024
Submit Time:            Sat May 04 02:37:17 GMT+08:00 2024
Start Time:             Sat May 04 02:37:17 GMT+08:00 2024
End Time:               Sat May 04 02:37:18 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:37:20.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:37:20.113 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:37:20.115 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 18
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:37:11 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:37:11 GMT+08:00 2024
End Time:                  Sat May 04 02:37:20 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:37:20.116 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:22.993 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9859550561797753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:22.997 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9859550561797753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:22.997 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:23.048 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 15/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:25.004 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8853503184713375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:25.004 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:25.073 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8853503184713375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:26.006 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8242074927953891 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:37:26.006 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:26.141 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8242074927953891 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:28.090 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:33.113 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:38.126 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:43.141 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:48.158 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:53.221 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:37:58.255 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:03.280 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:08.290 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:13.310 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:18.381 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:23.395 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:28.407 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:33.432 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:38.448 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:43.492 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:48.514 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:53.532 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:57.029 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:38:57.029 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:38:58.547 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:03.573 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:06.056 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7307692307692307 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:06.057 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:06.060 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7307692307692307 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:07.059 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7887788778877888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:07.059 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:07.139 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7887788778877888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:08.062 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7658402203856749 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:08.062 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:08.140 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7658402203856749 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:08.593 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:13.621 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:18.639 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:21.100 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.756838905775076 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:21.100 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:21.250 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.756838905775076 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:22.102 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7181008902077152 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:22.103 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:22.288 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7181008902077152 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:23.655 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:24.107 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7072463768115942 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:24.107 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:24.305 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7072463768115942 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:26.146 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7219101123595506 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:26.146 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:26.362 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7219101123595506 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:28.672 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:32.169 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:32.249 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.250 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.250 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.250 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.250 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 19
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.251 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 19, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.273 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.273 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.274 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.278 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2818, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:32.298 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.298 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.298 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:32.298 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:32.298 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:32.324 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2818, processInstanceId=884, startTime=1714761572311, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:32.325 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.056 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2818, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [WARN] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.067 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.075 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:33.076 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.079 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2818, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.081 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:33.395 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=Sat May 04 02:39:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2818, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, processId=2186, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:33.695 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.056 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=Sat May 04 02:39:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2818, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, processId=2186, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.070 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2818, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.070 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2818, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:32 GMT+08:00 2024, endTime=Sat May 04 02:39:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2818, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2818.log, processId=2186, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:34.070 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.097 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2818, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.097 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.098 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.098 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.098 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.104 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.105 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.105 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.107 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2818] - [INFO] 2024-05-04 02:39:34.108 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2819, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.112 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:34.114 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2819, taskName=switch, firstSubmitTime=1714761574107, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=25, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2819'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504023934'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.115 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:34.115 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:39:32 GMT+08:00 2024
Submit Time:            Sat May 04 02:39:32 GMT+08:00 2024
Start Time:             Sat May 04 02:39:32 GMT+08:00 2024
End Time:               Sat May 04 02:39:33 GMT+08:00 2024

[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.116 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.128 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.128 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.128 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.129 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761574129
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:34.129 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.129 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2819
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.130 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2819,
  "taskName" : "switch",
  "firstSubmitTime" : 1714761574107,
  "startTime" : 1714761574129,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 25,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2819"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504023934"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2819",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.131 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.131 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.131 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:34.135 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2819, processInstanceId=884, startTime=1714761574129, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.137 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.137 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.138 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.138 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}] successfully
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.141 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.141 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/in/830-20240503110322.json"
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.141 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"/local_storage/in/830-20240503110322.json" == "local_storage" successfully
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.147 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "/local_storage/in/830-20240503110322.json" == "local_storage" successfully: false
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.147 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.148 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.148 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.152 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:34 GMT+08:00 2024, endTime=Sat May 04 02:39:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.153 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:34.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.059 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.069 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.069 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:39:35.075 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=666), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2819] - [ERROR] 2024-05-04 02:39:35.076 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.076 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:34 GMT+08:00 2024, endTime=Sat May 04 02:39:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:39:35.084 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=667), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 120, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2819] - [WARN] 2024-05-04 02:39:35.092 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2819
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.093 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2819, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.093 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2819, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:34 GMT+08:00 2024, endTime=Sat May 04 02:39:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2819.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:35.093 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2819, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.107 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.107 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.107 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.112 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.114 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2819] - [INFO] 2024-05-04 02:39:35.115 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2820, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:35.118 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.118 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.118 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 02:39:35.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:39:34 GMT+08:00 2024
Submit Time:            Sat May 04 02:39:34 GMT+08:00 2024
Start Time:             Sat May 04 02:39:34 GMT+08:00 2024
End Time:               Sat May 04 02:39:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:39:35.124 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:35.125 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2820, processInstanceId=884, startTime=1714761575123, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.059 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.065 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.066 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.073 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2820, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.073 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.074 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.080 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:36.080 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.117 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2820, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.117 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:36.148 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=Sat May 04 02:39:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2820, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, processId=2197, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.059 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=Sat May 04 02:39:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2820, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, processId=2197, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.083 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2820, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.084 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2820, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:39:35 GMT+08:00 2024, endTime=Sat May 04 02:39:36 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_25/884/2820, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/25/884/2820.log, processId=2197, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:37.084 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.139 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2820, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.139 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.140 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.140 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.160 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.167 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.168 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2820] - [INFO] 2024-05-04 02:39:37.168 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:39:35 GMT+08:00 2024
Submit Time:            Sat May 04 02:39:35 GMT+08:00 2024
Start Time:             Sat May 04 02:39:35 GMT+08:00 2024
End Time:               Sat May 04 02:39:36 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 02:39:37.168 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 02:39:37.168 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 02:39:37.170 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 19
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:39:32 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:39:32 GMT+08:00 2024
End Time:                  Sat May 04 02:39:37 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 02:39:37.171 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:38.729 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:43.770 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 16/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:48.799 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:50.332 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7038216560509555 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:39:50.333 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:50.513 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7038216560509555 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:53.830 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:39:58.850 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:03.874 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:08.915 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:13.936 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:18.985 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:24.003 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:29.033 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:34.052 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:39.067 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:44.085 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:47.084 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:49.105 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:54.127 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:57.110 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7687861271676301 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:40:57.111 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:57.116 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7687861271676301 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:40:59.146 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:04.164 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:06.149 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230320699708455 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:06.150 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:06.171 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230320699708455 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:07.152 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134502923976607 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:07.154 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:07.193 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134502923976607 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:08.156 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8101983002832862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:08.156 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:08.218 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8101983002832862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:09.158 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8950437317784257 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:09.160 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:09.215 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:09.221 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8950437317784257 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:10.162 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7824858757062148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:10.162 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:10.224 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7824858757062148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:11.164 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8055555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:41:11.164 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:11.225 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8055555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:14.260 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:19.271 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:24.299 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:29.345 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:34.373 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:39.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:44.417 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:49.455 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:54.487 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:41:59.505 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:04.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:09.592 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 16/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:14.615 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:19.647 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:24.664 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:29.679 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:34.701 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:36.523 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:39.725 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:44.743 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:49.763 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:54.776 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:42:59.797 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:04.820 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:09.885 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:14.908 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:19.663 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.5 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:19.925 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:24.937 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:29.958 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:34.979 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:40.000 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:45.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:50.040 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:55.064 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:43:58.195 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:00.085 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:05.114 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:10.146 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:15.165 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:20.193 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:25.227 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:30.252 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:33.885 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:33.915 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:44:33.916 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:44:33.916 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 02:44:33.917 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:44:33.918 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 02:44:33.918 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:44:33.919 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 02:44:33.919 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:44:33.920 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:33.920 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:12ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:35.274 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:40.310 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:45.340 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:50.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:44:55.390 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:00.414 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:05.429 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:10.451 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:15.475 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:20.492 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:25.516 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:30.535 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:35.551 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:37.575 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7309827097392486 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:37.575 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:37.577 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7309827097392486 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:40.575 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:40.590 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7840236686390533 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:40.600 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:40.622 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7840236686390533 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:45.632 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:50.657 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:52.644 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:52.660 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.660 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.661 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.661 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.661 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.662 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.667 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.669 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2821, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:52.676 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.677 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.677 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:52.677 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:52.677 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:52.682 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:52.695 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2821, processInstanceId=885, startTime=1714761952690, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.330 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.336 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.336 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.344 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2821, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.346 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.348 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.355 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:53.355 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.391 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2821, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.391 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:53.735 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=Sat May 04 02:45:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2821, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, processId=2278, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.368 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=Sat May 04 02:45:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2821, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, processId=2278, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.376 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2821, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.377 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2821, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:45:52 GMT+08:00 2024, endTime=Sat May 04 02:45:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2821, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2821.log, processId=2278, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:54.377 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.421 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2821, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.421 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.422 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.422 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.422 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.428 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.428 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.428 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.430 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2821] - [INFO] 2024-05-04 02:45:54.432 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2822, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.436 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:54.437 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:52 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:52 GMT+08:00 2024
Start Time:             Sat May 04 02:45:52 GMT+08:00 2024
End Time:               Sat May 04 02:45:53 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:45:54.438 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2822, taskName=check file existence , firstSubmitTime=1714761954430, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=28, appIds=null, processInstanceId=885, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_exists}==1","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2822'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504024554'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='885'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/google_news/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.439 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.440 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.444 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:54.442 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.445 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.445 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.445 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761954445
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.445 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 885_2822
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.445 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2822,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714761954430,
  "startTime" : 1714761954445,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 28,
  "processInstanceId" : 885,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${is_exists}==1\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2822"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504024554"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "885"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/google_news/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "885_2822",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/google_news/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.446 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.446 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.446 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:54.447 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2822, processInstanceId=885, startTime=1714761954445, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.451 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${is_exists}==1",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}] successfully
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${is_exists}==1 
[WI-885][TI-2822] - [ERROR] 2024-05-04 02:45:54.452 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2822] - [ERROR] 2024-05-04 02:45:54.452 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2822] - [WARN] 2024-05-04 02:45:54.452 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.453 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:54 GMT+08:00 2024, endTime=Sat May 04 02:45:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:54.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.369 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.375 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.375 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:55.378 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=679), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2822] - [ERROR] 2024-05-04 02:45:55.380 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.380 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:54 GMT+08:00 2024, endTime=Sat May 04 02:45:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:55.384 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=680), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2822] - [WARN] 2024-05-04 02:45:55.385 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2822
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.385 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2822, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.385 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2822, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:54 GMT+08:00 2024, endTime=Sat May 04 02:45:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2822.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:55.385 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.432 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2822, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.435 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.435 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.435 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.436 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.445 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2822] - [INFO] 2024-05-04 02:45:55.449 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2823, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.460 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:55.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:55.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:55.464 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2823, taskName=check file existence , firstSubmitTime=1714761955445, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=28, appIds=null, processInstanceId=885, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_exists}==1","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2823'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504024555'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='885'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/google_news/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:55.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:55.465 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:54 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:54 GMT+08:00 2024
Start Time:             Sat May 04 02:45:54 GMT+08:00 2024
End Time:               Sat May 04 02:45:54 GMT+08:00 2024

[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.465 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.465 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.472 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:55.475 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.474 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.476 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.476 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761955476
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.476 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 885_2823
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.478 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2823,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714761955445,
  "startTime" : 1714761955476,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 28,
  "processInstanceId" : 885,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${is_exists}==1\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2823"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504024555"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "885"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/google_news/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "885_2823",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/google_news/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.482 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.493 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:55.500 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2823, processInstanceId=885, startTime=1714761955476, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.505 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.506 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${is_exists}==1",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.511 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.511 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}] successfully
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.516 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${is_exists}==1 
[WI-885][TI-2823] - [ERROR] 2024-05-04 02:45:55.516 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.516 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.516 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.516 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2823] - [ERROR] 2024-05-04 02:45:55.516 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2823] - [WARN] 2024-05-04 02:45:55.516 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.520 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:55 GMT+08:00 2024, endTime=Sat May 04 02:45:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.528 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:55.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:55.699 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.369 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.380 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.381 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:56.388 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=684), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2823] - [ERROR] 2024-05-04 02:45:56.413 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.414 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:55 GMT+08:00 2024, endTime=Sat May 04 02:45:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:56.424 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=685), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2823] - [WARN] 2024-05-04 02:45:56.448 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2823
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.469 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2823, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.469 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2823, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:55 GMT+08:00 2024, endTime=Sat May 04 02:45:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2823.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.469 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.559 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2823, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.560 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.561 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.562 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.564 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2823] - [INFO] 2024-05-04 02:45:56.567 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2824, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.607 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:55 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:55 GMT+08:00 2024
Start Time:             Sat May 04 02:45:55 GMT+08:00 2024
End Time:               Sat May 04 02:45:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.609 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2824, taskName=check file existence , firstSubmitTime=1714761956565, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=28, appIds=null, processInstanceId=885, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_exists}==1","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2824'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504024556'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='885'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/google_news/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.610 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.617 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.620 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.620 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761956620
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.621 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 885_2824
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.621 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2824,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714761956565,
  "startTime" : 1714761956620,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 28,
  "processInstanceId" : 885,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${is_exists}==1\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2824"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504024556"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "885"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/google_news/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "885_2824",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/google_news/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.622 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.616 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.622 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.629 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.636 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2824, processInstanceId=885, startTime=1714761956620, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.639 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.641 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${is_exists}==1",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.641 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.643 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}] successfully
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.644 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${is_exists}==1 
[WI-885][TI-2824] - [ERROR] 2024-05-04 02:45:56.645 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2824] - [ERROR] 2024-05-04 02:45:56.645 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2824] - [WARN] 2024-05-04 02:45:56.647 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.649 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:56 GMT+08:00 2024, endTime=Sat May 04 02:45:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.652 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.652 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:56.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.680 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8498498498498498 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:56.680 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:56.694 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8498498498498498 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.370 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.397 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.398 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:57.405 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=689), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2824] - [ERROR] 2024-05-04 02:45:57.408 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.408 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:56 GMT+08:00 2024, endTime=Sat May 04 02:45:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:57.414 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=690), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2824] - [WARN] 2024-05-04 02:45:57.416 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2824
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.416 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2824, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.417 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2824, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:56 GMT+08:00 2024, endTime=Sat May 04 02:45:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2824.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.417 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2824, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.478 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.478 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.478 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.479 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.482 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2824] - [INFO] 2024-05-04 02:45:57.485 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2825, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.501 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:57.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:57.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:57.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:57.502 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:56 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:56 GMT+08:00 2024
Start Time:             Sat May 04 02:45:56 GMT+08:00 2024
End Time:               Sat May 04 02:45:56 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.505 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2825, taskName=check file existence , firstSubmitTime=1714761957483, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=28, appIds=null, processInstanceId=885, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_exists}==1","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2825'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504024557'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='885'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/google_news/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.506 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.506 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.541 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.545 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.545 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.545 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714761957545
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.545 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 885_2825
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.548 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2825,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714761957483,
  "startTime" : 1714761957545,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 28,
  "processInstanceId" : 885,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${is_exists}==1\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2825"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504024557"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "885"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/google_news/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "885_2825",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/google_news/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.556 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2825, processInstanceId=885, startTime=1714761957545, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.576 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.576 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${is_exists}==1",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.577 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.577 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}] successfully
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.579 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${is_exists}==1 
[WI-885][TI-2825] - [ERROR] 2024-05-04 02:45:57.579 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.580 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.580 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.581 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2825] - [ERROR] 2024-05-04 02:45:57.581 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${is_exists}==1
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:105)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2825] - [WARN] 2024-05-04 02:45:57.587 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.594 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:57 GMT+08:00 2024, endTime=Sat May 04 02:45:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.598 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.603 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.605 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:57.605 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.682 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7902735562310029 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:57.682 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:57.721 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7902735562310029 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.371 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.376 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.376 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:58.382 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=694), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2825] - [ERROR] 2024-05-04 02:45:58.385 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.385 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:57 GMT+08:00 2024, endTime=Sat May 04 02:45:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:45:58.389 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=695), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 121, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2825] - [WARN] 2024-05-04 02:45:58.390 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2825
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.390 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2825, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.390 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2825, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:57 GMT+08:00 2024, endTime=Sat May 04 02:45:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2825.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:58.391 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.401 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2825, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.402 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.402 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.402 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.402 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.424 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.425 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.437 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2825] - [INFO] 2024-05-04 02:45:58.442 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2826, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:58.454 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.454 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.455 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.455 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.455 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.455 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:45:58.457 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:57 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:57 GMT+08:00 2024
Start Time:             Sat May 04 02:45:57 GMT+08:00 2024
End Time:               Sat May 04 02:45:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:45:58.488 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:58.488 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2826, processInstanceId=885, startTime=1714761958475, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:58.686 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7888563049853372 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:58.687 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:58.722 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7888563049853372 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.371 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.405 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2826, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.406 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.407 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.425 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:59.426 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.454 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2826, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.454 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2826] - [INFO] 2024-05-04 02:45:59.525 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=Sat May 04 02:45:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2826, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, processId=2298, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:59.689 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7552238805970148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:45:59.690 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:45:59.724 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7552238805970148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.381 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=Sat May 04 02:45:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2826, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, processId=2298, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.416 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2826, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.416 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2826, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:45:58 GMT+08:00 2024, endTime=Sat May 04 02:45:59 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2826, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2826.log, processId=2298, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.417 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.484 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2826, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.496 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.497 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.497 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.497 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.497 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.500 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.501 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.501 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.504 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2826] - [INFO] 2024-05-04 02:46:00.508 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2827, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:00.537 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:00.538 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:00.538 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:00.538 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:00.539 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:45:58 GMT+08:00 2024
Submit Time:            Sat May 04 02:45:58 GMT+08:00 2024
Start Time:             Sat May 04 02:45:58 GMT+08:00 2024
End Time:               Sat May 04 02:45:59 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.548 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.554 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2827, processInstanceId=885, startTime=1714761960548, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.691 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.78 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:00.691 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.725 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.78 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:00.736 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.381 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.388 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.388 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.399 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2827, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.399 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.399 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.407 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:01.407 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.500 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2827, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.500 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:01.605 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=Sat May 04 02:46:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2827, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, processId=2311, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=Sat May 04 02:46:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2827, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, processId=2311, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.390 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2827, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.390 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2827, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:00 GMT+08:00 2024, endTime=Sat May 04 02:46:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2827, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2827.log, processId=2311, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:02.391 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2827, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.409 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.410 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.413 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2827] - [INFO] 2024-05-04 02:46:02.416 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2828, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:02.442 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:02.446 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:02.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:02.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:02.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:46:00 GMT+08:00 2024
Submit Time:            Sat May 04 02:46:00 GMT+08:00 2024
Start Time:             Sat May 04 02:46:00 GMT+08:00 2024
End Time:               Sat May 04 02:46:01 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:46:02.459 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:02.476 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2828, processInstanceId=885, startTime=1714761962462, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.386 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.398 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.400 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.436 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2828, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.436 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.437 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.438 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2828, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.438 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.450 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:03.452 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:03.515 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=Sat May 04 02:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2828, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, processId=2323, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.387 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=Sat May 04 02:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2828, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, processId=2323, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.399 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2828, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.400 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2828, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:02 GMT+08:00 2024, endTime=Sat May 04 02:46:03 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2828, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2828.log, processId=2323, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:04.400 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2828, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.461 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.461 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.461 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.469 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2828] - [INFO] 2024-05-04 02:46:04.472 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2829, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:04.500 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:04.500 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:04.501 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:04.501 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:46:04.501 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:46:02 GMT+08:00 2024
Submit Time:            Sat May 04 02:46:02 GMT+08:00 2024
Start Time:             Sat May 04 02:46:02 GMT+08:00 2024
End Time:               Sat May 04 02:46:03 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:46:04.508 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:04.524 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2829, processInstanceId=885, startTime=1714761964511, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.390 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.409 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.409 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.475 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2829, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.475 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.475 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.486 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:05.486 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.499 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2829, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.499 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:05.563 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=Sat May 04 02:46:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2829, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, processId=2335, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:05.701 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7093023255813953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:05.702 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:05.744 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7093023255813953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:05.772 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:06.253 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714761965947, cpuUsage=0.7707736389684814, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5396708841580715, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:06.259 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.391 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=Sat May 04 02:46:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2829, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, processId=2335, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.401 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2829, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.402 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2829, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:46:04 GMT+08:00 2024, endTime=Sat May 04 02:46:05 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_28/885/2829, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/28/885/2829.log, processId=2335, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:06.403 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2829, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.408 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.409 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.409 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:preprocessing and kafka, task id:null, task code:13475238524229
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: preprocessing and kafka depend result : FAILED
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.416 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.417 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.417 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.417 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.432 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.432 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.432 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.432 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2829] - [INFO] 2024-05-04 02:46:06.433 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:46:04 GMT+08:00 2024
Submit Time:            Sat May 04 02:46:04 GMT+08:00 2024
Start Time:             Sat May 04 02:46:04 GMT+08:00 2024
End Time:               Sat May 04 02:46:05 GMT+08:00 2024

[WI-885][TI-null] - [INFO] 2024-05-04 02:46:06.433 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=885, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-null] - [INFO] 2024-05-04 02:46:06.433 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-null] - [INFO] 2024-05-04 02:46:06.435 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-28-20240504024552646
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:45:52 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:45:52 GMT+08:00 2024
End Time:                  Sat May 04 02:46:06 GMT+08:00 2024

[WI-885][TI-0] - [INFO] 2024-05-04 02:46:06.436 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:06.707 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:07.715 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.70284641851736 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:07.716 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:07.781 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.70284641851736 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:08.717 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7912967900077149 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:08.717 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:08.803 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7912967900077149 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:09.718 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:10.722 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:10.795 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:11.724 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:12.726 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:13.734 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:14.737 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:46:15.743 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:15.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:16.272 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:20.864 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:25.892 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:30.916 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:35.937 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:40.957 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:46.018 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:51.046 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:46:56.065 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:01.086 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:06.114 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:11.177 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:16.200 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:21.238 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:26.274 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:31.300 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:36.316 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:41.336 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:46.367 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:51.386 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:47:56.416 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:01.430 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:06.453 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:11.497 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:16.518 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:21.538 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:26.526 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714762105710, cpuUsage=0.7771260997067448, jvmMemoryUsage=0.034406248728434244, memoryUsage=0.5437617176012612, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:26.578 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:27.264 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8571428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:27.271 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:27.314 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8571428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:28.274 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.787878787878788 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:28.274 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:28.350 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.787878787878788 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:30.279 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7725947521865889 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:30.287 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:30.360 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7725947521865889 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:31.598 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:34.304 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.333 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.333 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.333 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.334 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.335 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:34.337 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=885)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.340 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.340 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.346 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.347 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.351 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.354 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2830, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.358 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 02:48:34.359 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: search for intake article JSON files failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:34.360 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.710 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2830, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:34 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2830] - [WARN] 2024-05-04 02:48:34.715 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2830
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.715 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2830, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2830, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:34 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:34.716 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2830, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.810 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.811 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.811 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.811 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.813 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.814 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.815 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2830] - [INFO] 2024-05-04 02:48:34.820 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2831, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:48:34.833 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: search for intake article JSON files failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:34.834 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.835 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.835 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.836 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:34.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:34 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:34 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:48:34 GMT+08:00 2024

[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:35.802 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2831, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:34 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2831] - [WARN] 2024-05-04 02:48:35.808 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2831
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:35.809 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2831, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:35.809 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2831, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:34 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:35.809 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.128 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2831, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.128 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.129 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.129 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.129 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.130 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.130 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.130 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.131 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2831] - [INFO] 2024-05-04 02:48:36.133 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2832, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [ERROR] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: search for intake article JSON files failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.140 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:34 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:34 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:48:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:36.617 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.803 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2832, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:36 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2832] - [WARN] 2024-05-04 02:48:36.810 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2832
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.810 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2832, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2832, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 02:48:36 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:36.811 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.882 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2832, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.883 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.883 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.883 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.885 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.890 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.900 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2832] - [INFO] 2024-05-04 02:48:36.904 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2833, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:36.917 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.917 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.917 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.917 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:36.917 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:36 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:36 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 02:48:36 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:36.924 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:36.934 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2833, processInstanceId=885, startTime=1714762116930, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.803 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.809 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.809 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.817 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2833, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.817 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.817 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.823 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:37.824 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.910 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2833, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.915 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:37.976 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=Sat May 04 02:48:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2833, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, processId=2377, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"OUT","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=Sat May 04 02:48:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2833, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, processId=2377, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"OUT","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.819 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2833, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.819 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2833, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:36 GMT+08:00 2024, endTime=Sat May 04 02:48:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2833, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2833.log, processId=2377, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"OUT","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:38.820 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.917 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2833, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.918 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.918 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.918 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.918 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.925 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.925 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.926 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.926 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2833] - [INFO] 2024-05-04 02:48:38.940 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2834, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.949 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.950 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.950 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:38.951 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:36 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:36 GMT+08:00 2024
Start Time:             Sat May 04 02:48:36 GMT+08:00 2024
End Time:               Sat May 04 02:48:37 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:38.956 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2834, taskName=check file existence , firstSubmitTime=1714762118931, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=29, appIds=null, processInstanceId=885, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${is_exists}==1","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2834'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504024838'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='885'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/google_news/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}, is_exists=Property{prop='is_exists', direct=IN, type=VARCHAR, value='1'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.956 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.975 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.975 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.975 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.975 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714762118975
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.976 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 885_2834
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.977 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2834,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714762118931,
  "startTime" : 1714762118975,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 29,
  "processInstanceId" : 885,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${is_exists}==1\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2834"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504024838"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "885"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/google_news/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    },
    "is_exists" : {
      "prop" : "is_exists",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1"
    }
  },
  "taskAppId" : "885_2834",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/google_news/in/830-20240503110322.json'\"},{\"prop\":\"is_exists\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"1\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:38.979 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:38.983 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2834, processInstanceId=885, startTime=1714762118975, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.984 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.986 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${is_exists}==1",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.986 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.986 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"}] successfully
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.988 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.995 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${is_exists}==1 
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.995 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:is_existsï¼ŒparamValue:"1"
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:38.995 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"1"==1 successfully
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.006 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "1"==1 successfully: true
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.006 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.006 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.008 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:38 GMT+08:00 2024, endTime=Sat May 04 02:48:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.009 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.009 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:39.010 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.233 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.248 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.248 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:48:40.255 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=719), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 122, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2834] - [ERROR] 2024-05-04 02:48:40.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:38 GMT+08:00 2024, endTime=Sat May 04 02:48:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [ERROR] 2024-05-04 02:48:40.263 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=720), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 103, 122, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-885][TI-2834] - [WARN] 2024-05-04 02:48:40.265 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2834
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.265 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2834, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.265 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2834, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 02:48:38 GMT+08:00 2024, endTime=Sat May 04 02:48:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2834.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/google_news/in/830-20240503110322.json'"},{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:40.265 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.335 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2834, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.335 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.336 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.336 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.336 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.347 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.351 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2834] - [INFO] 2024-05-04 02:48:40.354 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2835, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:40.360 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=7, desc='success'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.361 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.361 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:40.361 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:38 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:38 GMT+08:00 2024
Start Time:             Sat May 04 02:48:38 GMT+08:00 2024
End Time:               Sat May 04 02:48:39 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:40.367 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:40.379 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2835, processInstanceId=885, startTime=1714762120368, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.237 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.244 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.245 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.265 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2835, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.265 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.265 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.278 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:41.278 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.362 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2835, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.362 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:41.406 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=Sat May 04 02:48:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2835, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, processId=2391, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:41.640 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.240 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=Sat May 04 02:48:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2835, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, processId=2391, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.261 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2835, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.262 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2835, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:40 GMT+08:00 2024, endTime=Sat May 04 02:48:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2835, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2835.log, processId=2391, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:42.262 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.273 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2835, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.273 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.274 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.274 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.274 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.274 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.275 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.276 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.277 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2835] - [INFO] 2024-05-04 02:48:42.278 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2836, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:42.299 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:42.300 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:42.301 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:42.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:42.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:40 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:40 GMT+08:00 2024
Start Time:             Sat May 04 02:48:40 GMT+08:00 2024
End Time:               Sat May 04 02:48:41 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:42.307 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:42.318 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2836, processInstanceId=885, startTime=1714762122307, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.240 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.248 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.249 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.258 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2836, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.259 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.259 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.272 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:43.272 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.283 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2836, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.284 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:43.362 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=Sat May 04 02:48:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2836, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, processId=2404, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.242 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=Sat May 04 02:48:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2836, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, processId=2404, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.261 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2836, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.261 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2836, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:42 GMT+08:00 2024, endTime=Sat May 04 02:48:43 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2836, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2836.log, processId=2404, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:44.262 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2836, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.321 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.321 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.322 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.322 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.322 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.324 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.324 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.325 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.327 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2836] - [INFO] 2024-05-04 02:48:44.330 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2837, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:44.338 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:44.338 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:44.338 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:44.338 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:44.339 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:42 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:42 GMT+08:00 2024
Start Time:             Sat May 04 02:48:42 GMT+08:00 2024
End Time:               Sat May 04 02:48:43 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:44.345 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:44.360 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2837, processInstanceId=885, startTime=1714762124347, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.242 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.251 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.251 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.259 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2837, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.260 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.260 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.279 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:45.279 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.334 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2837, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.335 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:45.394 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=Sat May 04 02:48:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2837, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, processId=2416, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.244 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=Sat May 04 02:48:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2837, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, processId=2416, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.260 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2837, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.261 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2837, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:44 GMT+08:00 2024, endTime=Sat May 04 02:48:45 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2837, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2837.log, processId=2416, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:46.263 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2837, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.361 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.361 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.362 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.362 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.362 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.364 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.364 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13481487039552, 13475238524226]
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.365 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.367 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:885, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2837] - [INFO] 2024-05-04 02:48:46.369 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2838, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:885, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:46.384 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:46.384 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:46.384 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:46.385 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-885][TI-0] - [INFO] 2024-05-04 02:48:46.385 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:44 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:44 GMT+08:00 2024
Start Time:             Sat May 04 02:48:44 GMT+08:00 2024
End Time:               Sat May 04 02:48:45 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 02:48:46.392 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:46.397 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2838, processInstanceId=885, startTime=1714762126390, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:46.674 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.258 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:47.263 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7567567567567567 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:47.264 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:47.273 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7567567567567567 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.278 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.278 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.400 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2838, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.400 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.400 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.438 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:47.438 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.449 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=Sat May 04 02:48:47 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2838, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, processId=2428, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.482 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2838, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:47.482 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.255 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=Sat May 04 02:48:47 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2838, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, processId=2428, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.283 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=885, taskInstanceId=2838, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.284 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2838, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 02:48:46 GMT+08:00 2024, endTime=Sat May 04 02:48:47 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_29/885/2838, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/29/885/2838.log, processId=2428, appIds=null, event=RESULT, varPool=[{"prop":"is_exists","direct":"IN","type":"VARCHAR","value":"1"},{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=885)
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:48.285 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-885] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:48.281 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7463126843657817 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:48.285 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.300 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=885, taskInstanceId=2838, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.300 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.300 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.301 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.301 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:preprocessing and kafka, task id:null, task code:13475238524229
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.306 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: preprocessing and kafka depend result : FAILED
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.306 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.317 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-2838] - [INFO] 2024-05-04 02:48:48.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-28-20240504024552646
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 02:48:46 GMT+08:00 2024
Submit Time:            Sat May 04 02:48:46 GMT+08:00 2024
Start Time:             Sat May 04 02:48:46 GMT+08:00 2024
End Time:               Sat May 04 02:48:47 GMT+08:00 2024

[WI-885][TI-null] - [INFO] 2024-05-04 02:48:48.318 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=885, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-885][TI-null] - [INFO] 2024-05-04 02:48:48.322 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-885][TI-null] - [INFO] 2024-05-04 02:48:48.336 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-28-20240504024552646
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 02:48:34 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 02:48:34 GMT+08:00 2024
End Time:                  Sat May 04 02:48:48 GMT+08:00 2024

[WI-885][TI-0] - [INFO] 2024-05-04 02:48:48.338 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:48.382 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7463126843657817 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:49.287 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8048780487804877 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:48:49.288 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:49.391 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8048780487804877 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:51.736 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:48:56.894 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:01.917 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:06.964 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:12.018 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:17.055 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:22.102 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:27.124 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:32.149 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:37.189 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:38.586 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.72809667673716 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:38.590 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.72809667673716 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:38.591 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:41.599 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7033898305084746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:41.600 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:41.609 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7033898305084746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:42.213 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:43.604 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7118155619596542 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:43.604 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:43.626 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7118155619596542 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:44.608 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7746031746031746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:44.608 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:44.640 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7746031746031746 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:45.609 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7903682719546742 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:45.610 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:45.642 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7903682719546742 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:49:46.708 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714760535585, reportTime=1714762183698, cpuUsage=0.7342857142857142, jvmMemoryUsage=0.034424209594726564, memoryUsage=0.5445771403654549, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:47.234 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:52.255 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:49:57.282 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:02.297 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:07.319 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:12.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:17.383 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:22.403 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:27.430 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:32.457 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:37.500 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:42.524 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:44.271 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:50:44.272 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:46.275 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:50:46.275 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:47.539 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:52.652 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:50:57.671 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:02.699 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:07.714 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:12.751 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:17.772 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:22.798 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:27.814 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:32.837 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:37.858 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:42.881 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:47.905 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:53.260 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:51:58.279 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:03.291 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:08.309 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:13.348 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:18.366 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:23.381 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:28.399 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:33.416 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:39.734 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:44.757 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:52:49.770 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:35.109 +0800 c.z.h.p.HikariPool:[788] - DolphinScheduler - Thread starvation or clock leap detected (housekeeper delta=2m51s98ms105Âµs897ns).
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:35.110 +0800 o.a.z.ClientCnxn:[1249] - Client session timed out, have not heard from server in 165334ms for session id 0x1000001aa320008
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:35.110 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001aa320008 for server dolphinscheduler-zookeeper/172.18.0.5:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
org.apache.zookeeper.ClientCnxn$SessionTimeoutException: Client session timed out, have not heard from server in 165334ms for session id 0x1000001aa320008
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1250)
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:35.428 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: SUSPENDED
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:35.451 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[50] - Registry suspended
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:35.451 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a SUSPENDED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:35.828 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0416666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:35.936 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:36.808 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0416666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:36.819 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:36.863 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:36.883 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:36.961 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.11:44152, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.000 +0800 o.a.z.ClientCnxn:[1429] - Unable to reconnect to ZooKeeper service, session 0x1000001aa320008 has expired
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.001 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001aa320008 for server dolphinscheduler-zookeeper/172.18.0.5:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
org.apache.zookeeper.ClientCnxn$SessionExpiredException: Unable to reconnect to ZooKeeper service, session 0x1000001aa320008 has expired
	at org.apache.zookeeper.ClientCnxn$SendThread.onConnected(ClientCnxn.java:1430)
	at org.apache.zookeeper.ClientCnxnSocket.readConnectResult(ClientCnxnSocket.java:154)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:86)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1282)
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.000 +0800 o.a.c.ConnectionState:[316] - Session expired event received
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.002 +0800 o.a.z.ZooKeeper:[637] - Initiating client connection, connectString=dolphinscheduler-zookeeper:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@2ec92631
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.004 +0800 o.a.z.ClientCnxnSocket:[239] - jute.maxbuffer value is 1048575 Bytes
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.008 +0800 o.a.z.ClientCnxn:[1732] - zookeeper.request.timeout value is 0. feature enabled=false
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.017 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: LOST
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.031 +0800 o.a.z.ClientCnxn:[568] - EventThread shut down for session: 0x1000001aa320008
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.050 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.051 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.052 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.0.11:44162, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.053 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[42] - Registry disconnected
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.087 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a DISCONNECTED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.088 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[117] - Master clear workflow event queue due to lost registry connection
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.088 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[119] - Master clear process instance cache due to lost registry connection
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.088 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[121] - Master clear all state wheel task due to lost registry connection
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.088 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[66] - Master disconnect from registry will try to reconnect in 100 s
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.065 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.5:2181, session id = 0x1000001aa32000b, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.096 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: RECONNECTED
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.106 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[46] - Registry reconnected
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.106 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a RECONNECTED event from registry, the current server state is WAITING
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.106 +0800 o.a.d.s.m.r.MasterWaitingStrategy:[97] - Recover from waiting success, the current server status is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.229 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.628 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.628 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 23/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.638 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 02:55:37.639 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 02:55:37.639 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 02:55:37.639 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 02:55:37.639 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 02:55:37.639 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 02:55:37.642 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 02:55:37.642 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 02:55:37.643 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.643 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:41ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:37.827 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0198785291423098 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:37.827 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:38.132 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0198785291423098 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:38.829 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9473684210526315 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:38.830 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:39.133 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9473684210526315 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:39.832 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7430555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:39.832 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:40.134 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7430555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:40.834 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8882175226586103 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:40.837 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:41.152 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8882175226586103 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:41.839 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9379310344827587 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:41.840 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:42.153 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9379310344827587 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:42.721 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:42.841 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8859934853420195 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:42.841 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:43.155 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8859934853420195 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:43.843 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:44.845 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:45.847 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 02:55:46.850 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:47.644 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:47.758 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:52.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:55:57.808 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:56:02.840 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:56:07.866 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:56:12.904 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 02:56:17.925 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
