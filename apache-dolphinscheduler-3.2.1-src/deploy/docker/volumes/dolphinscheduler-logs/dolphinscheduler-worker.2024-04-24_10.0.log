[WI-0][TI-0] - [INFO] 2024-04-24 10:11:43.975 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8100558659217877 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:11:44.999 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9261363636363636 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:16:46.555 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7228571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:47.915 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8668555240793201 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.047 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1388, taskName=search for intake JSON files, firstSubmitTime=1713925074019, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1388'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424101754'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.054 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.055 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.066 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.066 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.066 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925074066
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.066 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1388
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1388,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713925074019,
  "startTime" : 1713925074066,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1388.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1388"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424101754"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1388",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.069 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.070 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.070 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.092 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.093 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388 check successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.093 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.093 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.093 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.094 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.094 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.094 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.094 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.094 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.095 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.095 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.096 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.096 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.096 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.096 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.096 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388/566_1388.sh
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:54.130 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3381
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:54.135 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1388] - [INFO] 2024-04-24 10:17:54.441 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1388, success=true)
[WI-0][TI-1388] - [INFO] 2024-04-24 10:17:54.450 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1388)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:55.137 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.138 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388, processId:3381 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.165 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.166 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.166 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.167 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1388
[WI-566][TI-1388] - [INFO] 2024-04-24 10:17:55.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1388] - [INFO] 2024-04-24 10:17:55.421 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1388, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:56.486 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1390, taskName=move to processing, firstSubmitTime=1713925076480, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1390'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424101756'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.487 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.489 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.490 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.490 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.490 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925076490
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.491 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1390
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.499 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1390,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713925076480,
  "startTime" : 1713925076490,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1390.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1390"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424101756"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1390",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.499 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.499 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.500 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.522 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.523 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390 check successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.526 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.526 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.526 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.526 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.526 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390/566_1390.sh
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:56.539 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3395
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:56.539 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1390] - [INFO] 2024-04-24 10:17:57.434 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1390, success=true)
[WI-0][TI-1390] - [INFO] 2024-04-24 10:17:57.456 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1390)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:57.559 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.561 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390, processId:3395 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.563 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1390
[WI-566][TI-1390] - [INFO] 2024-04-24 10:17:57.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1390] - [INFO] 2024-04-24 10:17:58.451 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1390, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.585 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1391, taskName=spark preprocessing, firstSubmitTime=1713925078578, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.12:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1391'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424101758'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.593 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.615 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.615 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925078615
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.615 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1391
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.616 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1391,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713925078578,
  "startTime" : 1713925078615,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1391.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1391"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424101758"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1391",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.616 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.616 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.616 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.627 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.627 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391 check successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.627 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.641 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.641 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.642 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.643 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.643 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.643 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    spark_reddit_preprocessing.py

[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.643 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.643 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/566_1391.sh
[WI-566][TI-1391] - [INFO] 2024-04-24 10:17:58.696 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3407
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:58.994 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8920454545454546 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1391] - [INFO] 2024-04-24 10:17:59.433 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1391, success=true)
[WI-0][TI-1391] - [INFO] 2024-04-24 10:17:59.441 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1391)
[WI-0][TI-0] - [INFO] 2024-04-24 10:17:59.706 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:00.030 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7214285714285714 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:01.034 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7909090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:01.716 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:02.719 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:02 INFO SparkContext: Running Spark version 3.5.1
	24/04/24 10:18:02 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:18:02 INFO SparkContext: Java version 1.8.0_402
	24/04/24 10:18:02 INFO ResourceUtils: ==============================================================
	24/04/24 10:18:02 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/24 10:18:02 INFO ResourceUtils: ==============================================================
	24/04/24 10:18:02 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/24 10:18:02 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/24 10:18:02 INFO ResourceProfile: Limiting resource is cpus at 1 tasks per executor
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:03.721 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:02 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/24 10:18:02 INFO SecurityManager: Changing view acls to: default
	24/04/24 10:18:02 INFO SecurityManager: Changing modify acls to: default
	24/04/24 10:18:02 INFO SecurityManager: Changing view acls groups to: 
	24/04/24 10:18:02 INFO SecurityManager: Changing modify acls groups to: 
	24/04/24 10:18:02 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
	24/04/24 10:18:03 INFO Utils: Successfully started service 'sparkDriver' on port 33155.
	24/04/24 10:18:03 INFO SparkEnv: Registering MapOutputTracker
	24/04/24 10:18:03 INFO SparkEnv: Registering BlockManagerMaster
	24/04/24 10:18:03 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/24 10:18:03 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/24 10:18:03 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/24 10:18:03 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-a99a83ce-9ad2-4122-95af-b3d600397cbf
	24/04/24 10:18:03 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:04.724 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:03 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/24 10:18:03 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/24 10:18:04 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
	24/04/24 10:18:04 INFO Utils: Successfully started service 'SparkUI' on port 4041.
	24/04/24 10:18:04 INFO SparkContext: Added JAR file:///tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar at spark://67053a64aa3f:33155/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713925082614
	24/04/24 10:18:04 INFO SparkContext: Added file file:///local_storage/reddit/processing/500-20240423.json at file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713925082614
	24/04/24 10:18:04 INFO Utils: Copying /local_storage/reddit/processing/500-20240423.json to /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/500-20240423.json
	24/04/24 10:18:04 INFO Executor: Starting executor ID driver on host 67053a64aa3f
	24/04/24 10:18:04 INFO Executor: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:18:04 INFO Executor: Java version 1.8.0_402
	24/04/24 10:18:04 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
	24/04/24 10:18:04 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@2fe9235e for default.
	24/04/24 10:18:04 INFO Executor: Fetching file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713925082614
	24/04/24 10:18:04 INFO Utils: /local_storage/reddit/processing/500-20240423.json has been previously copied to /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/500-20240423.json
	24/04/24 10:18:04 INFO Executor: Fetching spark://67053a64aa3f:33155/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713925082614
	24/04/24 10:18:04 INFO TransportClientFactory: Successfully created connection to 67053a64aa3f/172.18.1.1:33155 after 44 ms (0 ms spent in bootstraps)
	24/04/24 10:18:04 INFO Utils: Fetching spark://67053a64aa3f:33155/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar to /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/fetchFileTemp7087773606999793537.tmp
	24/04/24 10:18:04 INFO Executor: Adding file:/tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/spark-sql-kafka-0-10_2.13-3.5.1.jar to class loader default
	24/04/24 10:18:04 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34365.
	24/04/24 10:18:04 INFO NettyBlockTransferService: Server created on 67053a64aa3f:34365
	24/04/24 10:18:04 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/24 10:18:04 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 67053a64aa3f, 34365, None)
	24/04/24 10:18:04 INFO BlockManagerMasterEndpoint: Registering block manager 67053a64aa3f:34365 with 366.3 MiB RAM, BlockManagerId(driver, 67053a64aa3f, 34365, None)
	24/04/24 10:18:04 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 67053a64aa3f, 34365, None)
	24/04/24 10:18:04 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 67053a64aa3f, 34365, None)
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:05.727 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	
	
	
	 /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/500-20240423.json 
	
	
	
	24/04/24 10:18:05 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 345.6 KiB, free 366.0 MiB)
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:06.728 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:05 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 32.7 KiB, free 365.9 MiB)
	24/04/24 10:18:05 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 67053a64aa3f:34365 (size: 32.7 KiB, free: 366.3 MiB)
	24/04/24 10:18:05 INFO SparkContext: Created broadcast 0 from wholeTextFiles at NativeMethodAccessorImpl.java:0
	24/04/24 10:18:05 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/24 10:18:05 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:10.738 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:10 INFO CodeGenerator: Code generated in 308.848835 ms
	24/04/24 10:18:10 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:18:10 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:18:10 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/24 10:18:10 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/24 10:18:10 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/24 10:18:10 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:18:10 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:18:10 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:18:10 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 23.9 KiB, free 365.9 MiB)
	24/04/24 10:18:10 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 11.6 KiB, free 365.9 MiB)
	24/04/24 10:18:10 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 67053a64aa3f:34365 (size: 11.6 KiB, free: 366.3 MiB)
	24/04/24 10:18:10 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:18:10 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:18:10 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
	24/04/24 10:18:10 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (67053a64aa3f, executor driver, partition 0, PROCESS_LOCAL, 8096 bytes) 
	24/04/24 10:18:10 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:11.740 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:10 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/500-20240423.json:0+147333
	24/04/24 10:18:11 INFO CodeGenerator: Code generated in 39.588672 ms
	24/04/24 10:18:11 INFO PythonRunner: Times: total = 762, boot = 599, init = 141, finish = 22
	24/04/24 10:18:11 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2751 bytes result sent to driver
	24/04/24 10:18:11 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1213 ms on 67053a64aa3f (executor driver) (1/1)
	24/04/24 10:18:11 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 33743
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:12.741 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:11 INFO DAGScheduler: ResultStage 0 (json at NativeMethodAccessorImpl.java:0) finished in 1.385 s
	24/04/24 10:18:11 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
	24/04/24 10:18:11 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:18:11 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
	24/04/24 10:18:11 INFO DAGScheduler: Job 0 finished: json at NativeMethodAccessorImpl.java:0, took 1.453514 s
	24/04/24 10:18:11 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 67053a64aa3f:34365 in memory (size: 11.6 KiB, free: 366.3 MiB)
	
	
	
	 1 
	
	
	
	
	
	
	 2 
	
	
	
	
	
	
	 3 
	
	
	
	
	
	
	 4 
	
	
	
	24/04/24 10:18:12 INFO CodeGenerator: Code generated in 63.221158 ms
	24/04/24 10:18:12 INFO CodeGenerator: Code generated in 14.0203 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:13.086 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7307692307692308 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:13.750 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:12 INFO SparkContext: Starting job: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py:84
	24/04/24 10:18:12 INFO DAGScheduler: Got job 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py:84) with 1 output partitions
	24/04/24 10:18:12 INFO DAGScheduler: Final stage: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py:84)
	24/04/24 10:18:12 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:18:12 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:18:12 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:18:12 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 67.3 KiB, free 365.9 MiB)
	24/04/24 10:18:12 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 27.3 KiB, free 365.8 MiB)
	24/04/24 10:18:12 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 67053a64aa3f:34365 (size: 27.3 KiB, free: 366.2 MiB)
	24/04/24 10:18:12 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:18:12 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:18:12 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
	24/04/24 10:18:12 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (67053a64aa3f, executor driver, partition 0, PROCESS_LOCAL, 8096 bytes) 
	24/04/24 10:18:12 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
	24/04/24 10:18:12 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/userFiles-93ef91d9-7929-4165-a512-46864ff8e55e/500-20240423.json:0+147333
	24/04/24 10:18:13 INFO CodeGenerator: Code generated in 66.097493 ms
	24/04/24 10:18:13 INFO CodeGenerator: Code generated in 23.867967 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:14.768 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:18:13 INFO CodeGenerator: Code generated in 48.466023 ms
	24/04/24 10:18:13 INFO CodeGenerator: Code generated in 42.513313 ms
	24/04/24 10:18:13 INFO PythonRunner: Times: total = 143, boot = -1310, init = 1428, finish = 25
	24/04/24 10:18:13 INFO CodeGenerator: Code generated in 47.73375 ms
	24/04/24 10:18:14 INFO CodeGenerator: Code generated in 94.091047 ms
	24/04/24 10:18:14 INFO PythonUDFRunner: Times: total = 847, boot = 518, init = 328, finish = 1
	24/04/24 10:18:14 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 135837 bytes result sent to driver
	24/04/24 10:18:14 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1548 ms on 67053a64aa3f (executor driver) (1/1)
	24/04/24 10:18:14 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
	24/04/24 10:18:14 INFO DAGScheduler: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py:84) finished in 1.569 s
	24/04/24 10:18:14 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:18:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
	24/04/24 10:18:14 INFO DAGScheduler: Job 1 finished: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py:84, took 1.592949 s
	{"user":"NekoIdo","content":"https://preview.redd.it/u68bjywya5wc1.png?width=808&format=png&auto=webp&s=d42529d6566d93e3df2f8be398afd887a258d020\n\nFound the deleted post [here](https://www.reddit.com/r/SGExams/comments/1capzon/hi_i_am_the_driver_of_snh7z_i_would_like_to_clear/).  \nMain content has been deleted by mods but the comments are definitely not buying his excuse.\n\nAlso someone else posted another captured instance of this same driver being a road menace here:  \n[https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/](https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/)\n\nPersonally I think it's really lucky for this Benz driver that the SAAB driver survived, or the spotlight would shine solely on him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":341,"subreddit":"singapore","type":"post","id":"1cau62k","datetime":"2024-04-23 11:06:00"}
	{"user":"dylank999","content":"Speeding up to prevent people from changing lane/overtaking. \n\nNumber 1 ego of Singapore drivers. It's a pandemic on our roads.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9els/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":395,"subreddit":"singapore","type":"comment","id":"l0u9els","datetime":"2024-04-23 11:38:17"}
	{"user":"pureeyes","content":"All he had to do was say nothing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uau6z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":197,"subreddit":"singapore","type":"comment","id":"l0uau6z","datetime":"2024-04-23 11:49:38"}
	{"user":"PhantomWolf83","content":">my thought was to tell the SAAB driver to slow down, hence I sped up while he was overtaking\n\n???????","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u5ykg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":365,"subreddit":"singapore","type":"comment","id":"l0u5ykg","datetime":"2024-04-23 11:11:50"}
	{"user":"I_Miss_Every_Shot","content":"Basic Theory or Advance Theory should include a psycho-emotional assessment. People who registered increased heart rate/ BP/ stress or inclination to speed up/ overtake when overtaken or have their lane cut into should undergo mandatory counselling or be denied their license altogether.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uas8s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":115,"subreddit":"singapore","type":"comment","id":"l0uas8s","datetime":"2024-04-23 11:49:11"}
	{"user":"BinaryDoom","content":"It's precisely because there are immature drivers on the road, such behavior would only make driving in Singapore unpleasant. The white Merc driver is not the only one. It could have been someone else. Anyway, based on the footage, from the way he has executed it, I wouldn't buy his claim of wanting the black driver to slow down by speeding up. Only when you practice enough of this, it becomes a natural reaction.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaru6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0uaru6","datetime":"2024-04-23 11:49:06"}
	{"user":"testercheong","content":"I'm more curious as to why its posted on sgexams though","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uamri/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":72,"subreddit":"singapore","type":"comment","id":"l0uamri","datetime":"2024-04-23 11:47:59"}
	{"user":"adept1onreddit","content":"Regardless of what he thinks about the whole situation, the smart option would be to keep his mouth shut. Who knows what kind of legal issues may arise.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucey8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":27,"subreddit":"singapore","type":"comment","id":"l0ucey8","datetime":"2024-04-23 12:02:25"}
	{"user":"Background_Tax_1985","content":"His reasons are bs but that does not deviate from the fact that the accident was 100% caused by the saab driver (sd). \n\nEven before the mercedes driver (md) sped up to block the sd, sd was already speeding. Just a side note, if md and sd were racing each other we would have seen it from the first vehicle camera footage of the accident from the other merc, which we did not. \n\nIs md wrong and a dick? Yes. Did md commit an offence by driving in that manner? Maybe. Did he cause the accident? No.\n\nBecause after side swiping md, sd could have stopped. He had all the time and distance in the world to stop but he decided to speed on into the distance instead. \n\nThere is literally 2 school zones after that junction where the accident took place. If he had not gotten into an accident there, he could potentially have plowed into alot of kids, since the accident took place at school start time.\n\nSd really needs to be serverly punished for this.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7xwv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":193,"subreddit":"singapore","type":"comment","id":"l0u7xwv","datetime":"2024-04-23 11:26:49"}
	{"user":"blitzmango","content":"So desperate to defend his actions that he created 3 threads but looks like its gonna back fire instead. If it weren't for the second video incident, I might have given him the benefit of doubt, but sorry no.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7mlk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":57,"subreddit":"singapore","type":"comment","id":"l0u7mlk","datetime":"2024-04-23 11:24:24"}
	{"user":"top1global","content":"In the end, he is posting it to defend himself and blame others. 0 apology or remorse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubg1n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":48,"subreddit":"singapore","type":"comment","id":"l0ubg1n","datetime":"2024-04-23 11:54:35"}
	{"user":"Stripey7676","content":"Theres a huge debate over at EDMW whether any blame should be placed white merc. Now, the saab is 120% at fault. No doubt about that. However, while white merc is not criminally liable, he definitely contributed to the chain of events leading to the accident due to his ungracious, undefensive driving. \n\nFrom the vid, 2 things were evident \n\n1. Saab panic after clipping merc (who sped up to prevent overtaking). \n2. Saab went crazy fast after clipping as if to escape confrontation. \n\nIm betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThings would have been very different is merc slowed down, like a defensive driver would, when encountering siao langs on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud13l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":42,"subreddit":"singapore","type":"comment","id":"l0ud13l","datetime":"2024-04-23 12:07:31"}
	{"user":"FalseAgent","content":"yet another retarded sg driver. so what if others are speeding? you stick to the speed limit and drive safe. End of story. Everyone do this and play their part, we get safer roads. No need to be hero","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uep1i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0uep1i","datetime":"2024-04-23 12:21:36"}
	{"user":"Ceeja_y","content":"he wanted to post here but his acc didnt meet the requirements lol. oh well, he would still get an earful even if he did post here","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u77vi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":34,"subreddit":"singapore","type":"comment","id":"l0u77vi","datetime":"2024-04-23 11:21:18"}
	{"user":"BakeMate","content":"Hope the guilt eats him from inside. With more video surfacing of his driving behavior, he can write 10000 words essay all he wants, still a piece of shit\n\n> assuming I'm always like that\n\nYes you are. Nothing changed. It's a matter of whether you're caught on camera or not, and whether people want to upload","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7lcc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":76,"subreddit":"singapore","type":"comment","id":"l0u7lcc","datetime":"2024-04-23 11:24:08"}
	{"user":"MyColdDeadHandz","content":">As for the motorcycle incident, the motorcyclist was hogging the road, preventing me from going forward\n\nBut that was a single lane? Motorcyclist had all the right to be there in the middle of that lane. I've seen many drivers file up in two lines (when the road was wide enough, like in the clip) when filtering into an expressway, but this is the first time I've seen someone feel entitled in doing it.\n\nSounds like a real piece of work.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahrp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0uahrp","datetime":"2024-04-23 11:46:52"}
	{"user":"tolifeonline","content":"One young life was ended prematurely. The saying \"no parents should ever have to bury their child\" rings heavy in this incident. Imagine how inconsolable the father will be after waking up to find out his child has been taken away forever from him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2j2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uc2j2","datetime":"2024-04-23 11:59:38"}
	{"user":"dibidi","content":"his lawyers seeing his post: $$$$$$$","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udihn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0udihn","datetime":"2024-04-23 12:11:30"}
	{"user":"Initial_E","content":"In the 2-3 seconds of the incident both drivers were not making a conscious decision to goad each other, instead they were doing what they conditioned themselves to do. \nThere's no point asking \"what was going through his head\", it's what goes through his head every time he is behind the wheel that counts.\n\n\nSo it is with defensive driving. If it is a hat that you wear on your head, it should go on as automatically as wearing your seatbelt, should stay on for about just as long as you are wearing that seatbelt. And you can condition yourself to make it automatic. See, you already did it to wear a seatbelt.\n\nYou can't practice defensive driving only when you are nearly doing something dangerous, that's not how it works.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhxwn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhxwn","datetime":"2024-04-23 12:48:53"}
	{"user":"Common-Metal8578","content":"Heard other videos of him being an asshole driver are surfacing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo4s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ufo4s","datetime":"2024-04-23 12:30:00"}
	{"user":"KneeGal","content":"This Benz driver is an idiot but if you look at his [dashcam](https://imgur.com/a/YuwFzNz), after the contact, there is plenty of road left for the SAAB driver to brake. Instead it seems he sped up and ran directly into traffic. \n\nThe point of contact happened so far away from the junction that his involvement would have made no difference to the outcome.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0uea8q","datetime":"2024-04-23 12:18:02"}
	{"user":"ProfessionalMottsman","content":"Wow what a fool, never say anything in an accident as directed by your insurance company, they can refuse to cover you if you admit liability","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubboi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ubboi","datetime":"2024-04-23 11:53:37"}
	{"user":"RiskDry6267","content":"This merc also scum, open mouth to dig ownself bigger hole, edmw hurry up name and shame !","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhzil/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uhzil","datetime":"2024-04-23 12:49:17"}
	{"user":"Yokies","content":"Dude can't keep his mouth shut to save himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9hwk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0u9hwk","datetime":"2024-04-23 11:38:59"}
	{"user":"isleftisright","content":"Sd caused the accident by himself. He clearly had time to stop at the light but didnt. \n\nMd is a rude driver nonethless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdok/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubdok","datetime":"2024-04-23 11:54:03"}
	{"user":"CedaraThursday1314","content":"Self saboing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawb2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0uawb2","datetime":"2024-04-23 11:50:06"}
	{"user":"dibidi","content":"the root cause here is that there is no driving culture of giving way. \n\nevery driver drives like a race car driver. bec they see any pass by any other road user as a slight and sign of disrespect. \n\nroad safety will never be addressed in Singapore as long as gov doesnt address this culture.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udrb4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0udrb4","datetime":"2024-04-23 12:13:32"}
	{"user":"Formal_Judgment6481","content":"One of the most dumbass excuses. Hope this accident will forever haunt you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugemm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ugemm","datetime":"2024-04-23 12:35:58"}
	{"user":"peterthewiserock","content":"Benz drivers lawyer is going to have a field day with that post.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugfe6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ugfe6","datetime":"2024-04-23 12:36:07"}
	{"user":"subzephyr","content":"why tf he posting on a kids subreddit","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucyms/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ucyms","datetime":"2024-04-23 12:06:57"}
	{"user":"Ok-Tap4277","content":"Terrible cost to his behaviour escalating a bad situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ufo9n","datetime":"2024-04-23 12:30:02"}
	{"user":"pudding567","content":"What if the driver decides to sue for defamation? There is a Defence of Justification (truth) and Fair Comment though.\nhttps://irblaw.com.sg/learning-centre/defamation-in-singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2cj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh2cj","datetime":"2024-04-23 12:41:17"}
	{"user":"meister00","content":"He might or might not have indirect involvement in the accident (the accident might have still occurred even if he wasn't there), but regardless of that the merc driver is sure one of those asshole drivers.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9dc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh9dc","datetime":"2024-04-23 12:42:55"}
	{"user":"raymmm","content":"Just like how he sped up to \"tell\" the other driver to slow down. People are treating him like shit to \"tell\" him to stop being an asshole to other motorists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhdcb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhdcb","datetime":"2024-04-23 12:43:52"}
	{"user":"DiscipleOfYeshua","content":"1. This the guy behind the one who rushed into red light, yes?\n\nThe one behind directly (on right) or the one on left?\n\n2. Motorcycle prevented me moving forward means too slow for my taste / made me lose 12.3 seconds on way to red light? I mean, motorcycle didnt outright stop in the road, was just 10 kph too slow for this guy?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhv2v/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhv2v","datetime":"2024-04-23 12:48:11"}
	{"user":"jayaxe79","content":"Seems like the more he explained, more questions arises.\n\n- So he tried to push the blame away yet doesn't blame everyone for pointing the finger at him?\n\n- Did his actions actually indirectly caused the Saab driver to go crazy? By just speeding up to prevent overtaking? \n\nHe claimed that he isn't \"like the person outside these incidents\". Who the hell believes this statement?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8jiu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0u8jiu","datetime":"2024-04-23 11:31:31"}
	{"user":"okayokaycancan","content":"Take both off the roads and it will be a safer place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua4b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua4b7","datetime":"2024-04-23 11:43:52"}
	{"user":"stickytofw","content":"Everything he does from his driving, both during the time leading up to and outside of the recent tragedy, to his Reddit apology message just screams ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugc7m/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ugc7m","datetime":"2024-04-23 12:35:27"}
	{"user":"xthekonmanx","content":"And still not a single apology or sympathy for the accident victims super lanjiao lang! He did apologize for the long post though ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uh9tv","datetime":"2024-04-23 12:43:02"}
	{"user":"AdministrativeGas324","content":"This guy is so smart that he bid for his car licence plate number using his IQ score.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui1li/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui1li","datetime":"2024-04-23 12:49:48"}
	{"user":"Merecat-litters","content":"uh why this bastard what to \"Self Justification\" here. fk you mate...give Self Justification when giving your testimony in court you donkey see if they like.\n\nYou only saying this because you were one of the factor of the accident and were caught in the act you and are not sorry for it to happen but sorry for getting caught in the act. The way I am interpreting the writing is  to make you not be responsible fully but blame it on others. knnccb\n\nHopefully mod dont remove this too...and hopefully we can see this fucker face when they go to court cant wait to see the case.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui2c0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui2c0","datetime":"2024-04-23 12:49:59"}
	{"user":"crassina","content":"Can he also be charged with dangerous driving causing death? Because his actions seemed pretty dangerous to me","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicnq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uicnq","datetime":"2024-04-23 12:52:34"}
	{"user":"random_thoughts5","content":"Why did he post it in the sgexams subreddit? Isnt that a subreddit for secondary and JC students?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9tgk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9tgk","datetime":"2024-04-23 11:41:32"}
	{"user":"noelsupertramp","content":"Two cars racing each other on the premise of trying to slow the other party down. Nobody is gonna buy this reason.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubkkn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ubkkn","datetime":"2024-04-23 11:55:38"}
	{"user":"AsuraPhantoma","content":"The moment you sped up near a cross junction (or really, speeding up in general) you already lost the right to argue or say anything","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiai2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiai2","datetime":"2024-04-23 12:52:01"}
	{"user":"laubase","content":"I have never seen a Merc being driven competently on Singapore roads in 37 years. No signal before switching lanes? Probably a Merc. Intentionally cutting queues? Probably a Merc. Not checking blind spot before switching lanes? Probably a Merc. \"Lane splitting\" to deny others from overtaking them? Probably a Merc.The list goes on and on. \n\nI swear something drives (pun intended) these kinda people to buy Mercs, probably because they're trying to signal (again, pun intended) their superiority to the average Singaporean. \"Look at what I can afford, you plebs better give way to me because I am THAT much more important than you.\".\n\nAnyone buying a Merc should be subject to a compulsory TP road test.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uevgx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uevgx","datetime":"2024-04-23 12:23:07"}
	{"user":"freshcheesepie","content":"Good I can sleep well knowing that the comments are affecting him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6rnh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u6rnh","datetime":"2024-04-23 11:17:47"}
	{"user":"DeeKayNineNine","content":"To be fair, the Merc driver didn't cause the accident and didn't contribute to the cause of the accident. It would have happen with or without the Merc driver. The Saab was already speeding. \n\nWe still don't know what is wrong with that Saab driver. Was he drunk? Under drug? No license? Or just some reckless driver? We don't know yet. Let's wait for the authorities to release more info. \n\nThe merc driver is a jerk. You can see that from the other video. And I'm sure there are more. But he didn't cause the accident. And I hope this accident is a wake up call for him and will make him change to be a better driver from now on. Else we can be sure we'll see him online again.\n\nBy the way, I wonder if the Merc has car camera. I think he got an unblock view of the entire accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufjru/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufjru","datetime":"2024-04-23 12:28:57"}
	{"user":"Prov0st","content":"Why is everyones eyes on the white mercs?? The SAAB was doing the speeding. The white mercs is not free of sin but ultimately the direct culprit is the saab.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua3pq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ua3pq","datetime":"2024-04-23 11:43:44"}
	{"user":"Dulio_rosward","content":"If he truly felt guilty, then he should have been reflecting more on his actions since he contributed to the loss of those 2 lives.\n\nInstead he chose to spend his time trying to rationalise his actions to netizens.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8inb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0u8inb","datetime":"2024-04-23 11:31:20"}
	{"user":"Chrissylumpy21","content":"This guy needs to be banned from driving. Hes just sorry he got caught thats all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9s9o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9s9o","datetime":"2024-04-23 11:41:16"}
	{"user":"deangsana","content":"he doth protest too much","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uegtx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uegtx","datetime":"2024-04-23 12:19:40"}
	{"user":"ThenCheesecake","content":"shouldnt this explanation be taken with a grain of salt cause we cant confirm it was actually written by the driver themselves?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufqt7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufqt7","datetime":"2024-04-23 12:30:37"}
	{"user":"PartTimeBomoh","content":"Streisand effect. I didnt think anything of him till he decided to write this post","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo92/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ugo92","datetime":"2024-04-23 12:38:01"}
	{"user":"canceler80","content":"No proof that user is actual driver. Can be a troll account","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uixvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uixvo","datetime":"2024-04-23 12:58:00"}
	{"user":"livinglifeingrieve","content":"Lawyer: okay. 2 years jail. If good boy can come out in 8 months. 5 years ban on driving.\nJudge: okeh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj8x8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj8x8","datetime":"2024-04-23 13:00:50"}
	{"user":"Familiar_Guava_2860","content":"Where is the logic in one speeding up  to tell \nan overtaking driver to slow down?!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj9pb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj9pb","datetime":"2024-04-23 13:01:03"}
	{"user":"FitCranberry","content":"just another reminder that there can be people out there with a completely different headspace thats incomprehensible to yourself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujkc6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujkc6","datetime":"2024-04-23 13:03:48"}
	{"user":"Noobcakes19","content":"some of my previous post about this asshole was downvoted.\n\nwe saw his action on various dashcam including his own, He's indeed a major egoistic asshole.\n\neveryone : White merc driver is an asshole\n\nwhite merc driver:  Hold my beer..... I AM AN asshole!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtzb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtzb","datetime":"2024-04-23 13:06:18"}
	{"user":"Dizzy_Boysenberry499","content":"If you check One Motoring, he deregistered his car on 22 April","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk0k6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk0k6","datetime":"2024-04-23 13:08:02"}
	{"user":"KBDMASS","content":"surprisingly, most drivers have such mentality of speeding so that the other person wont over take.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklgb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklgb","datetime":"2024-04-23 13:13:37"}
	{"user":"signinj","content":"Oh no! The internet is judging me for my driving! Better come up with a WOT. That surely will make things better","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ule7o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ule7o","datetime":"2024-04-23 13:21:28"}
	{"user":"heyearthdude","content":"His stupidity knows no bounds. Who uses words like overkill when writing about a fatal accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ultcm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ultcm","datetime":"2024-04-23 13:25:41"}
	{"user":"Vindicted1501","content":"Just surrender to TP and they will investigate how much of a safe driver he is.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umjes/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umjes","datetime":"2024-04-23 13:33:00"}
	{"user":"EnvironmentalExam784","content":"Someone need to CSI this douchebag face out please.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzee/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzee","datetime":"2024-04-23 13:37:38"}
	{"user":"andrew_marc","content":"just by the way it is written you can tell he/she is self entitled/ultra defensive and someone who is never in the wrong","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzwi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzwi","datetime":"2024-04-23 13:37:46"}
	{"user":"Frequent-Switch-5699","content":"to the op: what you said, how you explain yourself is no longer useful now. Get ready for a session of formal investigation and get yourself a good lawyer to defend for yourself if you can afford. We shall let the evidence speak for itself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un2t4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un2t4","datetime":"2024-04-23 13:38:37"}
	{"user":"LT-Ghastly","content":"Just arrest this guy as well, for the safety of others and road users.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubcnm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ubcnm","datetime":"2024-04-23 11:53:49"}
	{"user":"HalcyoNighT","content":"Wait why tf did the merc driver make his post on r/sgexams? This is not TP exam","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubc60/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ubc60","datetime":"2024-04-23 11:53:43"}
	{"user":"pyroSeven","content":"Ask him to slow down by speeding up. Very good, didnt know they taught this at driving school \n\n\nSuck my lanjiao la.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udw03/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0udw03","datetime":"2024-04-23 12:14:40"}
	{"user":"jackgermeister","content":"Can ask him to post the unmuted version of the dashcam, then? Since he claimed to toot the motorcyclist, or ask the Saab driver to slowdown.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uedza/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uedza","datetime":"2024-04-23 12:18:59"}
	{"user":"Alive_Ad7522","content":"What the bull shit. Absolutely no remorse at all. Sick mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8v1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0u8v1q","datetime":"2024-04-23 11:33:55"}
	{"user":"Spiritual-Okra-7836","content":"oh my god this guy is a fucking moron. Take his license away NOW.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua8ut/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua8ut","datetime":"2024-04-23 11:44:52"}
	{"user":"lvofdifficulties","content":"Why did he post at /r/SGExams? He's a student?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9954/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0u9954","datetime":"2024-04-23 11:37:02"}
	{"user":"hawk_199","content":"Haha Streisand effect in play...if he didn't post this within a few days/weeks he would have been forgotten.\n\nGo and post this stupid justification and shoot himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhs1l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhs1l","datetime":"2024-04-23 12:47:25"}
	{"user":"CrossfittJesus","content":"Might be a hot take here but while the Merz is an asshole driver, I see the precious video of him a couple of days before the Tampines incident and the incident itself as mutually exclusive. IMO he didnt have that big a role to play in the Saab incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk9qq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk9qq","datetime":"2024-04-23 13:10:30"}
	{"user":"smurflings","content":"Not agreeing or disagreeing with this guy but why are people chewing him out for that incident? It's entirely the Saab driver's fault.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8rzg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0u8rzg","datetime":"2024-04-23 11:33:16"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue69a/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue69a","datetime":"2024-04-23 12:17:05"}
	{"user":"Winner_takesitall","content":"A sad by-product of our hyper competitive society: being unable to give, only know how to take..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uja1t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uja1t","datetime":"2024-04-23 13:01:08"}
	{"user":"foodloveroftheworld","content":"**When your 1000-word essay is due but you've only got 100 words of pure self-justification that miss the whole point.**","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukuo6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukuo6","datetime":"2024-04-23 13:16:05"}
	{"user":"MurkyConsideration98","content":"This chap is delulu.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uma4k/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uma4k","datetime":"2024-04-23 13:30:22"}
	{"user":"darrenoloGy","content":"typical narcissistic response.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un645/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un645","datetime":"2024-04-23 13:39:37"}
	{"user":"appealban","content":"this here is peak example of egoism/narcissism. gold medal mental gymnastics. hopefully the driver reads this and wake up his idea.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unvuv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unvuv","datetime":"2024-04-23 13:47:11"}
	{"user":"PerformanceCheap4074","content":"Gua Lan C**t with his GLC Mercs","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoefq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoefq","datetime":"2024-04-23 13:52:42"}
	{"user":"khaosdd","content":"A rich, GoonduLoserCunt-class driving asshole posting on an obscure subreddit?\n\nAlso glc camcar footage was uploaded by one Anthony Soon on fb who already locked his profile and disabled all comments. From the look of his profile and style, he doesn't seem like those who will browse reddit, much less r/SGExams.\n\nSo the op who posted there seems kinda sus to me. Could be an impersonator.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujb9c/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujb9c","datetime":"2024-04-23 13:01:26"}
	{"user":"buffyfluffy","content":"Yall gotta stop finding reasons to blame someone. Speeding on roads happen every single day in every single part of SG. Yes it's wrong, but that's not the reason for the 2 deaths. Speeding dont cause people to speed through a cross junction on a red light. Even on expressways you see those typical Ah beng BMW/VW/Mini speeders, they cut in and out dangerously but still manage to brake on time and cut in when the gap is right. This SAAB driver decided to try out GTA in real life but people still trying to find rationalize and find more people to blame in order to cope with this tragedy.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugr9t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugr9t","datetime":"2024-04-23 12:38:42"}
	{"user":"JakeAndRay","content":"When i first made comments about this guy i get downvoted like no ones business, now everyone shitting on him? Very good guys. Supreme echo chamber in here. \n\nSame shit happened during the initial covid outbreak. I say just stay home, not difficult exercise at home etc. Learn to think for yourselves guys. Pls downvote me no problem","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulxz7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulxz7","datetime":"2024-04-23 13:26:58"}
	{"user":"meowinbox","content":"How can you be so sure that's him though? Could be some reddit troll out to rage bait. Did he give any proof of identity?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7su1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0u7su1","datetime":"2024-04-23 11:25:45"}
	{"user":"Calamity_B4_Storm","content":"He thought he is playing uno but it all turn out to be oh no people Jia sai he also Jia Sai meh.. now he really KNS","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u99sb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0u99sb","datetime":"2024-04-23 11:37:10"}
	{"user":"Ambitious-Kick6468","content":"We should have a law to charge people who speed up when others are overtaking.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uejf9","datetime":"2024-04-23 12:20:17"}
	{"user":"imivan111","content":"Give this cunt the death penalty","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo5w/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugo5w","datetime":"2024-04-23 12:38:00"}
	{"user":"snookajam","content":"All the comments on driving should come with an identifier on how long the commentor has been driving on sg roads. Reading too many ridiculous things on the issue from people who probably dont know about the intricacies of driving on sg roads, or that road in particular.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueo81/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-3,"subreddit":"singapore","type":"comment","id":"l0ueo81","datetime":"2024-04-23 12:21:24"}
	{"user":"ProfessionalMottsman","content":"This is so common and its so dangerous. Do people not know there doing it ?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub6wi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":47,"subreddit":"singapore","type":"comment","id":"l0ub6wi","datetime":"2024-04-23 11:52:31"}
	{"user":"DiscipleOfYeshua","content":"Also boarding bus. \n\nWhen the side-loader aunties and occasional uncle pretend to not notice we all queuing, I sometimes hold my hands up to the sunlight to check whether Ive turned to a transparent ghost.\n\nLess risk of injury and death. Similar mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh7b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0uh7b7","datetime":"2024-04-23 12:42:27"}
	{"user":"RecognitionIcy7396","content":"I have driven in many countries and my observation is that Singaporeans are quite nice in real life but are really selfish drivers. How is it logical for someone to think that speeding up is going to get someone else to slow down?\n\nAnd if someone wants to come into your lane, maybe just let them? This guy keeps saying he had an emergency to attend to but maybe he should have left earlier or prepared more in advance so that he doesnt have to use these dangerous tactics. His poor planning shouldnt put everyone elses lives in danger.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugndy/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":16,"subreddit":"singapore","type":"comment","id":"l0ugndy","datetime":"2024-04-23 12:37:50"}
	{"user":"Lv3_Potato_Farmer","content":"Just because everyone is doing it doesnt make it right","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawvv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0uawvv","datetime":"2024-04-23 11:50:14"}
	{"user":"Realistoliberato","content":"It's of waste of fuel. And fuel is bloody expensive in Singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uizax/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uizax","datetime":"2024-04-23 12:58:22"}
	{"user":"CriticizeSpectacle7","content":"This is the reason sg drivers don't signal. Once u signal, ppl will simply speed up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue2rg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0ue2rg","datetime":"2024-04-23 12:16:16"}
	{"user":"MessyBoomer","content":"I swear some drivers speed up when I approach a pedestrian crossing to try and go through before I start crossing too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj6nk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uj6nk","datetime":"2024-04-23 13:00:15"}
	{"user":"Diligent_Soup_1069","content":"Definitely,many a times I have signaled to exit out of the highway but motorbikes and cars on the slower lanes will just speed up past you suddenly as if you signaling is a sign that there's a GSS right up ahead. \n\nThe mercedes has nothing to do with the accident persay but I do feel TP should at least look into his reckless driving habits and ego issues on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk6k4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk6k4","datetime":"2024-04-23 13:09:38"}
	{"user":"MicTest_1212","content":"Now he admitted publicly in black and white that he did speed up to prevent the Saab from taking over. \n\n Stupid, Egoistic, and Narcissistic ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerc7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":135,"subreddit":"singapore","type":"comment","id":"l0uerc7","datetime":"2024-04-23 12:22:08"}
	{"user":"drinkingbobatea","content":"He had to.... bc he is trying his absolute hardest to be a genuinely nice person...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucbip/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":45,"subreddit":"singapore","type":"comment","id":"l0ucbip","datetime":"2024-04-23 12:01:39"}
	{"user":"transcendcosmos","content":"I think he had to cos his name was already doxxed in HWZ. Had a separate incident a few days before where he behaved terribly too.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufnzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ufnzd","datetime":"2024-04-23 12:29:57"}
	{"user":"Brief_Worldliness162","content":"Smh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufl9p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufl9p","datetime":"2024-04-23 12:29:19"}
	{"user":"Fensirulfr","content":"I agree. From the available videos, it is not exactly clear what was the white car's intention at first. He probably should have asked a lawyer to read through what he was about to post online.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulykc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulykc","datetime":"2024-04-23 13:27:08"}
	{"user":"uniquely_ad","content":"I was right all along, drive long enough and I know what the merc was doing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un92f/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un92f","datetime":"2024-04-23 13:40:27"}
	{"user":"fredczar","content":"Its likely fake? How sure are we that this is the actual driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj10r/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uj10r","datetime":"2024-04-23 12:58:47"}
	{"user":"dylank999","content":"Better to close your mouth and let people think you're stupid than open it and prove it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtay/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtay","datetime":"2024-04-23 13:06:07"}
	{"user":"beklog","content":"same logic as with my ex:\n\n\"I cheated on u so u can pay attention to me\" \\___/","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6owe/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":225,"subreddit":"singapore","type":"comment","id":"l0u6owe","datetime":"2024-04-23 11:17:12"}
	{"user":"icwiener25","content":"'Don't speed up if you see another vehicle trying to overtake you' is literally one of the first things that is taught in Basic Theory when taking one's license.\n\n  \nAuthorities should probably check whether he even has a valid drivers' license.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udsxf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":46,"subreddit":"singapore","type":"comment","id":"l0udsxf","datetime":"2024-04-23 12:13:55"}
	{"user":"Prov0st","content":"Typical mindset of some Singaporean drivers, overtaking/ signalling = I MUST SPEED UP!!!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9x86/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":52,"subreddit":"singapore","type":"comment","id":"l0u9x86","datetime":"2024-04-23 11:42:19"}
	{"user":"Jizzipient","content":"You see officer, I invited these young girls to my home to warn them about the dangers of what could have happened if you meet randos on the internet. It's educational!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahpl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0uahpl","datetime":"2024-04-23 11:46:52"}
	{"user":"Party-Ring445","content":"Cannot lose mentality..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucpiz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ucpiz","datetime":"2024-04-23 12:04:51"}
	{"user":"ihavenoidea90s","content":"This guy sucks at gaslighting as much as he does driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ualql/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ualql","datetime":"2024-04-23 11:47:45"}
	{"user":"Critwice","content":"he think he TP lmao, can't see through his big fat ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8622/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0u8622","datetime":"2024-04-23 11:28:35"}
	{"user":"kyrandia71","content":"Last time in driving school, the instructors teach you to slow down if someone is tailgating you and not speed up. Either slow down or just filter to left lane to let other vehicle overtake. Is like someone stare at you want to fight, instead of looking away or say sorry to de-escalate, one stares back and says, \"kua simi?\"","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaf6t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0uaf6t","datetime":"2024-04-23 11:46:17"}
	{"user":"Vedor","content":"Just goes to show how highly he thought of himself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucnwd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ucnwd","datetime":"2024-04-23 12:04:28"}
	{"user":"Pitiful_Blackberry67","content":"Exactly, What was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9ej5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0u9ej5","datetime":"2024-04-23 11:38:16"}
	{"user":"thewind21","content":"Driver thinks he is a vilgante. Upholding the traffic rules.\n\nEarn too much. Head too big","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueacq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ueacq","datetime":"2024-04-23 12:18:04"}
	{"user":"splash8388","content":"Correct. Why need to tell him to slow down by chasing him? Just let him (Saab driver) be.  He (saab) is responsible for his own action ultimately. Why get involved as if you can tell the Saab driver to slow down ?  Saab driver may think you are trying to race with him. \nIt's a double edge sword for the merc driver with this action.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicrs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uicrs","datetime":"2024-04-23 12:52:35"}
	{"user":"roksah","content":"I think need IQ test instead of driver test","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiykm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uiykm","datetime":"2024-04-23 12:58:11"}
	{"user":"RealityLongjumping13","content":"If you are reading this and is really your thought at that point of time, it's WRONG.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9vf3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0u9vf3","datetime":"2024-04-23 11:41:56"}
	{"user":"TOFU-area","content":"smartest sg driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud4ez/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ud4ez","datetime":"2024-04-23 12:08:17"}
	{"user":"MilkTeaRamen","content":"Breaking News: Singapores driver population halves overnight. Government to temporary scrap COE measures. CAT A cars below 50k.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udilq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":63,"subreddit":"singapore","type":"comment","id":"l0udilq","datetime":"2024-04-23 12:11:31"}
	{"user":"mako-lollipop","content":"First time drivers would have a higher BP when they drive though. Need to make driving license expire after 10 years so have to retake","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0uea8d","datetime":"2024-04-23 12:18:02"}
	{"user":"CisternOfADown","content":"It seems all the driving lessons go out the window once they get licence. Drivers need a 'refresher'. I suggest licences to be renewable every 2 years with a theory test at least. I'm sick of seeing drivers zooming past zebra crossings or not waiting for pedestrians to completely cross at traffic lights.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uljvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uljvo","datetime":"2024-04-23 13:23:03"}
	{"user":"Party-Ring445","content":"Brain is still in primary school","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udgx9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":59,"subreddit":"singapore","type":"comment","id":"l0udgx9","datetime":"2024-04-23 12:11:09"}
	{"user":"ilovenoodles06","content":"Guy is probably a rich kid i assume","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud5o1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ud5o1","datetime":"2024-04-23 12:08:35"}
	{"user":"Lostwhispers05","content":"Perhaps because he created a throwaway account and r/sgexams has less strict posting requirements? Just speculating - I don't actually know r/sgexam's posting requirements.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf3ll/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0uf3ll","datetime":"2024-04-23 12:25:04"}
	{"user":"captwaffles-cat","content":"Student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueq9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ueq9n","datetime":"2024-04-23 12:21:53"}
	{"user":"FalseAgent","content":"because this subreddit is awful so now there are splinter communities","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejgj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uejgj","datetime":"2024-04-23 12:20:18"}
	{"user":"canceler80","content":"Troll account and is fake?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um5fm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um5fm","datetime":"2024-04-23 13:29:03"}
	{"user":"drlqnr","content":"not enough karma to post here i think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umfvp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umfvp","datetime":"2024-04-23 13:31:59"}
	{"user":"KopiSiewSiewDai","content":"I dont think the Merc driver is at fault for the accident at the cross junction. He is just a shitty driver who happened to be at the wrong place. \n\nThe bulk of the fault is still on the Saab driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zv4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":82,"subreddit":"singapore","type":"comment","id":"l0u9zv4","datetime":"2024-04-23 11:42:53"}
	{"user":"Carbonaddictxd","content":"Precisely, why are all the comments blaming md just because he's not a nice driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9bfs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9bfs","datetime":"2024-04-23 11:37:33"}
	{"user":"whimsicism","content":"This, it really feels like deflection to me when people blame the merc driver. He's a bad driver and annoying af but he didn't actually cause the incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueie3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0ueie3","datetime":"2024-04-23 12:20:03"}
	{"user":"danorcs","content":"Unfortunately I think the Merc driver is partially responsible\n\nYou know exactly what the SBs defence attorney will say:\n\nyour honour, my client was travelling along the straight road and was changing lanes in the process of overtaking a motorbike when a white merc unexpectedly aggressively accelerated, sideswiping my clients car at high speed and nearly causing it to slide and mount the kerb \n\nThis was an accident that the merc driver could have prevented at anytime by not accelerating and allowing the SB to pass, despite his claims that he was potentially forced to mount a kerb\n\nMy client was shocked at being side swiped at high speed and in a lapse of judgement he panicked and accelerated away from the dangerous Merc driver\n\nMy client was so agitated by the aggressive Merc driver that he constantly kept checking for said driver on the rear wheel window, and most unfortunately failed to notice that he was reaching a red light, causing the tragic accident for which he is apologetically here today\n\nIf I provoke someone into a frenzied state and he accidentally kills someone in a fit of panic, I may still be culpable in SG. It would require detailed legal examination at the very least","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul678/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul678","datetime":"2024-04-23 13:19:15"}
	{"user":"Alive-Confection3690","content":"Idk i kinda disagree here. md didnt cause the accident but he definitely aggravated the sd driver partially to do it. Majority of the fault is still on the sd of course but if md could swallow that petty pride of being overtaken, this accident might not have happened.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf1ev/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uf1ev","datetime":"2024-04-23 12:24:31"}
	{"user":"Possible-Grocery6244","content":"i do think that the merc hold partial responsibility for the accident, or at least he was the catalyst for it. Assuming that SAAB was trying to do a hit and run after the sideswipe (not because of brake failure), merc not speeding up wouldnt have made SAAB driver to react the way he did. Now, im not saying that SAAB driver is absolved of any responsiblity, but the merc driver should be held accountable as well.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea2p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0uea2p","datetime":"2024-04-23 12:18:00"}
	{"user":"Party-Ring445","content":"Victim should sue him for all he's worth. And add to that criminal charge and canning","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud91d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ud91d","datetime":"2024-04-23 12:09:24"}
	{"user":"Geminispace","content":"As I mentioned in other Reddit post, these drivers will never admit their fault but the fault of everyone else. Probably the Saab driver out there blaming the vans and the car in front for turning despite green light","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiju3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uiju3","datetime":"2024-04-23 12:54:23"}
	{"user":"velvetstigma","content":">Im betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThis is most definitely what happened here. He didn't expect the merc to speed up and thus clipping the merc. Once there was a hit, he panicked and only looked at the rear mirror whole hoping to speed through the junction, not realizing there was traffic ahead.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukbp3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukbp3","datetime":"2024-04-23 13:11:02"}
	{"user":"tens919382","content":"nah.  definitely on drugs.  who the fk cuts in like that","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uijq3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uijq3","datetime":"2024-04-23 12:54:21"}
	{"user":"Prov0st","content":"He would get outright nuked if he posted in this thread.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9z20/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0u9z20","datetime":"2024-04-23 11:42:43"}
	{"user":"darrenoloGy","content":"Exactly, single lane hog simi, not like the motorcycle was crawling at 10-20km/h. lame excuse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unxm5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unxm5","datetime":"2024-04-23 13:47:42"}
	{"user":"rafalim021","content":"100% spot on.\n\nPeople are just jumping on the Merc driver because:\n\n1. Its an opportunity for people to whack the everyday assholes on SG roads that speed up to stop someone from overtaking\n\n2. Its a Merc - and a more powerful engine model at that.\n\n\nGuy is definitely no saint though and his latest posts are abit of a clownfest and indicative of his fragile ego.\n\nI just hope this doesn't divert attention away from the SAAB driver who deserves everything he gets and more.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujjc1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujjc1","datetime":"2024-04-23 13:03:32"}
	{"user":"Eseru","content":"That's the thing that really puzzles me. It's one thing if the junction was right after the bend and the Saab didn't have time to slow down. Or he was trying to beat the red light and the other cars had just started moving.  \n  \nBut the Saab had a lot of time and road to slow down after overtaking. It also looks like the light had already turned red. He just plowed straight into the traffic which was already moving across the junction without even attempting to brake? What the hell was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un3yx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un3yx","datetime":"2024-04-23 13:38:58"}
	{"user":"wwabbbitt","content":"He's not the cause but he's the trigger","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un02l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un02l","datetime":"2024-04-23 13:37:49"}
	{"user":"jlonso","content":">would have made no difference to the outcome.\n\nIt's really hard to measure the impact of benz's involvement in this.\n\nDoes SAAB have enough time and distance to stop at the junction? Yes. The reason for not stopping? Hit & Run?\n\nI wouldn't go as to say it made no difference to the outcome. The outcome could be different if that initial contact wasn't made.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un85x/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un85x","datetime":"2024-04-23 13:40:12"}
	{"user":"AdeptPlanktonk","content":"It's a trait of egomaniacs, narcissists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufpgn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ufpgn","datetime":"2024-04-23 12:30:18"}
	{"user":"tryingmydarnest","content":">address this culture.\n\nHow though? Enforcement will be an issue, unless we allow citizens to go bounty hunting.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukal6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukal6","datetime":"2024-04-23 13:10:44"}
	{"user":"jlonso","content":"Lawyer don't have to do shit. No way to verify account is his.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umcup/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umcup","datetime":"2024-04-23 13:31:10"}
	{"user":"NekoIdo","content":"Good point!\n\nu/SNH7Z good luck!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiii5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiii5","datetime":"2024-04-23 12:54:03"}
	{"user":"Eshuon","content":"Uni students too, but yeah thats why it was removed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubo25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ubo25","datetime":"2024-04-23 11:56:24"}
	{"user":"PhantomWolf83","content":"Don't forget about the BMWs.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh1yu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uh1yu","datetime":"2024-04-23 12:41:12"}
	{"user":"BearbearDarling","content":"> It would have happen with or without the Merc driver. \n\nYeah, we really don't know that. Yes, the saab was speeding to begin with. But to say a speeding driver will surely beat red light and cause a collision down the road is pure speculation. There are speeding vehicles on the road everyday who don't get into accidents. Moreover, the saab displayed some control by maneuvering and switching lanes trying to overtake. He didn't just crash into the rear of the merc. He didn't barrel over the motorbike. That shows some control on his part even if he was driving dangerously. Versus his conduct at the cross junction where he just plows straight through like a bullet. There is some contrast in his behavior.\n\nThe merc provoking the ssab by speeding up to in attempt to block the overtaking and the saab clipping the merc are not insignificant events. It's possible that they had an effect on the saab driver's state of mind. He could have become blinded with rage and tried to floor it to hit and run. Even so, I think that the merc cannot be legally liable for the collisions at the junction. But you can't tell me the merc is completely uninvolved as if he was a mere bystander. And the worst thing is two lives are lost. One cannot help but wonder if the merc had simply let the saab go on its way, perhaps what happened at the junction might have been different.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uny28/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uny28","datetime":"2024-04-23 13:47:50"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorqc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorqc","datetime":"2024-04-23 13:56:41"}
	{"user":"MyNameIsOnce","content":"no info to dig for the saab driver. the most i personally found about the saab is a sgcarmart ad of the car before it was sold and it might not be the same car (but the colour and rims match + its a very rare car model, so it would be too much to be a coincidence)\n\ni wonder if there are any previous dashcam vids of the saab (SLD1505R) around.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucygd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ucygd","datetime":"2024-04-23 12:06:55"}
	{"user":"wirexyz","content":"I dont understand also. SAAB speed and beat red light and killed 2. But somehow Benz is at fault because he never give way to the SAAB that is speeding like crazy.\n\nSo next time I see someone breaking the law I need to give way to them instead of preventing from committing a crime? I am glad there is court with fairness here cause I think public opinion is a bit wrong.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udc6h/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0udc6h","datetime":"2024-04-23 12:10:08"}
	{"user":"musicmonkay","content":"Did he really contribute tho? \n\nShitty driver that I will curse in my heart if I met on the road yes \n\nBut he didnt force the Saab to speed, or do anything \n\nIf anything he was also sideswiped in the video right? Unless I saw wrongly which in any situation even though he did a dick move by speeding up, would be the merging driver (Saab)s fault\n\nIt is 100% in the Saab drivers control whether to speed or drive recklessly, as much as a bad driver the merc was, he/she wasnt even near the Saab when the accident happened","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc4gl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uc4gl","datetime":"2024-04-23 12:00:05"}
	{"user":"Haunting-Owl","content":"methinks too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhyfc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhyfc","datetime":"2024-04-23 12:49:01"}
	{"user":"KopiSiewSiewDai","content":"He cannot post anywhere else I think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua1k5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua1k5","datetime":"2024-04-23 11:43:16"}
	{"user":"haaaaaairy1","content":"Probably cause one of the victims was a student so trying to pander to that demographic.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua9xj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ua9xj","datetime":"2024-04-23 11:45:06"}
	{"user":"A_extra","content":"Because one of the victims killed was a jc student","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadca/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uadca","datetime":"2024-04-23 11:45:52"}
	{"user":"Sacred-Turnip","content":"Because people are also sick and tired of such driving behaviour like the merc driver practice. Apparently, he was also caught on camera on another occasion driving aggressively, likely proving his bad actions are not limited to that incident. In addition, people are also not buying his reply in trying to make himself sound like a saint.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub0lj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ub0lj","datetime":"2024-04-23 11:51:04"}
	{"user":"Alive_Ad7522","content":"Ppl are slamming him not for causing the eventual crash.  It is his driving posture and attitude that is undesirable.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u991l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u991l","datetime":"2024-04-23 11:37:00"}
	{"user":"lurkinglurkerwholurk","content":"Wrong place at the wrong time syndrome. That, and apparently theres plenty of evidence his default driving is a dick, AND him also tries to taichi his (tiny) contribution to the Saab drivers crash, a perceived running away from responsibility in an emotionally charged moment = a wild acceptable target appears. \n\nThrowing fuel into the fire, basically. He totally isnt the cause of that fire, but","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uffx3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uffx3","datetime":"2024-04-23 12:28:02"}
	{"user":"areunut1","content":"You can blame both at once. They are not mutually exclusive \n\n\nblame Saab driver for causing incident + blame Merc for driving like an idiot","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiex4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uiex4","datetime":"2024-04-23 12:53:07"}
	{"user":"Upper-Discount5109","content":"People always want someone to blame, always want to feel heard in the mob.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub523/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ub523","datetime":"2024-04-23 11:52:06"}
	{"user":"Spiritual-Okra-7836","content":"if this idiot had let him overtake none of this might have happened either. So he is also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahgt/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0uahgt","datetime":"2024-04-23 11:46:49"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue6a9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue6a9","datetime":"2024-04-23 12:17:06"}
	{"user":"NekoIdo","content":"Hence the word alleged in the title","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8f6n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u8f6n","datetime":"2024-04-23 11:30:35"}
	{"user":"GrammarNaziii","content":"This was my first reaction as well. Literally *anyone* could've created the account and wrote this shit up, but it seems like everyone here is just taking it at face value.\n\nWhat if it was the motorcycle driver who created this spiel to make the guy look even worse? Crazy sia.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufp25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ufp25","datetime":"2024-04-23 12:30:13"}
	{"user":"ailes_d","content":"They know, they still dont want to let other people cut them","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufv18/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":29,"subreddit":"singapore","type":"comment","id":"l0ufv18","datetime":"2024-04-23 12:31:38"}
	{"user":"hawk_199","content":"Basic logic but not many people have it and not taught in driving school tbh...At least I don't recall.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhwf0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhwf0","datetime":"2024-04-23 12:48:31"}
	{"user":"ivananiki","content":"But... he said he was a safe driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulfse/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulfse","datetime":"2024-04-23 13:21:54"}
	{"user":"Organic-Custard6243","content":"For some reason it is quite prevalent among Singaporean driver. When I drive overseas I find that they are more willing to give way. \n\nPerhaps, better legislation can help control this behaviour?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unc75/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unc75","datetime":"2024-04-23 13:41:22"}
	{"user":"Common-Metal8578","content":"There is no logic. The asshole is trying to rationalise his guilt and hope people agree with him. Even when you watch this guys own camera footage. He maintains the same distance from the motorcycle until the black car comes beside him. Suddenly he catches up with the motorcycle very quickly. Suddenly have an emergency? At that very moment? Anyway This kind of memory will eat him from the inside for the rest of his life and we don't need to help him with it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhknu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0uhknu","datetime":"2024-04-23 12:45:40"}
	{"user":"InfiniteDividends","content":"That's a poor reason to not signal, I still do. If the car behind speeds up, sure, I'll just lane change after you pass then. Life is too short to rage over idiots like that.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj97g/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":36,"subreddit":"singapore","type":"comment","id":"l0uj97g","datetime":"2024-04-23 13:00:55"}
	{"user":"abgnerd","content":"I think this kind of logic is something we need to eradicate. I don't do XXX cos of YYY, when XXX is the correct thing to do.\n\nSignal your intentions. \n\nIf the other person speeds up to block you then they are the ass, you just wait for the next opportunity to switch lanes.\n\n\"I don't signal cos other drivers will speed up and block.\" \n\nThese are the same drivers who will speed up and block people who signal intentions. These are the drivers that never signal and cut into lanes.\n\nDownvote me if you feel slightly targeted by this post, but I think some people on Reddit are guilty of bad road manners and it shows.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulogn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulogn","datetime":"2024-04-23 13:24:18"}
	{"user":"splash8388","content":"Not really for me. I signal ahead as a form of respect to pre-alert that I intend to change lane. I will only change lane when no vehicles are very near my vehicle. This also deter motorcyclist who might speed up to squeeze between 2 cars  I do not think I am rude after I force my way into my desired lane once I give ample time. The reason is I already give ample notice my intention to change. U cannot blame me after that just because you don't like to give way. Ha ha.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujg5u/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujg5u","datetime":"2024-04-23 13:02:42"}
	{"user":"MojaMonkey","content":"The only thing the driver is signalling is weakness.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueg0t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ueg0t","datetime":"2024-04-23 12:19:27"}
	{"user":"Fluffy-Nature-2087","content":"If they speed up when I signal, I will use my brains to overtake the car behind them and drive behind that fella who sped up. Then when that fella slip up on the road while infront of me, I would have it on dashcam and then later file a police report against them with it just to ruin their day or at least to let the police have a record of them slipping up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6m2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6m2","datetime":"2024-04-23 14:01:13"}
	{"user":"szab999","content":"yeah probably his lawyer told him to take it down.. but the internet never forgets","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufa4j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ufa4j","datetime":"2024-04-23 12:26:40"}
	{"user":"Twrd4321","content":"Unless it is possible to verify the person who wrote the post as the person who drove the car, it cannot be administered as evidence. \n\nAnyone can claim to be anyone on Reddit. Thats why usually for ask me anything, mods usually ask for proof. It is not good enough for someone to claim in the post they drove the car.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulawo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulawo","datetime":"2024-04-23 13:20:33"}
	{"user":"pureeyes","content":"Genuinely nice people would give way to others or at least be remorseful over their part in an accident that's killed two people ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucmtv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0ucmtv","datetime":"2024-04-23 12:04:14"}
	{"user":"HungryEdward","content":"I went to see after reading your comment. Seems he doxxed himself by using his own Facebook account to post his dashcam footage.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2s2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh2s2","datetime":"2024-04-23 12:41:23"}
	{"user":"PhantomWolf83","content":"It's been almost 20 years since I got my licence but I'm sure as hell they didn't teach that kind of defensive driving at BBDC...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u75n0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":87,"subreddit":"singapore","type":"comment","id":"l0u75n0","datetime":"2024-04-23 11:20:49"}
	{"user":"kumgongkia","content":"I will declare war on everyone to achieve world peace.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujnpr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujnpr","datetime":"2024-04-23 13:04:41"}
	{"user":"may0_sandwich","content":"Lol, 90% of drivers behave this way, are you suggesting all of them may not have a drivers license?? I think the real issue here is the shitty attitude that's been normalised in Singapore.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhiu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhiu9","datetime":"2024-04-23 12:45:12"}
	{"user":"erisestarrs","content":"I signal when I want to change lane not to get people to give way to me, but so the car will speed up and I can change into the lane BEHIND them.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui4r2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0ui4r2","datetime":"2024-04-23 12:50:36"}
	{"user":"Ok-Recommendation925","content":"His gaslighting won't work, especially when two people are dead....\n\nIn fact those two deaths make this clown look and sound like the devil (and an ass-clown-hole)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue7co/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ue7co","datetime":"2024-04-23 12:17:22"}
	{"user":"thewackykid","content":"yeah... to tell someone to slow down u should slow down yourself (NOT speed up).. if he don't listen and speed up then is not your fault... but at least he would have overtaken u safely and that will be the end of it...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubw58/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubw58","datetime":"2024-04-23 11:58:11"}
	{"user":"Noobcakes19","content":"he's Bruised Wean.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk3us/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk3us","datetime":"2024-04-23 13:08:54"}
	{"user":"Anphant","content":"Nah, behavioural test is more important. Stupid people can always be taught. Not so much for self-centred/obnoxious ones","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl96/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl96","datetime":"2024-04-23 13:44:03"}
	{"user":"Jay-ay","content":"Subscribed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8m9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0ug8m9","datetime":"2024-04-23 12:34:43"}
	{"user":"XLStress","content":"Fuck yeah.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uocg7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uocg7","datetime":"2024-04-23 13:52:06"}
	{"user":"I_Miss_Every_Shot","content":"Maybe need to retake and reassess after every 5-10 years. Check for bad habits","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufdye/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufdye","datetime":"2024-04-23 12:27:34"}
	{"user":"Brief_Worldliness162","content":"I thought he's 42 years old?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufttb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufttb","datetime":"2024-04-23 12:31:21"}
	{"user":"Stormagedd0nDarkLord","content":"Bulk? I'd say all of the fault is on the Saab driver for the accident. You can't be held responsible for someone doing a hit and run on you and zooming off. It's not like md floored it to chase after him. I think he reached the lights same time as the motobike.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udzcv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0udzcv","datetime":"2024-04-23 12:15:28"}
	{"user":"ssepaulette","content":"You guys should watch the video again. 5-6s mark frame by frame. Black car was already about to complete the overtaking and white car sped up. \n\nThis is different from asshole driver inching forward to prevent people from cutting which I believe is what you are talking about.\n\nPortion of the black car has already crossed the divider and white car sped up hitting black car in the center. Any further in the rear and black car could have spun out of control and may have killed the motorcyclist.\nThis is reckless driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue822/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ue822","datetime":"2024-04-23 12:17:32"}
	{"user":"Ok-Recommendation925","content":"Basically MD is the guy that was on his way to join a riot. But because he was late to the rally point, and the rioting was started by SD happening (with public opinion against the rioters), he simply joined the onlooker crowds and joined them in being \"kaypoh/what-happened?\"\n\nLOL","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uerf9","datetime":"2024-04-23 12:22:09"}
	{"user":"Background_Tax_1985","content":"Yeap agreed.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0uadu9","datetime":"2024-04-23 11:45:59"}
	{"user":"Background_Tax_1985","content":"Probably easier to blame him since he identified himself plus he was acting like a dick and i guess merc? \n\nI think once they announce who sd is everyone will be having a field day with him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zkz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9zkz","datetime":"2024-04-23 11:42:50"}
	{"user":"soulless33","content":"yeah same thing I told my friends.. the merc drive is an ass but he did not cause the accident..\n\nit's like everyone trying to explain why the driver plough thru the traffic and the merc driver is a scapegoat..\n\nend of the day its a terrible tragedy let us not assign blame, instead keep our prayers to those still in hospital..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaidk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uaidk","datetime":"2024-04-23 11:47:01"}
	{"user":"Background_Tax_1985","content":"Bro if im the dpp ah:\n\n1) your client is already speeding before he tried to overtake the white merc.\n\n2) why does your client need to overtake the 2 other vehicles at such high speed? That is not normal behaviour.\n\n3) a normal individual would have immediately stopped after the accident to check for damage, exchange info etc, not continue speeding\n\n4) it near impossible for a person to be that provoked in such a short span of time (say from bruce banner to hulk in 3s~5s)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up1d3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up1d3","datetime":"2024-04-23 13:59:38"}
	{"user":"Background_Tax_1985","content":"Nah. Sd was already speeding prior to the sideswipe and driving too aggresively, so it can't really be said that md aggravated him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufbjx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ufbjx","datetime":"2024-04-23 12:27:00"}
	{"user":"Background_Tax_1985","content":"I disagree. Sd was already speeding before the side swipe and carried on speeding after. Md's action is unrelated to the accident, even if is at fault for his behaviour.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf45d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uf45d","datetime":"2024-04-23 12:25:12"}
	{"user":"Vedor","content":"Such people confirm will just delete his account if he ever get nukes.\n\n\nIn the very first place, do you think he will post such thread if his licence plate wasn't made known to everyone?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucuaq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ucuaq","datetime":"2024-04-23 12:05:58"}
	{"user":"KneeGal","content":"I disagree. He is an asshole driver for sure but he is not the trigger because the SAAB was already speeding before the Merc noticed him (and started speeding up). Unless he has pre-cog, there is no reason for him to be going so fast in the first place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up2b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up2b7","datetime":"2024-04-23 13:59:55"}
	{"user":"KneeGal","content":"He was already speeding before he came into contact with the Merc. \n\nHe was still speeding after he came into contact.\n\nWhy do you think the outcome would have been different? It would be one thing if he was not speeding before and then sped after or vice versa. But he was constantly speeding.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uokul/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uokul","datetime":"2024-04-23 13:54:37"}
	{"user":"dibidi","content":"see how UK updated the highway code to include the hierarchy of road users requiring all road users to defer to the most vulnerable road users at all times. \n\nwith that rule in place any accident that happens the responsibility is automatically on the road user in the larger vehicle. insurance liability means de facto compliance. \n\nnow most everyone in the UK gives way.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklbw/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklbw","datetime":"2024-04-23 13:13:36"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorr4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorr4","datetime":"2024-04-23 13:56:41"}
	{"user":"Possible-Grocery6244","content":"because there is reasoning behind the speeding and the merc driver caused it. No one is saying SAAB is not at fault, but the merc driver definitely should share some responsibility because he was the one who sped up and induced the situation for the SAAB to sideswipe the merc, and in turn the SAAB driver panicked and wanted to hit and run hence speeding up after the sideswipe (assuming there is no brake failure). If the merc driver did not speed up, the subsequent chain of events wouldnt have occured","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf975/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf975","datetime":"2024-04-23 12:26:27"}
	{"user":"RiskDry6267","content":"Benz is being scolded for being an ego idiot.\nIf give way 100% no accident. Even though SAAB is probably 90% at fault.\nThe news story could have easily been the SAAB buah the Mercedes then crash him and both cars burning on the side of the road, and merc driver died, then what will we all say online? Asking for it right ? \nGive way from the start none of this shit will happen. Motorcycle bro in front also thank his lucky stars he wasnt collateral damage","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uieem/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uieem","datetime":"2024-04-23 12:52:59"}
	{"user":"smurflings","content":"Seeing, just in the replies to my post at least one blaming him for causing this eventually crash.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2zo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc2zo","datetime":"2024-04-23 11:59:45"}
	{"user":"Upper-Discount5109","content":"Multiple choices for saab driver after not being allowed to overtake. He could've waited, could've slowed down and overtake later, but he chose to chiong which eventually caused the accident. White merc = inconsiderate at most, didn't cause the accident. Saab driver = His decision, his consequences","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdyp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ubdyp","datetime":"2024-04-23 11:54:06"}
	{"user":"smurflings","content":"And if you had walked a different direction that day, none of this might have happened either! So you're also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubxw8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0ubxw8","datetime":"2024-04-23 11:58:35"}
	{"user":"crispyprata","content":"Ok?  if Temasek JC didnt organize an event at bedok reservoir the student would still be alive so TJC is also partly to blame /s","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uivg6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uivg6","datetime":"2024-04-23 12:57:22"}
	{"user":"meowinbox","content":"Bro, you and I both know that word doesn't make that much of a difference. \n\n\nI'm sure *you* are aware that he could just be trolling, I'm not singling *you* out in particular. My comment was also directed at the others already dragging him as though he's really going to be here reading these comments.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9i1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-21,"subreddit":"singapore","type":"comment","id":"l0u9i1q","datetime":"2024-04-23 11:39:00"}
	{"user":"alexand3rl","content":"It's taught in driving school. BTT literally has the question where if someone is trying to overtake you, you should slow down and assist the motorist to help overtake you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6zn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6zn","datetime":"2024-04-23 14:01:19"}
	{"user":"zchew","content":"Yes, he teach others how to drive safely by speeding up to block them. Very safety. Huehuehuehue","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl7s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl7s","datetime":"2024-04-23 13:44:03"}
	{"user":"theony","content":"> The asshole is trying to rationalise his guilt \n\nHe feels no guilt, he thinks he's a tragic hero who failed to achieve his goals even though his actions were heroic. That's why he posted his own video up, and made multiple reddit posts justifying his actions. \n\nThis kind will never, ever learn. The only thing he will take away from being slammed on the internet will be \"internet is stupid\". If the police catch him and charge him, the only thing he will take away is \"police are lazy and will only wayang in high profile cases to show off\".","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukchn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukchn","datetime":"2024-04-23 13:11:15"}
	{"user":"taeng89","content":"Upvoted. Completely agree with this","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo965/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo965","datetime":"2024-04-23 13:51:08"}
	{"user":"Critwice","content":"he wanted to post here but not enough karma/age? r/sgexams mods deleted because irrelevant.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufsvh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0ufsvh","datetime":"2024-04-23 12:31:07"}
	{"user":"timlim029","content":"Yeah. I'm surprised nobody is even questioning if the driver really wrote the post. I mean, it was posted on /r/SGExams. Could easily be a bored student.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyv5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyv5","datetime":"2024-04-23 13:58:52"}
	{"user":"MilkTeaRamen","content":"Bro this is call offensive driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud8xg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":61,"subreddit":"singapore","type":"comment","id":"l0ud8xg","datetime":"2024-04-23 12:09:22"}
	{"user":"Prov0st","content":"Bro, thats a genius cheat code.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uit3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uit3i","datetime":"2024-04-23 12:56:45"}
	{"user":"Jackker","content":"Yeah, this is the way. If they slow down and an opportunity is there to change lane, do it.\n\nIf they speed up, wait for as long as necessary until the opportunity is there. Then change lane,  it really is that simple. ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unsy8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unsy8","datetime":"2024-04-23 13:46:19"}
	{"user":"foxbat2525","content":"Never too old to be a student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujyi4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujyi4","datetime":"2024-04-23 13:07:29"}
	{"user":"_WonderStruck_17","content":"Agreed, the Saab driver being a complete siaokia had no bearing on the Merc driver. Merc driver was a bully too but it was two separate incidents.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwmx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":33,"subreddit":"singapore","type":"comment","id":"l0ufwmx","datetime":"2024-04-23 12:32:01"}
	{"user":"ailes_d","content":"Yeah the fault is totally on the saab driver because we all know hes speeding from very far away already. But in this case, the video not only provided evidence of saab driving recklessly, but also showcased the white merc cb mentality which lots of sg drivers have","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugdjz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ugdjz","datetime":"2024-04-23 12:35:44"}
	{"user":"ABootSG","content":"Tbh looking at these two incidents separately, I'd say the merce is reckless, saab on drugs.\n\nBut the saab driver was clearly on some shit already because he didn't stop despite colliding with the merce. As for the merce not stopping after their collision it's probably because he saw the saab trying to hit and run so he kept up with him.\n\nAlso at the junction from the perpendicular POV of another car, it didnt look like the saab was braking at all when he was on the junction.\n\nI think we should wait for the toxicology report on the saab driver. Probably on some serious amps.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf5wf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uf5wf","datetime":"2024-04-23 12:25:38"}
	{"user":"deathzz123","content":"TIL overtaking car can just chiong into lane no need check mirror or blind spot, if other driver dont yield they are reckless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukqtq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukqtq","datetime":"2024-04-23 13:15:03"}
	{"user":"infernoKings","content":"Exactly. Reckless driving by the SAAB driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umdro/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umdro","datetime":"2024-04-23 13:31:25"}
	{"user":"Possible-Grocery6244","content":"yes he was already speeding but precisely because of the sideswipe SAAB driver reacted the way he did. Or are you assuming that the incident would have occur either way without the sideswipe incident? im inclined to believe that this is a cause-and-effect situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwxr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ufwxr","datetime":"2024-04-23 12:32:06"}
	{"user":"tryingmydarnest","content":"TIL. Thanks for sharing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukq89/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukq89","datetime":"2024-04-23 13:14:53"}
	{"user":"Emotional_Apricot591","content":"He literally made a bad situation worse, so yes he is to blame as well","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udula/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0udula","datetime":"2024-04-23 12:14:19"}
	{"user":"Vedor","content":"Please tell that to journalists when they use the word \"alleged\" in their article.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf43e/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf43e","datetime":"2024-04-23 12:25:11"}
	{"user":"NekoIdo","content":"Buddy, all these stuff is already out there, people are going to find it with or without me. Im not making new shit up, Im just reiterating whats been said already. \n\nYou wanna defend this guy so bad knock yourself out man. But whats it got to do with you being unable to take the word alleged at face value?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua2tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua2tv","datetime":"2024-04-23 11:43:32"}
	{"user":"Jjzeng","content":"I was certainly offended by their driving","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh6g8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh6g8","datetime":"2024-04-23 12:42:14"}
	{"user":"hehetypo","content":"no this one is sinkie pwn sinkie driving end up pwn ownself so can sleep soundly at night","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul3w7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul3w7","datetime":"2024-04-23 13:18:37"}
	{"user":"Stormagedd0nDarkLord","content":"Exactly. I really dunno why md is getting this level of hate and blame for this. It's illogical.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8vb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ug8vb","datetime":"2024-04-23 12:34:46"}
	{"user":"Additional-Ad-1644","content":"Life doesnt have to be black and white, you know..\n\nWait till you are trying to overtake a lane hogger who somehow decides to speed up when you are passing him. Doesnt matter if hes right or wrong or legal or illegal. Still an asshole driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyq2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyq2","datetime":"2024-04-23 13:58:49"}
	{"user":"Background_Tax_1985","content":"I believe it would have still occured without the sideswipe incident. \n\nThe sideswipe incident took place pretty far away from the junction and he had the option of also making a left turn (zebra crossing), a right turn (traffic light) to get away from the merc if that was the intention. Infact, i would even warrant to say that going left would have been much better route to \"escape\".\n\nClearly sb was not really bothered by the sideswipe, if at all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhd3z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uhd3z","datetime":"2024-04-23 12:43:49"}
	{"user":"kumgongkia","content":"Are u the Saab driver? How would u know how that guy thinks? After kena sideswiped the knee jerk reaction is to accelerate all the way? Huh?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukfhh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukfhh","datetime":"2024-04-23 13:12:03"}
	{"user":"meowinbox","content":"I'm not defending the *driver*. Which part of what I said defended him? \n\n\nWhat I meant was, that post could have been written by some troll at home, and these netizens are wasting their energy giving this redditor all the rage and attention he wants, while the actual driver is somewhere else in his own world.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubf3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-10,"subreddit":"singapore","type":"comment","id":"l0ubf3i","datetime":"2024-04-23 11:54:22"}
	{"user":"_WonderStruck_17","content":"To be fair that instance does exemplify the typical kiasi behaviour that most of our SG drivers have, not wanting to give way to others which infuriates the motoring community a lot. That clip of the Merc driver committing a full corner like as though he's racing for their F1 team to overtake a motorbike on a expressway exit is one example.\n\nBut of course this tragic incident shouldn't be attributed to him. Hopefully this is a hard lesson for all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uinzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uinzd","datetime":"2024-04-23 12:55:25"}
	{"user":"deathzz123","content":"I agree with you no black and white and yes he is an asshole driver but if I overtake someone who speeds back up I will go back to my lane. At most miss exit go 1 round lo","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up7dj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up7dj","datetime":"2024-04-23 14:01:27"}
	{"user":"Possible-Grocery6244","content":"Him ramming through the traffic junction clearly shows that he is incapable of grasping the situation and brake accordingly when its a red light. But he took maneuvers to try to cut the behind cam car + merc driver and evade the motorcycle right before the sideswipe occurs. Isnt this just more evidence that his state of mind was different before and after the sideswipe, and that the sideswipe is the catalyst for this particular instance. My argument is he would have just rammed into the motorcycle or into the back of the merc without trying to cut both of them if his state of mind was the same before and after the sideswipe","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujbfx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0ujbfx","datetime":"2024-04-23 13:01:29"}
	{"user":"Possible-Grocery6244","content":"i did not say the knee jeck reaction is to accelerate all the way. Im merely stating what is observed from the video that the SAAB driver indeed accelerated all the way after the sideswipe and assumption is he was under the influenced and the sideswipe triggered a hit and run scenario","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulrqz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulrqz","datetime":"2024-04-23 13:25:14"}
	{"user":"NekoIdo","content":"Youre absolutely right, it could be him, could not be him.\n\nIts a public forum though so good luck gate keeping all the content here. Have fun!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc1bx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc1bx","datetime":"2024-04-23 11:59:22"}
	{"user":"TimidHuman","content":"Justify so much but you also feeding the troll (if it was truly one). Same same la","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uck2s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uck2s","datetime":"2024-04-23 12:03:36"}
	{"user":"happycanliao","content":"You can tell his state of mind just from that? Are you a psychiatrist?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk42j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk42j","datetime":"2024-04-23 13:08:58"}
	{"user":"Background_Tax_1985","content":"I can't really buy into your arguement. \n\nMy hypotesis is that if he was not intoxicated by drugs or alcohol, then he was trying to speed to somewhere (god knows where). \n\nThis is seen from the good control over the vehicle, even up to the accident. The vehicle barely wobbled, swerve around (except when overtaking, even after overtaking he was going as straight as an arrow) etc. Only issue is that sb was going way too fast. \n\nAnd in essence, there is no difference in his state of mind before or after. At least not so much that it would have caused the accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo6te/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo6te","datetime":"2024-04-23 13:50:25"}
	{"user":"Possible-Grocery6244","content":"isnt it clear the difference between the state of mind of the driver if 1. you are trying to avoid the vehicles infront of you by maneuvering the car and 2. you just straight plow through a red light junction? I dont think you need to be a psych to reach this conclusion","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uknwf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uknwf","datetime":"2024-04-23 13:14:16"}
	{"user":"happycanliao","content":"I don't think it's a state of mind issue? There could be other issues such as being distracted or the car may have been damaged by the accident causing loss of control (not likely but who knows).","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um9zs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um9zs","datetime":"2024-04-23 13:30:20"}
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:15.119 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8308868397857483 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:15.787 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391/spark_reddit_preprocessing.py", line 100, in <module>
	    .save()
	     ^^^^^^
	  File "/opt/spark-3.5.1-bin-hadoop3/python/lib/pyspark.zip/pyspark/sql/readwriter.py", line 1461, in save
	  File "/opt/spark-3.5.1-bin-hadoop3/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1322, in __call__
	  File "/opt/spark-3.5.1-bin-hadoop3/python/lib/pyspark.zip/pyspark/errors/exceptions/captured.py", line 179, in deco
	  File "/opt/spark-3.5.1-bin-hadoop3/python/lib/py4j-0.10.9.7-src.zip/py4j/protocol.py", line 326, in get_return_value
	py4j.protocol.Py4JJavaError: An error occurred while calling o110.save.
	: java.lang.NoClassDefFoundError: scala/$less$colon$less
		at org.apache.spark.sql.kafka010.KafkaSourceProvider.createRelation(KafkaSourceProvider.scala:180)
		at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:48)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
		at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
		at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
		at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
		at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
		at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
		at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
		at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)
		at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)
		at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)
		at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:248)
		at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
		at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
		at py4j.Gateway.invoke(Gateway.java:282)
		at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
		at py4j.commands.CallCommand.execute(CallCommand.java:79)
		at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
		at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
		at java.lang.Thread.run(Thread.java:750)
	Caused by: java.lang.ClassNotFoundException: scala.$less$colon$less
		at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
		... 42 more
	
	24/04/24 10:18:15 INFO SparkContext: Invoking stop() from shutdown hook
	24/04/24 10:18:15 INFO SparkContext: SparkContext is stopping with exitCode 0.
	24/04/24 10:18:15 INFO SparkUI: Stopped Spark web UI at http://67053a64aa3f:4041
	24/04/24 10:18:15 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
	24/04/24 10:18:15 INFO MemoryStore: MemoryStore cleared
	24/04/24 10:18:15 INFO BlockManager: BlockManager stopped
	24/04/24 10:18:15 INFO BlockManagerMaster: BlockManagerMaster stopped
	24/04/24 10:18:15 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
	24/04/24 10:18:15 INFO SparkContext: Successfully stopped SparkContext
	24/04/24 10:18:15 INFO ShutdownHookManager: Shutdown hook called
	24/04/24 10:18:15 INFO ShutdownHookManager: Deleting directory /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f/pyspark-d90fc7a4-66e0-4128-9d39-1f797ddd9dc7
	24/04/24 10:18:15 INFO ShutdownHookManager: Deleting directory /tmp/spark-0f451898-75a2-4c0a-801b-39ed0739ac5f
	24/04/24 10:18:15 INFO ShutdownHookManager: Deleting directory /tmp/spark-24d4eefe-b58c-4a44-bc41-a41b38594e5e
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.791 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391, processId:3407 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.827 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1391
[WI-566][TI-1391] - [INFO] 2024-04-24 10:18:15.827 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1391] - [INFO] 2024-04-24 10:18:16.678 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1391, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:18:17.138 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.71976401179941 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:19:06.325 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7551622418879056 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:30.731 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7485549132947977 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:31.744 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7556179775280899 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:20:43.829 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7462686567164178 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:22.151 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8714285714285716 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:22:32.192 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7078651685393258 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [ERROR] 2024-04-24 10:25:42.245 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[279] - Parse var pool error
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at org.apache.dolphinscheduler.plugin.task.api.AbstractCommandExecutor.lambda$parseProcessOutput$1(AbstractCommandExecutor.java:273)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.097 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has killed. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_96/561/1354, processId:1062 ,exitStatusCode:137 ,processWaitForStatus:true ,processExitValue:137
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.103 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.103 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.103 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: KILL to master : 172.18.1.1:1234
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_96/561/1354
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_96/561/1354
[WI-561][TI-1354] - [INFO] 2024-04-24 10:25:43.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-24 10:25:43.250 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8108108108108109 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-04-24 10:29:49.041 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [WARN] 2024-04-24 10:29:54.043 +0800 o.s.c.k.c.p.AbstractKubernetesProfileEnvironmentPostProcessor:[258] - Not running inside kubernetes. Skipping 'kubernetes' profile activation.
[WI-0][TI-0] - [INFO] 2024-04-24 10:29:54.099 +0800 o.a.d.s.w.WorkerServer:[634] - No active profile set, falling back to 1 default profile: "default"
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:02.640 +0800 o.s.c.c.s.GenericScope:[283] - BeanFactory id=7e7bf7c6-2cb3-34d2-a0d5-a56161c67d0e
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.012 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.046 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.050 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$392/302905744] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.080 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.209 +0800 o.a.d.c.u.NetUtils:[312] - Get all NetworkInterfaces: [name:eth0 (eth0), name:lo (lo)]
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.436 +0800 o.a.d.s.w.c.WorkerConfig:[98] - 
****************************Worker Configuration**************************************
  listen-port -> 1234
  exec-threads -> 100
  max-heartbeat-interval -> PT10S
  host-weight -> 100
  tenantConfig -> TenantConfig(autoCreateTenantEnabled=true, distributedTenantEnabled=false, defaultTenantEnabled=false)
  server-load-protection -> WorkerServerLoadProtection(enabled=true, maxCpuUsagePercentageThresholds=0.7, maxJVMMemoryUsagePercentageThresholds=0.7, maxSystemMemoryUsagePercentageThresholds=0.7, maxDiskUsagePercentageThresholds=0.7)
  registry-disconnect-strategy -> ConnectStrategyProperties(strategy=WAITING, maxWaitingTime=PT1M40S)
  task-execute-threads-full-policy: REJECT
  address -> 172.18.1.1:1234
  registry-path: /nodes/worker/172.18.1.1:1234
****************************Worker Configuration**************************************
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:05.467 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'workerConfig' of type [org.apache.dolphinscheduler.server.worker.config.WorkerConfig$$EnhancerBySpringCGLIB$$da954724] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:06.654 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:06.821 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'kubernetes.manifests-io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties' of type [io.kubernetes.client.spring.extended.manifests.config.KubernetesManifestsProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:06.925 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration' of type [io.kubernetes.client.spring.extended.controller.config.KubernetesInformerAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:07.182 +0800 o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker:[376] - Bean 'defaultApiClient' of type [io.kubernetes.client.openapi.ApiClient] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:07.657 +0800 o.e.j.u.log:[170] - Logging initialized @31188ms to org.eclipse.jetty.util.log.Slf4jLog
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.564 +0800 o.s.b.w.e.j.JettyServletWebServerFactory:[166] - Server initialized with port: 1235
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.579 +0800 o.e.j.s.Server:[375] - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 1.8.0_402-b06
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.728 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring embedded WebApplicationContext
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:08.730 +0800 o.s.b.w.s.c.ServletWebServerApplicationContext:[292] - Root WebApplicationContext: initialization completed in 14339 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.699 +0800 o.e.j.s.session:[334] - DefaultSessionIdManager workerName=node0
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.700 +0800 o.e.j.s.session:[339] - No SessionScavenger set, using defaults
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.789 +0800 o.e.j.s.session:[132] - node0 Scavenging every 660000ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.809 +0800 o.e.j.s.h.ContextHandler:[921] - Started o.s.b.w.e.j.JettyEmbeddedWebAppContext@52433946{application,/,[file:///tmp/jetty-docbase.1235.4147575345473226625/],AVAILABLE}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:12.815 +0800 o.e.j.s.Server:[415] - Started @36346ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.209 +0800 o.a.c.f.i.CuratorFrameworkImpl:[338] - Starting
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.869 +0800 o.a.z.ZooKeeper:[98] - Client environment:zookeeper.version=3.8.0-5a02a05eddb59aee6ac762f7ea82e92a68eb9c0f, built on 2022-02-25 08:49 UTC
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.870 +0800 o.a.z.ZooKeeper:[98] - Client environment:host.name=6b0330d1bc18
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.871 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.version=1.8.0_402
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.872 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.vendor=Temurin
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.873 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.home=/opt/java/openjdk
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.876 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.class.path=/opt/dolphinscheduler/conf:/opt/dolphinscheduler/libs/kerb-client-1.0.1.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/oauth2-oidc-sdk-9.35.jar:/opt/dolphinscheduler/libs/jsqlparser-4.4.jar:/opt/dolphinscheduler/libs/reactive-streams-1.0.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-extensions-5.10.2.jar:/opt/dolphinscheduler/libs/zookeeper-3.8.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-apps-5.10.2.jar:/opt/dolphinscheduler/libs/grpc-api-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pigeon-3.2.1.jar:/opt/dolphinscheduler/libs/client-java-api-13.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-obs-3.2.1.jar:/opt/dolphinscheduler/libs/spring-web-5.3.22.jar:/opt/dolphinscheduler/libs/aws-java-sdk-emr-1.12.300.jar:/opt/dolphinscheduler/libs/spring-context-5.3.22.jar:/opt/dolphinscheduler/libs/gapic-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-config-2.1.3.jar:/opt/dolphinscheduler/libs/jetty-io-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/annotations-13.0.jar:/opt/dolphinscheduler/libs/jpam-1.1.jar:/opt/dolphinscheduler/libs/joda-time-2.10.13.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-client-autoconfig-2.1.3.jar:/opt/dolphinscheduler/libs/kerb-identity-1.0.1.jar:/opt/dolphinscheduler/libs/vertica-jdbc-12.0.4-0.jar:/opt/dolphinscheduler/libs/grpc-googleapis-1.52.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-kms-2.11.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dvc-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-hana-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-httpclient-okhttp-6.0.0.jar:/opt/dolphinscheduler/libs/jline-2.12.jar:/opt/dolphinscheduler/libs/sshd-core-2.8.0.jar:/opt/dolphinscheduler/libs/jna-platform-5.10.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-sqlserver-3.2.1.jar:/opt/dolphinscheduler/libs/commons-beanutils-1.9.4.jar:/opt/dolphinscheduler/libs/grpc-services-1.41.0.jar:/opt/dolphinscheduler/libs/jmespath-java-1.12.300.jar:/opt/dolphinscheduler/libs/curator-client-5.3.0.jar:/opt/dolphinscheduler/libs/proto-google-common-protos-2.0.1.jar:/opt/dolphinscheduler/libs/mybatis-3.5.10.jar:/opt/dolphinscheduler/libs/jackson-annotations-2.13.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-all-3.2.1.jar:/opt/dolphinscheduler/libs/jakarta.xml.bind-api-2.3.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-jupyter-3.2.1.jar:/opt/dolphinscheduler/libs/mybatis-plus-extension-3.5.2.jar:/opt/dolphinscheduler/libs/j2objc-annotations-1.3.jar:/opt/dolphinscheduler/libs/Java-WebSocket-1.5.1.jar:/opt/dolphinscheduler/libs/azure-storage-common-12.20.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-sagemaker-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-databend-3.2.1.jar:/opt/dolphinscheduler/libs/google-auth-library-oauth2-http-1.15.0.jar:/opt/dolphinscheduler/libs/jetty-security-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-python-3.2.1.jar:/opt/dolphinscheduler/libs/snappy-java-1.1.10.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-batch-5.10.2.jar:/opt/dolphinscheduler/libs/netty-transport-native-epoll-4.1.53.Final-linux-x86_64.jar:/opt/dolphinscheduler/libs/jackson-core-asl-1.9.13.jar:/opt/dolphinscheduler/libs/gson-fire-1.8.5.jar:/opt/dolphinscheduler/libs/clickhouse-jdbc-0.4.6.jar:/opt/dolphinscheduler/libs/grpc-netty-shaded-1.41.0.jar:/opt/dolphinscheduler/libs/caffeine-2.9.3.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-core-4.5.10.jar:/opt/dolphinscheduler/libs/jackson-module-jaxb-annotations-2.13.3.jar:/opt/dolphinscheduler/libs/jetty-http-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jersey-servlet-1.19.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dinky-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_common-0.15.0.jar:/opt/dolphinscheduler/libs/netty-handler-4.1.53.Final.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datafactory-3.2.1.jar:/opt/dolphinscheduler/libs/json-path-2.7.0.jar:/opt/dolphinscheduler/libs/mybatis-plus-annotation-3.5.2.jar:/opt/dolphinscheduler/libs/azure-resourcemanager-datafactory-1.0.0-beta.19.jar:/opt/dolphinscheduler/libs/commons-codec-1.11.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-master-3.2.1.jar:/opt/dolphinscheduler/libs/spring-aop-5.3.22.jar:/opt/dolphinscheduler/libs/kubernetes-model-core-5.10.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-networking-5.10.2.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk7-1.6.21.jar:/opt/dolphinscheduler/libs/kerby-xdr-1.0.1.jar:/opt/dolphinscheduler/libs/aliyun-java-sdk-ram-3.1.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-k8s-3.2.1.jar:/opt/dolphinscheduler/libs/guava-31.1-jre.jar:/opt/dolphinscheduler/libs/netty-codec-dns-4.1.53.Final.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-kubeflow-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-azure-sql-3.2.1.jar:/opt/dolphinscheduler/libs/HikariCP-4.0.3.jar:/opt/dolphinscheduler/libs/hive-metastore-2.3.9.jar:/opt/dolphinscheduler/libs/msal4j-1.13.3.jar:/opt/dolphinscheduler/libs/jackson-core-2.13.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-hive-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mr-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-node-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-common-3.2.1.jar:/opt/dolphinscheduler/libs/jose4j-0.7.8.jar:/opt/dolphinscheduler/libs/jul-to-slf4j-1.7.36.jar:/opt/dolphinscheduler/libs/azure-identity-1.7.1.jar:/opt/dolphinscheduler/libs/spring-boot-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/commons-math3-3.1.1.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-json-provider-2.13.3.jar:/opt/dolphinscheduler/libs/perfmark-api-0.23.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-doris-3.2.1.jar:/opt/dolphinscheduler/libs/httpclient-4.5.13.jar:/opt/dolphinscheduler/libs/hive-service-2.3.9.jar:/opt/dolphinscheduler/libs/kerby-util-1.0.1.jar:/opt/dolphinscheduler/libs/commons-collections-3.2.2.jar:/opt/dolphinscheduler/libs/hadoop-yarn-client-3.2.4.jar:/opt/dolphinscheduler/libs/commons-text-1.8.jar:/opt/dolphinscheduler/libs/dolphinscheduler-worker-3.2.1.jar:/opt/dolphinscheduler/libs/hadoop-yarn-common-3.2.4.jar:/opt/dolphinscheduler/libs/zeppelin-client-0.10.1.jar:/opt/dolphinscheduler/libs/azure-core-management-1.10.1.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-jobclient-3.2.4.jar:/opt/dolphinscheduler/libs/jta-1.1.jar:/opt/dolphinscheduler/libs/annotations-4.1.1.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-alert-3.2.1.jar:/opt/dolphinscheduler/libs/curator-framework-5.3.0.jar:/opt/dolphinscheduler/libs/hive-jdbc-2.3.9.jar:/opt/dolphinscheduler/libs/kyuubi-hive-jdbc-shaded-1.7.0.jar:/opt/dolphinscheduler/libs/client-java-proto-13.0.2.jar:/opt/dolphinscheduler/libs/checker-qual-3.19.0.jar:/opt/dolphinscheduler/libs/jetty-servlet-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/google-cloud-core-grpc-2.10.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-shell-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-rsa-1.0.10.RELEASE.jar:/opt/dolphinscheduler/libs/avro-1.7.7.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-postgresql-3.2.1.jar:/opt/dolphinscheduler/libs/netty-nio-client-2.17.282.jar:/opt/dolphinscheduler/libs/spring-webmvc-5.3.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-mysql-3.2.1.jar:/opt/dolphinscheduler/libs/opentracing-util-0.33.0.jar:/opt/dolphinscheduler/libs/auto-value-1.10.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-all-3.2.1.jar:/opt/dolphinscheduler/libs/jetcd-core-0.5.11.jar:/opt/dolphinscheduler/libs/grpc-context-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datasync-3.2.1.jar:/opt/dolphinscheduler/libs/jackson-dataformat-cbor-2.13.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-gcs-3.2.1.jar:/opt/dolphinscheduler/libs/client-java-extended-13.0.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-redshift-3.2.1.jar:/opt/dolphinscheduler/libs/opencsv-2.3.jar:/opt/dolphinscheduler/libs/jcip-annotations-1.0-1.jar:/opt/dolphinscheduler/libs/accessors-smart-2.4.8.jar:/opt/dolphinscheduler/libs/hadoop-client-3.2.4.jar:/opt/dolphinscheduler/libs/commons-collections4-4.3.jar:/opt/dolphinscheduler/libs/metrics-core-4.2.11.jar:/opt/dolphinscheduler/libs/netty-resolver-4.1.53.Final.jar:/opt/dolphinscheduler/libs/parquet-hadoop-bundle-1.8.1.jar:/opt/dolphinscheduler/libs/bucket4j-core-6.2.0.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-3.1.3.jar:/opt/dolphinscheduler/libs/mssql-jdbc-11.2.1.jre8.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final.jar:/opt/dolphinscheduler/libs/kubernetes-model-coordination-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-linkis-3.2.1.jar:/opt/dolphinscheduler/libs/commons-net-3.6.jar:/opt/dolphinscheduler/libs/netty-transport-native-kqueue-4.1.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/dolphinscheduler-meter-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-client-api-6.0.0.jar:/opt/dolphinscheduler/libs/kubernetes-model-certificates-5.10.2.jar:/opt/dolphinscheduler/libs/opencensus-api-0.31.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-mlflow-3.2.1.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-jdk8-1.6.21.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-jdbc-3.2.1.jar:/opt/dolphinscheduler/libs/audience-annotations-0.12.0.jar:/opt/dolphinscheduler/libs/simpleclient_httpserver-0.15.0.jar:/opt/dolphinscheduler/libs/jetty-xml-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/kerby-asn1-1.0.1.jar:/opt/dolphinscheduler/libs/lang-tag-1.6.jar:/opt/dolphinscheduler/libs/api-common-2.6.0.jar:/opt/dolphinscheduler/libs/HdrHistogram-2.1.12.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-abs-3.2.1.jar:/opt/dolphinscheduler/libs/failsafe-2.4.4.jar:/opt/dolphinscheduler/libs/hbase-noop-htrace-4.1.1.jar:/opt/dolphinscheduler/libs/jamon-runtime-2.3.1.jar:/opt/dolphinscheduler/libs/jetty-util-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/threetenbp-1.6.5.jar:/opt/dolphinscheduler/libs/jakarta.activation-api-1.2.2.jar:/opt/dolphinscheduler/libs/kubernetes-model-common-5.10.2.jar:/opt/dolphinscheduler/libs/okhttp-4.9.3.jar:/opt/dolphinscheduler/libs/profiles-2.17.282.jar:/opt/dolphinscheduler/libs/hadoop-auth-3.2.4.jar:/opt/dolphinscheduler/libs/grpc-netty-1.41.0.jar:/opt/dolphinscheduler/libs/httpcore-nio-4.4.15.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-seatunnel-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-sagemaker-1.12.300.jar:/opt/dolphinscheduler/libs/oshi-core-6.1.1.jar:/opt/dolphinscheduler/libs/bonecp-0.8.0.RELEASE.jar:/opt/dolphinscheduler/libs/jackson-module-parameter-names-2.13.3.jar:/opt/dolphinscheduler/libs/bcutil-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/aws-json-protocol-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-base-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-all-3.2.1.jar:/opt/dolphinscheduler/libs/derby-10.14.2.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-snowflake-3.2.1.jar:/opt/dolphinscheduler/libs/netty-codec-http2-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jetty-continuation-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jackson-mapper-asl-1.9.13.jar:/opt/dolphinscheduler/libs/datanucleus-core-4.1.17.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-osx-aarch_64.jar:/opt/dolphinscheduler/libs/failureaccess-1.0.1.jar:/opt/dolphinscheduler/libs/error_prone_annotations-2.5.1.jar:/opt/dolphinscheduler/libs/kerb-admin-1.0.1.jar:/opt/dolphinscheduler/libs/token-provider-1.0.1.jar:/opt/dolphinscheduler/libs/reactor-netty-core-1.0.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-all-3.2.1.jar:/opt/dolphinscheduler/libs/jakarta.servlet-api-4.0.4.jar:/opt/dolphinscheduler/libs/http-client-spi-2.17.282.jar:/opt/dolphinscheduler/libs/regions-2.17.282.jar:/opt/dolphinscheduler/libs/logback-core-1.2.11.jar:/opt/dolphinscheduler/libs/json-1.8.jar:/opt/dolphinscheduler/libs/gax-grpc-2.23.0.jar:/opt/dolphinscheduler/libs/google-http-client-1.42.3.jar:/opt/dolphinscheduler/libs/hive-serde-2.3.9.jar:/opt/dolphinscheduler/libs/jettison-1.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-http-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-zookeeper-3.2.1.jar:/opt/dolphinscheduler/libs/spring-security-crypto-5.7.3.jar:/opt/dolphinscheduler/libs/auth-2.17.282.jar:/opt/dolphinscheduler/libs/proto-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/jetty-server-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/javax.annotation-api-1.3.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-starrocks-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dataquality-3.2.1.jar:/opt/dolphinscheduler/libs/jcl-over-slf4j-1.7.36.jar:/opt/dolphinscheduler/libs/commons-lang3-3.12.0.jar:/opt/dolphinscheduler/libs/tomcat-embed-el-9.0.65.jar:/opt/dolphinscheduler/libs/opentracing-noop-0.33.0.jar:/opt/dolphinscheduler/libs/client-java-13.0.2.jar:/opt/dolphinscheduler/libs/spring-beans-5.3.22.jar:/opt/dolphinscheduler/libs/snakeyaml-1.33.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-ssh-3.2.1.jar:/opt/dolphinscheduler/libs/commons-pool-1.6.jar:/opt/dolphinscheduler/libs/javax.servlet-api-3.1.0.jar:/opt/dolphinscheduler/libs/hadoop-common-3.2.4.jar:/opt/dolphinscheduler/libs/kubernetes-model-apiextensions-5.10.2.jar:/opt/dolphinscheduler/libs/spring-boot-2.7.3.jar:/opt/dolphinscheduler/libs/bcprov-ext-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/spring-boot-starter-2.7.3.jar:/opt/dolphinscheduler/libs/paranamer-2.3.jar:/opt/dolphinscheduler/libs/httpmime-4.5.13.jar:/opt/dolphinscheduler/libs/reactor-core-3.4.22.jar:/opt/dolphinscheduler/libs/azure-core-1.36.0.jar:/opt/dolphinscheduler/libs/bcpkix-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/kubernetes-model-scheduling-5.10.2.jar:/opt/dolphinscheduler/libs/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/dolphinscheduler/libs/websocket-client-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/unirest-java-3.7.04-standalone.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-core-3.2.4.jar:/opt/dolphinscheduler/libs/google-auth-library-credentials-1.15.0.jar:/opt/dolphinscheduler/libs/azure-storage-internal-avro-12.6.0.jar:/opt/dolphinscheduler/libs/jackson-datatype-jdk8-2.13.3.jar:/opt/dolphinscheduler/libs/spring-expression-5.3.22.jar:/opt/dolphinscheduler/libs/aspectjweaver-1.9.7.jar:/opt/dolphinscheduler/libs/websocket-common-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/client-java-api-fluent-13.0.2.jar:/opt/dolphinscheduler/libs/mybatis-plus-3.5.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-athena-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-oss-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-openmldb-3.2.1.jar:/opt/dolphinscheduler/libs/curator-recipes-5.3.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-api-3.2.1.jar:/opt/dolphinscheduler/libs/netty-all-4.1.53.Final.jar:/opt/dolphinscheduler/libs/netty-resolver-dns-4.1.53.Final.jar:/opt/dolphinscheduler/libs/kubernetes-model-autoscaling-5.10.2.jar:/opt/dolphinscheduler/libs/kerb-util-1.0.1.jar:/opt/dolphinscheduler/libs/grpc-alts-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-presto-3.2.1.jar:/opt/dolphinscheduler/libs/kerb-simplekdc-1.0.1.jar:/opt/dolphinscheduler/libs/protobuf-java-util-3.17.2.jar:/opt/dolphinscheduler/libs/azure-core-http-netty-1.13.0.jar:/opt/dolphinscheduler/libs/transaction-api-1.1.jar:/opt/dolphinscheduler/libs/datanucleus-api-jdo-4.2.4.jar:/opt/dolphinscheduler/libs/zeppelin-common-0.10.1.jar:/opt/dolphinscheduler/libs/zt-zip-1.15.jar:/opt/dolphinscheduler/libs/animal-sniffer-annotations-1.19.jar:/opt/dolphinscheduler/libs/google-http-client-jackson2-1.42.3.jar:/opt/dolphinscheduler/libs/netty-buffer-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jsr305-3.0.0.jar:/opt/dolphinscheduler/libs/netty-transport-classes-epoll-4.1.79.Final.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-autoconfigure-2.7.3.jar:/opt/dolphinscheduler/libs/simpleclient-0.15.0.jar:/opt/dolphinscheduler/libs/aliyun-sdk-oss-3.15.1.jar:/opt/dolphinscheduler/libs/json-utils-2.17.282.jar:/opt/dolphinscheduler/libs/tephra-api-0.6.0.jar:/opt/dolphinscheduler/libs/spring-jdbc-5.3.22.jar:/opt/dolphinscheduler/libs/grpc-xds-1.41.0.jar:/opt/dolphinscheduler/libs/logback-classic-1.2.11.jar:/opt/dolphinscheduler/libs/google-cloud-storage-2.18.0.jar:/opt/dolphinscheduler/libs/micrometer-registry-prometheus-1.9.3.jar:/opt/dolphinscheduler/libs/grpc-core-1.41.0.jar:/opt/dolphinscheduler/libs/aws-java-sdk-kms-1.12.300.jar:/opt/dolphinscheduler/libs/kubernetes-model-rbac-5.10.2.jar:/opt/dolphinscheduler/libs/ini4j-0.5.4.jar:/opt/dolphinscheduler/libs/spring-boot-starter-web-2.7.3.jar:/opt/dolphinscheduler/libs/spring-cloud-commons-3.1.3.jar:/opt/dolphinscheduler/libs/netty-codec-http-4.1.53.Final.jar:/opt/dolphinscheduler/libs/jetty-client-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/jetcd-common-0.5.11.jar:/opt/dolphinscheduler/libs/metrics-spi-2.17.282.jar:/opt/dolphinscheduler/libs/utils-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-emr-3.2.1.jar:/opt/dolphinscheduler/libs/protocol-core-2.17.282.jar:/opt/dolphinscheduler/libs/micrometer-core-1.9.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-unix-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.4.11.jar:/opt/dolphinscheduler/libs/annotations-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sql-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-common-3.2.1.jar:/opt/dolphinscheduler/libs/apache-client-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-oceanbase-3.2.1.jar:/opt/dolphinscheduler/libs/jdo-api-3.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-datax-3.2.1.jar:/opt/dolphinscheduler/libs/postgresql-42.4.1.jar:/opt/dolphinscheduler/libs/jetty-util-ajax-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/gax-2.23.0.jar:/opt/dolphinscheduler/libs/grpc-stub-1.41.0.jar:/opt/dolphinscheduler/libs/libfb303-0.9.3.jar:/opt/dolphinscheduler/libs/spring-core-5.3.22.jar:/opt/dolphinscheduler/libs/jaxb-api-2.3.1.jar:/opt/dolphinscheduler/libs/hive-service-rpc-2.3.9.jar:/opt/dolphinscheduler/libs/kubernetes-model-flowcontrol-5.10.2.jar:/opt/dolphinscheduler/libs/commons-logging-1.1.1.jar:/opt/dolphinscheduler/libs/mybatis-spring-2.0.7.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-oracle-3.2.1.jar:/opt/dolphinscheduler/libs/opencensus-proto-0.2.0.jar:/opt/dolphinscheduler/libs/grpc-protobuf-1.41.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-clickhouse-3.2.1.jar:/opt/dolphinscheduler/libs/spring-cloud-starter-bootstrap-3.1.3.jar:/opt/dolphinscheduler/libs/kubernetes-model-admissionregistration-5.10.2.jar:/opt/dolphinscheduler/libs/grpc-google-cloud-storage-v2-2.18.0-alpha.jar:/opt/dolphinscheduler/libs/esdk-obs-java-bundle-3.23.3.jar:/opt/dolphinscheduler/libs/dnsjava-2.1.7.jar:/opt/dolphinscheduler/libs/asm-9.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-spark-3.2.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-linux-aarch_64.jar:/opt/dolphinscheduler/libs/re2j-1.6.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-vertica-3.2.1.jar:/opt/dolphinscheduler/libs/json-smart-2.4.8.jar:/opt/dolphinscheduler/libs/reactor-netty-http-1.0.22.jar:/opt/dolphinscheduler/libs/google-api-services-storage-v1-rev20220705-2.0.0.jar:/opt/dolphinscheduler/libs/kubernetes-client-6.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-kyuubi-3.2.1.jar:/opt/dolphinscheduler/libs/auto-value-annotations-1.10.1.jar:/opt/dolphinscheduler/libs/commons-cli-1.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-data-quality-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-chunjun-3.2.1.jar:/opt/dolphinscheduler/libs/kerb-server-1.0.1.jar:/opt/dolphinscheduler/libs/content-type-2.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-remoteshell-3.2.1.jar:/opt/dolphinscheduler/libs/opencensus-contrib-http-util-0.31.1.jar:/opt/dolphinscheduler/libs/druid-1.2.20.jar:/opt/dolphinscheduler/libs/javolution-5.5.1.jar:/opt/dolphinscheduler/libs/protobuf-java-3.17.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-db2-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-core-1.12.300.jar:/opt/dolphinscheduler/libs/spring-boot-starter-logging-2.7.3.jar:/opt/dolphinscheduler/libs/kerby-pkix-1.0.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-procedure-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-etcd-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sqoop-3.2.1.jar:/opt/dolphinscheduler/libs/zookeeper-jute-3.8.0.jar:/opt/dolphinscheduler/libs/netty-resolver-dns-native-macos-4.1.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-sagemaker-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-configuration-processor-2.6.1.jar:/opt/dolphinscheduler/libs/hive-common-2.3.9.jar:/opt/dolphinscheduler/libs/kerb-common-1.0.1.jar:/opt/dolphinscheduler/libs/stax-api-1.0.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-storageclass-5.10.2.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-s3-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-jetty-2.7.3.jar:/opt/dolphinscheduler/libs/okio-2.8.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-dms-3.2.1.jar:/opt/dolphinscheduler/libs/simpleclient_common-0.15.0.jar:/opt/dolphinscheduler/libs/sdk-core-2.17.282.jar:/opt/dolphinscheduler/libs/javax.activation-api-1.2.0.jar:/opt/dolphinscheduler/libs/netty-handler-proxy-4.1.53.Final.jar:/opt/dolphinscheduler/libs/kerby-config-1.0.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-classes-2.0.53.Final.jar:/opt/dolphinscheduler/libs/jackson-jaxrs-base-2.13.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-trino-3.2.1.jar:/opt/dolphinscheduler/libs/presto-jdbc-0.238.1.jar:/opt/dolphinscheduler/libs/websocket-api-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-api-3.2.1.jar:/opt/dolphinscheduler/libs/kubernetes-model-metrics-5.10.2.jar:/opt/dolphinscheduler/libs/datasync-2.17.282.jar:/opt/dolphinscheduler/libs/hadoop-yarn-api-3.2.4.jar:/opt/dolphinscheduler/libs/google-http-client-apache-v2-1.42.3.jar:/opt/dolphinscheduler/libs/hadoop-annotations-3.2.4.jar:/opt/dolphinscheduler/libs/google-oauth-client-1.34.1.jar:/opt/dolphinscheduler/libs/sshd-common-2.8.0.jar:/opt/dolphinscheduler/libs/LatencyUtils-2.0.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-spark-3.2.1.jar:/opt/dolphinscheduler/libs/slf4j-api-1.7.36.jar:/opt/dolphinscheduler/libs/snowflake-jdbc-3.13.29.jar:/opt/dolphinscheduler/libs/jackson-datatype-jsr310-2.13.3.jar:/opt/dolphinscheduler/libs/trino-jdbc-402.jar:/opt/dolphinscheduler/libs/logging-interceptor-4.9.3.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel_agent-0.15.0.jar:/opt/dolphinscheduler/libs/janino-3.0.16.jar:/opt/dolphinscheduler/libs/jackson-dataformat-yaml-2.13.3.jar:/opt/dolphinscheduler/libs/ion-java-1.0.2.jar:/opt/dolphinscheduler/libs/commons-dbcp-1.4.jar:/opt/dolphinscheduler/libs/jsp-api-2.1.jar:/opt/dolphinscheduler/libs/google-http-client-gson-1.42.3.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-hivecli-3.2.1.jar:/opt/dolphinscheduler/libs/spring-boot-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/google-cloud-core-http-2.10.0.jar:/opt/dolphinscheduler/libs/DmJdbcDriver18-8.1.2.79.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-java-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-dameng-3.2.1.jar:/opt/dolphinscheduler/libs/sshd-sftp-2.8.0.jar:/opt/dolphinscheduler/libs/kerb-crypto-1.0.1.jar:/opt/dolphinscheduler/libs/conscrypt-openjdk-uber-2.5.2.jar:/opt/dolphinscheduler/libs/httpcore-4.4.15.jar:/opt/dolphinscheduler/libs/lz4-java-1.4.0.jar:/opt/dolphinscheduler/libs/guava-retrying-2.0.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-flink-stream-3.2.1.jar:/opt/dolphinscheduler/libs/spring-tx-5.3.22.jar:/opt/dolphinscheduler/libs/grpc-auth-1.41.0.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-osx-x86_64.jar:/opt/dolphinscheduler/libs/databend-jdbc-0.0.7.jar:/opt/dolphinscheduler/libs/bcprov-jdk15on-1.69.jar:/opt/dolphinscheduler/libs/commons-lang-2.6.jar:/opt/dolphinscheduler/libs/kubernetes-model-policy-5.10.2.jar:/opt/dolphinscheduler/libs/commons-io-2.11.0.jar:/opt/dolphinscheduler/libs/grpc-grpclb-1.41.0.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-linux-x86_64.jar:/opt/dolphinscheduler/libs/opentracing-api-0.33.0.jar:/opt/dolphinscheduler/libs/sshd-scp-2.8.0.jar:/opt/dolphinscheduler/libs/reload4j-1.2.18.3.jar:/opt/dolphinscheduler/libs/netty-tcnative-2.0.48.Final.jar:/opt/dolphinscheduler/libs/jdom2-2.0.6.1.jar:/opt/dolphinscheduler/libs/spring-boot-starter-json-2.7.3.jar:/opt/dolphinscheduler/libs/netty-transport-native-epoll-4.1.53.Final.jar:/opt/dolphinscheduler/libs/google-cloud-core-2.10.0.jar:/opt/dolphinscheduler/libs/javax.jdo-3.2.0-m3.jar:/opt/dolphinscheduler/libs/gax-httpjson-0.108.0.jar:/opt/dolphinscheduler/libs/mybatis-plus-core-3.5.2.jar:/opt/dolphinscheduler/libs/auto-service-annotations-1.0.1.jar:/opt/dolphinscheduler/libs/nimbus-jose-jwt-9.22.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-zeppelin-3.2.1.jar:/opt/dolphinscheduler/libs/commons-compress-1.21.jar:/opt/dolphinscheduler/libs/hadoop-hdfs-client-3.2.4.jar:/opt/dolphinscheduler/libs/msal4j-persistence-extension-1.1.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-pytorch-3.2.1.jar:/opt/dolphinscheduler/libs/netty-tcnative-boringssl-static-2.0.53.Final-windows-x86_64.jar:/opt/dolphinscheduler/libs/jetty-servlets-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/woodstox-core-6.4.0.jar:/opt/dolphinscheduler/libs/spring-cloud-kubernetes-commons-2.1.3.jar:/opt/dolphinscheduler/libs/grpc-protobuf-lite-1.41.0.jar:/opt/dolphinscheduler/libs/jetty-webapp-9.4.48.v20220622.jar:/opt/dolphinscheduler/libs/eventstream-1.0.1.jar:/opt/dolphinscheduler/libs/commons-compiler-3.1.7.jar:/opt/dolphinscheduler/libs/netty-transport-4.1.53.Final.jar:/opt/dolphinscheduler/libs/spring-cloud-context-3.1.3.jar:/opt/dolphinscheduler/libs/aws-java-sdk-dms-1.12.300.jar:/opt/dolphinscheduler/libs/hive-storage-api-2.4.0.jar:/opt/dolphinscheduler/libs/client-java-spring-integration-13.0.2.jar:/opt/dolphinscheduler/libs/spring-boot-starter-actuator-2.7.3.jar:/opt/dolphinscheduler/libs/third-party-jackson-core-2.17.282.jar:/opt/dolphinscheduler/libs/dolphinscheduler-storage-hdfs-3.2.1.jar:/opt/dolphinscheduler/libs/netty-codec-4.1.53.Final.jar:/opt/dolphinscheduler/libs/google-http-client-appengine-1.42.3.jar:/opt/dolphinscheduler/libs/commons-configuration2-2.1.1.jar:/opt/dolphinscheduler/libs/datanucleus-rdbms-4.1.19.jar:/opt/dolphinscheduler/libs/swagger-annotations-1.6.2.jar:/opt/dolphinscheduler/libs/simpleclient_tracer_otel-0.15.0.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-common-1.6.21.jar:/opt/dolphinscheduler/libs/aws-core-2.17.282.jar:/opt/dolphinscheduler/libs/kerb-core-1.0.1.jar:/opt/dolphinscheduler/libs/httpasyncclient-4.1.5.jar:/opt/dolphinscheduler/libs/dolphinscheduler-extract-worker-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-spi-3.2.1.jar:/opt/dolphinscheduler/libs/okhttp-2.7.5.jar:/opt/dolphinscheduler/libs/google-api-client-2.2.0.jar:/opt/dolphinscheduler/libs/kotlin-stdlib-1.6.21.jar:/opt/dolphinscheduler/libs/jakarta.websocket-api-1.1.2.jar:/opt/dolphinscheduler/libs/libthrift-0.9.3.jar:/opt/dolphinscheduler/libs/spring-boot-starter-aop-2.7.3.jar:/opt/dolphinscheduler/libs/netty-common-4.1.53.Final.jar:/opt/dolphinscheduler/libs/log4j-1.2-api-2.17.2.jar:/opt/dolphinscheduler/libs/jackson-databind-2.13.4.jar:/opt/dolphinscheduler/libs/jackson-dataformat-xml-2.13.3.jar:/opt/dolphinscheduler/libs/kubernetes-model-events-5.10.2.jar:/opt/dolphinscheduler/libs/gson-2.9.1.jar:/opt/dolphinscheduler/libs/proto-google-iam-v1-1.9.0.jar:/opt/dolphinscheduler/libs/netty-codec-socks-4.1.53.Final.jar:/opt/dolphinscheduler/libs/zjsonpatch-0.3.0.jar:/opt/dolphinscheduler/libs/hadoop-mapreduce-client-common-3.2.4.jar:/opt/dolphinscheduler/libs/dolphinscheduler-registry-api-3.2.1.jar:/opt/dolphinscheduler/libs/azure-storage-blob-12.21.0.jar:/opt/dolphinscheduler/libs/dolphinscheduler-task-zeppelin-3.2.1.jar:/opt/dolphinscheduler/libs/dolphinscheduler-datasource-api-3.2.1.jar:/opt/dolphinscheduler/libs/aws-java-sdk-s3-1.12.300.jar:/opt/dolphinscheduler/libs/stax2-api-4.2.1.jar:/opt/dolphinscheduler/libs/jakarta.annotation-api-1.3.5.jar:/opt/dolphinscheduler/libs/kubernetes-model-discovery-5.10.2.jar:/opt/dolphinscheduler/libs/jna-5.10.0.jar:/opt/dolphinscheduler/libs/spring-jcl-5.3.22.jar
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.879 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.879 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.io.tmpdir=/tmp
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.880 +0800 o.a.z.ZooKeeper:[98] - Client environment:java.compiler=<NA>
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.900 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.name=Linux
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.900 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.arch=amd64
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.901 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.version=6.5.0-28-generic
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.901 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.name=root
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.902 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.home=/root
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.902 +0800 o.a.z.ZooKeeper:[98] - Client environment:user.dir=/opt/dolphinscheduler
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.902 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.free=3192MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.903 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.max=3840MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.903 +0800 o.a.z.ZooKeeper:[98] - Client environment:os.memory.total=3840MB
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.905 +0800 o.a.z.ZooKeeper:[637] - Initiating client connection, connectString=dolphinscheduler-zookeeper:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@6996bbc4
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.910 +0800 o.a.z.c.X509Util:[77] - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.914 +0800 o.a.z.ClientCnxnSocket:[239] - jute.maxbuffer value is 1048575 Bytes
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.923 +0800 o.a.z.ClientCnxn:[1732] - zookeeper.request.timeout value is 0. feature enabled=false
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.957 +0800 o.a.c.f.i.CuratorFrameworkImpl:[386] - Default schema
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.973 +0800 o.a.z.ClientCnxn:[1171] - Opening socket connection to server dolphinscheduler-zookeeper/172.18.0.5:2181.
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.986 +0800 o.a.z.ClientCnxn:[1173] - SASL config status: Will not attempt to authenticate using SASL (unknown error)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:13.993 +0800 o.a.z.ClientCnxn:[1005] - Socket connection established, initiating session, client: /172.18.1.1:46974, server: dolphinscheduler-zookeeper/172.18.0.5:2181
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.025 +0800 o.a.z.ClientCnxn:[1444] - Session establishment complete on server dolphinscheduler-zookeeper/172.18.0.5:2181, session id = 0x10000918e5c0000, negotiated timeout = 30000
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.033 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: CONNECTED
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.142 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.199 +0800 o.a.c.f.i.EnsembleTracker:[201] - New config event received: {}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:14.616 +0800 o.a.d.s.w.r.WorkerRpcServer:[41] - WorkerRpcServer starting...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.274 +0800 o.a.d.e.b.NettyRemotingServer:[112] - WorkerRpcServer bind success at port: 1234
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.275 +0800 o.a.d.s.w.r.WorkerRpcServer:[43] - WorkerRpcServer started...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.377 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.632 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JAVA - JavaTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.633 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.651 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: JUPYTER - JupyterTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.652 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.655 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SPARK - SparkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.655 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.660 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK_STREAM - FlinkStreamTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.660 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.662 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTHON - PythonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.663 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.774 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATASYNC - DatasyncTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.775 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.776 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_FACTORY - DatafactoryTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.777 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.778 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: CHUNJUN - ChunJunTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.779 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.780 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: REMOTESHELL - RemoteShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.781 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.782 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PIGEON - PigeonTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.782 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.783 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SHELL - ShellTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.783 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.785 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PROCEDURE - ProcedureTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.792 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.798 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MR - MapReduceTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.801 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.811 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQOOP - SqoopTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.811 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.814 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: PYTORCH - PytorchTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.815 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.818 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: K8S - K8sTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.818 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.823 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SEATUNNEL - SeatunnelTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.824 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.829 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SAGEMAKER - SagemakerTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.829 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.831 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HTTP - HttpTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.831 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.834 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: EMR - EmrTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.835 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.836 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DMS - DmsTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.837 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.839 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATA_QUALITY - DataQualityTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.839 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.840 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: KUBEFLOW - KubeflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.840 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.841 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: SQL - SqlTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.842 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.842 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DVC - DvcTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.843 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.844 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DATAX - DataxTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.845 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.846 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: ZEPPELIN - ZeppelinTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.847 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.848 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: DINKY - DinkyTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.848 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.850 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: MLFLOW - MlflowTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.850 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.853 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: OPENMLDB - OpenmldbTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.854 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.856 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: LINKIS - LinkisTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.857 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.858 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: FLINK - FlinkTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.859 +0800 o.a.d.p.t.a.TaskPluginManager:[63] - Registering task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.861 +0800 o.a.d.p.t.a.TaskPluginManager:[68] - Registered task plugin: HIVECLI - HiveCliTaskChannelFactory
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:15.989 +0800 o.a.d.c.u.JSONUtils:[72] - init timezone: sun.util.calendar.ZoneInfo[id="Asia/Shanghai",offset=28800000,dstSavings=0,useDaylight=false,transitions=31,lastRule=null]
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:16.344 +0800 o.a.d.s.w.r.WorkerRegistryClient:[104] - Worker node: 172.18.1.1:1234 registry to ZK /nodes/worker/172.18.1.1:1234 successfully
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.380 +0800 o.a.d.c.m.BaseHeartBeatTask:[48] - Starting WorkerHeartBeatTask...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.389 +0800 o.a.d.c.m.BaseHeartBeatTask:[50] - Started WorkerHeartBeatTask, heartBeatInterval: 10000...
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.391 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.048689138576779 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.391 +0800 o.a.d.s.w.r.WorkerRegistryClient:[114] - Worker node: 172.18.1.1:1234 registry finished
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.394 +0800 o.a.d.s.w.m.MessageRetryRunner:[69] - Message retry runner staring
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.555 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionFinishEventSender
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.556 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionInfoUpdateEventSender
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.556 +0800 o.a.d.s.w.m.MessageRetryRunner:[72] - Injected message sender: TaskInstanceExecutionRunningEventSender
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:17.567 +0800 o.a.d.s.w.m.MessageRetryRunner:[75] - Message retry runner started
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:18.484 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.5555555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:19.704 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.9555555555555557 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:20.855 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.7619047619047619 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:21.865 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.144578313253012 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:22.884 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:23.978 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.9893617021276595 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:24.333 +0800 o.s.b.a.e.w.EndpointLinksResolver:[58] - Exposing 3 endpoint(s) beneath base path '/actuator'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.052 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.116 +0800 o.e.j.s.h.C.application:[2368] - Initializing Spring DispatcherServlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.123 +0800 o.s.w.s.DispatcherServlet:[525] - Initializing Servlet 'dispatcherServlet'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.183 +0800 o.s.w.s.DispatcherServlet:[547] - Completed initialization in 2 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.214 +0800 o.e.j.s.AbstractConnector:[333] - Started ServerConnector@acb5508{HTTP/1.1, (http/1.1)}{0.0.0.0:1235}
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.242 +0800 o.s.b.w.e.j.JettyWebServer:[172] - Jetty started on port(s) 1235 (http/1.1) with context path '/'
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:25.626 +0800 o.a.d.s.w.WorkerServer:[61] - Started WorkerServer in 45.948 seconds (JVM running for 49.157)
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:26.063 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 2.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:27.077 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9555233445224289 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:28.096 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8685064935064936 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:29.114 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0067567567567568 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:30.683 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8651315789473684 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:31.696 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8905109489051095 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:32.698 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8391304347826087 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:33.702 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8084507042253521 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:34.759 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8809523809523809 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:35.803 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8857142857142857 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:36.805 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8894736842105263 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:37.822 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9705882352941176 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:38.833 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8264150943396227 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:39.845 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7208121827411168 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:40.849 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8778280542986425 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:41.851 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9540229885057472 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:43.011 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7014218009478673 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:44.054 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.755 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:45.058 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7899543378995433 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:46.068 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8818443804034583 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:47.142 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8385826771653543 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:54.172 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.708215297450425 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:55.194 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7078651685393258 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.222 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8125 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:30:59.398 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1392, taskName=search for intake JSON files, firstSubmitTime=1713925858717, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1392'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103058'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=OUT, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.507 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.533 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.534 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925859536
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1392
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1392,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713925858717,
  "startTime" : 1713925859536,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1392.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1392"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103058"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1392",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.669 +0800 o.a.d.c.u.OSUtils:[231] - create linux os user: default
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.670 +0800 o.a.d.c.u.OSUtils:[233] - execute cmd: sudo useradd -g root
 default
[WI-0][TI-1392] - [INFO] 2024-04-24 10:30:59.670 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1392, success=true)
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.756 +0800 o.a.d.c.u.OSUtils:[190] - create user default success
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.762 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392 check successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.763 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.773 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.794 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.806 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.806 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.807 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.809 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.828 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.829 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.829 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}"
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.829 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.831 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392/566_1392.sh
[WI-566][TI-1392] - [INFO] 2024-04-24 10:30:59.838 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 86
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:00.247 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7024793388429752 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1392] - [INFO] 2024-04-24 10:31:00.670 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1392)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:00.847 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.850 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392, processId:86 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.852 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.853 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1392
[WI-566][TI-1392] - [INFO] 2024-04-24 10:31:00.883 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1392] - [INFO] 2024-04-24 10:31:01.661 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1392, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:49.477 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7335243553008597 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:31:50.514 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7437325905292478 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:03.177 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1395, taskName=search for intake JSON files, firstSubmitTime=1713925923163, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1395'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103203'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.181 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.183 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.188 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.188 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.188 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.188 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925923188
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.197 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1395
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.198 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1395,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713925923163,
  "startTime" : 1713925923188,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1395.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1395"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103203"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1395",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.199 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.199 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.199 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.210 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.211 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.212 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395 check successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.213 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.214 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.215 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.215 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.216 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.218 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.218 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.218 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.219 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.219 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.220 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}"
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.220 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.220 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395/566_1395.sh
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:03.229 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 115
[WI-0][TI-1395] - [INFO] 2024-04-24 10:32:03.801 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1395, success=true)
[WI-0][TI-1395] - [INFO] 2024-04-24 10:32:03.826 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1395)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:05.168 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.180 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395, processId:115 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.181 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.181 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.181 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.183 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.200 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.203 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.225 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1395
[WI-566][TI-1395] - [INFO] 2024-04-24 10:32:05.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1395] - [INFO] 2024-04-24 10:32:06.173 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1395, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:07.321 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1397, taskName=move to processing, firstSubmitTime=1713925927309, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1397'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103207'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.331 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.332 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.334 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.334 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925927334
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.336 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1397
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1397,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713925927309,
  "startTime" : 1713925927334,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1397.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1397"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103207"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1397",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.343 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.344 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.349 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.349 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397 check successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.351 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.352 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.352 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.353 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.354 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.354 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.354 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.354 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397/566_1397.sh
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:07.364 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 132
[WI-0][TI-1397] - [INFO] 2024-04-24 10:32:08.180 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1397, success=true)
[WI-0][TI-1397] - [INFO] 2024-04-24 10:32:08.189 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1397)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:08.373 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.389 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397, processId:132 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.389 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.389 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.393 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.399 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.400 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.400 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.401 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1397
[WI-566][TI-1397] - [INFO] 2024-04-24 10:32:08.401 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1397] - [INFO] 2024-04-24 10:32:09.184 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1397, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:09.281 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1398, taskName=spark preprocessing, firstSubmitTime=1713925929272, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=99, appIds=null, processInstanceId=566, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1398'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103209'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='566'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.283 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.284 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.285 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713925929286
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 566_1398
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.287 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1398,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713925929272,
  "startTime" : 1713925929286,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/99/566/1398.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 99,
  "processInstanceId" : 566,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1398"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103209"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "566"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "566_1398",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.297 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.305 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.306 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398 check successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.375 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.383 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.383 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.385 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.385 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.385 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.386 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.386 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.386 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.387 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.389 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.389 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    spark_reddit_preprocessing.py

[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.389 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.389 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398/566_1398.sh
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:09.396 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 150
[WI-0][TI-1398] - [INFO] 2024-04-24 10:32:10.198 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1398, success=true)
[WI-0][TI-1398] - [INFO] 2024-04-24 10:32:10.251 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1398)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:10.403 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398/566_1398.sh: line 10: /opt/spark-3.5.1-bin-hadoop3/bin/spark-submit: No such file or directory
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.405 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398, processId:150 ,exitStatusCode:127 ,processWaitForStatus:true ,processExitValue:127
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.406 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.407 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.407 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.412 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.428 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.429 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.429 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.452 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_99/566/1398
[WI-566][TI-1398] - [INFO] 2024-04-24 10:32:10.452 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1398] - [INFO] 2024-04-24 10:32:11.203 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1398, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:32.251 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7134502923976608 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:33.331 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7166666666666666 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:32:57.460 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.872093023255814 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:34:19.937 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7278481012658228 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:01.179 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7102272727272727 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:02.243 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8736842105263158 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:03.247 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8820224719101123 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:15.351 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1399, taskName=search for intake JSON files, firstSubmitTime=1713926115291, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=100, appIds=null, processInstanceId=567, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1399'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103515'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='567'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.353 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.354 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926115372
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.375 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 567_1399
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.380 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1399,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713926115291,
  "startTime" : 1713926115372,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1399.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 100,
  "processInstanceId" : 567,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1399"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103515"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "567"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "567_1399",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.387 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.400 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.402 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.404 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399 check successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.406 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.407 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.408 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.410 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.418 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.421 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.421 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399/567_1399.sh
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:15.449 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 211
[WI-0][TI-1399] - [INFO] 2024-04-24 10:35:15.621 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1399, success=true)
[WI-0][TI-1399] - [INFO] 2024-04-24 10:35:15.637 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1399)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:16.451 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.457 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399, processId:211 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.460 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.467 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.468 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.468 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1399
[WI-567][TI-1399] - [INFO] 2024-04-24 10:35:16.471 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1399] - [INFO] 2024-04-24 10:35:16.622 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1399, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:17.726 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1401, taskName=move to processing, firstSubmitTime=1713926117693, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=100, appIds=null, processInstanceId=567, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1401'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103517'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='567'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.732 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.735 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.756 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926117757
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 567_1401
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1401,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713926117693,
  "startTime" : 1713926117757,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 100,
  "processInstanceId" : 567,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1401"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103517"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "567"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "567_1401",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.797 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.799 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401 check successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.805 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.810 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.812 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.812 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.812 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.813 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401/567_1401.sh
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:17.819 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 225
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.599 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.611 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionRunningEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.9:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1401.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=1713926118597)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.612 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, workflowInstanceHost=172.18.0.9:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.617 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1401, processInstanceId=567, startTime=1713926117757, workflowInstanceHost=172.18.0.9:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713926118597)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.634 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1401, success=true)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.645 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1401)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.658 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1401, success=true)
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:18.685 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1401)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:18.830 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.837 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401, processId:225 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.839 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.839 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.839 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.845 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1401
[WI-567][TI-1401] - [INFO] 2024-04-24 10:35:18.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1401] - [INFO] 2024-04-24 10:35:19.615 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1401, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:19.674 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1402, taskName=spark preprocessing, firstSubmitTime=1713926119647, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=100, appIds=null, processInstanceId=567, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1402'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424103519'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='567'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.675 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.676 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.680 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926119680
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 567_1402
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1402,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926119647,
  "startTime" : 1713926119680,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/100/567/1402.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 100,
  "processInstanceId" : 567,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1402"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424103519"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "567"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "567_1402",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.681 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.682 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.682 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.691 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.692 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.694 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402 check successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.694 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.725 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.727 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.727 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    spark_reddit_preprocessing.py

[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.730 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/567_1402.sh
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:19.735 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 237
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:20.623 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1402, success=true)
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:20.637 +0800 o.a.d.s.w.m.MessageRetryRunner:[132] - Begin retry send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1402, processInstanceId=567, startTime=1713926119680, workflowInstanceHost=172.18.0.9:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:20.640 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1402)
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:20.650 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1402)
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:20.651 +0800 o.a.d.s.w.m.MessageRetryRunner:[135] - Success send message to master, event: TaskInstanceExecutionInfoEvent(taskInstanceId=1402, processInstanceId=567, startTime=1713926119680, workflowInstanceHost=172.18.0.9:5678, taskInstanceHost=172.18.1.1:1234, logPath=null, processId=0, eventCreateTime=0, eventSendTime=1713926120637)
[WI-0][TI-1402] - [WARN] 2024-04-24 10:35:20.656 +0800 o.a.d.s.w.m.MessageRetryRunner:[139] - Retry send message to master error
java.util.ConcurrentModificationException: null
	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:911)
	at java.util.ArrayList$Itr.next(ArrayList.java:861)
	at org.apache.dolphinscheduler.server.worker.message.MessageRetryRunner.run(MessageRetryRunner.java:127)
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:20.739 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:21.359 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7357859531772575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:22.447 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7549341026817913 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:22.748 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:22 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:23.749 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:23 INFO SparkContext: Running Spark version 3.5.1
	24/04/24 10:35:23 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:35:23 INFO SparkContext: Java version 1.8.0_402
	24/04/24 10:35:23 INFO ResourceUtils: ==============================================================
	24/04/24 10:35:23 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/24 10:35:23 INFO ResourceUtils: ==============================================================
	24/04/24 10:35:23 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/24 10:35:23 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/24 10:35:23 INFO ResourceProfile: Limiting resource is cpus at 1 tasks per executor
	24/04/24 10:35:23 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/24 10:35:23 INFO SecurityManager: Changing view acls to: default
	24/04/24 10:35:23 INFO SecurityManager: Changing modify acls to: default
	24/04/24 10:35:23 INFO SecurityManager: Changing view acls groups to: 
	24/04/24 10:35:23 INFO SecurityManager: Changing modify acls groups to: 
	24/04/24 10:35:23 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
	24/04/24 10:35:23 INFO Utils: Successfully started service 'sparkDriver' on port 33411.
	24/04/24 10:35:23 INFO SparkEnv: Registering MapOutputTracker
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:24.751 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:23 INFO SparkEnv: Registering BlockManagerMaster
	24/04/24 10:35:23 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/24 10:35:23 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/24 10:35:23 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/24 10:35:24 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-2d48ddc5-74f6-4c91-bbc0-9e88debfd335
	24/04/24 10:35:24 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
	24/04/24 10:35:24 INFO SparkEnv: Registering OutputCommitCoordinator
	24/04/24 10:35:24 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/24 10:35:24 INFO Utils: Successfully started service 'SparkUI' on port 4040.
	24/04/24 10:35:24 INFO SparkContext: Added JAR file:///tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar at spark://6b0330d1bc18:33411/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713926123272
	24/04/24 10:35:24 INFO SparkContext: Added file file:///local_storage/reddit/processing/500-20240423.json at file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713926123272
	24/04/24 10:35:24 INFO Utils: Copying /local_storage/reddit/processing/500-20240423.json to /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/500-20240423.json
	24/04/24 10:35:24 INFO Executor: Starting executor ID driver on host 6b0330d1bc18
	24/04/24 10:35:24 INFO Executor: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:35:24 INFO Executor: Java version 1.8.0_402
	24/04/24 10:35:24 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
	24/04/24 10:35:24 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@25302f7f for default.
	24/04/24 10:35:24 INFO Executor: Fetching file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713926123272
	24/04/24 10:35:24 INFO Utils: /local_storage/reddit/processing/500-20240423.json has been previously copied to /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/500-20240423.json
	24/04/24 10:35:24 INFO Executor: Fetching spark://6b0330d1bc18:33411/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713926123272
	24/04/24 10:35:24 INFO TransportClientFactory: Successfully created connection to 6b0330d1bc18/172.18.1.1:33411 after 54 ms (0 ms spent in bootstraps)
	24/04/24 10:35:24 INFO Utils: Fetching spark://6b0330d1bc18:33411/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar to /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/fetchFileTemp8489542186449976643.tmp
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:25.754 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:24 INFO Executor: Adding file:/tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/spark-sql-kafka-0-10_2.13-3.5.1.jar to class loader default
	24/04/24 10:35:24 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 37297.
	24/04/24 10:35:24 INFO NettyBlockTransferService: Server created on 6b0330d1bc18:37297
	24/04/24 10:35:24 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/24 10:35:24 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 6b0330d1bc18, 37297, None)
	24/04/24 10:35:24 INFO BlockManagerMasterEndpoint: Registering block manager 6b0330d1bc18:37297 with 366.3 MiB RAM, BlockManagerId(driver, 6b0330d1bc18, 37297, None)
	24/04/24 10:35:24 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 6b0330d1bc18, 37297, None)
	24/04/24 10:35:24 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 6b0330d1bc18, 37297, None)
	
	
	
	 /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/500-20240423.json 
	
	
	
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:26.760 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:25 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 345.6 KiB, free 366.0 MiB)
	24/04/24 10:35:25 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 32.7 KiB, free 365.9 MiB)
	24/04/24 10:35:25 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 6b0330d1bc18:37297 (size: 32.7 KiB, free: 366.3 MiB)
	24/04/24 10:35:25 INFO SparkContext: Created broadcast 0 from wholeTextFiles at NativeMethodAccessorImpl.java:0
	24/04/24 10:35:25 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/24 10:35:25 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:28.478 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8888888888888888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:29.528 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7675276752767527 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:31.558 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8735632183908045 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:32.606 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9075907590759076 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:32.872 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:31 INFO CodeGenerator: Code generated in 764.02811 ms
	24/04/24 10:35:32 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:35:32 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:35:32 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/24 10:35:32 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/24 10:35:32 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/24 10:35:32 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:35:32 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:35:32 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:35:32 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 24.0 KiB, free 365.9 MiB)
	24/04/24 10:35:32 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 11.4 KiB, free 365.9 MiB)
	24/04/24 10:35:32 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 6b0330d1bc18:37297 (size: 11.4 KiB, free: 366.3 MiB)
	24/04/24 10:35:32 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:35:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:35:32 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:33.608 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8357771260997067 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:33.887 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:32 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (6b0330d1bc18, executor driver, partition 0, PROCESS_LOCAL, 8176 bytes) 
	24/04/24 10:35:32 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
	24/04/24 10:35:33 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/500-20240423.json:0+147333
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:34.891 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:34 INFO CodeGenerator: Code generated in 70.206162 ms
	24/04/24 10:35:34 INFO PythonRunner: Times: total = 759, boot = 592, init = 146, finish = 21
	24/04/24 10:35:34 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2947 bytes result sent to driver
	24/04/24 10:35:34 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1587 ms on 6b0330d1bc18 (executor driver) (1/1)
	24/04/24 10:35:34 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
	24/04/24 10:35:34 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 42309
	24/04/24 10:35:34 INFO DAGScheduler: ResultStage 0 (json at NativeMethodAccessorImpl.java:0) finished in 1.988 s
	24/04/24 10:35:34 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:35:34 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
	24/04/24 10:35:34 INFO DAGScheduler: Job 0 finished: json at NativeMethodAccessorImpl.java:0, took 2.285438 s
	
	
	
	 1 
	
	
	
	
	
	
	 2 
	
	
	
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:35.917 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	
	
	
	 3 
	
	
	
	
	
	
	 4 
	
	
	
	24/04/24 10:35:35 INFO CodeGenerator: Code generated in 28.809436 ms
	24/04/24 10:35:35 INFO CodeGenerator: Code generated in 17.249902 ms
	24/04/24 10:35:35 INFO SparkContext: Starting job: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py:84
	24/04/24 10:35:35 INFO DAGScheduler: Got job 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py:84) with 1 output partitions
	24/04/24 10:35:35 INFO DAGScheduler: Final stage: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py:84)
	24/04/24 10:35:35 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:35:35 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:35:35 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 6b0330d1bc18:37297 in memory (size: 11.4 KiB, free: 366.3 MiB)
	24/04/24 10:35:35 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:35:35 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 62.8 KiB, free 365.9 MiB)
	24/04/24 10:35:35 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 22.6 KiB, free 365.8 MiB)
	24/04/24 10:35:35 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 6b0330d1bc18:37297 (size: 22.6 KiB, free: 366.2 MiB)
	24/04/24 10:35:35 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:35:35 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:35:35 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
	24/04/24 10:35:35 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (6b0330d1bc18, executor driver, partition 0, PROCESS_LOCAL, 8176 bytes) 
	24/04/24 10:35:35 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
	24/04/24 10:35:35 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/userFiles-2ae85539-41dd-4d01-b999-f476404385ff/500-20240423.json:0+147333
	24/04/24 10:35:35 INFO CodeGenerator: Code generated in 34.93389 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:36.920 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:35 INFO CodeGenerator: Code generated in 13.010437 ms
	24/04/24 10:35:36 INFO CodeGenerator: Code generated in 19.870546 ms
	24/04/24 10:35:36 INFO CodeGenerator: Code generated in 11.961747 ms
	24/04/24 10:35:36 INFO CodeGenerator: Code generated in 17.026197 ms
	24/04/24 10:35:36 INFO PythonRunner: Times: total = 110, boot = -1413, init = 1511, finish = 12
	24/04/24 10:35:36 INFO CodeGenerator: Code generated in 81.899284 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:35:37.922 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:35:36 INFO PythonUDFRunner: Times: total = 717, boot = 585, init = 132, finish = 0
	24/04/24 10:35:36 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 135926 bytes result sent to driver
	24/04/24 10:35:36 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1435 ms on 6b0330d1bc18 (executor driver) (1/1)
	24/04/24 10:35:36 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
	24/04/24 10:35:36 INFO DAGScheduler: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py:84) finished in 1.465 s
	24/04/24 10:35:36 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:35:36 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
	24/04/24 10:35:36 INFO DAGScheduler: Job 1 finished: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py:84, took 1.476180 s
	{"user":"NekoIdo","content":"https://preview.redd.it/u68bjywya5wc1.png?width=808&format=png&auto=webp&s=d42529d6566d93e3df2f8be398afd887a258d020\n\nFound the deleted post [here](https://www.reddit.com/r/SGExams/comments/1capzon/hi_i_am_the_driver_of_snh7z_i_would_like_to_clear/).  \nMain content has been deleted by mods but the comments are definitely not buying his excuse.\n\nAlso someone else posted another captured instance of this same driver being a road menace here:  \n[https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/](https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/)\n\nPersonally I think it's really lucky for this Benz driver that the SAAB driver survived, or the spotlight would shine solely on him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":341,"subreddit":"singapore","type":"post","id":"1cau62k","datetime":"2024-04-23 11:06:00"}
	{"user":"dylank999","content":"Speeding up to prevent people from changing lane/overtaking. \n\nNumber 1 ego of Singapore drivers. It's a pandemic on our roads.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9els/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":395,"subreddit":"singapore","type":"comment","id":"l0u9els","datetime":"2024-04-23 11:38:17"}
	{"user":"pureeyes","content":"All he had to do was say nothing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uau6z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":197,"subreddit":"singapore","type":"comment","id":"l0uau6z","datetime":"2024-04-23 11:49:38"}
	{"user":"PhantomWolf83","content":">my thought was to tell the SAAB driver to slow down, hence I sped up while he was overtaking\n\n???????","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u5ykg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":365,"subreddit":"singapore","type":"comment","id":"l0u5ykg","datetime":"2024-04-23 11:11:50"}
	{"user":"I_Miss_Every_Shot","content":"Basic Theory or Advance Theory should include a psycho-emotional assessment. People who registered increased heart rate/ BP/ stress or inclination to speed up/ overtake when overtaken or have their lane cut into should undergo mandatory counselling or be denied their license altogether.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uas8s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":115,"subreddit":"singapore","type":"comment","id":"l0uas8s","datetime":"2024-04-23 11:49:11"}
	{"user":"BinaryDoom","content":"It's precisely because there are immature drivers on the road, such behavior would only make driving in Singapore unpleasant. The white Merc driver is not the only one. It could have been someone else. Anyway, based on the footage, from the way he has executed it, I wouldn't buy his claim of wanting the black driver to slow down by speeding up. Only when you practice enough of this, it becomes a natural reaction.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaru6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0uaru6","datetime":"2024-04-23 11:49:06"}
	{"user":"testercheong","content":"I'm more curious as to why its posted on sgexams though","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uamri/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":72,"subreddit":"singapore","type":"comment","id":"l0uamri","datetime":"2024-04-23 11:47:59"}
	{"user":"adept1onreddit","content":"Regardless of what he thinks about the whole situation, the smart option would be to keep his mouth shut. Who knows what kind of legal issues may arise.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucey8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":27,"subreddit":"singapore","type":"comment","id":"l0ucey8","datetime":"2024-04-23 12:02:25"}
	{"user":"Background_Tax_1985","content":"His reasons are bs but that does not deviate from the fact that the accident was 100% caused by the saab driver (sd). \n\nEven before the mercedes driver (md) sped up to block the sd, sd was already speeding. Just a side note, if md and sd were racing each other we would have seen it from the first vehicle camera footage of the accident from the other merc, which we did not. \n\nIs md wrong and a dick? Yes. Did md commit an offence by driving in that manner? Maybe. Did he cause the accident? No.\n\nBecause after side swiping md, sd could have stopped. He had all the time and distance in the world to stop but he decided to speed on into the distance instead. \n\nThere is literally 2 school zones after that junction where the accident took place. If he had not gotten into an accident there, he could potentially have plowed into alot of kids, since the accident took place at school start time.\n\nSd really needs to be serverly punished for this.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7xwv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":193,"subreddit":"singapore","type":"comment","id":"l0u7xwv","datetime":"2024-04-23 11:26:49"}
	{"user":"blitzmango","content":"So desperate to defend his actions that he created 3 threads but looks like its gonna back fire instead. If it weren't for the second video incident, I might have given him the benefit of doubt, but sorry no.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7mlk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":57,"subreddit":"singapore","type":"comment","id":"l0u7mlk","datetime":"2024-04-23 11:24:24"}
	{"user":"top1global","content":"In the end, he is posting it to defend himself and blame others. 0 apology or remorse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubg1n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":48,"subreddit":"singapore","type":"comment","id":"l0ubg1n","datetime":"2024-04-23 11:54:35"}
	{"user":"Stripey7676","content":"Theres a huge debate over at EDMW whether any blame should be placed white merc. Now, the saab is 120% at fault. No doubt about that. However, while white merc is not criminally liable, he definitely contributed to the chain of events leading to the accident due to his ungracious, undefensive driving. \n\nFrom the vid, 2 things were evident \n\n1. Saab panic after clipping merc (who sped up to prevent overtaking). \n2. Saab went crazy fast after clipping as if to escape confrontation. \n\nIm betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThings would have been very different is merc slowed down, like a defensive driver would, when encountering siao langs on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud13l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":42,"subreddit":"singapore","type":"comment","id":"l0ud13l","datetime":"2024-04-23 12:07:31"}
	{"user":"FalseAgent","content":"yet another retarded sg driver. so what if others are speeding? you stick to the speed limit and drive safe. End of story. Everyone do this and play their part, we get safer roads. No need to be hero","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uep1i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0uep1i","datetime":"2024-04-23 12:21:36"}
	{"user":"Ceeja_y","content":"he wanted to post here but his acc didnt meet the requirements lol. oh well, he would still get an earful even if he did post here","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u77vi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":34,"subreddit":"singapore","type":"comment","id":"l0u77vi","datetime":"2024-04-23 11:21:18"}
	{"user":"BakeMate","content":"Hope the guilt eats him from inside. With more video surfacing of his driving behavior, he can write 10000 words essay all he wants, still a piece of shit\n\n> assuming I'm always like that\n\nYes you are. Nothing changed. It's a matter of whether you're caught on camera or not, and whether people want to upload","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7lcc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":76,"subreddit":"singapore","type":"comment","id":"l0u7lcc","datetime":"2024-04-23 11:24:08"}
	{"user":"MyColdDeadHandz","content":">As for the motorcycle incident, the motorcyclist was hogging the road, preventing me from going forward\n\nBut that was a single lane? Motorcyclist had all the right to be there in the middle of that lane. I've seen many drivers file up in two lines (when the road was wide enough, like in the clip) when filtering into an expressway, but this is the first time I've seen someone feel entitled in doing it.\n\nSounds like a real piece of work.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahrp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0uahrp","datetime":"2024-04-23 11:46:52"}
	{"user":"tolifeonline","content":"One young life was ended prematurely. The saying \"no parents should ever have to bury their child\" rings heavy in this incident. Imagine how inconsolable the father will be after waking up to find out his child has been taken away forever from him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2j2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uc2j2","datetime":"2024-04-23 11:59:38"}
	{"user":"dibidi","content":"his lawyers seeing his post: $$$$$$$","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udihn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0udihn","datetime":"2024-04-23 12:11:30"}
	{"user":"Initial_E","content":"In the 2-3 seconds of the incident both drivers were not making a conscious decision to goad each other, instead they were doing what they conditioned themselves to do. \nThere's no point asking \"what was going through his head\", it's what goes through his head every time he is behind the wheel that counts.\n\n\nSo it is with defensive driving. If it is a hat that you wear on your head, it should go on as automatically as wearing your seatbelt, should stay on for about just as long as you are wearing that seatbelt. And you can condition yourself to make it automatic. See, you already did it to wear a seatbelt.\n\nYou can't practice defensive driving only when you are nearly doing something dangerous, that's not how it works.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhxwn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhxwn","datetime":"2024-04-23 12:48:53"}
	{"user":"Common-Metal8578","content":"Heard other videos of him being an asshole driver are surfacing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo4s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ufo4s","datetime":"2024-04-23 12:30:00"}
	{"user":"KneeGal","content":"This Benz driver is an idiot but if you look at his [dashcam](https://imgur.com/a/YuwFzNz), after the contact, there is plenty of road left for the SAAB driver to brake. Instead it seems he sped up and ran directly into traffic. \n\nThe point of contact happened so far away from the junction that his involvement would have made no difference to the outcome.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0uea8q","datetime":"2024-04-23 12:18:02"}
	{"user":"ProfessionalMottsman","content":"Wow what a fool, never say anything in an accident as directed by your insurance company, they can refuse to cover you if you admit liability","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubboi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ubboi","datetime":"2024-04-23 11:53:37"}
	{"user":"RiskDry6267","content":"This merc also scum, open mouth to dig ownself bigger hole, edmw hurry up name and shame !","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhzil/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uhzil","datetime":"2024-04-23 12:49:17"}
	{"user":"Yokies","content":"Dude can't keep his mouth shut to save himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9hwk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0u9hwk","datetime":"2024-04-23 11:38:59"}
	{"user":"isleftisright","content":"Sd caused the accident by himself. He clearly had time to stop at the light but didnt. \n\nMd is a rude driver nonethless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdok/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubdok","datetime":"2024-04-23 11:54:03"}
	{"user":"CedaraThursday1314","content":"Self saboing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawb2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0uawb2","datetime":"2024-04-23 11:50:06"}
	{"user":"dibidi","content":"the root cause here is that there is no driving culture of giving way. \n\nevery driver drives like a race car driver. bec they see any pass by any other road user as a slight and sign of disrespect. \n\nroad safety will never be addressed in Singapore as long as gov doesnt address this culture.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udrb4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0udrb4","datetime":"2024-04-23 12:13:32"}
	{"user":"Formal_Judgment6481","content":"One of the most dumbass excuses. Hope this accident will forever haunt you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugemm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ugemm","datetime":"2024-04-23 12:35:58"}
	{"user":"peterthewiserock","content":"Benz drivers lawyer is going to have a field day with that post.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugfe6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ugfe6","datetime":"2024-04-23 12:36:07"}
	{"user":"subzephyr","content":"why tf he posting on a kids subreddit","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucyms/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ucyms","datetime":"2024-04-23 12:06:57"}
	{"user":"Ok-Tap4277","content":"Terrible cost to his behaviour escalating a bad situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ufo9n","datetime":"2024-04-23 12:30:02"}
	{"user":"pudding567","content":"What if the driver decides to sue for defamation? There is a Defence of Justification (truth) and Fair Comment though.\nhttps://irblaw.com.sg/learning-centre/defamation-in-singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2cj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh2cj","datetime":"2024-04-23 12:41:17"}
	{"user":"meister00","content":"He might or might not have indirect involvement in the accident (the accident might have still occurred even if he wasn't there), but regardless of that the merc driver is sure one of those asshole drivers.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9dc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh9dc","datetime":"2024-04-23 12:42:55"}
	{"user":"raymmm","content":"Just like how he sped up to \"tell\" the other driver to slow down. People are treating him like shit to \"tell\" him to stop being an asshole to other motorists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhdcb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhdcb","datetime":"2024-04-23 12:43:52"}
	{"user":"DiscipleOfYeshua","content":"1. This the guy behind the one who rushed into red light, yes?\n\nThe one behind directly (on right) or the one on left?\n\n2. Motorcycle prevented me moving forward means too slow for my taste / made me lose 12.3 seconds on way to red light? I mean, motorcycle didnt outright stop in the road, was just 10 kph too slow for this guy?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhv2v/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhv2v","datetime":"2024-04-23 12:48:11"}
	{"user":"jayaxe79","content":"Seems like the more he explained, more questions arises.\n\n- So he tried to push the blame away yet doesn't blame everyone for pointing the finger at him?\n\n- Did his actions actually indirectly caused the Saab driver to go crazy? By just speeding up to prevent overtaking? \n\nHe claimed that he isn't \"like the person outside these incidents\". Who the hell believes this statement?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8jiu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0u8jiu","datetime":"2024-04-23 11:31:31"}
	{"user":"okayokaycancan","content":"Take both off the roads and it will be a safer place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua4b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua4b7","datetime":"2024-04-23 11:43:52"}
	{"user":"stickytofw","content":"Everything he does from his driving, both during the time leading up to and outside of the recent tragedy, to his Reddit apology message just screams ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugc7m/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ugc7m","datetime":"2024-04-23 12:35:27"}
	{"user":"xthekonmanx","content":"And still not a single apology or sympathy for the accident victims super lanjiao lang! He did apologize for the long post though ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uh9tv","datetime":"2024-04-23 12:43:02"}
	{"user":"AdministrativeGas324","content":"This guy is so smart that he bid for his car licence plate number using his IQ score.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui1li/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui1li","datetime":"2024-04-23 12:49:48"}
	{"user":"Merecat-litters","content":"uh why this bastard what to \"Self Justification\" here. fk you mate...give Self Justification when giving your testimony in court you donkey see if they like.\n\nYou only saying this because you were one of the factor of the accident and were caught in the act you and are not sorry for it to happen but sorry for getting caught in the act. The way I am interpreting the writing is  to make you not be responsible fully but blame it on others. knnccb\n\nHopefully mod dont remove this too...and hopefully we can see this fucker face when they go to court cant wait to see the case.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui2c0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui2c0","datetime":"2024-04-23 12:49:59"}
	{"user":"crassina","content":"Can he also be charged with dangerous driving causing death? Because his actions seemed pretty dangerous to me","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicnq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uicnq","datetime":"2024-04-23 12:52:34"}
	{"user":"random_thoughts5","content":"Why did he post it in the sgexams subreddit? Isnt that a subreddit for secondary and JC students?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9tgk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9tgk","datetime":"2024-04-23 11:41:32"}
	{"user":"noelsupertramp","content":"Two cars racing each other on the premise of trying to slow the other party down. Nobody is gonna buy this reason.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubkkn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ubkkn","datetime":"2024-04-23 11:55:38"}
	{"user":"AsuraPhantoma","content":"The moment you sped up near a cross junction (or really, speeding up in general) you already lost the right to argue or say anything","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiai2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiai2","datetime":"2024-04-23 12:52:01"}
	{"user":"laubase","content":"I have never seen a Merc being driven competently on Singapore roads in 37 years. No signal before switching lanes? Probably a Merc. Intentionally cutting queues? Probably a Merc. Not checking blind spot before switching lanes? Probably a Merc. \"Lane splitting\" to deny others from overtaking them? Probably a Merc.The list goes on and on. \n\nI swear something drives (pun intended) these kinda people to buy Mercs, probably because they're trying to signal (again, pun intended) their superiority to the average Singaporean. \"Look at what I can afford, you plebs better give way to me because I am THAT much more important than you.\".\n\nAnyone buying a Merc should be subject to a compulsory TP road test.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uevgx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uevgx","datetime":"2024-04-23 12:23:07"}
	{"user":"freshcheesepie","content":"Good I can sleep well knowing that the comments are affecting him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6rnh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u6rnh","datetime":"2024-04-23 11:17:47"}
	{"user":"DeeKayNineNine","content":"To be fair, the Merc driver didn't cause the accident and didn't contribute to the cause of the accident. It would have happen with or without the Merc driver. The Saab was already speeding. \n\nWe still don't know what is wrong with that Saab driver. Was he drunk? Under drug? No license? Or just some reckless driver? We don't know yet. Let's wait for the authorities to release more info. \n\nThe merc driver is a jerk. You can see that from the other video. And I'm sure there are more. But he didn't cause the accident. And I hope this accident is a wake up call for him and will make him change to be a better driver from now on. Else we can be sure we'll see him online again.\n\nBy the way, I wonder if the Merc has car camera. I think he got an unblock view of the entire accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufjru/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufjru","datetime":"2024-04-23 12:28:57"}
	{"user":"Prov0st","content":"Why is everyones eyes on the white mercs?? The SAAB was doing the speeding. The white mercs is not free of sin but ultimately the direct culprit is the saab.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua3pq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ua3pq","datetime":"2024-04-23 11:43:44"}
	{"user":"Dulio_rosward","content":"If he truly felt guilty, then he should have been reflecting more on his actions since he contributed to the loss of those 2 lives.\n\nInstead he chose to spend his time trying to rationalise his actions to netizens.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8inb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0u8inb","datetime":"2024-04-23 11:31:20"}
	{"user":"Chrissylumpy21","content":"This guy needs to be banned from driving. Hes just sorry he got caught thats all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9s9o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9s9o","datetime":"2024-04-23 11:41:16"}
	{"user":"deangsana","content":"he doth protest too much","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uegtx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uegtx","datetime":"2024-04-23 12:19:40"}
	{"user":"ThenCheesecake","content":"shouldnt this explanation be taken with a grain of salt cause we cant confirm it was actually written by the driver themselves?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufqt7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufqt7","datetime":"2024-04-23 12:30:37"}
	{"user":"PartTimeBomoh","content":"Streisand effect. I didnt think anything of him till he decided to write this post","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo92/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ugo92","datetime":"2024-04-23 12:38:01"}
	{"user":"canceler80","content":"No proof that user is actual driver. Can be a troll account","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uixvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uixvo","datetime":"2024-04-23 12:58:00"}
	{"user":"livinglifeingrieve","content":"Lawyer: okay. 2 years jail. If good boy can come out in 8 months. 5 years ban on driving.\nJudge: okeh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj8x8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj8x8","datetime":"2024-04-23 13:00:50"}
	{"user":"Familiar_Guava_2860","content":"Where is the logic in one speeding up  to tell \nan overtaking driver to slow down?!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj9pb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj9pb","datetime":"2024-04-23 13:01:03"}
	{"user":"FitCranberry","content":"just another reminder that there can be people out there with a completely different headspace thats incomprehensible to yourself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujkc6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujkc6","datetime":"2024-04-23 13:03:48"}
	{"user":"Noobcakes19","content":"some of my previous post about this asshole was downvoted.\n\nwe saw his action on various dashcam including his own, He's indeed a major egoistic asshole.\n\neveryone : White merc driver is an asshole\n\nwhite merc driver:  Hold my beer..... I AM AN asshole!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtzb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtzb","datetime":"2024-04-23 13:06:18"}
	{"user":"Dizzy_Boysenberry499","content":"If you check One Motoring, he deregistered his car on 22 April","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk0k6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk0k6","datetime":"2024-04-23 13:08:02"}
	{"user":"KBDMASS","content":"surprisingly, most drivers have such mentality of speeding so that the other person wont over take.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklgb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklgb","datetime":"2024-04-23 13:13:37"}
	{"user":"signinj","content":"Oh no! The internet is judging me for my driving! Better come up with a WOT. That surely will make things better","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ule7o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ule7o","datetime":"2024-04-23 13:21:28"}
	{"user":"heyearthdude","content":"His stupidity knows no bounds. Who uses words like overkill when writing about a fatal accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ultcm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ultcm","datetime":"2024-04-23 13:25:41"}
	{"user":"Vindicted1501","content":"Just surrender to TP and they will investigate how much of a safe driver he is.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umjes/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umjes","datetime":"2024-04-23 13:33:00"}
	{"user":"EnvironmentalExam784","content":"Someone need to CSI this douchebag face out please.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzee/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzee","datetime":"2024-04-23 13:37:38"}
	{"user":"andrew_marc","content":"just by the way it is written you can tell he/she is self entitled/ultra defensive and someone who is never in the wrong","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzwi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzwi","datetime":"2024-04-23 13:37:46"}
	{"user":"Frequent-Switch-5699","content":"to the op: what you said, how you explain yourself is no longer useful now. Get ready for a session of formal investigation and get yourself a good lawyer to defend for yourself if you can afford. We shall let the evidence speak for itself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un2t4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un2t4","datetime":"2024-04-23 13:38:37"}
	{"user":"LT-Ghastly","content":"Just arrest this guy as well, for the safety of others and road users.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubcnm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ubcnm","datetime":"2024-04-23 11:53:49"}
	{"user":"HalcyoNighT","content":"Wait why tf did the merc driver make his post on r/sgexams? This is not TP exam","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubc60/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ubc60","datetime":"2024-04-23 11:53:43"}
	{"user":"pyroSeven","content":"Ask him to slow down by speeding up. Very good, didnt know they taught this at driving school \n\n\nSuck my lanjiao la.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udw03/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0udw03","datetime":"2024-04-23 12:14:40"}
	{"user":"jackgermeister","content":"Can ask him to post the unmuted version of the dashcam, then? Since he claimed to toot the motorcyclist, or ask the Saab driver to slowdown.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uedza/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uedza","datetime":"2024-04-23 12:18:59"}
	{"user":"Alive_Ad7522","content":"What the bull shit. Absolutely no remorse at all. Sick mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8v1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0u8v1q","datetime":"2024-04-23 11:33:55"}
	{"user":"Spiritual-Okra-7836","content":"oh my god this guy is a fucking moron. Take his license away NOW.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua8ut/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua8ut","datetime":"2024-04-23 11:44:52"}
	{"user":"lvofdifficulties","content":"Why did he post at /r/SGExams? He's a student?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9954/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0u9954","datetime":"2024-04-23 11:37:02"}
	{"user":"hawk_199","content":"Haha Streisand effect in play...if he didn't post this within a few days/weeks he would have been forgotten.\n\nGo and post this stupid justification and shoot himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhs1l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhs1l","datetime":"2024-04-23 12:47:25"}
	{"user":"CrossfittJesus","content":"Might be a hot take here but while the Merz is an asshole driver, I see the precious video of him a couple of days before the Tampines incident and the incident itself as mutually exclusive. IMO he didnt have that big a role to play in the Saab incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk9qq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk9qq","datetime":"2024-04-23 13:10:30"}
	{"user":"smurflings","content":"Not agreeing or disagreeing with this guy but why are people chewing him out for that incident? It's entirely the Saab driver's fault.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8rzg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0u8rzg","datetime":"2024-04-23 11:33:16"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue69a/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue69a","datetime":"2024-04-23 12:17:05"}
	{"user":"Winner_takesitall","content":"A sad by-product of our hyper competitive society: being unable to give, only know how to take..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uja1t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uja1t","datetime":"2024-04-23 13:01:08"}
	{"user":"foodloveroftheworld","content":"**When your 1000-word essay is due but you've only got 100 words of pure self-justification that miss the whole point.**","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukuo6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukuo6","datetime":"2024-04-23 13:16:05"}
	{"user":"MurkyConsideration98","content":"This chap is delulu.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uma4k/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uma4k","datetime":"2024-04-23 13:30:22"}
	{"user":"darrenoloGy","content":"typical narcissistic response.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un645/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un645","datetime":"2024-04-23 13:39:37"}
	{"user":"appealban","content":"this here is peak example of egoism/narcissism. gold medal mental gymnastics. hopefully the driver reads this and wake up his idea.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unvuv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unvuv","datetime":"2024-04-23 13:47:11"}
	{"user":"PerformanceCheap4074","content":"Gua Lan C**t with his GLC Mercs","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoefq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoefq","datetime":"2024-04-23 13:52:42"}
	{"user":"khaosdd","content":"A rich, GoonduLoserCunt-class driving asshole posting on an obscure subreddit?\n\nAlso glc camcar footage was uploaded by one Anthony Soon on fb who already locked his profile and disabled all comments. From the look of his profile and style, he doesn't seem like those who will browse reddit, much less r/SGExams.\n\nSo the op who posted there seems kinda sus to me. Could be an impersonator.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujb9c/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujb9c","datetime":"2024-04-23 13:01:26"}
	{"user":"buffyfluffy","content":"Yall gotta stop finding reasons to blame someone. Speeding on roads happen every single day in every single part of SG. Yes it's wrong, but that's not the reason for the 2 deaths. Speeding dont cause people to speed through a cross junction on a red light. Even on expressways you see those typical Ah beng BMW/VW/Mini speeders, they cut in and out dangerously but still manage to brake on time and cut in when the gap is right. This SAAB driver decided to try out GTA in real life but people still trying to find rationalize and find more people to blame in order to cope with this tragedy.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugr9t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugr9t","datetime":"2024-04-23 12:38:42"}
	{"user":"JakeAndRay","content":"When i first made comments about this guy i get downvoted like no ones business, now everyone shitting on him? Very good guys. Supreme echo chamber in here. \n\nSame shit happened during the initial covid outbreak. I say just stay home, not difficult exercise at home etc. Learn to think for yourselves guys. Pls downvote me no problem","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulxz7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulxz7","datetime":"2024-04-23 13:26:58"}
	{"user":"meowinbox","content":"How can you be so sure that's him though? Could be some reddit troll out to rage bait. Did he give any proof of identity?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7su1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0u7su1","datetime":"2024-04-23 11:25:45"}
	{"user":"Calamity_B4_Storm","content":"He thought he is playing uno but it all turn out to be oh no people Jia sai he also Jia Sai meh.. now he really KNS","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u99sb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0u99sb","datetime":"2024-04-23 11:37:10"}
	{"user":"Ambitious-Kick6468","content":"We should have a law to charge people who speed up when others are overtaking.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uejf9","datetime":"2024-04-23 12:20:17"}
	{"user":"imivan111","content":"Give this cunt the death penalty","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo5w/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugo5w","datetime":"2024-04-23 12:38:00"}
	{"user":"snookajam","content":"All the comments on driving should come with an identifier on how long the commentor has been driving on sg roads. Reading too many ridiculous things on the issue from people who probably dont know about the intricacies of driving on sg roads, or that road in particular.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueo81/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-3,"subreddit":"singapore","type":"comment","id":"l0ueo81","datetime":"2024-04-23 12:21:24"}
	{"user":"ProfessionalMottsman","content":"This is so common and its so dangerous. Do people not know there doing it ?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub6wi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":47,"subreddit":"singapore","type":"comment","id":"l0ub6wi","datetime":"2024-04-23 11:52:31"}
	{"user":"DiscipleOfYeshua","content":"Also boarding bus. \n\nWhen the side-loader aunties and occasional uncle pretend to not notice we all queuing, I sometimes hold my hands up to the sunlight to check whether Ive turned to a transparent ghost.\n\nLess risk of injury and death. Similar mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh7b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0uh7b7","datetime":"2024-04-23 12:42:27"}
	{"user":"RecognitionIcy7396","content":"I have driven in many countries and my observation is that Singaporeans are quite nice in real life but are really selfish drivers. How is it logical for someone to think that speeding up is going to get someone else to slow down?\n\nAnd if someone wants to come into your lane, maybe just let them? This guy keeps saying he had an emergency to attend to but maybe he should have left earlier or prepared more in advance so that he doesnt have to use these dangerous tactics. His poor planning shouldnt put everyone elses lives in danger.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugndy/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":16,"subreddit":"singapore","type":"comment","id":"l0ugndy","datetime":"2024-04-23 12:37:50"}
	{"user":"Lv3_Potato_Farmer","content":"Just because everyone is doing it doesnt make it right","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawvv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0uawvv","datetime":"2024-04-23 11:50:14"}
	{"user":"Realistoliberato","content":"It's of waste of fuel. And fuel is bloody expensive in Singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uizax/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uizax","datetime":"2024-04-23 12:58:22"}
	{"user":"CriticizeSpectacle7","content":"This is the reason sg drivers don't signal. Once u signal, ppl will simply speed up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue2rg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0ue2rg","datetime":"2024-04-23 12:16:16"}
	{"user":"MessyBoomer","content":"I swear some drivers speed up when I approach a pedestrian crossing to try and go through before I start crossing too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj6nk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uj6nk","datetime":"2024-04-23 13:00:15"}
	{"user":"Diligent_Soup_1069","content":"Definitely,many a times I have signaled to exit out of the highway but motorbikes and cars on the slower lanes will just speed up past you suddenly as if you signaling is a sign that there's a GSS right up ahead. \n\nThe mercedes has nothing to do with the accident persay but I do feel TP should at least look into his reckless driving habits and ego issues on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk6k4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk6k4","datetime":"2024-04-23 13:09:38"}
	{"user":"MicTest_1212","content":"Now he admitted publicly in black and white that he did speed up to prevent the Saab from taking over. \n\n Stupid, Egoistic, and Narcissistic ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerc7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":135,"subreddit":"singapore","type":"comment","id":"l0uerc7","datetime":"2024-04-23 12:22:08"}
	{"user":"drinkingbobatea","content":"He had to.... bc he is trying his absolute hardest to be a genuinely nice person...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucbip/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":45,"subreddit":"singapore","type":"comment","id":"l0ucbip","datetime":"2024-04-23 12:01:39"}
	{"user":"transcendcosmos","content":"I think he had to cos his name was already doxxed in HWZ. Had a separate incident a few days before where he behaved terribly too.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufnzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ufnzd","datetime":"2024-04-23 12:29:57"}
	{"user":"Brief_Worldliness162","content":"Smh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufl9p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufl9p","datetime":"2024-04-23 12:29:19"}
	{"user":"Fensirulfr","content":"I agree. From the available videos, it is not exactly clear what was the white car's intention at first. He probably should have asked a lawyer to read through what he was about to post online.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulykc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulykc","datetime":"2024-04-23 13:27:08"}
	{"user":"uniquely_ad","content":"I was right all along, drive long enough and I know what the merc was doing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un92f/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un92f","datetime":"2024-04-23 13:40:27"}
	{"user":"fredczar","content":"Its likely fake? How sure are we that this is the actual driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj10r/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uj10r","datetime":"2024-04-23 12:58:47"}
	{"user":"dylank999","content":"Better to close your mouth and let people think you're stupid than open it and prove it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtay/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtay","datetime":"2024-04-23 13:06:07"}
	{"user":"beklog","content":"same logic as with my ex:\n\n\"I cheated on u so u can pay attention to me\" \\___/","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6owe/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":225,"subreddit":"singapore","type":"comment","id":"l0u6owe","datetime":"2024-04-23 11:17:12"}
	{"user":"icwiener25","content":"'Don't speed up if you see another vehicle trying to overtake you' is literally one of the first things that is taught in Basic Theory when taking one's license.\n\n  \nAuthorities should probably check whether he even has a valid drivers' license.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udsxf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":46,"subreddit":"singapore","type":"comment","id":"l0udsxf","datetime":"2024-04-23 12:13:55"}
	{"user":"Prov0st","content":"Typical mindset of some Singaporean drivers, overtaking/ signalling = I MUST SPEED UP!!!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9x86/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":52,"subreddit":"singapore","type":"comment","id":"l0u9x86","datetime":"2024-04-23 11:42:19"}
	{"user":"Jizzipient","content":"You see officer, I invited these young girls to my home to warn them about the dangers of what could have happened if you meet randos on the internet. It's educational!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahpl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0uahpl","datetime":"2024-04-23 11:46:52"}
	{"user":"Party-Ring445","content":"Cannot lose mentality..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucpiz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ucpiz","datetime":"2024-04-23 12:04:51"}
	{"user":"ihavenoidea90s","content":"This guy sucks at gaslighting as much as he does driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ualql/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ualql","datetime":"2024-04-23 11:47:45"}
	{"user":"Critwice","content":"he think he TP lmao, can't see through his big fat ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8622/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0u8622","datetime":"2024-04-23 11:28:35"}
	{"user":"kyrandia71","content":"Last time in driving school, the instructors teach you to slow down if someone is tailgating you and not speed up. Either slow down or just filter to left lane to let other vehicle overtake. Is like someone stare at you want to fight, instead of looking away or say sorry to de-escalate, one stares back and says, \"kua simi?\"","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaf6t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0uaf6t","datetime":"2024-04-23 11:46:17"}
	{"user":"Vedor","content":"Just goes to show how highly he thought of himself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucnwd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ucnwd","datetime":"2024-04-23 12:04:28"}
	{"user":"Pitiful_Blackberry67","content":"Exactly, What was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9ej5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0u9ej5","datetime":"2024-04-23 11:38:16"}
	{"user":"thewind21","content":"Driver thinks he is a vilgante. Upholding the traffic rules.\n\nEarn too much. Head too big","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueacq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ueacq","datetime":"2024-04-23 12:18:04"}
	{"user":"splash8388","content":"Correct. Why need to tell him to slow down by chasing him? Just let him (Saab driver) be.  He (saab) is responsible for his own action ultimately. Why get involved as if you can tell the Saab driver to slow down ?  Saab driver may think you are trying to race with him. \nIt's a double edge sword for the merc driver with this action.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicrs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uicrs","datetime":"2024-04-23 12:52:35"}
	{"user":"roksah","content":"I think need IQ test instead of driver test","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiykm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uiykm","datetime":"2024-04-23 12:58:11"}
	{"user":"RealityLongjumping13","content":"If you are reading this and is really your thought at that point of time, it's WRONG.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9vf3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0u9vf3","datetime":"2024-04-23 11:41:56"}
	{"user":"TOFU-area","content":"smartest sg driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud4ez/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ud4ez","datetime":"2024-04-23 12:08:17"}
	{"user":"MilkTeaRamen","content":"Breaking News: Singapores driver population halves overnight. Government to temporary scrap COE measures. CAT A cars below 50k.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udilq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":63,"subreddit":"singapore","type":"comment","id":"l0udilq","datetime":"2024-04-23 12:11:31"}
	{"user":"mako-lollipop","content":"First time drivers would have a higher BP when they drive though. Need to make driving license expire after 10 years so have to retake","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0uea8d","datetime":"2024-04-23 12:18:02"}
	{"user":"CisternOfADown","content":"It seems all the driving lessons go out the window once they get licence. Drivers need a 'refresher'. I suggest licences to be renewable every 2 years with a theory test at least. I'm sick of seeing drivers zooming past zebra crossings or not waiting for pedestrians to completely cross at traffic lights.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uljvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uljvo","datetime":"2024-04-23 13:23:03"}
	{"user":"Party-Ring445","content":"Brain is still in primary school","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udgx9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":59,"subreddit":"singapore","type":"comment","id":"l0udgx9","datetime":"2024-04-23 12:11:09"}
	{"user":"ilovenoodles06","content":"Guy is probably a rich kid i assume","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud5o1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ud5o1","datetime":"2024-04-23 12:08:35"}
	{"user":"Lostwhispers05","content":"Perhaps because he created a throwaway account and r/sgexams has less strict posting requirements? Just speculating - I don't actually know r/sgexam's posting requirements.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf3ll/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0uf3ll","datetime":"2024-04-23 12:25:04"}
	{"user":"captwaffles-cat","content":"Student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueq9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ueq9n","datetime":"2024-04-23 12:21:53"}
	{"user":"FalseAgent","content":"because this subreddit is awful so now there are splinter communities","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejgj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uejgj","datetime":"2024-04-23 12:20:18"}
	{"user":"canceler80","content":"Troll account and is fake?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um5fm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um5fm","datetime":"2024-04-23 13:29:03"}
	{"user":"drlqnr","content":"not enough karma to post here i think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umfvp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umfvp","datetime":"2024-04-23 13:31:59"}
	{"user":"KopiSiewSiewDai","content":"I dont think the Merc driver is at fault for the accident at the cross junction. He is just a shitty driver who happened to be at the wrong place. \n\nThe bulk of the fault is still on the Saab driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zv4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":82,"subreddit":"singapore","type":"comment","id":"l0u9zv4","datetime":"2024-04-23 11:42:53"}
	{"user":"Carbonaddictxd","content":"Precisely, why are all the comments blaming md just because he's not a nice driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9bfs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9bfs","datetime":"2024-04-23 11:37:33"}
	{"user":"whimsicism","content":"This, it really feels like deflection to me when people blame the merc driver. He's a bad driver and annoying af but he didn't actually cause the incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueie3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0ueie3","datetime":"2024-04-23 12:20:03"}
	{"user":"danorcs","content":"Unfortunately I think the Merc driver is partially responsible\n\nYou know exactly what the SBs defence attorney will say:\n\nyour honour, my client was travelling along the straight road and was changing lanes in the process of overtaking a motorbike when a white merc unexpectedly aggressively accelerated, sideswiping my clients car at high speed and nearly causing it to slide and mount the kerb \n\nThis was an accident that the merc driver could have prevented at anytime by not accelerating and allowing the SB to pass, despite his claims that he was potentially forced to mount a kerb\n\nMy client was shocked at being side swiped at high speed and in a lapse of judgement he panicked and accelerated away from the dangerous Merc driver\n\nMy client was so agitated by the aggressive Merc driver that he constantly kept checking for said driver on the rear wheel window, and most unfortunately failed to notice that he was reaching a red light, causing the tragic accident for which he is apologetically here today\n\nIf I provoke someone into a frenzied state and he accidentally kills someone in a fit of panic, I may still be culpable in SG. It would require detailed legal examination at the very least","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul678/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul678","datetime":"2024-04-23 13:19:15"}
	{"user":"Alive-Confection3690","content":"Idk i kinda disagree here. md didnt cause the accident but he definitely aggravated the sd driver partially to do it. Majority of the fault is still on the sd of course but if md could swallow that petty pride of being overtaken, this accident might not have happened.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf1ev/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uf1ev","datetime":"2024-04-23 12:24:31"}
	{"user":"Possible-Grocery6244","content":"i do think that the merc hold partial responsibility for the accident, or at least he was the catalyst for it. Assuming that SAAB was trying to do a hit and run after the sideswipe (not because of brake failure), merc not speeding up wouldnt have made SAAB driver to react the way he did. Now, im not saying that SAAB driver is absolved of any responsiblity, but the merc driver should be held accountable as well.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea2p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0uea2p","datetime":"2024-04-23 12:18:00"}
	{"user":"Party-Ring445","content":"Victim should sue him for all he's worth. And add to that criminal charge and canning","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud91d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ud91d","datetime":"2024-04-23 12:09:24"}
	{"user":"Geminispace","content":"As I mentioned in other Reddit post, these drivers will never admit their fault but the fault of everyone else. Probably the Saab driver out there blaming the vans and the car in front for turning despite green light","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiju3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uiju3","datetime":"2024-04-23 12:54:23"}
	{"user":"velvetstigma","content":">Im betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThis is most definitely what happened here. He didn't expect the merc to speed up and thus clipping the merc. Once there was a hit, he panicked and only looked at the rear mirror whole hoping to speed through the junction, not realizing there was traffic ahead.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukbp3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukbp3","datetime":"2024-04-23 13:11:02"}
	{"user":"tens919382","content":"nah.  definitely on drugs.  who the fk cuts in like that","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uijq3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uijq3","datetime":"2024-04-23 12:54:21"}
	{"user":"Prov0st","content":"He would get outright nuked if he posted in this thread.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9z20/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0u9z20","datetime":"2024-04-23 11:42:43"}
	{"user":"darrenoloGy","content":"Exactly, single lane hog simi, not like the motorcycle was crawling at 10-20km/h. lame excuse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unxm5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unxm5","datetime":"2024-04-23 13:47:42"}
	{"user":"rafalim021","content":"100% spot on.\n\nPeople are just jumping on the Merc driver because:\n\n1. Its an opportunity for people to whack the everyday assholes on SG roads that speed up to stop someone from overtaking\n\n2. Its a Merc - and a more powerful engine model at that.\n\n\nGuy is definitely no saint though and his latest posts are abit of a clownfest and indicative of his fragile ego.\n\nI just hope this doesn't divert attention away from the SAAB driver who deserves everything he gets and more.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujjc1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujjc1","datetime":"2024-04-23 13:03:32"}
	{"user":"Eseru","content":"That's the thing that really puzzles me. It's one thing if the junction was right after the bend and the Saab didn't have time to slow down. Or he was trying to beat the red light and the other cars had just started moving.  \n  \nBut the Saab had a lot of time and road to slow down after overtaking. It also looks like the light had already turned red. He just plowed straight into the traffic which was already moving across the junction without even attempting to brake? What the hell was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un3yx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un3yx","datetime":"2024-04-23 13:38:58"}
	{"user":"wwabbbitt","content":"He's not the cause but he's the trigger","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un02l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un02l","datetime":"2024-04-23 13:37:49"}
	{"user":"jlonso","content":">would have made no difference to the outcome.\n\nIt's really hard to measure the impact of benz's involvement in this.\n\nDoes SAAB have enough time and distance to stop at the junction? Yes. The reason for not stopping? Hit & Run?\n\nI wouldn't go as to say it made no difference to the outcome. The outcome could be different if that initial contact wasn't made.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un85x/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un85x","datetime":"2024-04-23 13:40:12"}
	{"user":"AdeptPlanktonk","content":"It's a trait of egomaniacs, narcissists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufpgn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ufpgn","datetime":"2024-04-23 12:30:18"}
	{"user":"tryingmydarnest","content":">address this culture.\n\nHow though? Enforcement will be an issue, unless we allow citizens to go bounty hunting.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukal6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukal6","datetime":"2024-04-23 13:10:44"}
	{"user":"jlonso","content":"Lawyer don't have to do shit. No way to verify account is his.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umcup/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umcup","datetime":"2024-04-23 13:31:10"}
	{"user":"NekoIdo","content":"Good point!\n\nu/SNH7Z good luck!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiii5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiii5","datetime":"2024-04-23 12:54:03"}
	{"user":"Eshuon","content":"Uni students too, but yeah thats why it was removed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubo25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ubo25","datetime":"2024-04-23 11:56:24"}
	{"user":"PhantomWolf83","content":"Don't forget about the BMWs.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh1yu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uh1yu","datetime":"2024-04-23 12:41:12"}
	{"user":"BearbearDarling","content":"> It would have happen with or without the Merc driver. \n\nYeah, we really don't know that. Yes, the saab was speeding to begin with. But to say a speeding driver will surely beat red light and cause a collision down the road is pure speculation. There are speeding vehicles on the road everyday who don't get into accidents. Moreover, the saab displayed some control by maneuvering and switching lanes trying to overtake. He didn't just crash into the rear of the merc. He didn't barrel over the motorbike. That shows some control on his part even if he was driving dangerously. Versus his conduct at the cross junction where he just plows straight through like a bullet. There is some contrast in his behavior.\n\nThe merc provoking the ssab by speeding up to in attempt to block the overtaking and the saab clipping the merc are not insignificant events. It's possible that they had an effect on the saab driver's state of mind. He could have become blinded with rage and tried to floor it to hit and run. Even so, I think that the merc cannot be legally liable for the collisions at the junction. But you can't tell me the merc is completely uninvolved as if he was a mere bystander. And the worst thing is two lives are lost. One cannot help but wonder if the merc had simply let the saab go on its way, perhaps what happened at the junction might have been different.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uny28/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uny28","datetime":"2024-04-23 13:47:50"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorqc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorqc","datetime":"2024-04-23 13:56:41"}
	{"user":"MyNameIsOnce","content":"no info to dig for the saab driver. the most i personally found about the saab is a sgcarmart ad of the car before it was sold and it might not be the same car (but the colour and rims match + its a very rare car model, so it would be too much to be a coincidence)\n\ni wonder if there are any previous dashcam vids of the saab (SLD1505R) around.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucygd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ucygd","datetime":"2024-04-23 12:06:55"}
	{"user":"wirexyz","content":"I dont understand also. SAAB speed and beat red light and killed 2. But somehow Benz is at fault because he never give way to the SAAB that is speeding like crazy.\n\nSo next time I see someone breaking the law I need to give way to them instead of preventing from committing a crime? I am glad there is court with fairness here cause I think public opinion is a bit wrong.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udc6h/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0udc6h","datetime":"2024-04-23 12:10:08"}
	{"user":"musicmonkay","content":"Did he really contribute tho? \n\nShitty driver that I will curse in my heart if I met on the road yes \n\nBut he didnt force the Saab to speed, or do anything \n\nIf anything he was also sideswiped in the video right? Unless I saw wrongly which in any situation even though he did a dick move by speeding up, would be the merging driver (Saab)s fault\n\nIt is 100% in the Saab drivers control whether to speed or drive recklessly, as much as a bad driver the merc was, he/she wasnt even near the Saab when the accident happened","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc4gl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uc4gl","datetime":"2024-04-23 12:00:05"}
	{"user":"Haunting-Owl","content":"methinks too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhyfc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhyfc","datetime":"2024-04-23 12:49:01"}
	{"user":"KopiSiewSiewDai","content":"He cannot post anywhere else I think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua1k5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua1k5","datetime":"2024-04-23 11:43:16"}
	{"user":"haaaaaairy1","content":"Probably cause one of the victims was a student so trying to pander to that demographic.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua9xj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ua9xj","datetime":"2024-04-23 11:45:06"}
	{"user":"A_extra","content":"Because one of the victims killed was a jc student","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadca/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uadca","datetime":"2024-04-23 11:45:52"}
	{"user":"Sacred-Turnip","content":"Because people are also sick and tired of such driving behaviour like the merc driver practice. Apparently, he was also caught on camera on another occasion driving aggressively, likely proving his bad actions are not limited to that incident. In addition, people are also not buying his reply in trying to make himself sound like a saint.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub0lj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ub0lj","datetime":"2024-04-23 11:51:04"}
	{"user":"Alive_Ad7522","content":"Ppl are slamming him not for causing the eventual crash.  It is his driving posture and attitude that is undesirable.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u991l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u991l","datetime":"2024-04-23 11:37:00"}
	{"user":"lurkinglurkerwholurk","content":"Wrong place at the wrong time syndrome. That, and apparently theres plenty of evidence his default driving is a dick, AND him also tries to taichi his (tiny) contribution to the Saab drivers crash, a perceived running away from responsibility in an emotionally charged moment = a wild acceptable target appears. \n\nThrowing fuel into the fire, basically. He totally isnt the cause of that fire, but","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uffx3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uffx3","datetime":"2024-04-23 12:28:02"}
	{"user":"areunut1","content":"You can blame both at once. They are not mutually exclusive \n\n\nblame Saab driver for causing incident + blame Merc for driving like an idiot","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiex4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uiex4","datetime":"2024-04-23 12:53:07"}
	{"user":"Upper-Discount5109","content":"People always want someone to blame, always want to feel heard in the mob.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub523/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ub523","datetime":"2024-04-23 11:52:06"}
	{"user":"Spiritual-Okra-7836","content":"if this idiot had let him overtake none of this might have happened either. So he is also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahgt/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0uahgt","datetime":"2024-04-23 11:46:49"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue6a9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue6a9","datetime":"2024-04-23 12:17:06"}
	{"user":"NekoIdo","content":"Hence the word alleged in the title","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8f6n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u8f6n","datetime":"2024-04-23 11:30:35"}
	{"user":"GrammarNaziii","content":"This was my first reaction as well. Literally *anyone* could've created the account and wrote this shit up, but it seems like everyone here is just taking it at face value.\n\nWhat if it was the motorcycle driver who created this spiel to make the guy look even worse? Crazy sia.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufp25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ufp25","datetime":"2024-04-23 12:30:13"}
	{"user":"ailes_d","content":"They know, they still dont want to let other people cut them","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufv18/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":29,"subreddit":"singapore","type":"comment","id":"l0ufv18","datetime":"2024-04-23 12:31:38"}
	{"user":"hawk_199","content":"Basic logic but not many people have it and not taught in driving school tbh...At least I don't recall.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhwf0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhwf0","datetime":"2024-04-23 12:48:31"}
	{"user":"ivananiki","content":"But... he said he was a safe driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulfse/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulfse","datetime":"2024-04-23 13:21:54"}
	{"user":"Organic-Custard6243","content":"For some reason it is quite prevalent among Singaporean driver. When I drive overseas I find that they are more willing to give way. \n\nPerhaps, better legislation can help control this behaviour?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unc75/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unc75","datetime":"2024-04-23 13:41:22"}
	{"user":"Common-Metal8578","content":"There is no logic. The asshole is trying to rationalise his guilt and hope people agree with him. Even when you watch this guys own camera footage. He maintains the same distance from the motorcycle until the black car comes beside him. Suddenly he catches up with the motorcycle very quickly. Suddenly have an emergency? At that very moment? Anyway This kind of memory will eat him from the inside for the rest of his life and we don't need to help him with it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhknu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0uhknu","datetime":"2024-04-23 12:45:40"}
	{"user":"InfiniteDividends","content":"That's a poor reason to not signal, I still do. If the car behind speeds up, sure, I'll just lane change after you pass then. Life is too short to rage over idiots like that.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj97g/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":36,"subreddit":"singapore","type":"comment","id":"l0uj97g","datetime":"2024-04-23 13:00:55"}
	{"user":"abgnerd","content":"I think this kind of logic is something we need to eradicate. I don't do XXX cos of YYY, when XXX is the correct thing to do.\n\nSignal your intentions. \n\nIf the other person speeds up to block you then they are the ass, you just wait for the next opportunity to switch lanes.\n\n\"I don't signal cos other drivers will speed up and block.\" \n\nThese are the same drivers who will speed up and block people who signal intentions. These are the drivers that never signal and cut into lanes.\n\nDownvote me if you feel slightly targeted by this post, but I think some people on Reddit are guilty of bad road manners and it shows.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulogn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulogn","datetime":"2024-04-23 13:24:18"}
	{"user":"splash8388","content":"Not really for me. I signal ahead as a form of respect to pre-alert that I intend to change lane. I will only change lane when no vehicles are very near my vehicle. This also deter motorcyclist who might speed up to squeeze between 2 cars  I do not think I am rude after I force my way into my desired lane once I give ample time. The reason is I already give ample notice my intention to change. U cannot blame me after that just because you don't like to give way. Ha ha.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujg5u/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujg5u","datetime":"2024-04-23 13:02:42"}
	{"user":"MojaMonkey","content":"The only thing the driver is signalling is weakness.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueg0t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ueg0t","datetime":"2024-04-23 12:19:27"}
	{"user":"Fluffy-Nature-2087","content":"If they speed up when I signal, I will use my brains to overtake the car behind them and drive behind that fella who sped up. Then when that fella slip up on the road while infront of me, I would have it on dashcam and then later file a police report against them with it just to ruin their day or at least to let the police have a record of them slipping up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6m2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6m2","datetime":"2024-04-23 14:01:13"}
	{"user":"szab999","content":"yeah probably his lawyer told him to take it down.. but the internet never forgets","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufa4j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ufa4j","datetime":"2024-04-23 12:26:40"}
	{"user":"Twrd4321","content":"Unless it is possible to verify the person who wrote the post as the person who drove the car, it cannot be administered as evidence. \n\nAnyone can claim to be anyone on Reddit. Thats why usually for ask me anything, mods usually ask for proof. It is not good enough for someone to claim in the post they drove the car.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulawo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulawo","datetime":"2024-04-23 13:20:33"}
	{"user":"pureeyes","content":"Genuinely nice people would give way to others or at least be remorseful over their part in an accident that's killed two people ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucmtv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0ucmtv","datetime":"2024-04-23 12:04:14"}
	{"user":"HungryEdward","content":"I went to see after reading your comment. Seems he doxxed himself by using his own Facebook account to post his dashcam footage.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2s2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh2s2","datetime":"2024-04-23 12:41:23"}
	{"user":"PhantomWolf83","content":"It's been almost 20 years since I got my licence but I'm sure as hell they didn't teach that kind of defensive driving at BBDC...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u75n0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":87,"subreddit":"singapore","type":"comment","id":"l0u75n0","datetime":"2024-04-23 11:20:49"}
	{"user":"kumgongkia","content":"I will declare war on everyone to achieve world peace.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujnpr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujnpr","datetime":"2024-04-23 13:04:41"}
	{"user":"may0_sandwich","content":"Lol, 90% of drivers behave this way, are you suggesting all of them may not have a drivers license?? I think the real issue here is the shitty attitude that's been normalised in Singapore.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhiu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhiu9","datetime":"2024-04-23 12:45:12"}
	{"user":"erisestarrs","content":"I signal when I want to change lane not to get people to give way to me, but so the car will speed up and I can change into the lane BEHIND them.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui4r2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0ui4r2","datetime":"2024-04-23 12:50:36"}
	{"user":"Ok-Recommendation925","content":"His gaslighting won't work, especially when two people are dead....\n\nIn fact those two deaths make this clown look and sound like the devil (and an ass-clown-hole)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue7co/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ue7co","datetime":"2024-04-23 12:17:22"}
	{"user":"thewackykid","content":"yeah... to tell someone to slow down u should slow down yourself (NOT speed up).. if he don't listen and speed up then is not your fault... but at least he would have overtaken u safely and that will be the end of it...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubw58/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubw58","datetime":"2024-04-23 11:58:11"}
	{"user":"Noobcakes19","content":"he's Bruised Wean.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk3us/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk3us","datetime":"2024-04-23 13:08:54"}
	{"user":"Anphant","content":"Nah, behavioural test is more important. Stupid people can always be taught. Not so much for self-centred/obnoxious ones","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl96/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl96","datetime":"2024-04-23 13:44:03"}
	{"user":"Jay-ay","content":"Subscribed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8m9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0ug8m9","datetime":"2024-04-23 12:34:43"}
	{"user":"XLStress","content":"Fuck yeah.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uocg7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uocg7","datetime":"2024-04-23 13:52:06"}
	{"user":"I_Miss_Every_Shot","content":"Maybe need to retake and reassess after every 5-10 years. Check for bad habits","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufdye/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufdye","datetime":"2024-04-23 12:27:34"}
	{"user":"Brief_Worldliness162","content":"I thought he's 42 years old?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufttb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufttb","datetime":"2024-04-23 12:31:21"}
	{"user":"Stormagedd0nDarkLord","content":"Bulk? I'd say all of the fault is on the Saab driver for the accident. You can't be held responsible for someone doing a hit and run on you and zooming off. It's not like md floored it to chase after him. I think he reached the lights same time as the motobike.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udzcv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0udzcv","datetime":"2024-04-23 12:15:28"}
	{"user":"ssepaulette","content":"You guys should watch the video again. 5-6s mark frame by frame. Black car was already about to complete the overtaking and white car sped up. \n\nThis is different from asshole driver inching forward to prevent people from cutting which I believe is what you are talking about.\n\nPortion of the black car has already crossed the divider and white car sped up hitting black car in the center. Any further in the rear and black car could have spun out of control and may have killed the motorcyclist.\nThis is reckless driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue822/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ue822","datetime":"2024-04-23 12:17:32"}
	{"user":"Ok-Recommendation925","content":"Basically MD is the guy that was on his way to join a riot. But because he was late to the rally point, and the rioting was started by SD happening (with public opinion against the rioters), he simply joined the onlooker crowds and joined them in being \"kaypoh/what-happened?\"\n\nLOL","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uerf9","datetime":"2024-04-23 12:22:09"}
	{"user":"Background_Tax_1985","content":"Yeap agreed.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0uadu9","datetime":"2024-04-23 11:45:59"}
	{"user":"Background_Tax_1985","content":"Probably easier to blame him since he identified himself plus he was acting like a dick and i guess merc? \n\nI think once they announce who sd is everyone will be having a field day with him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zkz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9zkz","datetime":"2024-04-23 11:42:50"}
	{"user":"soulless33","content":"yeah same thing I told my friends.. the merc drive is an ass but he did not cause the accident..\n\nit's like everyone trying to explain why the driver plough thru the traffic and the merc driver is a scapegoat..\n\nend of the day its a terrible tragedy let us not assign blame, instead keep our prayers to those still in hospital..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaidk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uaidk","datetime":"2024-04-23 11:47:01"}
	{"user":"Background_Tax_1985","content":"Bro if im the dpp ah:\n\n1) your client is already speeding before he tried to overtake the white merc.\n\n2) why does your client need to overtake the 2 other vehicles at such high speed? That is not normal behaviour.\n\n3) a normal individual would have immediately stopped after the accident to check for damage, exchange info etc, not continue speeding\n\n4) it near impossible for a person to be that provoked in such a short span of time (say from bruce banner to hulk in 3s~5s)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up1d3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up1d3","datetime":"2024-04-23 13:59:38"}
	{"user":"Background_Tax_1985","content":"Nah. Sd was already speeding prior to the sideswipe and driving too aggresively, so it can't really be said that md aggravated him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufbjx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ufbjx","datetime":"2024-04-23 12:27:00"}
	{"user":"Background_Tax_1985","content":"I disagree. Sd was already speeding before the side swipe and carried on speeding after. Md's action is unrelated to the accident, even if is at fault for his behaviour.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf45d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uf45d","datetime":"2024-04-23 12:25:12"}
	{"user":"Vedor","content":"Such people confirm will just delete his account if he ever get nukes.\n\n\nIn the very first place, do you think he will post such thread if his licence plate wasn't made known to everyone?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucuaq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ucuaq","datetime":"2024-04-23 12:05:58"}
	{"user":"KneeGal","content":"I disagree. He is an asshole driver for sure but he is not the trigger because the SAAB was already speeding before the Merc noticed him (and started speeding up). Unless he has pre-cog, there is no reason for him to be going so fast in the first place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up2b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up2b7","datetime":"2024-04-23 13:59:55"}
	{"user":"KneeGal","content":"He was already speeding before he came into contact with the Merc. \n\nHe was still speeding after he came into contact.\n\nWhy do you think the outcome would have been different? It would be one thing if he was not speeding before and then sped after or vice versa. But he was constantly speeding.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uokul/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uokul","datetime":"2024-04-23 13:54:37"}
	{"user":"dibidi","content":"see how UK updated the highway code to include the hierarchy of road users requiring all road users to defer to the most vulnerable road users at all times. \n\nwith that rule in place any accident that happens the responsibility is automatically on the road user in the larger vehicle. insurance liability means de facto compliance. \n\nnow most everyone in the UK gives way.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklbw/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklbw","datetime":"2024-04-23 13:13:36"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorr4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorr4","datetime":"2024-04-23 13:56:41"}
	{"user":"Possible-Grocery6244","content":"because there is reasoning behind the speeding and the merc driver caused it. No one is saying SAAB is not at fault, but the merc driver definitely should share some responsibility because he was the one who sped up and induced the situation for the SAAB to sideswipe the merc, and in turn the SAAB driver panicked and wanted to hit and run hence speeding up after the sideswipe (assuming there is no brake failure). If the merc driver did not speed up, the subsequent chain of events wouldnt have occured","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf975/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf975","datetime":"2024-04-23 12:26:27"}
	{"user":"RiskDry6267","content":"Benz is being scolded for being an ego idiot.\nIf give way 100% no accident. Even though SAAB is probably 90% at fault.\nThe news story could have easily been the SAAB buah the Mercedes then crash him and both cars burning on the side of the road, and merc driver died, then what will we all say online? Asking for it right ? \nGive way from the start none of this shit will happen. Motorcycle bro in front also thank his lucky stars he wasnt collateral damage","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uieem/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uieem","datetime":"2024-04-23 12:52:59"}
	{"user":"smurflings","content":"Seeing, just in the replies to my post at least one blaming him for causing this eventually crash.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2zo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc2zo","datetime":"2024-04-23 11:59:45"}
	{"user":"Upper-Discount5109","content":"Multiple choices for saab driver after not being allowed to overtake. He could've waited, could've slowed down and overtake later, but he chose to chiong which eventually caused the accident. White merc = inconsiderate at most, didn't cause the accident. Saab driver = His decision, his consequences","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdyp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ubdyp","datetime":"2024-04-23 11:54:06"}
	{"user":"smurflings","content":"And if you had walked a different direction that day, none of this might have happened either! So you're also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubxw8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0ubxw8","datetime":"2024-04-23 11:58:35"}
	{"user":"crispyprata","content":"Ok?  if Temasek JC didnt organize an event at bedok reservoir the student would still be alive so TJC is also partly to blame /s","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uivg6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uivg6","datetime":"2024-04-23 12:57:22"}
	{"user":"meowinbox","content":"Bro, you and I both know that word doesn't make that much of a difference. \n\n\nI'm sure *you* are aware that he could just be trolling, I'm not singling *you* out in particular. My comment was also directed at the others already dragging him as though he's really going to be here reading these comments.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9i1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-21,"subreddit":"singapore","type":"comment","id":"l0u9i1q","datetime":"2024-04-23 11:39:00"}
	{"user":"alexand3rl","content":"It's taught in driving school. BTT literally has the question where if someone is trying to overtake you, you should slow down and assist the motorist to help overtake you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6zn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6zn","datetime":"2024-04-23 14:01:19"}
	{"user":"zchew","content":"Yes, he teach others how to drive safely by speeding up to block them. Very safety. Huehuehuehue","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl7s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl7s","datetime":"2024-04-23 13:44:03"}
	{"user":"theony","content":"> The asshole is trying to rationalise his guilt \n\nHe feels no guilt, he thinks he's a tragic hero who failed to achieve his goals even though his actions were heroic. That's why he posted his own video up, and made multiple reddit posts justifying his actions. \n\nThis kind will never, ever learn. The only thing he will take away from being slammed on the internet will be \"internet is stupid\". If the police catch him and charge him, the only thing he will take away is \"police are lazy and will only wayang in high profile cases to show off\".","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukchn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukchn","datetime":"2024-04-23 13:11:15"}
	{"user":"taeng89","content":"Upvoted. Completely agree with this","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo965/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo965","datetime":"2024-04-23 13:51:08"}
	{"user":"Critwice","content":"he wanted to post here but not enough karma/age? r/sgexams mods deleted because irrelevant.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufsvh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0ufsvh","datetime":"2024-04-23 12:31:07"}
	{"user":"timlim029","content":"Yeah. I'm surprised nobody is even questioning if the driver really wrote the post. I mean, it was posted on /r/SGExams. Could easily be a bored student.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyv5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyv5","datetime":"2024-04-23 13:58:52"}
	{"user":"MilkTeaRamen","content":"Bro this is call offensive driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud8xg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":61,"subreddit":"singapore","type":"comment","id":"l0ud8xg","datetime":"2024-04-23 12:09:22"}
	{"user":"Prov0st","content":"Bro, thats a genius cheat code.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uit3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uit3i","datetime":"2024-04-23 12:56:45"}
	{"user":"Jackker","content":"Yeah, this is the way. If they slow down and an opportunity is there to change lane, do it.\n\nIf they speed up, wait for as long as necessary until the opportunity is there. Then change lane,  it really is that simple. ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unsy8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unsy8","datetime":"2024-04-23 13:46:19"}
	{"user":"foxbat2525","content":"Never too old to be a student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujyi4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujyi4","datetime":"2024-04-23 13:07:29"}
	{"user":"_WonderStruck_17","content":"Agreed, the Saab driver being a complete siaokia had no bearing on the Merc driver. Merc driver was a bully too but it was two separate incidents.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwmx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":33,"subreddit":"singapore","type":"comment","id":"l0ufwmx","datetime":"2024-04-23 12:32:01"}
	{"user":"ailes_d","content":"Yeah the fault is totally on the saab driver because we all know hes speeding from very far away already. But in this case, the video not only provided evidence of saab driving recklessly, but also showcased the white merc cb mentality which lots of sg drivers have","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugdjz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ugdjz","datetime":"2024-04-23 12:35:44"}
	{"user":"ABootSG","content":"Tbh looking at these two incidents separately, I'd say the merce is reckless, saab on drugs.\n\nBut the saab driver was clearly on some shit already because he didn't stop despite colliding with the merce. As for the merce not stopping after their collision it's probably because he saw the saab trying to hit and run so he kept up with him.\n\nAlso at the junction from the perpendicular POV of another car, it didnt look like the saab was braking at all when he was on the junction.\n\nI think we should wait for the toxicology report on the saab driver. Probably on some serious amps.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf5wf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uf5wf","datetime":"2024-04-23 12:25:38"}
	{"user":"deathzz123","content":"TIL overtaking car can just chiong into lane no need check mirror or blind spot, if other driver dont yield they are reckless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukqtq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukqtq","datetime":"2024-04-23 13:15:03"}
	{"user":"infernoKings","content":"Exactly. Reckless driving by the SAAB driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umdro/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umdro","datetime":"2024-04-23 13:31:25"}
	{"user":"Possible-Grocery6244","content":"yes he was already speeding but precisely because of the sideswipe SAAB driver reacted the way he did. Or are you assuming that the incident would have occur either way without the sideswipe incident? im inclined to believe that this is a cause-and-effect situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwxr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ufwxr","datetime":"2024-04-23 12:32:06"}
	{"user":"tryingmydarnest","content":"TIL. Thanks for sharing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukq89/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukq89","datetime":"2024-04-23 13:14:53"}
	{"user":"Emotional_Apricot591","content":"He literally made a bad situation worse, so yes he is to blame as well","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udula/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0udula","datetime":"2024-04-23 12:14:19"}
	{"user":"Vedor","content":"Please tell that to journalists when they use the word \"alleged\" in their article.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf43e/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf43e","datetime":"2024-04-23 12:25:11"}
	{"user":"NekoIdo","content":"Buddy, all these stuff is already out there, people are going to find it with or without me. Im not making new shit up, Im just reiterating whats been said already. \n\nYou wanna defend this guy so bad knock yourself out man. But whats it got to do with you being unable to take the word alleged at face value?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua2tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua2tv","datetime":"2024-04-23 11:43:32"}
	{"user":"Jjzeng","content":"I was certainly offended by their driving","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh6g8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh6g8","datetime":"2024-04-23 12:42:14"}
	{"user":"hehetypo","content":"no this one is sinkie pwn sinkie driving end up pwn ownself so can sleep soundly at night","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul3w7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul3w7","datetime":"2024-04-23 13:18:37"}
	{"user":"Stormagedd0nDarkLord","content":"Exactly. I really dunno why md is getting this level of hate and blame for this. It's illogical.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8vb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ug8vb","datetime":"2024-04-23 12:34:46"}
	{"user":"Additional-Ad-1644","content":"Life doesnt have to be black and white, you know..\n\nWait till you are trying to overtake a lane hogger who somehow decides to speed up when you are passing him. Doesnt matter if hes right or wrong or legal or illegal. Still an asshole driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyq2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyq2","datetime":"2024-04-23 13:58:49"}
	{"user":"Background_Tax_1985","content":"I believe it would have still occured without the sideswipe incident. \n\nThe sideswipe incident took place pretty far away from the junction and he had the option of also making a left turn (zebra crossing), a right turn (traffic light) to get away from the merc if that was the intention. Infact, i would even warrant to say that going left would have been much better route to \"escape\".\n\nClearly sb was not really bothered by the sideswipe, if at all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhd3z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uhd3z","datetime":"2024-04-23 12:43:49"}
	{"user":"kumgongkia","content":"Are u the Saab driver? How would u know how that guy thinks? After kena sideswiped the knee jerk reaction is to accelerate all the way? Huh?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukfhh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukfhh","datetime":"2024-04-23 13:12:03"}
	{"user":"meowinbox","content":"I'm not defending the *driver*. Which part of what I said defended him? \n\n\nWhat I meant was, that post could have been written by some troll at home, and these netizens are wasting their energy giving this redditor all the rage and attention he wants, while the actual driver is somewhere else in his own world.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubf3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-10,"subreddit":"singapore","type":"comment","id":"l0ubf3i","datetime":"2024-04-23 11:54:22"}
	{"user":"_WonderStruck_17","content":"To be fair that instance does exemplify the typical kiasi behaviour that most of our SG drivers have, not wanting to give way to others which infuriates the motoring community a lot. That clip of the Merc driver committing a full corner like as though he's racing for their F1 team to overtake a motorbike on a expressway exit is one example.\n\nBut of course this tragic incident shouldn't be attributed to him. Hopefully this is a hard lesson for all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uinzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uinzd","datetime":"2024-04-23 12:55:25"}
	{"user":"deathzz123","content":"I agree with you no black and white and yes he is an asshole driver but if I overtake someone who speeds back up I will go back to my lane. At most miss exit go 1 round lo","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up7dj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up7dj","datetime":"2024-04-23 14:01:27"}
	{"user":"Possible-Grocery6244","content":"Him ramming through the traffic junction clearly shows that he is incapable of grasping the situation and brake accordingly when its a red light. But he took maneuvers to try to cut the behind cam car + merc driver and evade the motorcycle right before the sideswipe occurs. Isnt this just more evidence that his state of mind was different before and after the sideswipe, and that the sideswipe is the catalyst for this particular instance. My argument is he would have just rammed into the motorcycle or into the back of the merc without trying to cut both of them if his state of mind was the same before and after the sideswipe","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujbfx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0ujbfx","datetime":"2024-04-23 13:01:29"}
	{"user":"Possible-Grocery6244","content":"i did not say the knee jeck reaction is to accelerate all the way. Im merely stating what is observed from the video that the SAAB driver indeed accelerated all the way after the sideswipe and assumption is he was under the influenced and the sideswipe triggered a hit and run scenario","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulrqz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulrqz","datetime":"2024-04-23 13:25:14"}
	{"user":"NekoIdo","content":"Youre absolutely right, it could be him, could not be him.\n\nIts a public forum though so good luck gate keeping all the content here. Have fun!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc1bx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc1bx","datetime":"2024-04-23 11:59:22"}
	{"user":"TimidHuman","content":"Justify so much but you also feeding the troll (if it was truly one). Same same la","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uck2s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uck2s","datetime":"2024-04-23 12:03:36"}
	{"user":"happycanliao","content":"You can tell his state of mind just from that? Are you a psychiatrist?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk42j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk42j","datetime":"2024-04-23 13:08:58"}
	{"user":"Background_Tax_1985","content":"I can't really buy into your arguement. \n\nMy hypotesis is that if he was not intoxicated by drugs or alcohol, then he was trying to speed to somewhere (god knows where). \n\nThis is seen from the good control over the vehicle, even up to the accident. The vehicle barely wobbled, swerve around (except when overtaking, even after overtaking he was going as straight as an arrow) etc. Only issue is that sb was going way too fast. \n\nAnd in essence, there is no difference in his state of mind before or after. At least not so much that it would have caused the accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo6te/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo6te","datetime":"2024-04-23 13:50:25"}
	{"user":"Possible-Grocery6244","content":"isnt it clear the difference between the state of mind of the driver if 1. you are trying to avoid the vehicles infront of you by maneuvering the car and 2. you just straight plow through a red light junction? I dont think you need to be a psych to reach this conclusion","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uknwf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uknwf","datetime":"2024-04-23 13:14:16"}
	{"user":"happycanliao","content":"I don't think it's a state of mind issue? There could be other issues such as being distracted or the car may have been damaged by the accident causing loss of control (not likely but who knows).","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um9zs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um9zs","datetime":"2024-04-23 13:30:20"}
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402/spark_reddit_preprocessing.py", line 100, in <module>
	    .save()
	     ^^^^^^
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/pyspark.zip/pyspark/sql/readwriter.py", line 1461, in save
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1322, in __call__
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/pyspark.zip/pyspark/errors/exceptions/captured.py", line 179, in deco
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/py4j-0.10.9.7-src.zip/py4j/protocol.py", line 326, in get_return_value
	py4j.protocol.Py4JJavaError: An error occurred while calling o110.save.
	: java.lang.NoClassDefFoundError: org/apache/kafka/common/serialization/ByteArraySerializer
		at org.apache.spark.sql.kafka010.KafkaSourceProvider$.<clinit>(KafkaSourceProvider.scala:601)
		at org.apache.spark.sql.kafka010.KafkaSourceProvider.createRelation(KafkaSourceProvider.scala:180)
		at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:48)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
		at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
		at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
		at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
		at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
		at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
		at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
		at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)
		at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)
		at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)
		at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:248)
		at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
		at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
		at py4j.Gateway.invoke(Gateway.java:282)
		at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
		at py4j.commands.CallCommand.execute(CallCommand.java:79)
		at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
		at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
		at java.lang.Thread.run(Thread.java:750)
	Caused by: java.lang.ClassNotFoundException: org.apache.kafka.common.serialization.ByteArraySerializer
		at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
		... 43 more
	
	24/04/24 10:35:37 INFO SparkContext: Invoking stop() from shutdown hook
	24/04/24 10:35:37 INFO SparkContext: SparkContext is stopping with exitCode 0.
	24/04/24 10:35:37 INFO SparkUI: Stopped Spark web UI at http://6b0330d1bc18:4040
	24/04/24 10:35:37 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
	24/04/24 10:35:37 INFO MemoryStore: MemoryStore cleared
	24/04/24 10:35:37 INFO BlockManager: BlockManager stopped
	24/04/24 10:35:37 INFO BlockManagerMaster: BlockManagerMaster stopped
	24/04/24 10:35:37 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
	24/04/24 10:35:37 INFO SparkContext: Successfully stopped SparkContext
	24/04/24 10:35:37 INFO ShutdownHookManager: Shutdown hook called
	24/04/24 10:35:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f
	24/04/24 10:35:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-2b849349-4d0f-4b7e-ba06-ccc4d75eb41f/pyspark-019c7841-2f45-4632-a4b9-251fc0382ea4
	24/04/24 10:35:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-8bd64b71-1a4d-4327-9562-3f0669c4f98c
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.955 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402, processId:237 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.964 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_100/567/1402
[WI-567][TI-1402] - [INFO] 2024-04-24 10:35:37.964 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1402] - [INFO] 2024-04-24 10:35:38.666 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1402, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:41:12.206 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.768361581920904 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:12.463 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7009063444108761 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.585 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1403, taskName=search for intake JSON files, firstSubmitTime=1713926541546, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=101, appIds=null, processInstanceId=568, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1403'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104221'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='568'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.587 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.599 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.599 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926541599
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 568_1403
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.600 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1403,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713926541546,
  "startTime" : 1713926541599,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1403.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 101,
  "processInstanceId" : 568,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1403"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104221"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "568"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "568_1403",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.613 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.614 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.615 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403 check successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.615 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.616 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.633 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.636 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.637 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.637 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.637 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.638 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.638 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.639 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.640 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.640 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.640 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.640 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403/568_1403.sh
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:21.650 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 468
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:21.651 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1403] - [INFO] 2024-04-24 10:42:21.814 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1403, success=true)
[WI-0][TI-1403] - [INFO] 2024-04-24 10:42:21.826 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1403)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:22.652 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.653 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403, processId:468 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.659 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.685 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.685 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.685 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1403
[WI-568][TI-1403] - [INFO] 2024-04-24 10:42:22.688 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1403] - [INFO] 2024-04-24 10:42:22.814 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1403, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:23.941 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1405, taskName=move to processing, firstSubmitTime=1713926543928, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=101, appIds=null, processInstanceId=568, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1405'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104223'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='568'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.942 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.943 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.946 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.947 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.947 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926543947
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 568_1405
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1405,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713926543928,
  "startTime" : 1713926543947,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1405.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 101,
  "processInstanceId" : 568,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1405"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104223"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "568"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "568_1405",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.966 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.967 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.967 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405 check successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.972 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.972 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.972 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.973 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.974 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.974 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.974 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.974 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.975 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405/568_1405.sh
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:23.979 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 482
[WI-0][TI-1405] - [INFO] 2024-04-24 10:42:24.843 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1405, success=true)
[WI-0][TI-1405] - [INFO] 2024-04-24 10:42:24.850 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1405)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:24.982 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.984 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405, processId:482 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.984 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.985 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.985 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1405
[WI-568][TI-1405] - [INFO] 2024-04-24 10:42:24.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1405] - [INFO] 2024-04-24 10:42:25.819 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1405, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:25.956 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1406, taskName=spark preprocessing, firstSubmitTime=1713926545946, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=101, appIds=null, processInstanceId=568, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1406'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104225'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='568'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.958 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.959 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.966 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926545967
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 568_1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1406,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926545946,
  "startTime" : 1713926545967,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 101,
  "processInstanceId" : 568,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1406"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104225"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "568"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "568_1406",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.974 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.975 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406 check successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406/spark_reddit_preprocessing.py)})
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.995 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.997 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.997 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:25.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.008 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.009 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.009 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \
    spark_reddit_preprocessing.py

[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.009 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.009 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406/568_1406.sh
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:26.014 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 494
[WI-0][TI-1406] - [INFO] 2024-04-24 10:42:26.829 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1406, success=true)
[WI-0][TI-1406] - [INFO] 2024-04-24 10:42:26.840 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1406)
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:27.015 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:42:28.017 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Exception in thread "main" java.lang.IllegalArgumentException: requirement failed: Provided Maven Coordinates must be in the form 'groupId:artifactId:version'. The coordinate provided is: --packages
		at scala.Predef$.require(Predef.scala:337)
		at org.apache.spark.deploy.SparkSubmitUtils$.$anonfun$extractMavenCoordinates$1(SparkSubmit.scala:1221)
		at scala.collection.ArrayOps$.map$extension(ArrayOps.scala:929)
		at org.apache.spark.deploy.SparkSubmitUtils$.extractMavenCoordinates(SparkSubmit.scala:1219)
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1541)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.019 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, processId:494 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.019 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.020 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.021 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.022 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.040 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.041 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.041 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:42:28.044 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1406] - [INFO] 2024-04-24 10:42:28.823 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1406, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:43:57.515 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7385057471264368 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:11.695 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1406, taskName=spark preprocessing, firstSubmitTime=1713926545946, startTime=1713926545967, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=101, appIds=null, processInstanceId=568, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=12, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=null, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1406'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104411'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.task.execute.path=Property{prop='system.task.execute.path', direct=IN, type=VARCHAR, value='/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='568'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.703 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.706 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926651707
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 568_1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1406,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926545946,
  "startTime" : 1713926651707,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/101/568/1406.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 101,
  "processInstanceId" : 568,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 12,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1406"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104411"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.task.execute.path" : {
      "prop" : "system.task.execute.path",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "568"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "568_1406",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.709 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.716 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406 check successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406/spark_reddit_preprocessing.py)})
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.724 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.732 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.732 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.732 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \
    spark_reddit_preprocessing.py

[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.732 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.732 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406/568_1406.sh
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:11.746 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 554
[WI-0][TI-1406] - [INFO] 2024-04-24 10:44:12.442 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1406, success=true)
[WI-0][TI-1406] - [INFO] 2024-04-24 10:44:12.513 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1406)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:12.746 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406/568_1406.sh: line 5: /bin/spark-submit: No such file or directory
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.747 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406, processId:554 ,exitStatusCode:127 ,processWaitForStatus:true ,processExitValue:127
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.748 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_101/568/1406
[WI-568][TI-1406] - [INFO] 2024-04-24 10:44:12.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1406] - [INFO] 2024-04-24 10:44:13.422 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1406, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:13.600 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9183416885493753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:14.617 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7455089820359282 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:42.761 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7305389221556886 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:43.774 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7859154929577465 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:49.945 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1407, taskName=search for intake JSON files, firstSubmitTime=1713926689876, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=102, appIds=null, processInstanceId=569, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1407'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104449'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='569'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.947 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.949 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.952 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926689952
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 569_1407
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.953 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1407,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713926689876,
  "startTime" : 1713926689952,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1407.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 102,
  "processInstanceId" : 569,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1407"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104449"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "569"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "569_1407",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.953 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.953 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.954 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.960 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407 check successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.962 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.964 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.964 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.964 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.965 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.967 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407/569_1407.sh
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:49.993 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 578
[WI-0][TI-1407] - [INFO] 2024-04-24 10:44:50.592 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1407, success=true)
[WI-0][TI-1407] - [INFO] 2024-04-24 10:44:50.601 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1407)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:50.993 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.011 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407, processId:578 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.026 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.028 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.031 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.034 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.057 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.058 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.058 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.059 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1407
[WI-569][TI-1407] - [INFO] 2024-04-24 10:44:51.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1407] - [INFO] 2024-04-24 10:44:51.590 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1407, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:52.693 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1409, taskName=move to processing, firstSubmitTime=1713926692683, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=102, appIds=null, processInstanceId=569, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1409'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104452'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='569'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.694 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.699 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.700 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.700 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.700 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926692700
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.700 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 569_1409
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1409,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713926692683,
  "startTime" : 1713926692700,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1409.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 102,
  "processInstanceId" : 569,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1409"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104452"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "569"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "569_1409",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.701 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.702 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.702 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.705 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409 check successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.709 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.711 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.711 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.730 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.730 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.730 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.730 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.730 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409/569_1409.sh
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:52.746 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 591
[WI-0][TI-1409] - [INFO] 2024-04-24 10:44:53.579 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1409, success=true)
[WI-0][TI-1409] - [INFO] 2024-04-24 10:44:53.600 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1409)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:53.746 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.765 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409, processId:591 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.778 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1409
[WI-569][TI-1409] - [INFO] 2024-04-24 10:44:53.793 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1409] - [INFO] 2024-04-24 10:44:54.568 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1409, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.656 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1410, taskName=spark preprocessing, firstSubmitTime=1713926694646, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=102, appIds=null, processInstanceId=569, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1410'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104454'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='569'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.669 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.672 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926694673
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 569_1410
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1410,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926694646,
  "startTime" : 1713926694673,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/102/569/1410.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 102,
  "processInstanceId" : 569,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1410"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104454"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "569"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "569_1410",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410 check successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410/spark_reddit_preprocessing.py)})
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.687 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.691 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.692 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.692 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.693 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.693 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.694 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.706 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.706 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.707 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \
    spark_reddit_preprocessing.py

[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.708 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.708 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410/569_1410.sh
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:54.712 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 603
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:54.813 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7163742690058479 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-1410] - [INFO] 2024-04-24 10:44:55.626 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1410, success=true)
[WI-0][TI-1410] - [INFO] 2024-04-24 10:44:55.708 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1410)
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:55.715 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:55.836 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7675159235668789 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:44:57.731 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Exception in thread "main" java.lang.IllegalArgumentException: requirement failed: Provided Maven Coordinates must be in the form 'groupId:artifactId:version'. The coordinate provided is: --packages
		at scala.Predef$.require(Predef.scala:337)
		at org.apache.spark.deploy.SparkSubmitUtils$.$anonfun$extractMavenCoordinates$1(SparkSubmit.scala:1221)
		at scala.collection.ArrayOps$.map$extension(ArrayOps.scala:929)
		at org.apache.spark.deploy.SparkSubmitUtils$.extractMavenCoordinates(SparkSubmit.scala:1219)
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1541)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.734 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410, processId:603 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.735 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.741 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_102/569/1410
[WI-569][TI-1410] - [INFO] 2024-04-24 10:44:57.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1410] - [INFO] 2024-04-24 10:44:58.578 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1410, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:32.071 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.744927536231884 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:50.157 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7203647416413375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:55.195 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7381615598885793 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:57.269 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1411, taskName=search for intake JSON files, firstSubmitTime=1713926757245, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=103, appIds=null, processInstanceId=570, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1411'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104557'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='570'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.269 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.270 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.275 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.275 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926757275
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 570_1411
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.276 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1411,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713926757245,
  "startTime" : 1713926757275,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1411.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 103,
  "processInstanceId" : 570,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1411"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104557"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "570"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "570_1411",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.315 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411 check successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.317 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.319 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.320 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.320 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.320 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.320 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411/570_1411.sh
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:57.324 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 658
[WI-0][TI-1411] - [INFO] 2024-04-24 10:45:57.752 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1411, success=true)
[WI-0][TI-1411] - [INFO] 2024-04-24 10:45:57.761 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1411)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:58.329 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.332 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411, processId:658 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.333 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.354 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.354 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1411
[WI-570][TI-1411] - [INFO] 2024-04-24 10:45:58.356 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1411] - [INFO] 2024-04-24 10:45:58.755 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1411, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:45:59.919 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1413, taskName=move to processing, firstSubmitTime=1713926759885, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=103, appIds=null, processInstanceId=570, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1413'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104559'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='570'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.921 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.922 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.922 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926759922
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 570_1413
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.931 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1413,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713926759885,
  "startTime" : 1713926759922,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1413.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 103,
  "processInstanceId" : 570,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1413"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104559"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "570"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "570_1413",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.931 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.932 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.932 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413 check successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.937 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.938 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.939 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.939 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.939 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.939 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.939 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413/570_1413.sh
[WI-570][TI-1413] - [INFO] 2024-04-24 10:45:59.943 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 672
[WI-0][TI-1413] - [INFO] 2024-04-24 10:46:00.766 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1413, success=true)
[WI-0][TI-1413] - [INFO] 2024-04-24 10:46:00.780 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1413)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:00.945 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.948 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413, processId:672 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.948 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.952 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.957 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1413
[WI-570][TI-1413] - [INFO] 2024-04-24 10:46:00.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1413] - [INFO] 2024-04-24 10:46:01.763 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1413, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:01.852 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1414, taskName=spark preprocessing, firstSubmitTime=1713926761837, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=103, appIds=null, processInstanceId=570, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1414'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104601'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='570'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.855 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.868 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.868 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.869 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926761869
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.869 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 570_1414
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1414,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926761837,
  "startTime" : 1713926761869,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/103/570/1414.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 103,
  "processInstanceId" : 570,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1414"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104601"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "570"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "570_1414",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.871 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.871 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.871 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.881 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414 check successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.882 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.883 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414/spark_reddit_preprocessing.py)})
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.885 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.885 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.886 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.887 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.887 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.888 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.889 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.891 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.892 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.893 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1 \
    spark_reddit_preprocessing.py

[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.894 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.894 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414/570_1414.sh
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:01.899 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 684
[WI-0][TI-1414] - [INFO] 2024-04-24 10:46:02.769 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1414, success=true)
[WI-0][TI-1414] - [INFO] 2024-04-24 10:46:02.778 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1414)
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:02.902 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:46:03.906 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Exception in thread "main" java.lang.IllegalArgumentException: requirement failed: Provided Maven Coordinates must be in the form 'groupId:artifactId:version'. The coordinate provided is: org.apache.spark:spark-sql-kafka-0-10_2.13-3.5.1
		at scala.Predef$.require(Predef.scala:337)
		at org.apache.spark.deploy.SparkSubmitUtils$.$anonfun$extractMavenCoordinates$1(SparkSubmit.scala:1221)
		at scala.collection.ArrayOps$.map$extension(ArrayOps.scala:929)
		at org.apache.spark.deploy.SparkSubmitUtils$.extractMavenCoordinates(SparkSubmit.scala:1219)
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1541)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.907 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414, processId:684 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.912 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.912 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.913 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.919 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.920 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_103/570/1414
[WI-570][TI-1414] - [INFO] 2024-04-24 10:46:03.921 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1414] - [INFO] 2024-04-24 10:46:04.765 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1414, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:30.706 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1415, taskName=search for intake JSON files, firstSubmitTime=1713926850694, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=104, appIds=null, processInstanceId=571, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1415'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104730'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='571'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.708 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.709 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926850720
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 571_1415
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1415,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713926850694,
  "startTime" : 1713926850720,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1415.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 104,
  "processInstanceId" : 571,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1415"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104730"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "571"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "571_1415",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.734 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415 check successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.739 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.742 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415/571_1415.sh
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:30.748 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 746
[WI-0][TI-1415] - [INFO] 2024-04-24 10:47:31.490 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1415, success=true)
[WI-0][TI-1415] - [INFO] 2024-04-24 10:47:31.507 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1415)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:31.750 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.776 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415, processId:746 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.782 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.782 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.782 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.788 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.789 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.789 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.792 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1415
[WI-571][TI-1415] - [INFO] 2024-04-24 10:47:31.792 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1415] - [INFO] 2024-04-24 10:47:32.478 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1415, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:32.677 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7391304347826088 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:33.615 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1417, taskName=move to processing, firstSubmitTime=1713926853601, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=104, appIds=null, processInstanceId=571, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1417'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104733'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='571'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.618 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.619 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926853620
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 571_1417
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1417,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713926853601,
  "startTime" : 1713926853620,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1417.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 104,
  "processInstanceId" : 571,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1417"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104733"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "571"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "571_1417",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.621 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.638 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.639 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.659 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.659 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417 check successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.660 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.660 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.660 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.660 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.660 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.661 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.662 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.662 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.665 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.683 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417/571_1417.sh
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:33.723 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 760
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:33.724 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1417] - [INFO] 2024-04-24 10:47:34.491 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1417, success=true)
[WI-0][TI-1417] - [INFO] 2024-04-24 10:47:34.508 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1417)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:34.732 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.733 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417, processId:760 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1417
[WI-571][TI-1417] - [INFO] 2024-04-24 10:47:34.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1417] - [INFO] 2024-04-24 10:47:35.491 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1417, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:35.599 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1418, taskName=spark preprocessing, firstSubmitTime=1713926855588, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=104, appIds=null, processInstanceId=571, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1418'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424104735'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='571'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.600 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713926855602
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 571_1418
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1418,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713926855588,
  "startTime" : 1713926855602,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/104/571/1418.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 104,
  "processInstanceId" : 571,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1418"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424104735"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "571"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "571_1418",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.614 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.614 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.614 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418 check successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418/spark_reddit_preprocessing.py)})
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.623 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  } ]
}
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.625 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.625 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.625 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    spark_reddit_preprocessing.py

[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.625 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.625 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418/571_1418.sh
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:35.630 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 772
[WI-0][TI-1418] - [INFO] 2024-04-24 10:47:36.514 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1418, success=true)
[WI-0][TI-1418] - [INFO] 2024-04-24 10:47:36.520 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1418)
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:36.631 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:37.642 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Ivy Default Cache set to: /home/default/.ivy2/cache
	The jars for the packages stored in: /home/default/.ivy2/jars
	org.apache.spark#spark-sql-kafka-0-10_2.13 added as a dependency
	:: resolving dependencies :: org.apache.spark#spark-submit-parent-610741a4-75d8-498c-90d0-d5cf3080b152;1.0
		confs: [default]
[WI-0][TI-0] - [INFO] 2024-04-24 10:47:41.647 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Exception in thread "main" java.io.FileNotFoundException: /home/default/.ivy2/cache/resolved-org.apache.spark-spark-submit-parent-610741a4-75d8-498c-90d0-d5cf3080b152-1.0.xml (No such file or directory)
		at java.io.FileOutputStream.open0(Native Method)
		at java.io.FileOutputStream.open(FileOutputStream.java:270)
		at java.io.FileOutputStream.<init>(FileOutputStream.java:213)
		at java.io.FileOutputStream.<init>(FileOutputStream.java:162)
		at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorWriter.write(XmlModuleDescriptorWriter.java:71)
		at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorWriter.write(XmlModuleDescriptorWriter.java:63)
		at org.apache.ivy.core.module.descriptor.DefaultModuleDescriptor.toIvyFile(DefaultModuleDescriptor.java:553)
		at org.apache.ivy.core.cache.DefaultResolutionCacheManager.saveResolvedModuleDescriptor(DefaultResolutionCacheManager.java:184)
		at org.apache.ivy.core.resolve.ResolveEngine.resolve(ResolveEngine.java:259)
		at org.apache.ivy.Ivy.resolve(Ivy.java:522)
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1580)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.648 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418, processId:772 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.663 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.681 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_104/571/1418
[WI-571][TI-1418] - [INFO] 2024-04-24 10:47:41.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1418] - [INFO] 2024-04-24 10:47:42.538 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1418, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:49:58.554 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7254335260115607 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:05.917 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9015384615384615 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.056 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1419, taskName=search for intake JSON files, firstSubmitTime=1713927069050, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=105, appIds=null, processInstanceId=572, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1419'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105109'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='572'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.072 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.082 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.105 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927069106
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 572_1419
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.107 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1419,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927069050,
  "startTime" : 1713927069106,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1419.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 105,
  "processInstanceId" : 572,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1419"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105109"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "572"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "572_1419",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.108 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.108 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.109 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.124 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.136 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419 check successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.144 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.144 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.154 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.154 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.154 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.154 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.154 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419/572_1419.sh
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:09.173 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 861
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:09.173 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-1419] - [INFO] 2024-04-24 10:51:09.870 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1419, success=true)
[WI-0][TI-1419] - [INFO] 2024-04-24 10:51:09.879 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1419)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:10.186 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.197 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419, processId:861 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.198 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.198 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.198 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.198 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.203 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1419
[WI-572][TI-1419] - [INFO] 2024-04-24 10:51:10.204 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1419] - [INFO] 2024-04-24 10:51:10.824 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1419, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:11.988 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1421, taskName=move to processing, firstSubmitTime=1713927071979, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=105, appIds=null, processInstanceId=572, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1421'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105111'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='572'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.989 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.990 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927071991
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 572_1421
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1421,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927071979,
  "startTime" : 1713927071991,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1421.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 105,
  "processInstanceId" : 572,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1421"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105111"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "572"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "572_1421",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.995 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.997 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421 check successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.997 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.997 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.998 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.999 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.999 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:11.999 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.000 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.000 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.001 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.001 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.001 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.001 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.001 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421/572_1421.sh
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:12.005 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 875
[WI-0][TI-1421] - [INFO] 2024-04-24 10:51:12.830 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1421, success=true)
[WI-0][TI-1421] - [INFO] 2024-04-24 10:51:12.839 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1421)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:13.014 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.023 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421, processId:875 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.024 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.025 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.025 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.029 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.029 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.029 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1421
[WI-572][TI-1421] - [INFO] 2024-04-24 10:51:13.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1421] - [INFO] 2024-04-24 10:51:13.842 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1421, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:13.976 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1422, taskName=spark preprocessing, firstSubmitTime=1713927073938, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=105, appIds=null, processInstanceId=572, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    -- jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1422'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105113'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='572'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.978 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.978 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927073979
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.980 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 572_1422
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1422,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927073938,
  "startTime" : 1713927073979,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/105/572/1422.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 105,
  "processInstanceId" : 572,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    -- jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1422"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105113"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "572"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "572_1422",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.988 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.989 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:13.989 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.007 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.007 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422 check successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.018 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.018 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    -- jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.019 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.020 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.020 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.020 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    -- jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    spark_reddit_preprocessing.py

[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.020 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.021 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422/572_1422.sh
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:14.028 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 887
[WI-0][TI-1422] - [INFO] 2024-04-24 10:51:14.835 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1422, success=true)
[WI-0][TI-1422] - [INFO] 2024-04-24 10:51:14.846 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1422)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:14.969 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8389057750759878 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:15.030 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Error: Unrecognized option: --
	
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:15.986 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9107142857142858 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:17.075 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Usage: spark-submit [options] <app jar | python file | R file> [app arguments]
	Usage: spark-submit --kill [submission ID] --master [spark://...]
	Usage: spark-submit --status [submission ID] --master [spark://...]
	Usage: spark-submit run-example [options] example-class [example args]
	
	Options:
	  --master MASTER_URL         spark://host:port, mesos://host:port, yarn,
	                              k8s://https://host:port, or local (Default: local[*]).
	  --deploy-mode DEPLOY_MODE   Whether to launch the driver program locally ("client") or
	                              on one of the worker machines inside the cluster ("cluster")
	                              (Default: client).
	  --class CLASS_NAME          Your application's main class (for Java / Scala apps).
	  --name NAME                 A name of your application.
	  --jars JARS                 Comma-separated list of jars to include on the driver
	                              and executor classpaths.
	  --packages                  Comma-separated list of maven coordinates of jars to include
	                              on the driver and executor classpaths. Will search the local
	                              maven repo, then maven central and any additional remote
	                              repositories given by --repositories. The format for the
	                              coordinates should be groupId:artifactId:version.
	  --exclude-packages          Comma-separated list of groupId:artifactId, to exclude while
	                              resolving the dependencies provided in --packages to avoid
	                              dependency conflicts.
	  --repositories              Comma-separated list of additional remote repositories to
	                              search for the maven coordinates given with --packages.
	  --py-files PY_FILES         Comma-separated list of .zip, .egg, or .py files to place
	                              on the PYTHONPATH for Python apps.
	  --files FILES               Comma-separated list of files to be placed in the working
	                              directory of each executor. File paths of these files
	                              in executors can be accessed via SparkFiles.get(fileName).
	  --archives ARCHIVES         Comma-separated list of archives to be extracted into the
	                              working directory of each executor.
	
	  --conf, -c PROP=VALUE       Arbitrary Spark configuration property.
	  --properties-file FILE      Path to a file from which to load extra properties. If not
	                              specified, this will look for conf/spark-defaults.conf.
	
	  --driver-memory MEM         Memory for driver (e.g. 1000M, 2G) (Default: 1024M).
	  --driver-java-options       Extra Java options to pass to the driver.
	  --driver-library-path       Extra library path entries to pass to the driver.
	  --driver-class-path         Extra class path entries to pass to the driver. Note that
	                              jars added with --jars are automatically included in the
	                              classpath.
	
	  --executor-memory MEM       Memory per executor (e.g. 1000M, 2G) (Default: 1G).
	
	  --proxy-user NAME           User to impersonate when submitting the application.
	                              This argument does not work with --principal / --keytab.
	
	  --help, -h                  Show this help message and exit.
	  --verbose, -v               Print additional debug output.
	  --version,                  Print the version of current Spark.
	
	 Spark Connect only:
	   --remote CONNECT_URL       URL to connect to the server for Spark Connect, e.g.,
	                              sc://host:port. --master and --deploy-mode cannot be set
	                              together with this option. This option is experimental, and
	                              might change between minor releases.
	
	 Cluster deploy mode only:
	  --driver-cores NUM          Number of cores used by the driver, only in cluster mode
	                              (Default: 1).
	
	 Spark standalone or Mesos with cluster deploy mode only:
	  --supervise                 If given, restarts the driver on failure.
	
	 Spark standalone, Mesos or K8s with cluster deploy mode only:
	  --kill SUBMISSION_ID        If given, kills the driver specified.
	  --status SUBMISSION_ID      If given, requests the status of the driver specified.
	
	 Spark standalone and Mesos only:
	  --total-executor-cores NUM  Total cores for all executors.
	
	 Spark standalone, YARN and Kubernetes only:
	  --executor-cores NUM        Number of cores used by each executor. (Default: 1 in
	                              YARN and K8S modes, or all available cores on the worker
	                              in standalone mode).
	
	 Spark on YARN and Kubernetes only:
	  --num-executors NUM         Number of executors to launch (Default: 2).
	                              If dynamic allocation is enabled, the initial number of
	                              executors will be at least NUM.
	  --principal PRINCIPAL       Principal to be used to login to KDC.
	  --keytab KEYTAB             The full path to the file that contains the keytab for the
	                              principal specified above.
	
	 Spark on YARN only:
	  --queue QUEUE_NAME          The YARN queue to submit to (Default: "default").
	      
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.082 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422, processId:887 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.101 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_105/572/1422
[WI-572][TI-1422] - [INFO] 2024-04-24 10:51:17.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1422] - [INFO] 2024-04-24 10:51:17.837 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1422, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:51:33.040 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7716763005780347 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:13.178 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7382352941176471 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:27.425 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1423, taskName=search for intake JSON files, firstSubmitTime=1713927147407, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=106, appIds=null, processInstanceId=573, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1423'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105227'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='573'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.426 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.427 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.429 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.430 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927147430
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 573_1423
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1423,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927147407,
  "startTime" : 1713927147430,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1423.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 106,
  "processInstanceId" : 573,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1423"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105227"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "573"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "573_1423",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.435 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.435 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423 check successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.435 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.437 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.437 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.437 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.437 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.438 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.438 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.438 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.438 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423/573_1423.sh
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:27.458 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 946
[WI-0][TI-1423] - [INFO] 2024-04-24 10:52:27.978 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1423, success=true)
[WI-0][TI-1423] - [INFO] 2024-04-24 10:52:27.991 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1423)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:28.466 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.470 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423, processId:946 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.470 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.471 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.471 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.471 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.482 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.482 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.482 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.483 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1423
[WI-573][TI-1423] - [INFO] 2024-04-24 10:52:28.483 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1423] - [INFO] 2024-04-24 10:52:28.965 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1423, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:30.034 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1425, taskName=move to processing, firstSubmitTime=1713927150023, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=106, appIds=null, processInstanceId=573, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1425'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105230'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='573'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.041 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.041 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.042 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.042 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.042 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927150042
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 573_1425
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1425,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927150023,
  "startTime" : 1713927150042,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1425.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 106,
  "processInstanceId" : 573,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1425"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105230"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "573"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "573_1425",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.043 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.044 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.044 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.054 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.055 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425 check successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.057 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.058 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.058 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.058 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.059 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.059 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425/573_1425.sh
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:30.063 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 960
[WI-0][TI-1425] - [INFO] 2024-04-24 10:52:30.963 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1425, success=true)
[WI-0][TI-1425] - [INFO] 2024-04-24 10:52:30.989 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1425)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:31.065 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.080 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425, processId:960 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.080 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.081 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.081 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.085 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.086 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.086 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.087 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1425
[WI-573][TI-1425] - [INFO] 2024-04-24 10:52:31.087 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1425] - [INFO] 2024-04-24 10:52:31.979 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1425, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:32.058 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1426, taskName=spark preprocessing, firstSubmitTime=1713927152051, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=106, appIds=null, processInstanceId=573, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1426'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105232'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='573'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.060 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.060 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927152064
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 573_1426
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1426,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927152051,
  "startTime" : 1713927152064,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/106/573/1426.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 106,
  "processInstanceId" : 573,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1426"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105232"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "573"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "573_1426",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.068 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426 check successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.068 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.071 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.072 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.072 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.072 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.072 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.073 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.073 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.073 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.073 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.074 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.074 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.074 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    spark_reddit_preprocessing.py

[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.075 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.075 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426/573_1426.sh
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:32.082 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 972
[WI-0][TI-1426] - [INFO] 2024-04-24 10:52:32.982 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1426, success=true)
[WI-0][TI-1426] - [INFO] 2024-04-24 10:52:32.998 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1426)
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:33.084 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:34.086 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Ivy Default Cache set to: /home/default/.ivy2/cache
	The jars for the packages stored in: /home/default/.ivy2/jars
	org.apache.spark#spark-sql-kafka-0-10_2.13 added as a dependency
	:: resolving dependencies :: org.apache.spark#spark-submit-parent-1635e0c8-7b33-4817-b369-868b84b015a8;1.0
		confs: [default]
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:34.308 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7220543806646526 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:52:37.091 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Exception in thread "main" java.io.FileNotFoundException: /home/default/.ivy2/cache/resolved-org.apache.spark-spark-submit-parent-1635e0c8-7b33-4817-b369-868b84b015a8-1.0.xml (No such file or directory)
		at java.io.FileOutputStream.open0(Native Method)
		at java.io.FileOutputStream.open(FileOutputStream.java:270)
		at java.io.FileOutputStream.<init>(FileOutputStream.java:213)
		at java.io.FileOutputStream.<init>(FileOutputStream.java:162)
		at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorWriter.write(XmlModuleDescriptorWriter.java:71)
		at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorWriter.write(XmlModuleDescriptorWriter.java:63)
		at org.apache.ivy.core.module.descriptor.DefaultModuleDescriptor.toIvyFile(DefaultModuleDescriptor.java:553)
		at org.apache.ivy.core.cache.DefaultResolutionCacheManager.saveResolvedModuleDescriptor(DefaultResolutionCacheManager.java:184)
		at org.apache.ivy.core.resolve.ResolveEngine.resolve(ResolveEngine.java:259)
		at org.apache.ivy.Ivy.resolve(Ivy.java:522)
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1580)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.100 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426, processId:972 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.102 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.104 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.130 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_106/573/1426
[WI-573][TI-1426] - [INFO] 2024-04-24 10:52:38.130 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1426] - [INFO] 2024-04-24 10:52:38.997 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1426, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:23.897 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.888283378746594 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:43.020 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7034883720930233 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:54.290 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1427, taskName=search for intake JSON files, firstSubmitTime=1713927354270, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=574, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1427'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105554'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='574'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.293 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.293 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927354304
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 574_1427
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.305 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1427,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927354270,
  "startTime" : 1713927354304,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1427.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 574,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1427"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105554"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "574"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "574_1427",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.305 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.312 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.322 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427 check successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.323 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.324 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.324 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.324 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.325 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.325 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.325 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.325 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.326 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427/574_1427.sh
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:54.337 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1059
[WI-0][TI-1427] - [INFO] 2024-04-24 10:55:54.754 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1427, success=true)
[WI-0][TI-1427] - [INFO] 2024-04-24 10:55:54.766 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1427)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.179 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7088948787061994 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:55.338 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.340 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427, processId:1059 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.348 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.348 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.349 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1427
[WI-574][TI-1427] - [INFO] 2024-04-24 10:55:55.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1427] - [INFO] 2024-04-24 10:55:55.738 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1427, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:56.795 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1429, taskName=move to processing, firstSubmitTime=1713927356771, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=574, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1429'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105556'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='574'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.801 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.801 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.807 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.807 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.807 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.807 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927356807
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.808 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 574_1429
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.808 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1429,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927356771,
  "startTime" : 1713927356807,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1429.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 574,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1429"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105556"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "574"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "574_1429",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.815 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.816 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.817 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429 check successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.817 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.818 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.818 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.818 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.818 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.818 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.819 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.819 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.819 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.820 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.820 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.820 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.820 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.821 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429/574_1429.sh
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:56.824 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1073
[WI-0][TI-1429] - [INFO] 2024-04-24 10:55:57.749 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1429, success=true)
[WI-0][TI-1429] - [INFO] 2024-04-24 10:55:57.758 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1429)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:57.829 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.839 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429, processId:1073 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.840 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.841 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.841 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.842 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.856 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.857 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.860 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1429
[WI-574][TI-1429] - [INFO] 2024-04-24 10:55:57.861 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.309 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1430, taskName=search for intake JSON files, firstSubmitTime=1713927358291, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=575, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1430'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105558'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='575'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.310 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.311 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.314 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.314 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927358314
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.315 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 575_1430
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1430,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927358291,
  "startTime" : 1713927358314,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1430.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 575,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1430"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105558"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "575"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "575_1430",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.319 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.320 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430 check successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.322 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.323 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430/575_1430.sh
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:58.326 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1085
[WI-0][TI-1429] - [INFO] 2024-04-24 10:55:58.755 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1429, success=true)
[WI-0][TI-1430] - [INFO] 2024-04-24 10:55:58.774 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1430, success=true)
[WI-0][TI-1430] - [INFO] 2024-04-24 10:55:58.786 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1430)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:58.842 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1431, taskName=spark preprocessing, firstSubmitTime=1713927358833, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=574, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1431'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105558'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='574'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.844 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.844 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.845 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.845 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927358845
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.845 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 574_1431
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.846 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1431,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927358833,
  "startTime" : 1713927358845,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/574/1431.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 574,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    --conf spark.driver.extraJavaOptions=\\\"-Divy.cache.dir=/tmp -Divy.home=/tmp\\\" \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1431"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105558"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "574"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "574_1431",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.850 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.850 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431 check successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.858 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.858 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.859 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.860 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.860 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    --conf spark.driver.extraJavaOptions="-Divy.cache.dir=/tmp -Divy.home=/tmp" \
    spark_reddit_preprocessing.py

[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.861 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431/574_1431.sh
[WI-574][TI-1431] - [INFO] 2024-04-24 10:55:58.873 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1098
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.333 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.338 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430, processId:1085 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.347 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.347 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1430
[WI-575][TI-1430] - [INFO] 2024-04-24 10:55:59.348 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1431] - [INFO] 2024-04-24 10:55:59.806 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1431, success=true)
[WI-0][TI-1430] - [INFO] 2024-04-24 10:55:59.823 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1430, success=true)
[WI-0][TI-1431] - [INFO] 2024-04-24 10:55:59.828 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1431)
[WI-0][TI-0] - [INFO] 2024-04-24 10:55:59.887 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.212 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7565543071161049 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.914 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:00.918 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1433, taskName=move to processing, firstSubmitTime=1713927360906, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=575, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1433'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105600'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='575'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.927 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.929 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.938 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.938 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.938 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927360939
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 575_1433
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1433,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927360906,
  "startTime" : 1713927360939,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1433.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 575,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1433"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105600"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "575"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "575_1433",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.942 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.960 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433 check successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.971 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.972 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.973 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.974 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.974 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433/575_1433.sh
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:00.981 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1140
[WI-0][TI-1433] - [INFO] 2024-04-24 10:56:01.793 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1433, success=true)
[WI-0][TI-1433] - [INFO] 2024-04-24 10:56:01.799 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1433)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:01.923 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Ivy Default Cache set to: /tmp
	The jars for the packages stored in: /tmp/jars
	org.apache.spark#spark-sql-kafka-0-10_2.13 added as a dependency
	:: resolving dependencies :: org.apache.spark#spark-submit-parent-59d876ef-64bf-4503-b5f4-681028d71dde;1.0
		confs: [default]
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:01.983 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.986 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433, processId:1140 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.995 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1433
[WI-575][TI-1433] - [INFO] 2024-04-24 10:56:01.995 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1433] - [INFO] 2024-04-24 10:56:02.785 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1433, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:02.849 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1434, taskName=spark preprocessing, firstSubmitTime=1713927362842, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=107, appIds=null, processInstanceId=575, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1434'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105602'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='575'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.850 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927362855
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 575_1434
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.857 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1434,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927362842,
  "startTime" : 1713927362855,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/107/575/1434.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 107,
  "processInstanceId" : 575,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    --conf spark.driver.extraJavaOptions=\\\"-Divy.cache.dir=/tmp -Divy.home=/tmp\\\" \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1434"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105602"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "575"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "575_1434",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.862 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.862 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.863 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434 check successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.863 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.869 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.869 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.871 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.871 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.871 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.873 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.873 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.874 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    --conf spark.driver.extraJavaOptions="-Divy.cache.dir=/tmp -Divy.home=/tmp" \
    spark_reddit_preprocessing.py

[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.874 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.874 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434/575_1434.sh
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:02.877 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1155
[WI-0][TI-1434] - [INFO] 2024-04-24 10:56:03.791 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1434, success=true)
[WI-0][TI-1434] - [INFO] 2024-04-24 10:56:03.801 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1434)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:03.885 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:04.249 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8862275449101795 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:05.280 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8697183098591549 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:05.917 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: loading settings :: url = jar:file:/opt/spark-3.5.1-bin-hadoop3-scala2.13/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
	Ivy Default Cache set to: /tmp
	The jars for the packages stored in: /tmp/jars
	org.apache.spark#spark-sql-kafka-0-10_2.13 added as a dependency
	:: resolving dependencies :: org.apache.spark#spark-submit-parent-6a4b633c-0376-42fa-9805-fd5c8e5027a8;1.0
		confs: [default]
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:06.921 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.spark#spark-sql-kafka-0-10_2.13;3.5.1 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:06.939 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.spark#spark-sql-kafka-0-10_2.13;3.5.1 in central
		found org.apache.spark#spark-token-provider-kafka-0-10_2.13;3.5.1 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:07.933 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.spark#spark-token-provider-kafka-0-10_2.13;3.5.1 in central
		found org.apache.kafka#kafka-clients;3.4.1 in central
		found org.lz4#lz4-java;1.8.0 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:07.954 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.kafka#kafka-clients;3.4.1 in central
		found org.lz4#lz4-java;1.8.0 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:08.959 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.xerial.snappy#snappy-java;1.1.10.3 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:09.959 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.slf4j#slf4j-api;2.0.7 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:09.960 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.slf4j#slf4j-api;2.0.7 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:13.978 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
		found org.apache.hadoop#hadoop-client-api;3.3.4 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:13.977 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
		found org.apache.hadoop#hadoop-client-api;3.3.4 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:14.991 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	[Fatal Error] ivy-28.xml.original:390:16: An invalid XML character (Unicode: 0x0) was found in the element content of the document.
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:17.994 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found com.google.code.findbugs#jsr305;3.0.0 in central
		found org.scala-lang.modules#scala-parallel-collections_2.13;1.0.4 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:17.992 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found com.google.code.findbugs#jsr305;3.0.0 in central
		found org.scala-lang.modules#scala-parallel-collections_2.13;1.0.4 in central
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:19.998 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	downloading https://repo1.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.13/3.5.1/spark-sql-kafka-0-10_2.13-3.5.1.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:21.006 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.apache.spark#spark-sql-kafka-0-10_2.13;3.5.1!spark-sql-kafka-0-10_2.13.jar (638ms)
	downloading https://repo1.maven.org/maven2/org/apache/spark/spark-token-provider-kafka-0-10_2.13/3.5.1/spark-token-provider-kafka-0-10_2.13-3.5.1.jar ...
		[SUCCESSFUL ] org.apache.spark#spark-token-provider-kafka-0-10_2.13;3.5.1!spark-token-provider-kafka-0-10_2.13.jar (381ms)
	downloading https://repo1.maven.org/maven2/org/scala-lang/modules/scala-parallel-collections_2.13/1.0.4/scala-parallel-collections_2.13-1.0.4.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:22.008 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.scala-lang.modules#scala-parallel-collections_2.13;1.0.4!scala-parallel-collections_2.13.jar (635ms)
	downloading https://repo1.maven.org/maven2/org/apache/kafka/kafka-clients/3.4.1/kafka-clients-3.4.1.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:23.000 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		found org.apache.commons#commons-pool2;2.11.1 in central
	downloading https://repo1.maven.org/maven2/org/apache/kafka/kafka-clients/3.4.1/kafka-clients-3.4.1.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:23.010 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.apache.kafka#kafka-clients;3.4.1!kafka-clients.jar (882ms)
	downloading https://repo1.maven.org/maven2/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar ...
		[SUCCESSFUL ] com.google.code.findbugs#jsr305;3.0.0!jsr305.jar (392ms)
	downloading https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-runtime/3.3.4/hadoop-client-runtime-3.3.4.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:25.003 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.apache.kafka#kafka-clients;3.4.1!kafka-clients.jar (2405ms)
	downloading https://repo1.maven.org/maven2/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.jar ...
		[SUCCESSFUL ] org.apache.commons#commons-pool2;2.11.1!commons-pool2.jar (388ms)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:26.006 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	downloading https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-runtime/3.3.4/hadoop-client-runtime-3.3.4.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:29.016 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.apache.hadoop#hadoop-client-runtime;3.3.4!hadoop-client-runtime.jar (5480ms)
	downloading https://repo1.maven.org/maven2/org/lz4/lz4-java/1.8.0/lz4-java-1.8.0.jar ...
		[SUCCESSFUL ] org.lz4#lz4-java;1.8.0!lz4-java.jar (403ms)
	downloading https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.jar ...
		[SUCCESSFUL ] org.xerial.snappy#snappy-java;1.1.10.3!snappy-java.jar(bundle) (477ms)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:30.019 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	downloading https://repo1.maven.org/maven2/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.jar ...
		[SUCCESSFUL ] org.slf4j#slf4j-api;2.0.7!slf4j-api.jar (377ms)
	downloading https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-api/3.3.4/hadoop-client-api-3.3.4.jar ...
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:31.022 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
		[SUCCESSFUL ] org.apache.hadoop#hadoop-client-api;3.3.4!hadoop-client-api.jar (1270ms)
	:: resolution report :: resolve 18715ms :: artifacts dl 10952ms
		:: modules in use:
		com.google.code.findbugs#jsr305;3.0.0 from central in [default]
		org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
		org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
		org.apache.kafka#kafka-clients;3.4.1 from central in [default]
		org.apache.spark#spark-sql-kafka-0-10_2.13;3.5.1 from central in [default]
		org.apache.spark#spark-token-provider-kafka-0-10_2.13;3.5.1 from central in [default]
		org.lz4#lz4-java;1.8.0 from central in [default]
		org.scala-lang.modules#scala-parallel-collections_2.13;1.0.4 from central in [default]
		org.slf4j#slf4j-api;2.0.7 from central in [default]
		org.xerial.snappy#snappy-java;1.1.10.3 from central in [default]
		---------------------------------------------------------------------
		|                  |            modules            ||   artifacts   |
		|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
		---------------------------------------------------------------------
		|      default     |   12  |   10  |   10  |   0   ||   10  |   10  |
		---------------------------------------------------------------------
	
	:: problems summary ::
	:::: WARNINGS
		impossible to put metadata file in cache: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.pom (2.0.7) (java.io.FileNotFoundException: /tmp/org.slf4j/slf4j-api/ivy-2.0.7.xml.original (No such file or directory))
	
		problem while downloading module descriptor: https://repo1.maven.org/maven2/org/apache/commons/commons-parent/28/commons-parent-28.pom: Downloaded file size (0) doesn't match expected Content Length (50149) for https://repo1.maven.org/maven2/org/apache/commons/commons-parent/28/commons-parent-28.pom. Please retry. (215ms)
	
		io problem while parsing ivy file: https://repo1.maven.org/maven2/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.pom (java.io.IOException: Impossible to load parent for file:/tmp/commons-logging/commons-logging/ivy-1.1.3.xml.original. Parent=org.apache.commons#commons-parent;28)
	
			module not found: commons-logging#commons-logging;1.1.3
	
		==== local-m2-cache: tried
	
		  file:/home/default/.m2/repository/org/apache/commons/commons-parent/28/commons-parent-28.pom
	
		  -- artifact org.apache.commons#commons-parent;28!commons-parent.jar:
	
		  file:/home/default/.m2/repository/org/apache/commons/commons-parent/28/commons-parent-28.jar
	
		==== local-ivy-cache: tried
	
		  /tmp/local/org.apache.commons/commons-parent/28/ivys/ivy.xml
	
		  -- artifact org.apache.commons#commons-parent;28!commons-parent.jar:
	
		  /tmp/local/org.apache.commons/commons-parent/28/jars/commons-parent.jar
	
		==== central: tried
	
		  https://repo1.maven.org/maven2/org/apache/commons/commons-parent/28/commons-parent-28.pom
	
		==== spark-packages: tried
	
		  https://repos.spark-packages.org/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.pom
	
		  -- artifact commons-logging#commons-logging;1.1.3!commons-logging.jar:
	
		  https://repos.spark-packages.org/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar
	
		problem while downloading module descriptor: https://repo1.maven.org/maven2/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.pom: Downloaded file size (0) doesn't match expected Content Length (17925) for https://repo1.maven.org/maven2/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.pom. Please retry. (200ms)
	
			module not found: org.apache.commons#commons-pool2;2.11.1
	
		==== local-m2-cache: tried
	
		  file:/home/default/.m2/repository/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.pom
	
		  -- artifact org.apache.commons#commons-pool2;2.11.1!commons-pool2.jar:
	
		  file:/home/default/.m2/repository/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.jar
	
		==== local-ivy-cache: tried
	
		  /tmp/local/org.apache.commons/commons-pool2/2.11.1/ivys/ivy.xml
	
		  -- artifact org.apache.commons#commons-pool2;2.11.1!commons-pool2.jar:
	
		  /tmp/local/org.apache.commons/commons-pool2/2.11.1/jars/commons-pool2.jar
	
		==== central: tried
	
		  https://repo1.maven.org/maven2/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.pom
	
		==== spark-packages: tried
	
		  https://repos.spark-packages.org/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.pom
	
		  -- artifact org.apache.commons#commons-pool2;2.11.1!commons-pool2.jar:
	
		  https://repos.spark-packages.org/org/apache/commons/commons-pool2/2.11.1/commons-pool2-2.11.1.jar
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			::          UNRESOLVED DEPENDENCIES         ::
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			:: commons-logging#commons-logging;1.1.3: not found
	
			:: org.apache.commons#commons-pool2;2.11.1: not found
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
	
	
	:: USE VERBOSE OR DEBUG MESSAGE LEVEL FOR MORE DETAILS
	Exception in thread "main" java.lang.RuntimeException: [unresolved dependency: commons-logging#commons-logging;1.1.3: not found, unresolved dependency: org.apache.commons#commons-pool2;2.11.1: not found]
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1608)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.036 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431, processId:1098 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.036 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.055 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.055 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.062 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.062 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.063 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.077 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/574/1431
[WI-574][TI-1431] - [INFO] 2024-04-24 10:56:31.086 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1431] - [INFO] 2024-04-24 10:56:31.831 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1431, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:56:38.048 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	:: resolution report :: resolve 16588ms :: artifacts dl 15577ms
		:: modules in use:
		com.google.code.findbugs#jsr305;3.0.0 from central in [default]
		org.apache.commons#commons-pool2;2.11.1 from central in [default]
		org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
		org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
		org.apache.kafka#kafka-clients;3.4.1 from central in [default]
		org.apache.spark#spark-sql-kafka-0-10_2.13;3.5.1 from central in [default]
		org.apache.spark#spark-token-provider-kafka-0-10_2.13;3.5.1 from central in [default]
		org.lz4#lz4-java;1.8.0 from central in [default]
		org.scala-lang.modules#scala-parallel-collections_2.13;1.0.4 from central in [default]
		org.slf4j#slf4j-api;2.0.7 from central in [default]
		---------------------------------------------------------------------
		|                  |            modules            ||   artifacts   |
		|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
		---------------------------------------------------------------------
		|      default     |   12  |   9   |   7   |   0   ||   10  |   2   |
		---------------------------------------------------------------------
	
	:: problems summary ::
	:::: WARNINGS
		problem while downloading module descriptor: https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.pom: Downloaded file size (0) doesn't match expected Content Length (3067) for https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.pom. Please retry. (177ms)
	
			module not found: org.xerial.snappy#snappy-java;1.1.10.3
	
		==== local-m2-cache: tried
	
		  file:/home/default/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.pom
	
		  -- artifact org.xerial.snappy#snappy-java;1.1.10.3!snappy-java.jar:
	
		  file:/home/default/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.jar
	
		==== local-ivy-cache: tried
	
		  /tmp/local/org.xerial.snappy/snappy-java/1.1.10.3/ivys/ivy.xml
	
		  -- artifact org.xerial.snappy#snappy-java;1.1.10.3!snappy-java.jar:
	
		  /tmp/local/org.xerial.snappy/snappy-java/1.1.10.3/jars/snappy-java.jar
	
		==== central: tried
	
		  https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.pom
	
		==== spark-packages: tried
	
		  https://repos.spark-packages.org/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.pom
	
		  -- artifact org.xerial.snappy#snappy-java;1.1.10.3!snappy-java.jar:
	
		  https://repos.spark-packages.org/org/xerial/snappy/snappy-java/1.1.10.3/snappy-java-1.1.10.3.jar
	
			[FAILED     ] org.apache.hadoop#hadoop-client-runtime;3.3.4!hadoop-client-runtime.jar: Downloaded file size (0) doesn't match expected Content Length (30085504) for https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-runtime/3.3.4/hadoop-client-runtime-3.3.4.jar. Please retry. (12773ms)
	
			[FAILED     ] org.apache.hadoop#hadoop-client-runtime;3.3.4!hadoop-client-runtime.jar: Downloaded file size (0) doesn't match expected Content Length (30085504) for https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-runtime/3.3.4/hadoop-client-runtime-3.3.4.jar. Please retry. (12773ms)
	
		==== central: tried
	
		  https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-client-runtime/3.3.4/hadoop-client-runtime-3.3.4.jar
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			::          UNRESOLVED DEPENDENCIES         ::
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			:: org.xerial.snappy#snappy-java;1.1.10.3: not found
	
			:: commons-logging#commons-logging;1.1.3: java.text.ParseException: An invalid XML character (Unicode: 0x0) was found in the element content of the document.
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			::              FAILED DOWNLOADS            ::
	
			:: ^ see resolution messages for details  ^ ::
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
			:: org.apache.hadoop#hadoop-client-runtime;3.3.4!hadoop-client-runtime.jar
	
			::::::::::::::::::::::::::::::::::::::::::::::
	
	
	:::: ERRORS
		An invalid XML character (Unicode: 0x0) was found in the element content of the document.
	
	
	:: USE VERBOSE OR DEBUG MESSAGE LEVEL FOR MORE DETAILS
	Exception in thread "main" java.lang.RuntimeException: [unresolved dependency: org.xerial.snappy#snappy-java;1.1.10.3: not found, unresolved dependency: commons-logging#commons-logging;1.1.3: java.text.ParseException: An invalid XML character (Unicode: 0x0) was found in the element content of the document., download failed: org.apache.hadoop#hadoop-client-runtime;3.3.4!hadoop-client-runtime.jar]
		at org.apache.spark.deploy.SparkSubmitUtils$.resolveMavenCoordinates(SparkSubmit.scala:1608)
		at org.apache.spark.util.DependencyUtils$.resolveMavenDependencies(DependencyUtils.scala:185)
		at org.apache.spark.deploy.SparkSubmit.prepareSubmitEnvironment(SparkSubmit.scala:334)
		at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:964)
		at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:194)
		at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:217)
		at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)
		at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1120)
		at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1129)
		at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.051 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434, processId:1155 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.055 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.060 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_107/575/1434
[WI-575][TI-1434] - [INFO] 2024-04-24 10:56:38.068 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1434] - [INFO] 2024-04-24 10:56:38.837 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1434, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:57:00.515 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7156549520766773 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:18.872 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7552870090634441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:29.935 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8271604938271605 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:32.937 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1435, taskName=search for intake JSON files, firstSubmitTime=1713927512929, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=108, appIds=null, processInstanceId=576, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1435'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105832'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='576'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.939 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.939 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.944 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.944 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927512944
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 576_1435
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.945 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1435,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927512929,
  "startTime" : 1713927512944,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1435.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 108,
  "processInstanceId" : 576,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1435"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105832"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "576"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "576_1435",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.946 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.946 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.946 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.949 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.949 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435 check successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.952 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.952 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.953 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.953 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.953 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.953 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435/576_1435.sh
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:32.959 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1235
[WI-0][TI-1435] - [INFO] 2024-04-24 10:58:33.094 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1435, success=true)
[WI-0][TI-1435] - [INFO] 2024-04-24 10:58:33.100 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1435)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:33.959 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.961 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435, processId:1235 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.964 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.965 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.965 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1435
[WI-576][TI-1435] - [INFO] 2024-04-24 10:58:33.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1435] - [INFO] 2024-04-24 10:58:34.092 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1435, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:35.263 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1437, taskName=move to processing, firstSubmitTime=1713927515245, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=108, appIds=null, processInstanceId=576, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1437'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105835'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='576'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.263 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.264 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.266 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927515267
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 576_1437
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.268 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1437,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927515245,
  "startTime" : 1713927515267,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1437.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 108,
  "processInstanceId" : 576,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1437"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105835"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "576"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "576_1437",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.272 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.273 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.274 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437 check successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.276 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.276 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.276 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.276 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.277 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.277 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.292 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.294 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.295 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.295 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.295 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437/576_1437.sh
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:35.300 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1249
[WI-0][TI-1437] - [INFO] 2024-04-24 10:58:36.099 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1437, success=true)
[WI-0][TI-1437] - [INFO] 2024-04-24 10:58:36.114 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1437)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:36.303 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.307 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437, processId:1249 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.320 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.330 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1437
[WI-576][TI-1437] - [INFO] 2024-04-24 10:58:36.331 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1437] - [INFO] 2024-04-24 10:58:37.091 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1437, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:37.198 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1438, taskName=spark preprocessing, firstSubmitTime=1713927517192, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=108, appIds=null, processInstanceId=576, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    # --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1438'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105837'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='576'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.201 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.246 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.254 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.254 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.254 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.254 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927517254
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.254 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 576_1438
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1438,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927517192,
  "startTime" : 1713927517254,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/108/576/1438.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 108,
  "processInstanceId" : 576,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    # --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    --conf spark.driver.extraJavaOptions=\\\"-Divy.cache.dir=/tmp -Divy.home=/tmp\\\" \\\\\\n    spark_reddit_preprocessing.py\\n\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1438"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105837"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "576"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "576_1438",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.261 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.262 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.262 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438 check successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.262 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.269 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.270 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.270 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    # --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.272 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.274 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.274 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.274 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    # --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    --conf spark.driver.extraJavaOptions="-Divy.cache.dir=/tmp -Divy.home=/tmp" \
    spark_reddit_preprocessing.py

[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.275 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.275 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438/576_1438.sh
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:37.285 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1261
[WI-0][TI-1438] - [INFO] 2024-04-24 10:58:38.098 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1438, success=true)
[WI-0][TI-1438] - [INFO] 2024-04-24 10:58:38.109 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1438)
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:38.290 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Error: Missing application resource.
	
[WI-0][TI-0] - [INFO] 2024-04-24 10:58:39.294 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Usage: spark-submit [options] <app jar | python file | R file> [app arguments]
	Usage: spark-submit --kill [submission ID] --master [spark://...]
	Usage: spark-submit --status [submission ID] --master [spark://...]
	Usage: spark-submit run-example [options] example-class [example args]
	
	Options:
	  --master MASTER_URL         spark://host:port, mesos://host:port, yarn,
	                              k8s://https://host:port, or local (Default: local[*]).
	  --deploy-mode DEPLOY_MODE   Whether to launch the driver program locally ("client") or
	                              on one of the worker machines inside the cluster ("cluster")
	                              (Default: client).
	  --class CLASS_NAME          Your application's main class (for Java / Scala apps).
	  --name NAME                 A name of your application.
	  --jars JARS                 Comma-separated list of jars to include on the driver
	                              and executor classpaths.
	  --packages                  Comma-separated list of maven coordinates of jars to include
	                              on the driver and executor classpaths. Will search the local
	                              maven repo, then maven central and any additional remote
	                              repositories given by --repositories. The format for the
	                              coordinates should be groupId:artifactId:version.
	  --exclude-packages          Comma-separated list of groupId:artifactId, to exclude while
	                              resolving the dependencies provided in --packages to avoid
	                              dependency conflicts.
	  --repositories              Comma-separated list of additional remote repositories to
	                              search for the maven coordinates given with --packages.
	  --py-files PY_FILES         Comma-separated list of .zip, .egg, or .py files to place
	                              on the PYTHONPATH for Python apps.
	  --files FILES               Comma-separated list of files to be placed in the working
	                              directory of each executor. File paths of these files
	                              in executors can be accessed via SparkFiles.get(fileName).
	  --archives ARCHIVES         Comma-separated list of archives to be extracted into the
	                              working directory of each executor.
	
	  --conf, -c PROP=VALUE       Arbitrary Spark configuration property.
	  --properties-file FILE      Path to a file from which to load extra properties. If not
	                              specified, this will look for conf/spark-defaults.conf.
	
	  --driver-memory MEM         Memory for driver (e.g. 1000M, 2G) (Default: 1024M).
	  --driver-java-options       Extra Java options to pass to the driver.
	  --driver-library-path       Extra library path entries to pass to the driver.
	  --driver-class-path         Extra class path entries to pass to the driver. Note that
	                              jars added with --jars are automatically included in the
	                              classpath.
	
	  --executor-memory MEM       Memory per executor (e.g. 1000M, 2G) (Default: 1G).
	
	  --proxy-user NAME           User to impersonate when submitting the application.
	                              This argument does not work with --principal / --keytab.
	
	  --help, -h                  Show this help message and exit.
	  --verbose, -v               Print additional debug output.
	  --version,                  Print the version of current Spark.
	
	 Spark Connect only:
	   --remote CONNECT_URL       URL to connect to the server for Spark Connect, e.g.,
	                              sc://host:port. --master and --deploy-mode cannot be set
	                              together with this option. This option is experimental, and
	                              might change between minor releases.
	
	 Cluster deploy mode only:
	  --driver-cores NUM          Number of cores used by the driver, only in cluster mode
	                              (Default: 1).
	
	 Spark standalone or Mesos with cluster deploy mode only:
	  --supervise                 If given, restarts the driver on failure.
	
	 Spark standalone, Mesos or K8s with cluster deploy mode only:
	  --kill SUBMISSION_ID        If given, kills the driver specified.
	  --status SUBMISSION_ID      If given, requests the status of the driver specified.
	
	 Spark standalone and Mesos only:
	  --total-executor-cores NUM  Total cores for all executors.
	
	 Spark standalone, YARN and Kubernetes only:
	  --executor-cores NUM        Number of cores used by each executor. (Default: 1 in
	                              YARN and K8S modes, or all available cores on the worker
	                              in standalone mode).
	
	 Spark on YARN and Kubernetes only:
	  --num-executors NUM         Number of executors to launch (Default: 2).
	                              If dynamic allocation is enabled, the initial number of
	                              executors will be at least NUM.
	  --principal PRINCIPAL       Principal to be used to login to KDC.
	  --keytab KEYTAB             The full path to the file that contains the keytab for the
	                              principal specified above.
	
	 Spark on YARN only:
	  --queue QUEUE_NAME          The YARN queue to submit to (Default: "default").
	      
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438/576_1438.sh: line 20: --jars: command not found
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.295 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438, processId:1261 ,exitStatusCode:127 ,processWaitForStatus:true ,processExitValue:127
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.297 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.300 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_108/576/1438
[WI-576][TI-1438] - [INFO] 2024-04-24 10:58:39.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1438] - [INFO] 2024-04-24 10:58:40.105 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1438, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:05.189 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7296511627906976 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:19.242 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7556818181818182 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:25.244 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1439, taskName=search for intake JSON files, firstSubmitTime=1713927565212, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=109, appIds=null, processInstanceId=577, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='search for intake JSON files'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1439'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340113777664'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105925'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='577'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.246 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: search for intake JSON files to wait queue success
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.246 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.259 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.259 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.259 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.259 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927565259
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.259 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 577_1439
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1439,
  "taskName" : "search for intake JSON files",
  "firstSubmitTime" : 1713927565212,
  "startTime" : 1713927565259,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1439.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 109,
  "processInstanceId" : 577,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# find 1 raw file in the folder\\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\\n\\n# check if raw_file_dir is empty, then set raw_file_dir to null\\nif [ -z \\\"$raw_file_dir\\\" ]; then\\n    raw_file_dir=null\\nfi\\n\\necho \\\"#{setValue(raw_file_dir=${raw_file_dir})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "search for intake JSON files"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1439"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340113777664"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105925"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "577"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "577_1439",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.260 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.260 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.261 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439 check successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# find 1 raw file in the folder\nraw_file_dir=$(find ${REDDIT_HOME}/${folder} -type f -name '*.json'| head -n 1)\n\n# check if raw_file_dir is empty, then set raw_file_dir to null\nif [ -z \"$raw_file_dir\" ]; then\n    raw_file_dir=null\nfi\n\necho \"#{setValue(raw_file_dir=${raw_file_dir})}\"",
  "resourceList" : [ ]
}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.266 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.267 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.268 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# find 1 raw file in the folder
raw_file_dir=$(find /local_storage/reddit/processing -type f -name '*.json'| head -n 1)

# check if raw_file_dir is empty, then set raw_file_dir to null
if [ -z "$raw_file_dir" ]; then
    raw_file_dir=null
fi

echo "#{setValue(raw_file_dir=${raw_file_dir})}"
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.268 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.268 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439/577_1439.sh
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:25.278 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1317
[WI-0][TI-1439] - [INFO] 2024-04-24 10:59:26.212 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1439, success=true)
[WI-0][TI-1439] - [INFO] 2024-04-24 10:59:26.232 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1439)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:26.284 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.285 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439, processId:1317 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.286 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.287 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.294 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1439
[WI-577][TI-1439] - [INFO] 2024-04-24 10:59:26.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1439] - [INFO] 2024-04-24 10:59:27.213 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1439, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:28.352 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1441, taskName=move to processing, firstSubmitTime=1713927568336, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=109, appIds=null, processInstanceId=577, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='move to processing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1441'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13340390094208'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105928'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='577'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.355 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: move to processing to wait queue success
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.355 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.357 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927568358
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 577_1441
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1441,
  "taskName" : "move to processing",
  "firstSubmitTime" : 1713927568336,
  "startTime" : 1713927568358,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1441.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 109,
  "processInstanceId" : 577,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"raw_file_dir\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# move file to the reddit processing folder\\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\\nfilename=$(basename \\\"${raw_file_dir}\\\")\\nif ! grep -q \\\"${REDDIT_HOME}/processing\\\" <<< \\\"${raw_file_dir}\\\"; then\\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\\nelse\\n    echo JSON is already in processing\\nfi\\n\\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\\necho \\\"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "move to processing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1441"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13340390094208"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105928"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "577"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "577_1441",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.359 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.359 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.359 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.364 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.365 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.365 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441 check successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.367 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.368 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "raw_file_dir",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# move file to the reddit processing folder\n# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error\nfilename=$(basename \"${raw_file_dir}\")\nif ! grep -q \"${REDDIT_HOME}/processing\" <<< \"${raw_file_dir}\"; then\n    mv ${raw_file_dir} ${REDDIT_HOME}/processing\nelse\n    echo JSON is already in processing\nfi\n\n# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing\necho \"#{setValue(raw_file_dir=${REDDIT_HOME}/processing/${filename})}\"",
  "resourceList" : [ ]
}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.369 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.370 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.382 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.382 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
# move file to the reddit processing folder
# but dont move it, if it already exists in the folder, for example when the selected folder to search is reddit/processing, the file may already be inside the processing folder, which will lead to an error
filename=$(basename "/local_storage/reddit/processing/500-20240423.json")
if ! grep -q "/local_storage/reddit/processing" <<< "/local_storage/reddit/processing/500-20240423.json"; then
    mv /local_storage/reddit/processing/500-20240423.json /local_storage/reddit/processing
else
    echo JSON is already in processing
fi

# update the raw_file_dir parameters in the scenario that the raw file gets moved to processing
echo "#{setValue(raw_file_dir=/local_storage/reddit/processing/${filename})}"
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.382 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.382 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441/577_1441.sh
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:28.387 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1330
[WI-0][TI-1441] - [INFO] 2024-04-24 10:59:29.251 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1441, success=true)
[WI-0][TI-1441] - [INFO] 2024-04-24 10:59:29.262 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1441)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:29.387 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	JSON is already in processing
	#{setValue(raw_file_dir=/local_storage/reddit/processing/500-20240423.json)}
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.390 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441, processId:1330 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.391 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.435 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.438 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.439 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.441 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1441
[WI-577][TI-1441] - [INFO] 2024-04-24 10:59:29.441 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1441] - [INFO] 2024-04-24 10:59:30.242 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1441, success=true)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:30.271 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=1442, taskName=spark preprocessing, firstSubmitTime=1713927570264, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.9:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=109, appIds=null, processInstanceId=577, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"processing"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n\n# --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\","resourceList":[{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py","res":null},{"id":null,"resourceName":"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar","res":null}]}, environmentConfig=export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='spark preprocessing'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240424'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='1442'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13210058002752'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240424105930'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='processing'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='577'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/reddit/processing/500-20240423.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240423'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.272 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: spark preprocessing to wait queue success
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1713927570275
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 577_1442
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 1442,
  "taskName" : "spark preprocessing",
  "firstSubmitTime" : 1713927570264,
  "startTime" : 1713927570275,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.9:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240424/13201021801792/109/577/1442.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 109,
  "processInstanceId" : 577,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"processing\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"$SPARK_HOME/bin/spark-submit \\\\\\n    --master local \\\\\\n    --deploy-mode client \\\\\\n    --conf spark.driver.cores=1 \\\\\\n    --conf spark.driver.memory=1G \\\\\\n    --conf spark.executor.instances=1 \\\\\\n    --conf spark.executor.cores=1 \\\\\\n    --conf spark.executor.memory=1G \\\\\\n    --name reddit_preprocessing \\\\\\n    --files ${raw_file_dir} \\\\\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\\\\n    --conf spark.driver.extraJavaOptions=\\\"-Divy.cache.dir=/tmp -Divy.home=/tmp\\\" \\\\\\n    spark_reddit_preprocessing.py\\n\\n# --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\\\\",\"resourceList\":[{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py\",\"res\":null},{\"id\":null,\"resourceName\":\"file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar\",\"res\":null}]}",
  "environmentConfig" : "export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13\nexport JAVA_HOME=/opt/java/openjdk\nexport PYSPARK_DRIVER_PYTHON=/bin/python3.11\nexport PYTHON_LAUNCHER=/bin/python3.11\nexport PYSPARK_PYTHON=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "spark preprocessing"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1442"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13210058002752"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240424105930"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "processing"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "577"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit/processing/500-20240423.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240423"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "577_1442",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/reddit/processing/500-20240423.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.280 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442 check successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py, resourceRelativePath=spark_reddit_preprocessing.py, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py), file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceRelativePath=spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar)})
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.302 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "$SPARK_HOME/bin/spark-submit \\\n    --master local \\\n    --deploy-mode client \\\n    --conf spark.driver.cores=1 \\\n    --conf spark.driver.memory=1G \\\n    --conf spark.executor.instances=1 \\\n    --conf spark.executor.cores=1 \\\n    --conf spark.executor.memory=1G \\\n    --name reddit_preprocessing \\\n    --files ${raw_file_dir} \\\n    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \\\n    --conf spark.driver.extraJavaOptions=\"-Divy.cache.dir=/tmp -Divy.home=/tmp\" \\\n    spark_reddit_preprocessing.py\n\n# --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \\",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_reddit_preprocessing.py",
    "res" : null
  }, {
    "id" : null,
    "resourceName" : "file:/dolphinscheduler/default/resources/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar",
    "res" : null
  } ]
}
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.306 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.306 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/reddit/processing/500-20240423.json"}] successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.306 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.307 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.307 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.307 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.307 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export SPARK_HOME=/opt/spark-3.5.1-bin-hadoop3-scala2.13
export JAVA_HOME=/opt/java/openjdk
export PYSPARK_DRIVER_PYTHON=/bin/python3.11
export PYTHON_LAUNCHER=/bin/python3.11
export PYSPARK_PYTHON=/bin/python3.11
$SPARK_HOME/bin/spark-submit \
    --master local \
    --deploy-mode client \
    --conf spark.driver.cores=1 \
    --conf spark.driver.memory=1G \
    --conf spark.executor.instances=1 \
    --conf spark.executor.cores=1 \
    --conf spark.executor.memory=1G \
    --name reddit_preprocessing \
    --files /local_storage/reddit/processing/500-20240423.json \
    --jars spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar \
    --conf spark.driver.extraJavaOptions="-Divy.cache.dir=/tmp -Divy.home=/tmp" \
    spark_reddit_preprocessing.py

# --packages org.apache.spark:spark-sql-kafka-0-10_2.13:3.5.1 \
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.307 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.308 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/577_1442.sh
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:30.311 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1342
[WI-0][TI-1442] - [INFO] 2024-04-24 10:59:31.259 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=1442, success=true)
[WI-0][TI-1442] - [INFO] 2024-04-24 10:59:31.272 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=1442)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:31.310 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7042682926829269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:31.311 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:33.318 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:34.320 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:33 INFO SparkContext: Running Spark version 3.5.1
	24/04/24 10:59:33 INFO SparkContext: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:59:33 INFO SparkContext: Java version 1.8.0_402
	24/04/24 10:59:33 INFO ResourceUtils: ==============================================================
	24/04/24 10:59:33 INFO ResourceUtils: No custom resources configured for spark.driver.
	24/04/24 10:59:33 INFO ResourceUtils: ==============================================================
	24/04/24 10:59:33 INFO SparkContext: Submitted application: reddit_preprocessing
	24/04/24 10:59:33 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
	24/04/24 10:59:33 INFO ResourceProfile: Limiting resource is cpus at 1 tasks per executor
	24/04/24 10:59:33 INFO ResourceProfileManager: Added ResourceProfile id: 0
	24/04/24 10:59:33 INFO SecurityManager: Changing view acls to: default
	24/04/24 10:59:33 INFO SecurityManager: Changing modify acls to: default
	24/04/24 10:59:33 INFO SecurityManager: Changing view acls groups to: 
	24/04/24 10:59:33 INFO SecurityManager: Changing modify acls groups to: 
	24/04/24 10:59:33 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: default; groups with view permissions: EMPTY; users with modify permissions: default; groups with modify permissions: EMPTY
	24/04/24 10:59:33 INFO Utils: Successfully started service 'sparkDriver' on port 36835.
	24/04/24 10:59:34 INFO SparkEnv: Registering MapOutputTracker
	24/04/24 10:59:34 INFO SparkEnv: Registering BlockManagerMaster
	24/04/24 10:59:34 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
	24/04/24 10:59:34 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
	24/04/24 10:59:34 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
	24/04/24 10:59:34 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7fedee97-1bc0-43ef-a295-f6b203560ce5
	24/04/24 10:59:34 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
	24/04/24 10:59:34 INFO SparkEnv: Registering OutputCommitCoordinator
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:35.321 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:34 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
	24/04/24 10:59:34 INFO Utils: Successfully started service 'SparkUI' on port 4040.
	24/04/24 10:59:34 INFO SparkContext: Added JAR file:///tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_packages/spark-sql-kafka-0-10_2.13-3.5.1.jar at spark://6b0330d1bc18:36835/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713927573506
	24/04/24 10:59:34 INFO SparkContext: Added file file:///local_storage/reddit/processing/500-20240423.json at file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713927573506
	24/04/24 10:59:34 INFO Utils: Copying /local_storage/reddit/processing/500-20240423.json to /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/500-20240423.json
	24/04/24 10:59:34 INFO Executor: Starting executor ID driver on host 6b0330d1bc18
	24/04/24 10:59:34 INFO Executor: OS info Linux, 6.5.0-28-generic, amd64
	24/04/24 10:59:34 INFO Executor: Java version 1.8.0_402
	24/04/24 10:59:34 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
	24/04/24 10:59:34 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@4845525 for default.
	24/04/24 10:59:34 INFO Executor: Fetching file:///local_storage/reddit/processing/500-20240423.json with timestamp 1713927573506
	24/04/24 10:59:34 INFO Utils: /local_storage/reddit/processing/500-20240423.json has been previously copied to /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/500-20240423.json
	24/04/24 10:59:34 INFO Executor: Fetching spark://6b0330d1bc18:36835/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar with timestamp 1713927573506
	24/04/24 10:59:34 INFO TransportClientFactory: Successfully created connection to 6b0330d1bc18/172.18.1.1:36835 after 42 ms (0 ms spent in bootstraps)
	24/04/24 10:59:34 INFO Utils: Fetching spark://6b0330d1bc18:36835/jars/spark-sql-kafka-0-10_2.13-3.5.1.jar to /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/fetchFileTemp177320202170562313.tmp
	24/04/24 10:59:34 INFO Executor: Adding file:/tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/spark-sql-kafka-0-10_2.13-3.5.1.jar to class loader default
	24/04/24 10:59:34 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45387.
	24/04/24 10:59:34 INFO NettyBlockTransferService: Server created on 6b0330d1bc18:45387
	24/04/24 10:59:34 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
	24/04/24 10:59:34 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 6b0330d1bc18, 45387, None)
	24/04/24 10:59:34 INFO BlockManagerMasterEndpoint: Registering block manager 6b0330d1bc18:45387 with 366.3 MiB RAM, BlockManagerId(driver, 6b0330d1bc18, 45387, None)
	24/04/24 10:59:34 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 6b0330d1bc18, 45387, None)
	24/04/24 10:59:34 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 6b0330d1bc18, 45387, None)
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:36.324 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	
	
	
	 /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/500-20240423.json 
	
	
	
	24/04/24 10:59:35 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 345.6 KiB, free 366.0 MiB)
	24/04/24 10:59:35 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 32.7 KiB, free 365.9 MiB)
	24/04/24 10:59:35 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 6b0330d1bc18:45387 (size: 32.7 KiB, free: 366.3 MiB)
	24/04/24 10:59:35 INFO SparkContext: Created broadcast 0 from wholeTextFiles at NativeMethodAccessorImpl.java:0
	24/04/24 10:59:35 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
	24/04/24 10:59:35 INFO SharedState: Warehouse path is 'file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark-warehouse'.
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:37.392 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7441860465116279 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:41.479 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:40 INFO CodeGenerator: Code generated in 441.017287 ms
	24/04/24 10:59:40 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:59:40 INFO FileInputFormat: Total input files to process : 1
	24/04/24 10:59:40 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
	24/04/24 10:59:40 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
	24/04/24 10:59:40 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
	24/04/24 10:59:40 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:59:40 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:59:40 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:59:40 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 24.1 KiB, free 365.9 MiB)
	24/04/24 10:59:40 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 11.4 KiB, free 365.9 MiB)
	24/04/24 10:59:40 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 6b0330d1bc18:45387 (size: 11.4 KiB, free: 366.3 MiB)
	24/04/24 10:59:40 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:59:40 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:59:40 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
	24/04/24 10:59:41 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (6b0330d1bc18, executor driver, partition 0, PROCESS_LOCAL, 8176 bytes) 
	24/04/24 10:59:41 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
	24/04/24 10:59:41 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/500-20240423.json:0+147333
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:42.489 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:41 INFO CodeGenerator: Code generated in 29.238552 ms
	24/04/24 10:59:42 INFO PythonRunner: Times: total = 598, boot = 418, init = 168, finish = 12
	24/04/24 10:59:42 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2947 bytes result sent to driver
	24/04/24 10:59:42 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1093 ms on 6b0330d1bc18 (executor driver) (1/1)
	24/04/24 10:59:42 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
	24/04/24 10:59:42 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 42843
	24/04/24 10:59:42 INFO DAGScheduler: ResultStage 0 (json at NativeMethodAccessorImpl.java:0) finished in 1.222 s
	24/04/24 10:59:42 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:59:42 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
	24/04/24 10:59:42 INFO DAGScheduler: Job 0 finished: json at NativeMethodAccessorImpl.java:0, took 1.320997 s
	
	
	
	 1 
	
	
	
	
	
	
	 2 
	
	
	
	
	
	
	 3 
	
	
	
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:43.492 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	
	
	
	 4 
	
	
	
	24/04/24 10:59:42 INFO CodeGenerator: Code generated in 37.690724 ms
	24/04/24 10:59:43 INFO CodeGenerator: Code generated in 48.126507 ms
	24/04/24 10:59:43 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 6b0330d1bc18:45387 in memory (size: 11.4 KiB, free: 366.3 MiB)
	24/04/24 10:59:43 INFO SparkContext: Starting job: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py:84
	24/04/24 10:59:43 INFO DAGScheduler: Got job 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py:84) with 1 output partitions
	24/04/24 10:59:43 INFO DAGScheduler: Final stage: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py:84)
	24/04/24 10:59:43 INFO DAGScheduler: Parents of final stage: List()
	24/04/24 10:59:43 INFO DAGScheduler: Missing parents: List()
	24/04/24 10:59:43 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0), which has no missing parents
	24/04/24 10:59:43 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 62.8 KiB, free 365.9 MiB)
	24/04/24 10:59:43 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 22.6 KiB, free 365.8 MiB)
	24/04/24 10:59:43 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 6b0330d1bc18:45387 (size: 22.6 KiB, free: 366.2 MiB)
	24/04/24 10:59:43 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1585
	24/04/24 10:59:43 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[19] at toJavaRDD at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
	24/04/24 10:59:43 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
	24/04/24 10:59:43 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (6b0330d1bc18, executor driver, partition 0, PROCESS_LOCAL, 8176 bytes) 
	24/04/24 10:59:43 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
	24/04/24 10:59:43 INFO WholeTextFileRDD: Input split: Paths:/tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/userFiles-b112604c-3e41-4134-ac6a-c607fc12f43a/500-20240423.json:0+147333
	24/04/24 10:59:43 INFO CodeGenerator: Code generated in 14.16277 ms
	24/04/24 10:59:43 INFO CodeGenerator: Code generated in 9.974984 ms
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:43.496 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7421203438395416 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:44.494 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:44 INFO CodeGenerator: Code generated in 17.946452 ms
	24/04/24 10:59:44 INFO CodeGenerator: Code generated in 16.891794 ms
	24/04/24 10:59:44 INFO CodeGenerator: Code generated in 70.224748 ms
	24/04/24 10:59:44 INFO PythonRunner: Times: total = 110, boot = -1218, init = 1319, finish = 9
[WI-0][TI-0] - [INFO] 2024-04-24 10:59:45.495 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	24/04/24 10:59:44 INFO CodeGenerator: Code generated in 105.816301 ms
	24/04/24 10:59:44 INFO PythonUDFRunner: Times: total = 945, boot = 656, init = 288, finish = 1
	24/04/24 10:59:44 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 135926 bytes result sent to driver
	24/04/24 10:59:44 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1549 ms on 6b0330d1bc18 (executor driver) (1/1)
	24/04/24 10:59:44 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
	24/04/24 10:59:44 INFO DAGScheduler: ResultStage 1 (collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py:84) finished in 1.590 s
	24/04/24 10:59:44 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
	24/04/24 10:59:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
	24/04/24 10:59:44 INFO DAGScheduler: Job 1 finished: collect at /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py:84, took 1.603091 s
	{"user":"NekoIdo","content":"https://preview.redd.it/u68bjywya5wc1.png?width=808&format=png&auto=webp&s=d42529d6566d93e3df2f8be398afd887a258d020\n\nFound the deleted post [here](https://www.reddit.com/r/SGExams/comments/1capzon/hi_i_am_the_driver_of_snh7z_i_would_like_to_clear/).  \nMain content has been deleted by mods but the comments are definitely not buying his excuse.\n\nAlso someone else posted another captured instance of this same driver being a road menace here:  \n[https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/](https://forums.hardwarezone.com.sg/threads/gvgt-snh7z-mercedes-glc43-tailgating-cambike-try-to-force-cambike-off-the-road.7022346/)\n\nPersonally I think it's really lucky for this Benz driver that the SAAB driver survived, or the spotlight would shine solely on him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":341,"subreddit":"singapore","type":"post","id":"1cau62k","datetime":"2024-04-23 11:06:00"}
	{"user":"dylank999","content":"Speeding up to prevent people from changing lane/overtaking. \n\nNumber 1 ego of Singapore drivers. It's a pandemic on our roads.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9els/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":395,"subreddit":"singapore","type":"comment","id":"l0u9els","datetime":"2024-04-23 11:38:17"}
	{"user":"pureeyes","content":"All he had to do was say nothing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uau6z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":197,"subreddit":"singapore","type":"comment","id":"l0uau6z","datetime":"2024-04-23 11:49:38"}
	{"user":"PhantomWolf83","content":">my thought was to tell the SAAB driver to slow down, hence I sped up while he was overtaking\n\n???????","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u5ykg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":365,"subreddit":"singapore","type":"comment","id":"l0u5ykg","datetime":"2024-04-23 11:11:50"}
	{"user":"I_Miss_Every_Shot","content":"Basic Theory or Advance Theory should include a psycho-emotional assessment. People who registered increased heart rate/ BP/ stress or inclination to speed up/ overtake when overtaken or have their lane cut into should undergo mandatory counselling or be denied their license altogether.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uas8s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":115,"subreddit":"singapore","type":"comment","id":"l0uas8s","datetime":"2024-04-23 11:49:11"}
	{"user":"BinaryDoom","content":"It's precisely because there are immature drivers on the road, such behavior would only make driving in Singapore unpleasant. The white Merc driver is not the only one. It could have been someone else. Anyway, based on the footage, from the way he has executed it, I wouldn't buy his claim of wanting the black driver to slow down by speeding up. Only when you practice enough of this, it becomes a natural reaction.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaru6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0uaru6","datetime":"2024-04-23 11:49:06"}
	{"user":"testercheong","content":"I'm more curious as to why its posted on sgexams though","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uamri/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":72,"subreddit":"singapore","type":"comment","id":"l0uamri","datetime":"2024-04-23 11:47:59"}
	{"user":"adept1onreddit","content":"Regardless of what he thinks about the whole situation, the smart option would be to keep his mouth shut. Who knows what kind of legal issues may arise.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucey8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":27,"subreddit":"singapore","type":"comment","id":"l0ucey8","datetime":"2024-04-23 12:02:25"}
	{"user":"Background_Tax_1985","content":"His reasons are bs but that does not deviate from the fact that the accident was 100% caused by the saab driver (sd). \n\nEven before the mercedes driver (md) sped up to block the sd, sd was already speeding. Just a side note, if md and sd were racing each other we would have seen it from the first vehicle camera footage of the accident from the other merc, which we did not. \n\nIs md wrong and a dick? Yes. Did md commit an offence by driving in that manner? Maybe. Did he cause the accident? No.\n\nBecause after side swiping md, sd could have stopped. He had all the time and distance in the world to stop but he decided to speed on into the distance instead. \n\nThere is literally 2 school zones after that junction where the accident took place. If he had not gotten into an accident there, he could potentially have plowed into alot of kids, since the accident took place at school start time.\n\nSd really needs to be serverly punished for this.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7xwv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":193,"subreddit":"singapore","type":"comment","id":"l0u7xwv","datetime":"2024-04-23 11:26:49"}
	{"user":"blitzmango","content":"So desperate to defend his actions that he created 3 threads but looks like its gonna back fire instead. If it weren't for the second video incident, I might have given him the benefit of doubt, but sorry no.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7mlk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":57,"subreddit":"singapore","type":"comment","id":"l0u7mlk","datetime":"2024-04-23 11:24:24"}
	{"user":"top1global","content":"In the end, he is posting it to defend himself and blame others. 0 apology or remorse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubg1n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":48,"subreddit":"singapore","type":"comment","id":"l0ubg1n","datetime":"2024-04-23 11:54:35"}
	{"user":"Stripey7676","content":"Theres a huge debate over at EDMW whether any blame should be placed white merc. Now, the saab is 120% at fault. No doubt about that. However, while white merc is not criminally liable, he definitely contributed to the chain of events leading to the accident due to his ungracious, undefensive driving. \n\nFrom the vid, 2 things were evident \n\n1. Saab panic after clipping merc (who sped up to prevent overtaking). \n2. Saab went crazy fast after clipping as if to escape confrontation. \n\nIm betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThings would have been very different is merc slowed down, like a defensive driver would, when encountering siao langs on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud13l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":42,"subreddit":"singapore","type":"comment","id":"l0ud13l","datetime":"2024-04-23 12:07:31"}
	{"user":"FalseAgent","content":"yet another retarded sg driver. so what if others are speeding? you stick to the speed limit and drive safe. End of story. Everyone do this and play their part, we get safer roads. No need to be hero","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uep1i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0uep1i","datetime":"2024-04-23 12:21:36"}
	{"user":"Ceeja_y","content":"he wanted to post here but his acc didnt meet the requirements lol. oh well, he would still get an earful even if he did post here","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u77vi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":34,"subreddit":"singapore","type":"comment","id":"l0u77vi","datetime":"2024-04-23 11:21:18"}
	{"user":"BakeMate","content":"Hope the guilt eats him from inside. With more video surfacing of his driving behavior, he can write 10000 words essay all he wants, still a piece of shit\n\n> assuming I'm always like that\n\nYes you are. Nothing changed. It's a matter of whether you're caught on camera or not, and whether people want to upload","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7lcc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":76,"subreddit":"singapore","type":"comment","id":"l0u7lcc","datetime":"2024-04-23 11:24:08"}
	{"user":"MyColdDeadHandz","content":">As for the motorcycle incident, the motorcyclist was hogging the road, preventing me from going forward\n\nBut that was a single lane? Motorcyclist had all the right to be there in the middle of that lane. I've seen many drivers file up in two lines (when the road was wide enough, like in the clip) when filtering into an expressway, but this is the first time I've seen someone feel entitled in doing it.\n\nSounds like a real piece of work.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahrp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0uahrp","datetime":"2024-04-23 11:46:52"}
	{"user":"tolifeonline","content":"One young life was ended prematurely. The saying \"no parents should ever have to bury their child\" rings heavy in this incident. Imagine how inconsolable the father will be after waking up to find out his child has been taken away forever from him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2j2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uc2j2","datetime":"2024-04-23 11:59:38"}
	{"user":"dibidi","content":"his lawyers seeing his post: $$$$$$$","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udihn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0udihn","datetime":"2024-04-23 12:11:30"}
	{"user":"Initial_E","content":"In the 2-3 seconds of the incident both drivers were not making a conscious decision to goad each other, instead they were doing what they conditioned themselves to do. \nThere's no point asking \"what was going through his head\", it's what goes through his head every time he is behind the wheel that counts.\n\n\nSo it is with defensive driving. If it is a hat that you wear on your head, it should go on as automatically as wearing your seatbelt, should stay on for about just as long as you are wearing that seatbelt. And you can condition yourself to make it automatic. See, you already did it to wear a seatbelt.\n\nYou can't practice defensive driving only when you are nearly doing something dangerous, that's not how it works.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhxwn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhxwn","datetime":"2024-04-23 12:48:53"}
	{"user":"Common-Metal8578","content":"Heard other videos of him being an asshole driver are surfacing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo4s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ufo4s","datetime":"2024-04-23 12:30:00"}
	{"user":"KneeGal","content":"This Benz driver is an idiot but if you look at his [dashcam](https://imgur.com/a/YuwFzNz), after the contact, there is plenty of road left for the SAAB driver to brake. Instead it seems he sped up and ran directly into traffic. \n\nThe point of contact happened so far away from the junction that his involvement would have made no difference to the outcome.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0uea8q","datetime":"2024-04-23 12:18:02"}
	{"user":"ProfessionalMottsman","content":"Wow what a fool, never say anything in an accident as directed by your insurance company, they can refuse to cover you if you admit liability","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubboi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ubboi","datetime":"2024-04-23 11:53:37"}
	{"user":"RiskDry6267","content":"This merc also scum, open mouth to dig ownself bigger hole, edmw hurry up name and shame !","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhzil/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uhzil","datetime":"2024-04-23 12:49:17"}
	{"user":"Yokies","content":"Dude can't keep his mouth shut to save himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9hwk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":19,"subreddit":"singapore","type":"comment","id":"l0u9hwk","datetime":"2024-04-23 11:38:59"}
	{"user":"isleftisright","content":"Sd caused the accident by himself. He clearly had time to stop at the light but didnt. \n\nMd is a rude driver nonethless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdok/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubdok","datetime":"2024-04-23 11:54:03"}
	{"user":"CedaraThursday1314","content":"Self saboing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawb2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0uawb2","datetime":"2024-04-23 11:50:06"}
	{"user":"dibidi","content":"the root cause here is that there is no driving culture of giving way. \n\nevery driver drives like a race car driver. bec they see any pass by any other road user as a slight and sign of disrespect. \n\nroad safety will never be addressed in Singapore as long as gov doesnt address this culture.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udrb4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0udrb4","datetime":"2024-04-23 12:13:32"}
	{"user":"Formal_Judgment6481","content":"One of the most dumbass excuses. Hope this accident will forever haunt you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugemm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ugemm","datetime":"2024-04-23 12:35:58"}
	{"user":"peterthewiserock","content":"Benz drivers lawyer is going to have a field day with that post.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugfe6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ugfe6","datetime":"2024-04-23 12:36:07"}
	{"user":"subzephyr","content":"why tf he posting on a kids subreddit","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucyms/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ucyms","datetime":"2024-04-23 12:06:57"}
	{"user":"Ok-Tap4277","content":"Terrible cost to his behaviour escalating a bad situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufo9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ufo9n","datetime":"2024-04-23 12:30:02"}
	{"user":"pudding567","content":"What if the driver decides to sue for defamation? There is a Defence of Justification (truth) and Fair Comment though.\nhttps://irblaw.com.sg/learning-centre/defamation-in-singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2cj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh2cj","datetime":"2024-04-23 12:41:17"}
	{"user":"meister00","content":"He might or might not have indirect involvement in the accident (the accident might have still occurred even if he wasn't there), but regardless of that the merc driver is sure one of those asshole drivers.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9dc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uh9dc","datetime":"2024-04-23 12:42:55"}
	{"user":"raymmm","content":"Just like how he sped up to \"tell\" the other driver to slow down. People are treating him like shit to \"tell\" him to stop being an asshole to other motorists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhdcb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhdcb","datetime":"2024-04-23 12:43:52"}
	{"user":"DiscipleOfYeshua","content":"1. This the guy behind the one who rushed into red light, yes?\n\nThe one behind directly (on right) or the one on left?\n\n2. Motorcycle prevented me moving forward means too slow for my taste / made me lose 12.3 seconds on way to red light? I mean, motorcycle didnt outright stop in the road, was just 10 kph too slow for this guy?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhv2v/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uhv2v","datetime":"2024-04-23 12:48:11"}
	{"user":"jayaxe79","content":"Seems like the more he explained, more questions arises.\n\n- So he tried to push the blame away yet doesn't blame everyone for pointing the finger at him?\n\n- Did his actions actually indirectly caused the Saab driver to go crazy? By just speeding up to prevent overtaking? \n\nHe claimed that he isn't \"like the person outside these incidents\". Who the hell believes this statement?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8jiu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0u8jiu","datetime":"2024-04-23 11:31:31"}
	{"user":"okayokaycancan","content":"Take both off the roads and it will be a safer place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua4b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua4b7","datetime":"2024-04-23 11:43:52"}
	{"user":"stickytofw","content":"Everything he does from his driving, both during the time leading up to and outside of the recent tragedy, to his Reddit apology message just screams ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugc7m/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ugc7m","datetime":"2024-04-23 12:35:27"}
	{"user":"xthekonmanx","content":"And still not a single apology or sympathy for the accident victims super lanjiao lang! He did apologize for the long post though ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh9tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uh9tv","datetime":"2024-04-23 12:43:02"}
	{"user":"AdministrativeGas324","content":"This guy is so smart that he bid for his car licence plate number using his IQ score.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui1li/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui1li","datetime":"2024-04-23 12:49:48"}
	{"user":"Merecat-litters","content":"uh why this bastard what to \"Self Justification\" here. fk you mate...give Self Justification when giving your testimony in court you donkey see if they like.\n\nYou only saying this because you were one of the factor of the accident and were caught in the act you and are not sorry for it to happen but sorry for getting caught in the act. The way I am interpreting the writing is  to make you not be responsible fully but blame it on others. knnccb\n\nHopefully mod dont remove this too...and hopefully we can see this fucker face when they go to court cant wait to see the case.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui2c0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0ui2c0","datetime":"2024-04-23 12:49:59"}
	{"user":"crassina","content":"Can he also be charged with dangerous driving causing death? Because his actions seemed pretty dangerous to me","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicnq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uicnq","datetime":"2024-04-23 12:52:34"}
	{"user":"random_thoughts5","content":"Why did he post it in the sgexams subreddit? Isnt that a subreddit for secondary and JC students?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9tgk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9tgk","datetime":"2024-04-23 11:41:32"}
	{"user":"noelsupertramp","content":"Two cars racing each other on the premise of trying to slow the other party down. Nobody is gonna buy this reason.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubkkn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ubkkn","datetime":"2024-04-23 11:55:38"}
	{"user":"AsuraPhantoma","content":"The moment you sped up near a cross junction (or really, speeding up in general) you already lost the right to argue or say anything","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiai2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiai2","datetime":"2024-04-23 12:52:01"}
	{"user":"laubase","content":"I have never seen a Merc being driven competently on Singapore roads in 37 years. No signal before switching lanes? Probably a Merc. Intentionally cutting queues? Probably a Merc. Not checking blind spot before switching lanes? Probably a Merc. \"Lane splitting\" to deny others from overtaking them? Probably a Merc.The list goes on and on. \n\nI swear something drives (pun intended) these kinda people to buy Mercs, probably because they're trying to signal (again, pun intended) their superiority to the average Singaporean. \"Look at what I can afford, you plebs better give way to me because I am THAT much more important than you.\".\n\nAnyone buying a Merc should be subject to a compulsory TP road test.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uevgx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uevgx","datetime":"2024-04-23 12:23:07"}
	{"user":"freshcheesepie","content":"Good I can sleep well knowing that the comments are affecting him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6rnh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u6rnh","datetime":"2024-04-23 11:17:47"}
	{"user":"DeeKayNineNine","content":"To be fair, the Merc driver didn't cause the accident and didn't contribute to the cause of the accident. It would have happen with or without the Merc driver. The Saab was already speeding. \n\nWe still don't know what is wrong with that Saab driver. Was he drunk? Under drug? No license? Or just some reckless driver? We don't know yet. Let's wait for the authorities to release more info. \n\nThe merc driver is a jerk. You can see that from the other video. And I'm sure there are more. But he didn't cause the accident. And I hope this accident is a wake up call for him and will make him change to be a better driver from now on. Else we can be sure we'll see him online again.\n\nBy the way, I wonder if the Merc has car camera. I think he got an unblock view of the entire accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufjru/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufjru","datetime":"2024-04-23 12:28:57"}
	{"user":"Prov0st","content":"Why is everyones eyes on the white mercs?? The SAAB was doing the speeding. The white mercs is not free of sin but ultimately the direct culprit is the saab.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua3pq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ua3pq","datetime":"2024-04-23 11:43:44"}
	{"user":"Dulio_rosward","content":"If he truly felt guilty, then he should have been reflecting more on his actions since he contributed to the loss of those 2 lives.\n\nInstead he chose to spend his time trying to rationalise his actions to netizens.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8inb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0u8inb","datetime":"2024-04-23 11:31:20"}
	{"user":"Chrissylumpy21","content":"This guy needs to be banned from driving. Hes just sorry he got caught thats all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9s9o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u9s9o","datetime":"2024-04-23 11:41:16"}
	{"user":"deangsana","content":"he doth protest too much","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uegtx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uegtx","datetime":"2024-04-23 12:19:40"}
	{"user":"ThenCheesecake","content":"shouldnt this explanation be taken with a grain of salt cause we cant confirm it was actually written by the driver themselves?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufqt7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufqt7","datetime":"2024-04-23 12:30:37"}
	{"user":"PartTimeBomoh","content":"Streisand effect. I didnt think anything of him till he decided to write this post","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo92/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ugo92","datetime":"2024-04-23 12:38:01"}
	{"user":"canceler80","content":"No proof that user is actual driver. Can be a troll account","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uixvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uixvo","datetime":"2024-04-23 12:58:00"}
	{"user":"livinglifeingrieve","content":"Lawyer: okay. 2 years jail. If good boy can come out in 8 months. 5 years ban on driving.\nJudge: okeh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj8x8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj8x8","datetime":"2024-04-23 13:00:50"}
	{"user":"Familiar_Guava_2860","content":"Where is the logic in one speeding up  to tell \nan overtaking driver to slow down?!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj9pb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uj9pb","datetime":"2024-04-23 13:01:03"}
	{"user":"FitCranberry","content":"just another reminder that there can be people out there with a completely different headspace thats incomprehensible to yourself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujkc6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujkc6","datetime":"2024-04-23 13:03:48"}
	{"user":"Noobcakes19","content":"some of my previous post about this asshole was downvoted.\n\nwe saw his action on various dashcam including his own, He's indeed a major egoistic asshole.\n\neveryone : White merc driver is an asshole\n\nwhite merc driver:  Hold my beer..... I AM AN asshole!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtzb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtzb","datetime":"2024-04-23 13:06:18"}
	{"user":"Dizzy_Boysenberry499","content":"If you check One Motoring, he deregistered his car on 22 April","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk0k6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk0k6","datetime":"2024-04-23 13:08:02"}
	{"user":"KBDMASS","content":"surprisingly, most drivers have such mentality of speeding so that the other person wont over take.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklgb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklgb","datetime":"2024-04-23 13:13:37"}
	{"user":"signinj","content":"Oh no! The internet is judging me for my driving! Better come up with a WOT. That surely will make things better","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ule7o/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ule7o","datetime":"2024-04-23 13:21:28"}
	{"user":"heyearthdude","content":"His stupidity knows no bounds. Who uses words like overkill when writing about a fatal accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ultcm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ultcm","datetime":"2024-04-23 13:25:41"}
	{"user":"Vindicted1501","content":"Just surrender to TP and they will investigate how much of a safe driver he is.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umjes/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umjes","datetime":"2024-04-23 13:33:00"}
	{"user":"EnvironmentalExam784","content":"Someone need to CSI this douchebag face out please.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzee/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzee","datetime":"2024-04-23 13:37:38"}
	{"user":"andrew_marc","content":"just by the way it is written you can tell he/she is self entitled/ultra defensive and someone who is never in the wrong","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umzwi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umzwi","datetime":"2024-04-23 13:37:46"}
	{"user":"Frequent-Switch-5699","content":"to the op: what you said, how you explain yourself is no longer useful now. Get ready for a session of formal investigation and get yourself a good lawyer to defend for yourself if you can afford. We shall let the evidence speak for itself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un2t4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un2t4","datetime":"2024-04-23 13:38:37"}
	{"user":"LT-Ghastly","content":"Just arrest this guy as well, for the safety of others and road users.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubcnm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ubcnm","datetime":"2024-04-23 11:53:49"}
	{"user":"HalcyoNighT","content":"Wait why tf did the merc driver make his post on r/sgexams? This is not TP exam","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubc60/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ubc60","datetime":"2024-04-23 11:53:43"}
	{"user":"pyroSeven","content":"Ask him to slow down by speeding up. Very good, didnt know they taught this at driving school \n\n\nSuck my lanjiao la.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udw03/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0udw03","datetime":"2024-04-23 12:14:40"}
	{"user":"jackgermeister","content":"Can ask him to post the unmuted version of the dashcam, then? Since he claimed to toot the motorcyclist, or ask the Saab driver to slowdown.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uedza/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uedza","datetime":"2024-04-23 12:18:59"}
	{"user":"Alive_Ad7522","content":"What the bull shit. Absolutely no remorse at all. Sick mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8v1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0u8v1q","datetime":"2024-04-23 11:33:55"}
	{"user":"Spiritual-Okra-7836","content":"oh my god this guy is a fucking moron. Take his license away NOW.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua8ut/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua8ut","datetime":"2024-04-23 11:44:52"}
	{"user":"lvofdifficulties","content":"Why did he post at /r/SGExams? He's a student?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9954/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0u9954","datetime":"2024-04-23 11:37:02"}
	{"user":"hawk_199","content":"Haha Streisand effect in play...if he didn't post this within a few days/weeks he would have been forgotten.\n\nGo and post this stupid justification and shoot himself","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhs1l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhs1l","datetime":"2024-04-23 12:47:25"}
	{"user":"CrossfittJesus","content":"Might be a hot take here but while the Merz is an asshole driver, I see the precious video of him a couple of days before the Tampines incident and the incident itself as mutually exclusive. IMO he didnt have that big a role to play in the Saab incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk9qq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk9qq","datetime":"2024-04-23 13:10:30"}
	{"user":"smurflings","content":"Not agreeing or disagreeing with this guy but why are people chewing him out for that incident? It's entirely the Saab driver's fault.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8rzg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0u8rzg","datetime":"2024-04-23 11:33:16"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue69a/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue69a","datetime":"2024-04-23 12:17:05"}
	{"user":"Winner_takesitall","content":"A sad by-product of our hyper competitive society: being unable to give, only know how to take..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uja1t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uja1t","datetime":"2024-04-23 13:01:08"}
	{"user":"foodloveroftheworld","content":"**When your 1000-word essay is due but you've only got 100 words of pure self-justification that miss the whole point.**","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukuo6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukuo6","datetime":"2024-04-23 13:16:05"}
	{"user":"MurkyConsideration98","content":"This chap is delulu.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uma4k/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uma4k","datetime":"2024-04-23 13:30:22"}
	{"user":"darrenoloGy","content":"typical narcissistic response.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un645/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un645","datetime":"2024-04-23 13:39:37"}
	{"user":"appealban","content":"this here is peak example of egoism/narcissism. gold medal mental gymnastics. hopefully the driver reads this and wake up his idea.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unvuv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unvuv","datetime":"2024-04-23 13:47:11"}
	{"user":"PerformanceCheap4074","content":"Gua Lan C**t with his GLC Mercs","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoefq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoefq","datetime":"2024-04-23 13:52:42"}
	{"user":"khaosdd","content":"A rich, GoonduLoserCunt-class driving asshole posting on an obscure subreddit?\n\nAlso glc camcar footage was uploaded by one Anthony Soon on fb who already locked his profile and disabled all comments. From the look of his profile and style, he doesn't seem like those who will browse reddit, much less r/SGExams.\n\nSo the op who posted there seems kinda sus to me. Could be an impersonator.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujb9c/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujb9c","datetime":"2024-04-23 13:01:26"}
	{"user":"buffyfluffy","content":"Yall gotta stop finding reasons to blame someone. Speeding on roads happen every single day in every single part of SG. Yes it's wrong, but that's not the reason for the 2 deaths. Speeding dont cause people to speed through a cross junction on a red light. Even on expressways you see those typical Ah beng BMW/VW/Mini speeders, they cut in and out dangerously but still manage to brake on time and cut in when the gap is right. This SAAB driver decided to try out GTA in real life but people still trying to find rationalize and find more people to blame in order to cope with this tragedy.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugr9t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugr9t","datetime":"2024-04-23 12:38:42"}
	{"user":"JakeAndRay","content":"When i first made comments about this guy i get downvoted like no ones business, now everyone shitting on him? Very good guys. Supreme echo chamber in here. \n\nSame shit happened during the initial covid outbreak. I say just stay home, not difficult exercise at home etc. Learn to think for yourselves guys. Pls downvote me no problem","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulxz7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulxz7","datetime":"2024-04-23 13:26:58"}
	{"user":"meowinbox","content":"How can you be so sure that's him though? Could be some reddit troll out to rage bait. Did he give any proof of identity?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u7su1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0u7su1","datetime":"2024-04-23 11:25:45"}
	{"user":"Calamity_B4_Storm","content":"He thought he is playing uno but it all turn out to be oh no people Jia sai he also Jia Sai meh.. now he really KNS","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u99sb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0u99sb","datetime":"2024-04-23 11:37:10"}
	{"user":"Ambitious-Kick6468","content":"We should have a law to charge people who speed up when others are overtaking.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uejf9","datetime":"2024-04-23 12:20:17"}
	{"user":"imivan111","content":"Give this cunt the death penalty","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugo5w/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ugo5w","datetime":"2024-04-23 12:38:00"}
	{"user":"snookajam","content":"All the comments on driving should come with an identifier on how long the commentor has been driving on sg roads. Reading too many ridiculous things on the issue from people who probably dont know about the intricacies of driving on sg roads, or that road in particular.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueo81/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-3,"subreddit":"singapore","type":"comment","id":"l0ueo81","datetime":"2024-04-23 12:21:24"}
	{"user":"ProfessionalMottsman","content":"This is so common and its so dangerous. Do people not know there doing it ?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub6wi/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":47,"subreddit":"singapore","type":"comment","id":"l0ub6wi","datetime":"2024-04-23 11:52:31"}
	{"user":"DiscipleOfYeshua","content":"Also boarding bus. \n\nWhen the side-loader aunties and occasional uncle pretend to not notice we all queuing, I sometimes hold my hands up to the sunlight to check whether Ive turned to a transparent ghost.\n\nLess risk of injury and death. Similar mindset.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh7b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0uh7b7","datetime":"2024-04-23 12:42:27"}
	{"user":"RecognitionIcy7396","content":"I have driven in many countries and my observation is that Singaporeans are quite nice in real life but are really selfish drivers. How is it logical for someone to think that speeding up is going to get someone else to slow down?\n\nAnd if someone wants to come into your lane, maybe just let them? This guy keeps saying he had an emergency to attend to but maybe he should have left earlier or prepared more in advance so that he doesnt have to use these dangerous tactics. His poor planning shouldnt put everyone elses lives in danger.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugndy/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":16,"subreddit":"singapore","type":"comment","id":"l0ugndy","datetime":"2024-04-23 12:37:50"}
	{"user":"Lv3_Potato_Farmer","content":"Just because everyone is doing it doesnt make it right","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uawvv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0uawvv","datetime":"2024-04-23 11:50:14"}
	{"user":"Realistoliberato","content":"It's of waste of fuel. And fuel is bloody expensive in Singapore","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uizax/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uizax","datetime":"2024-04-23 12:58:22"}
	{"user":"CriticizeSpectacle7","content":"This is the reason sg drivers don't signal. Once u signal, ppl will simply speed up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue2rg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":14,"subreddit":"singapore","type":"comment","id":"l0ue2rg","datetime":"2024-04-23 12:16:16"}
	{"user":"MessyBoomer","content":"I swear some drivers speed up when I approach a pedestrian crossing to try and go through before I start crossing too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj6nk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uj6nk","datetime":"2024-04-23 13:00:15"}
	{"user":"Diligent_Soup_1069","content":"Definitely,many a times I have signaled to exit out of the highway but motorbikes and cars on the slower lanes will just speed up past you suddenly as if you signaling is a sign that there's a GSS right up ahead. \n\nThe mercedes has nothing to do with the accident persay but I do feel TP should at least look into his reckless driving habits and ego issues on the road.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk6k4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk6k4","datetime":"2024-04-23 13:09:38"}
	{"user":"MicTest_1212","content":"Now he admitted publicly in black and white that he did speed up to prevent the Saab from taking over. \n\n Stupid, Egoistic, and Narcissistic ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerc7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":135,"subreddit":"singapore","type":"comment","id":"l0uerc7","datetime":"2024-04-23 12:22:08"}
	{"user":"drinkingbobatea","content":"He had to.... bc he is trying his absolute hardest to be a genuinely nice person...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucbip/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":45,"subreddit":"singapore","type":"comment","id":"l0ucbip","datetime":"2024-04-23 12:01:39"}
	{"user":"transcendcosmos","content":"I think he had to cos his name was already doxxed in HWZ. Had a separate incident a few days before where he behaved terribly too.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufnzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ufnzd","datetime":"2024-04-23 12:29:57"}
	{"user":"Brief_Worldliness162","content":"Smh","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufl9p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufl9p","datetime":"2024-04-23 12:29:19"}
	{"user":"Fensirulfr","content":"I agree. From the available videos, it is not exactly clear what was the white car's intention at first. He probably should have asked a lawyer to read through what he was about to post online.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulykc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulykc","datetime":"2024-04-23 13:27:08"}
	{"user":"uniquely_ad","content":"I was right all along, drive long enough and I know what the merc was doing","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un92f/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un92f","datetime":"2024-04-23 13:40:27"}
	{"user":"fredczar","content":"Its likely fake? How sure are we that this is the actual driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj10r/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uj10r","datetime":"2024-04-23 12:58:47"}
	{"user":"dylank999","content":"Better to close your mouth and let people think you're stupid than open it and prove it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujtay/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujtay","datetime":"2024-04-23 13:06:07"}
	{"user":"beklog","content":"same logic as with my ex:\n\n\"I cheated on u so u can pay attention to me\" \\___/","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u6owe/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":225,"subreddit":"singapore","type":"comment","id":"l0u6owe","datetime":"2024-04-23 11:17:12"}
	{"user":"icwiener25","content":"'Don't speed up if you see another vehicle trying to overtake you' is literally one of the first things that is taught in Basic Theory when taking one's license.\n\n  \nAuthorities should probably check whether he even has a valid drivers' license.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udsxf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":46,"subreddit":"singapore","type":"comment","id":"l0udsxf","datetime":"2024-04-23 12:13:55"}
	{"user":"Prov0st","content":"Typical mindset of some Singaporean drivers, overtaking/ signalling = I MUST SPEED UP!!!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9x86/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":52,"subreddit":"singapore","type":"comment","id":"l0u9x86","datetime":"2024-04-23 11:42:19"}
	{"user":"Jizzipient","content":"You see officer, I invited these young girls to my home to warn them about the dangers of what could have happened if you meet randos on the internet. It's educational!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahpl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0uahpl","datetime":"2024-04-23 11:46:52"}
	{"user":"Party-Ring445","content":"Cannot lose mentality..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucpiz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ucpiz","datetime":"2024-04-23 12:04:51"}
	{"user":"ihavenoidea90s","content":"This guy sucks at gaslighting as much as he does driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ualql/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ualql","datetime":"2024-04-23 11:47:45"}
	{"user":"Critwice","content":"he think he TP lmao, can't see through his big fat ego.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8622/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0u8622","datetime":"2024-04-23 11:28:35"}
	{"user":"kyrandia71","content":"Last time in driving school, the instructors teach you to slow down if someone is tailgating you and not speed up. Either slow down or just filter to left lane to let other vehicle overtake. Is like someone stare at you want to fight, instead of looking away or say sorry to de-escalate, one stares back and says, \"kua simi?\"","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaf6t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":23,"subreddit":"singapore","type":"comment","id":"l0uaf6t","datetime":"2024-04-23 11:46:17"}
	{"user":"Vedor","content":"Just goes to show how highly he thought of himself.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucnwd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0ucnwd","datetime":"2024-04-23 12:04:28"}
	{"user":"Pitiful_Blackberry67","content":"Exactly, What was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9ej5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0u9ej5","datetime":"2024-04-23 11:38:16"}
	{"user":"thewind21","content":"Driver thinks he is a vilgante. Upholding the traffic rules.\n\nEarn too much. Head too big","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueacq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ueacq","datetime":"2024-04-23 12:18:04"}
	{"user":"splash8388","content":"Correct. Why need to tell him to slow down by chasing him? Just let him (Saab driver) be.  He (saab) is responsible for his own action ultimately. Why get involved as if you can tell the Saab driver to slow down ?  Saab driver may think you are trying to race with him. \nIt's a double edge sword for the merc driver with this action.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uicrs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uicrs","datetime":"2024-04-23 12:52:35"}
	{"user":"roksah","content":"I think need IQ test instead of driver test","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiykm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uiykm","datetime":"2024-04-23 12:58:11"}
	{"user":"RealityLongjumping13","content":"If you are reading this and is really your thought at that point of time, it's WRONG.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9vf3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0u9vf3","datetime":"2024-04-23 11:41:56"}
	{"user":"TOFU-area","content":"smartest sg driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud4ez/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ud4ez","datetime":"2024-04-23 12:08:17"}
	{"user":"MilkTeaRamen","content":"Breaking News: Singapores driver population halves overnight. Government to temporary scrap COE measures. CAT A cars below 50k.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udilq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":63,"subreddit":"singapore","type":"comment","id":"l0udilq","datetime":"2024-04-23 12:11:31"}
	{"user":"mako-lollipop","content":"First time drivers would have a higher BP when they drive though. Need to make driving license expire after 10 years so have to retake","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea8d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0uea8d","datetime":"2024-04-23 12:18:02"}
	{"user":"CisternOfADown","content":"It seems all the driving lessons go out the window once they get licence. Drivers need a 'refresher'. I suggest licences to be renewable every 2 years with a theory test at least. I'm sick of seeing drivers zooming past zebra crossings or not waiting for pedestrians to completely cross at traffic lights.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uljvo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uljvo","datetime":"2024-04-23 13:23:03"}
	{"user":"Party-Ring445","content":"Brain is still in primary school","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udgx9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":59,"subreddit":"singapore","type":"comment","id":"l0udgx9","datetime":"2024-04-23 12:11:09"}
	{"user":"ilovenoodles06","content":"Guy is probably a rich kid i assume","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud5o1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ud5o1","datetime":"2024-04-23 12:08:35"}
	{"user":"Lostwhispers05","content":"Perhaps because he created a throwaway account and r/sgexams has less strict posting requirements? Just speculating - I don't actually know r/sgexam's posting requirements.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf3ll/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0uf3ll","datetime":"2024-04-23 12:25:04"}
	{"user":"captwaffles-cat","content":"Student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueq9n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ueq9n","datetime":"2024-04-23 12:21:53"}
	{"user":"FalseAgent","content":"because this subreddit is awful so now there are splinter communities","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uejgj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uejgj","datetime":"2024-04-23 12:20:18"}
	{"user":"canceler80","content":"Troll account and is fake?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um5fm/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um5fm","datetime":"2024-04-23 13:29:03"}
	{"user":"drlqnr","content":"not enough karma to post here i think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umfvp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umfvp","datetime":"2024-04-23 13:31:59"}
	{"user":"KopiSiewSiewDai","content":"I dont think the Merc driver is at fault for the accident at the cross junction. He is just a shitty driver who happened to be at the wrong place. \n\nThe bulk of the fault is still on the Saab driver","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zv4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":82,"subreddit":"singapore","type":"comment","id":"l0u9zv4","datetime":"2024-04-23 11:42:53"}
	{"user":"Carbonaddictxd","content":"Precisely, why are all the comments blaming md just because he's not a nice driver?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9bfs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9bfs","datetime":"2024-04-23 11:37:33"}
	{"user":"whimsicism","content":"This, it really feels like deflection to me when people blame the merc driver. He's a bad driver and annoying af but he didn't actually cause the incident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueie3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0ueie3","datetime":"2024-04-23 12:20:03"}
	{"user":"danorcs","content":"Unfortunately I think the Merc driver is partially responsible\n\nYou know exactly what the SBs defence attorney will say:\n\nyour honour, my client was travelling along the straight road and was changing lanes in the process of overtaking a motorbike when a white merc unexpectedly aggressively accelerated, sideswiping my clients car at high speed and nearly causing it to slide and mount the kerb \n\nThis was an accident that the merc driver could have prevented at anytime by not accelerating and allowing the SB to pass, despite his claims that he was potentially forced to mount a kerb\n\nMy client was shocked at being side swiped at high speed and in a lapse of judgement he panicked and accelerated away from the dangerous Merc driver\n\nMy client was so agitated by the aggressive Merc driver that he constantly kept checking for said driver on the rear wheel window, and most unfortunately failed to notice that he was reaching a red light, causing the tragic accident for which he is apologetically here today\n\nIf I provoke someone into a frenzied state and he accidentally kills someone in a fit of panic, I may still be culpable in SG. It would require detailed legal examination at the very least","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul678/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul678","datetime":"2024-04-23 13:19:15"}
	{"user":"Alive-Confection3690","content":"Idk i kinda disagree here. md didnt cause the accident but he definitely aggravated the sd driver partially to do it. Majority of the fault is still on the sd of course but if md could swallow that petty pride of being overtaken, this accident might not have happened.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf1ev/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uf1ev","datetime":"2024-04-23 12:24:31"}
	{"user":"Possible-Grocery6244","content":"i do think that the merc hold partial responsibility for the accident, or at least he was the catalyst for it. Assuming that SAAB was trying to do a hit and run after the sideswipe (not because of brake failure), merc not speeding up wouldnt have made SAAB driver to react the way he did. Now, im not saying that SAAB driver is absolved of any responsiblity, but the merc driver should be held accountable as well.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uea2p/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-9,"subreddit":"singapore","type":"comment","id":"l0uea2p","datetime":"2024-04-23 12:18:00"}
	{"user":"Party-Ring445","content":"Victim should sue him for all he's worth. And add to that criminal charge and canning","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud91d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ud91d","datetime":"2024-04-23 12:09:24"}
	{"user":"Geminispace","content":"As I mentioned in other Reddit post, these drivers will never admit their fault but the fault of everyone else. Probably the Saab driver out there blaming the vans and the car in front for turning despite green light","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiju3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uiju3","datetime":"2024-04-23 12:54:23"}
	{"user":"velvetstigma","content":">Im betting saab driver was distracted (likely eyes on rear view mirror),  checking merc reaction  before ploughing through the junction. Looking at the force of the Saab during the accident, No one sane will cheong thru a junction full of vehicles. Saabs eyes were clearly off the road. \n\nThis is most definitely what happened here. He didn't expect the merc to speed up and thus clipping the merc. Once there was a hit, he panicked and only looked at the rear mirror whole hoping to speed through the junction, not realizing there was traffic ahead.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukbp3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukbp3","datetime":"2024-04-23 13:11:02"}
	{"user":"tens919382","content":"nah.  definitely on drugs.  who the fk cuts in like that","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uijq3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uijq3","datetime":"2024-04-23 12:54:21"}
	{"user":"Prov0st","content":"He would get outright nuked if he posted in this thread.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9z20/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0u9z20","datetime":"2024-04-23 11:42:43"}
	{"user":"darrenoloGy","content":"Exactly, single lane hog simi, not like the motorcycle was crawling at 10-20km/h. lame excuse.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unxm5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unxm5","datetime":"2024-04-23 13:47:42"}
	{"user":"rafalim021","content":"100% spot on.\n\nPeople are just jumping on the Merc driver because:\n\n1. Its an opportunity for people to whack the everyday assholes on SG roads that speed up to stop someone from overtaking\n\n2. Its a Merc - and a more powerful engine model at that.\n\n\nGuy is definitely no saint though and his latest posts are abit of a clownfest and indicative of his fragile ego.\n\nI just hope this doesn't divert attention away from the SAAB driver who deserves everything he gets and more.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujjc1/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujjc1","datetime":"2024-04-23 13:03:32"}
	{"user":"Eseru","content":"That's the thing that really puzzles me. It's one thing if the junction was right after the bend and the Saab didn't have time to slow down. Or he was trying to beat the red light and the other cars had just started moving.  \n  \nBut the Saab had a lot of time and road to slow down after overtaking. It also looks like the light had already turned red. He just plowed straight into the traffic which was already moving across the junction without even attempting to brake? What the hell was he thinking?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un3yx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un3yx","datetime":"2024-04-23 13:38:58"}
	{"user":"wwabbbitt","content":"He's not the cause but he's the trigger","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un02l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un02l","datetime":"2024-04-23 13:37:49"}
	{"user":"jlonso","content":">would have made no difference to the outcome.\n\nIt's really hard to measure the impact of benz's involvement in this.\n\nDoes SAAB have enough time and distance to stop at the junction? Yes. The reason for not stopping? Hit & Run?\n\nI wouldn't go as to say it made no difference to the outcome. The outcome could be different if that initial contact wasn't made.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0un85x/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0un85x","datetime":"2024-04-23 13:40:12"}
	{"user":"AdeptPlanktonk","content":"It's a trait of egomaniacs, narcissists.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufpgn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ufpgn","datetime":"2024-04-23 12:30:18"}
	{"user":"tryingmydarnest","content":">address this culture.\n\nHow though? Enforcement will be an issue, unless we allow citizens to go bounty hunting.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukal6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukal6","datetime":"2024-04-23 13:10:44"}
	{"user":"jlonso","content":"Lawyer don't have to do shit. No way to verify account is his.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umcup/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umcup","datetime":"2024-04-23 13:31:10"}
	{"user":"NekoIdo","content":"Good point!\n\nu/SNH7Z good luck!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiii5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uiii5","datetime":"2024-04-23 12:54:03"}
	{"user":"Eshuon","content":"Uni students too, but yeah thats why it was removed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubo25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ubo25","datetime":"2024-04-23 11:56:24"}
	{"user":"PhantomWolf83","content":"Don't forget about the BMWs.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh1yu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0uh1yu","datetime":"2024-04-23 12:41:12"}
	{"user":"BearbearDarling","content":"> It would have happen with or without the Merc driver. \n\nYeah, we really don't know that. Yes, the saab was speeding to begin with. But to say a speeding driver will surely beat red light and cause a collision down the road is pure speculation. There are speeding vehicles on the road everyday who don't get into accidents. Moreover, the saab displayed some control by maneuvering and switching lanes trying to overtake. He didn't just crash into the rear of the merc. He didn't barrel over the motorbike. That shows some control on his part even if he was driving dangerously. Versus his conduct at the cross junction where he just plows straight through like a bullet. There is some contrast in his behavior.\n\nThe merc provoking the ssab by speeding up to in attempt to block the overtaking and the saab clipping the merc are not insignificant events. It's possible that they had an effect on the saab driver's state of mind. He could have become blinded with rage and tried to floor it to hit and run. Even so, I think that the merc cannot be legally liable for the collisions at the junction. But you can't tell me the merc is completely uninvolved as if he was a mere bystander. And the worst thing is two lives are lost. One cannot help but wonder if the merc had simply let the saab go on its way, perhaps what happened at the junction might have been different.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uny28/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uny28","datetime":"2024-04-23 13:47:50"}
	{"user":"[deleted]","content":"[removed]","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorqc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorqc","datetime":"2024-04-23 13:56:41"}
	{"user":"MyNameIsOnce","content":"no info to dig for the saab driver. the most i personally found about the saab is a sgcarmart ad of the car before it was sold and it might not be the same car (but the colour and rims match + its a very rare car model, so it would be too much to be a coincidence)\n\ni wonder if there are any previous dashcam vids of the saab (SLD1505R) around.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucygd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ucygd","datetime":"2024-04-23 12:06:55"}
	{"user":"wirexyz","content":"I dont understand also. SAAB speed and beat red light and killed 2. But somehow Benz is at fault because he never give way to the SAAB that is speeding like crazy.\n\nSo next time I see someone breaking the law I need to give way to them instead of preventing from committing a crime? I am glad there is court with fairness here cause I think public opinion is a bit wrong.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udc6h/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0udc6h","datetime":"2024-04-23 12:10:08"}
	{"user":"musicmonkay","content":"Did he really contribute tho? \n\nShitty driver that I will curse in my heart if I met on the road yes \n\nBut he didnt force the Saab to speed, or do anything \n\nIf anything he was also sideswiped in the video right? Unless I saw wrongly which in any situation even though he did a dick move by speeding up, would be the merging driver (Saab)s fault\n\nIt is 100% in the Saab drivers control whether to speed or drive recklessly, as much as a bad driver the merc was, he/she wasnt even near the Saab when the accident happened","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc4gl/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uc4gl","datetime":"2024-04-23 12:00:05"}
	{"user":"Haunting-Owl","content":"methinks too","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhyfc/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uhyfc","datetime":"2024-04-23 12:49:01"}
	{"user":"KopiSiewSiewDai","content":"He cannot post anywhere else I think","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua1k5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ua1k5","datetime":"2024-04-23 11:43:16"}
	{"user":"haaaaaairy1","content":"Probably cause one of the victims was a student so trying to pander to that demographic.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua9xj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0ua9xj","datetime":"2024-04-23 11:45:06"}
	{"user":"A_extra","content":"Because one of the victims killed was a jc student","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadca/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uadca","datetime":"2024-04-23 11:45:52"}
	{"user":"Sacred-Turnip","content":"Because people are also sick and tired of such driving behaviour like the merc driver practice. Apparently, he was also caught on camera on another occasion driving aggressively, likely proving his bad actions are not limited to that incident. In addition, people are also not buying his reply in trying to make himself sound like a saint.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub0lj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ub0lj","datetime":"2024-04-23 11:51:04"}
	{"user":"Alive_Ad7522","content":"Ppl are slamming him not for causing the eventual crash.  It is his driving posture and attitude that is undesirable.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u991l/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0u991l","datetime":"2024-04-23 11:37:00"}
	{"user":"lurkinglurkerwholurk","content":"Wrong place at the wrong time syndrome. That, and apparently theres plenty of evidence his default driving is a dick, AND him also tries to taichi his (tiny) contribution to the Saab drivers crash, a perceived running away from responsibility in an emotionally charged moment = a wild acceptable target appears. \n\nThrowing fuel into the fire, basically. He totally isnt the cause of that fire, but","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uffx3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uffx3","datetime":"2024-04-23 12:28:02"}
	{"user":"areunut1","content":"You can blame both at once. They are not mutually exclusive \n\n\nblame Saab driver for causing incident + blame Merc for driving like an idiot","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uiex4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0uiex4","datetime":"2024-04-23 12:53:07"}
	{"user":"Upper-Discount5109","content":"People always want someone to blame, always want to feel heard in the mob.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ub523/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ub523","datetime":"2024-04-23 11:52:06"}
	{"user":"Spiritual-Okra-7836","content":"if this idiot had let him overtake none of this might have happened either. So he is also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uahgt/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0uahgt","datetime":"2024-04-23 11:46:49"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue6a9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ue6a9","datetime":"2024-04-23 12:17:06"}
	{"user":"NekoIdo","content":"Hence the word alleged in the title","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u8f6n/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":7,"subreddit":"singapore","type":"comment","id":"l0u8f6n","datetime":"2024-04-23 11:30:35"}
	{"user":"GrammarNaziii","content":"This was my first reaction as well. Literally *anyone* could've created the account and wrote this shit up, but it seems like everyone here is just taking it at face value.\n\nWhat if it was the motorcycle driver who created this spiel to make the guy look even worse? Crazy sia.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufp25/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ufp25","datetime":"2024-04-23 12:30:13"}
	{"user":"ailes_d","content":"They know, they still dont want to let other people cut them","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufv18/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":29,"subreddit":"singapore","type":"comment","id":"l0ufv18","datetime":"2024-04-23 12:31:38"}
	{"user":"hawk_199","content":"Basic logic but not many people have it and not taught in driving school tbh...At least I don't recall.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhwf0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhwf0","datetime":"2024-04-23 12:48:31"}
	{"user":"ivananiki","content":"But... he said he was a safe driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulfse/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulfse","datetime":"2024-04-23 13:21:54"}
	{"user":"Organic-Custard6243","content":"For some reason it is quite prevalent among Singaporean driver. When I drive overseas I find that they are more willing to give way. \n\nPerhaps, better legislation can help control this behaviour?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unc75/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unc75","datetime":"2024-04-23 13:41:22"}
	{"user":"Common-Metal8578","content":"There is no logic. The asshole is trying to rationalise his guilt and hope people agree with him. Even when you watch this guys own camera footage. He maintains the same distance from the motorcycle until the black car comes beside him. Suddenly he catches up with the motorcycle very quickly. Suddenly have an emergency? At that very moment? Anyway This kind of memory will eat him from the inside for the rest of his life and we don't need to help him with it.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhknu/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0uhknu","datetime":"2024-04-23 12:45:40"}
	{"user":"InfiniteDividends","content":"That's a poor reason to not signal, I still do. If the car behind speeds up, sure, I'll just lane change after you pass then. Life is too short to rage over idiots like that.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uj97g/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":36,"subreddit":"singapore","type":"comment","id":"l0uj97g","datetime":"2024-04-23 13:00:55"}
	{"user":"abgnerd","content":"I think this kind of logic is something we need to eradicate. I don't do XXX cos of YYY, when XXX is the correct thing to do.\n\nSignal your intentions. \n\nIf the other person speeds up to block you then they are the ass, you just wait for the next opportunity to switch lanes.\n\n\"I don't signal cos other drivers will speed up and block.\" \n\nThese are the same drivers who will speed up and block people who signal intentions. These are the drivers that never signal and cut into lanes.\n\nDownvote me if you feel slightly targeted by this post, but I think some people on Reddit are guilty of bad road manners and it shows.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulogn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulogn","datetime":"2024-04-23 13:24:18"}
	{"user":"splash8388","content":"Not really for me. I signal ahead as a form of respect to pre-alert that I intend to change lane. I will only change lane when no vehicles are very near my vehicle. This also deter motorcyclist who might speed up to squeeze between 2 cars  I do not think I am rude after I force my way into my desired lane once I give ample time. The reason is I already give ample notice my intention to change. U cannot blame me after that just because you don't like to give way. Ha ha.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujg5u/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujg5u","datetime":"2024-04-23 13:02:42"}
	{"user":"MojaMonkey","content":"The only thing the driver is signalling is weakness.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ueg0t/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ueg0t","datetime":"2024-04-23 12:19:27"}
	{"user":"Fluffy-Nature-2087","content":"If they speed up when I signal, I will use my brains to overtake the car behind them and drive behind that fella who sped up. Then when that fella slip up on the road while infront of me, I would have it on dashcam and then later file a police report against them with it just to ruin their day or at least to let the police have a record of them slipping up.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6m2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6m2","datetime":"2024-04-23 14:01:13"}
	{"user":"szab999","content":"yeah probably his lawyer told him to take it down.. but the internet never forgets","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufa4j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":28,"subreddit":"singapore","type":"comment","id":"l0ufa4j","datetime":"2024-04-23 12:26:40"}
	{"user":"Twrd4321","content":"Unless it is possible to verify the person who wrote the post as the person who drove the car, it cannot be administered as evidence. \n\nAnyone can claim to be anyone on Reddit. Thats why usually for ask me anything, mods usually ask for proof. It is not good enough for someone to claim in the post they drove the car.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulawo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulawo","datetime":"2024-04-23 13:20:33"}
	{"user":"pureeyes","content":"Genuinely nice people would give way to others or at least be remorseful over their part in an accident that's killed two people ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucmtv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":24,"subreddit":"singapore","type":"comment","id":"l0ucmtv","datetime":"2024-04-23 12:04:14"}
	{"user":"HungryEdward","content":"I went to see after reading your comment. Seems he doxxed himself by using his own Facebook account to post his dashcam footage.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh2s2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh2s2","datetime":"2024-04-23 12:41:23"}
	{"user":"PhantomWolf83","content":"It's been almost 20 years since I got my licence but I'm sure as hell they didn't teach that kind of defensive driving at BBDC...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u75n0/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":87,"subreddit":"singapore","type":"comment","id":"l0u75n0","datetime":"2024-04-23 11:20:49"}
	{"user":"kumgongkia","content":"I will declare war on everyone to achieve world peace.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujnpr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujnpr","datetime":"2024-04-23 13:04:41"}
	{"user":"may0_sandwich","content":"Lol, 90% of drivers behave this way, are you suggesting all of them may not have a drivers license?? I think the real issue here is the shitty attitude that's been normalised in Singapore.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhiu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0uhiu9","datetime":"2024-04-23 12:45:12"}
	{"user":"erisestarrs","content":"I signal when I want to change lane not to get people to give way to me, but so the car will speed up and I can change into the lane BEHIND them.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ui4r2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0ui4r2","datetime":"2024-04-23 12:50:36"}
	{"user":"Ok-Recommendation925","content":"His gaslighting won't work, especially when two people are dead....\n\nIn fact those two deaths make this clown look and sound like the devil (and an ass-clown-hole)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue7co/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":11,"subreddit":"singapore","type":"comment","id":"l0ue7co","datetime":"2024-04-23 12:17:22"}
	{"user":"thewackykid","content":"yeah... to tell someone to slow down u should slow down yourself (NOT speed up).. if he don't listen and speed up then is not your fault... but at least he would have overtaken u safely and that will be the end of it...","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubw58/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":12,"subreddit":"singapore","type":"comment","id":"l0ubw58","datetime":"2024-04-23 11:58:11"}
	{"user":"Noobcakes19","content":"he's Bruised Wean.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk3us/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk3us","datetime":"2024-04-23 13:08:54"}
	{"user":"Anphant","content":"Nah, behavioural test is more important. Stupid people can always be taught. Not so much for self-centred/obnoxious ones","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl96/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl96","datetime":"2024-04-23 13:44:03"}
	{"user":"Jay-ay","content":"Subscribed","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8m9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":17,"subreddit":"singapore","type":"comment","id":"l0ug8m9","datetime":"2024-04-23 12:34:43"}
	{"user":"XLStress","content":"Fuck yeah.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uocg7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uocg7","datetime":"2024-04-23 13:52:06"}
	{"user":"I_Miss_Every_Shot","content":"Maybe need to retake and reassess after every 5-10 years. Check for bad habits","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufdye/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":6,"subreddit":"singapore","type":"comment","id":"l0ufdye","datetime":"2024-04-23 12:27:34"}
	{"user":"Brief_Worldliness162","content":"I thought he's 42 years old?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufttb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0ufttb","datetime":"2024-04-23 12:31:21"}
	{"user":"Stormagedd0nDarkLord","content":"Bulk? I'd say all of the fault is on the Saab driver for the accident. You can't be held responsible for someone doing a hit and run on you and zooming off. It's not like md floored it to chase after him. I think he reached the lights same time as the motobike.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udzcv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":49,"subreddit":"singapore","type":"comment","id":"l0udzcv","datetime":"2024-04-23 12:15:28"}
	{"user":"ssepaulette","content":"You guys should watch the video again. 5-6s mark frame by frame. Black car was already about to complete the overtaking and white car sped up. \n\nThis is different from asshole driver inching forward to prevent people from cutting which I believe is what you are talking about.\n\nPortion of the black car has already crossed the divider and white car sped up hitting black car in the center. Any further in the rear and black car could have spun out of control and may have killed the motorcyclist.\nThis is reckless driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ue822/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":21,"subreddit":"singapore","type":"comment","id":"l0ue822","datetime":"2024-04-23 12:17:32"}
	{"user":"Ok-Recommendation925","content":"Basically MD is the guy that was on his way to join a riot. But because he was late to the rally point, and the rioting was started by SD happening (with public opinion against the rioters), he simply joined the onlooker crowds and joined them in being \"kaypoh/what-happened?\"\n\nLOL","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uerf9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uerf9","datetime":"2024-04-23 12:22:09"}
	{"user":"Background_Tax_1985","content":"Yeap agreed.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uadu9/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0uadu9","datetime":"2024-04-23 11:45:59"}
	{"user":"Background_Tax_1985","content":"Probably easier to blame him since he identified himself plus he was acting like a dick and i guess merc? \n\nI think once they announce who sd is everyone will be having a field day with him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9zkz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":32,"subreddit":"singapore","type":"comment","id":"l0u9zkz","datetime":"2024-04-23 11:42:50"}
	{"user":"soulless33","content":"yeah same thing I told my friends.. the merc drive is an ass but he did not cause the accident..\n\nit's like everyone trying to explain why the driver plough thru the traffic and the merc driver is a scapegoat..\n\nend of the day its a terrible tragedy let us not assign blame, instead keep our prayers to those still in hospital..","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uaidk/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uaidk","datetime":"2024-04-23 11:47:01"}
	{"user":"Background_Tax_1985","content":"Bro if im the dpp ah:\n\n1) your client is already speeding before he tried to overtake the white merc.\n\n2) why does your client need to overtake the 2 other vehicles at such high speed? That is not normal behaviour.\n\n3) a normal individual would have immediately stopped after the accident to check for damage, exchange info etc, not continue speeding\n\n4) it near impossible for a person to be that provoked in such a short span of time (say from bruce banner to hulk in 3s~5s)","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up1d3/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up1d3","datetime":"2024-04-23 13:59:38"}
	{"user":"Background_Tax_1985","content":"Nah. Sd was already speeding prior to the sideswipe and driving too aggresively, so it can't really be said that md aggravated him.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufbjx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":8,"subreddit":"singapore","type":"comment","id":"l0ufbjx","datetime":"2024-04-23 12:27:00"}
	{"user":"Background_Tax_1985","content":"I disagree. Sd was already speeding before the side swipe and carried on speeding after. Md's action is unrelated to the accident, even if is at fault for his behaviour.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf45d/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uf45d","datetime":"2024-04-23 12:25:12"}
	{"user":"Vedor","content":"Such people confirm will just delete his account if he ever get nukes.\n\n\nIn the very first place, do you think he will post such thread if his licence plate wasn't made known to everyone?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ucuaq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0ucuaq","datetime":"2024-04-23 12:05:58"}
	{"user":"KneeGal","content":"I disagree. He is an asshole driver for sure but he is not the trigger because the SAAB was already speeding before the Merc noticed him (and started speeding up). Unless he has pre-cog, there is no reason for him to be going so fast in the first place.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up2b7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up2b7","datetime":"2024-04-23 13:59:55"}
	{"user":"KneeGal","content":"He was already speeding before he came into contact with the Merc. \n\nHe was still speeding after he came into contact.\n\nWhy do you think the outcome would have been different? It would be one thing if he was not speeding before and then sped after or vice versa. But he was constantly speeding.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uokul/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uokul","datetime":"2024-04-23 13:54:37"}
	{"user":"dibidi","content":"see how UK updated the highway code to include the hierarchy of road users requiring all road users to defer to the most vulnerable road users at all times. \n\nwith that rule in place any accident that happens the responsibility is automatically on the road user in the larger vehicle. insurance liability means de facto compliance. \n\nnow most everyone in the UK gives way.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uklbw/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uklbw","datetime":"2024-04-23 13:13:36"}
	{"user":"AutoModerator","content":"Facebook links are not allowed on this subreddit due to doxxing concerns. Please amend your submission to remove the link and write in to modmail for it to be manually approved again. Alternatively, you may wish to resubmit the post without the link.\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/singapore) if you have any questions or concerns.*","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uorr4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uorr4","datetime":"2024-04-23 13:56:41"}
	{"user":"Possible-Grocery6244","content":"because there is reasoning behind the speeding and the merc driver caused it. No one is saying SAAB is not at fault, but the merc driver definitely should share some responsibility because he was the one who sped up and induced the situation for the SAAB to sideswipe the merc, and in turn the SAAB driver panicked and wanted to hit and run hence speeding up after the sideswipe (assuming there is no brake failure). If the merc driver did not speed up, the subsequent chain of events wouldnt have occured","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf975/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf975","datetime":"2024-04-23 12:26:27"}
	{"user":"RiskDry6267","content":"Benz is being scolded for being an ego idiot.\nIf give way 100% no accident. Even though SAAB is probably 90% at fault.\nThe news story could have easily been the SAAB buah the Mercedes then crash him and both cars burning on the side of the road, and merc driver died, then what will we all say online? Asking for it right ? \nGive way from the start none of this shit will happen. Motorcycle bro in front also thank his lucky stars he wasnt collateral damage","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uieem/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uieem","datetime":"2024-04-23 12:52:59"}
	{"user":"smurflings","content":"Seeing, just in the replies to my post at least one blaming him for causing this eventually crash.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc2zo/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc2zo","datetime":"2024-04-23 11:59:45"}
	{"user":"Upper-Discount5109","content":"Multiple choices for saab driver after not being allowed to overtake. He could've waited, could've slowed down and overtake later, but he chose to chiong which eventually caused the accident. White merc = inconsiderate at most, didn't cause the accident. Saab driver = His decision, his consequences","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubdyp/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ubdyp","datetime":"2024-04-23 11:54:06"}
	{"user":"smurflings","content":"And if you had walked a different direction that day, none of this might have happened either! So you're also partly to blame.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubxw8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-1,"subreddit":"singapore","type":"comment","id":"l0ubxw8","datetime":"2024-04-23 11:58:35"}
	{"user":"crispyprata","content":"Ok?  if Temasek JC didnt organize an event at bedok reservoir the student would still be alive so TJC is also partly to blame /s","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uivg6/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0uivg6","datetime":"2024-04-23 12:57:22"}
	{"user":"meowinbox","content":"Bro, you and I both know that word doesn't make that much of a difference. \n\n\nI'm sure *you* are aware that he could just be trolling, I'm not singling *you* out in particular. My comment was also directed at the others already dragging him as though he's really going to be here reading these comments.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0u9i1q/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-21,"subreddit":"singapore","type":"comment","id":"l0u9i1q","datetime":"2024-04-23 11:39:00"}
	{"user":"alexand3rl","content":"It's taught in driving school. BTT literally has the question where if someone is trying to overtake you, you should slow down and assist the motorist to help overtake you","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up6zn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up6zn","datetime":"2024-04-23 14:01:19"}
	{"user":"zchew","content":"Yes, he teach others how to drive safely by speeding up to block them. Very safety. Huehuehuehue","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unl7s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unl7s","datetime":"2024-04-23 13:44:03"}
	{"user":"theony","content":"> The asshole is trying to rationalise his guilt \n\nHe feels no guilt, he thinks he's a tragic hero who failed to achieve his goals even though his actions were heroic. That's why he posted his own video up, and made multiple reddit posts justifying his actions. \n\nThis kind will never, ever learn. The only thing he will take away from being slammed on the internet will be \"internet is stupid\". If the police catch him and charge him, the only thing he will take away is \"police are lazy and will only wayang in high profile cases to show off\".","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukchn/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukchn","datetime":"2024-04-23 13:11:15"}
	{"user":"taeng89","content":"Upvoted. Completely agree with this","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo965/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo965","datetime":"2024-04-23 13:51:08"}
	{"user":"Critwice","content":"he wanted to post here but not enough karma/age? r/sgexams mods deleted because irrelevant.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufsvh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":22,"subreddit":"singapore","type":"comment","id":"l0ufsvh","datetime":"2024-04-23 12:31:07"}
	{"user":"timlim029","content":"Yeah. I'm surprised nobody is even questioning if the driver really wrote the post. I mean, it was posted on /r/SGExams. Could easily be a bored student.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyv5/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyv5","datetime":"2024-04-23 13:58:52"}
	{"user":"MilkTeaRamen","content":"Bro this is call offensive driving.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ud8xg/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":61,"subreddit":"singapore","type":"comment","id":"l0ud8xg","datetime":"2024-04-23 12:09:22"}
	{"user":"Prov0st","content":"Bro, thats a genius cheat code.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uit3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":5,"subreddit":"singapore","type":"comment","id":"l0uit3i","datetime":"2024-04-23 12:56:45"}
	{"user":"Jackker","content":"Yeah, this is the way. If they slow down and an opportunity is there to change lane, do it.\n\nIf they speed up, wait for as long as necessary until the opportunity is there. Then change lane,  it really is that simple. ","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0unsy8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0unsy8","datetime":"2024-04-23 13:46:19"}
	{"user":"foxbat2525","content":"Never too old to be a student driving daddy's car","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujyi4/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ujyi4","datetime":"2024-04-23 13:07:29"}
	{"user":"_WonderStruck_17","content":"Agreed, the Saab driver being a complete siaokia had no bearing on the Merc driver. Merc driver was a bully too but it was two separate incidents.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwmx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":33,"subreddit":"singapore","type":"comment","id":"l0ufwmx","datetime":"2024-04-23 12:32:01"}
	{"user":"ailes_d","content":"Yeah the fault is totally on the saab driver because we all know hes speeding from very far away already. But in this case, the video not only provided evidence of saab driving recklessly, but also showcased the white merc cb mentality which lots of sg drivers have","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ugdjz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":9,"subreddit":"singapore","type":"comment","id":"l0ugdjz","datetime":"2024-04-23 12:35:44"}
	{"user":"ABootSG","content":"Tbh looking at these two incidents separately, I'd say the merce is reckless, saab on drugs.\n\nBut the saab driver was clearly on some shit already because he didn't stop despite colliding with the merce. As for the merce not stopping after their collision it's probably because he saw the saab trying to hit and run so he kept up with him.\n\nAlso at the junction from the perpendicular POV of another car, it didnt look like the saab was braking at all when he was on the junction.\n\nI think we should wait for the toxicology report on the saab driver. Probably on some serious amps.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf5wf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":18,"subreddit":"singapore","type":"comment","id":"l0uf5wf","datetime":"2024-04-23 12:25:38"}
	{"user":"deathzz123","content":"TIL overtaking car can just chiong into lane no need check mirror or blind spot, if other driver dont yield they are reckless","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukqtq/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukqtq","datetime":"2024-04-23 13:15:03"}
	{"user":"infernoKings","content":"Exactly. Reckless driving by the SAAB driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0umdro/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0umdro","datetime":"2024-04-23 13:31:25"}
	{"user":"Possible-Grocery6244","content":"yes he was already speeding but precisely because of the sideswipe SAAB driver reacted the way he did. Or are you assuming that the incident would have occur either way without the sideswipe incident? im inclined to believe that this is a cause-and-effect situation","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ufwxr/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":0,"subreddit":"singapore","type":"comment","id":"l0ufwxr","datetime":"2024-04-23 12:32:06"}
	{"user":"tryingmydarnest","content":"TIL. Thanks for sharing.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukq89/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukq89","datetime":"2024-04-23 13:14:53"}
	{"user":"Emotional_Apricot591","content":"He literally made a bad situation worse, so yes he is to blame as well","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0udula/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":2,"subreddit":"singapore","type":"comment","id":"l0udula","datetime":"2024-04-23 12:14:19"}
	{"user":"Vedor","content":"Please tell that to journalists when they use the word \"alleged\" in their article.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uf43e/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0uf43e","datetime":"2024-04-23 12:25:11"}
	{"user":"NekoIdo","content":"Buddy, all these stuff is already out there, people are going to find it with or without me. Im not making new shit up, Im just reiterating whats been said already. \n\nYou wanna defend this guy so bad knock yourself out man. But whats it got to do with you being unable to take the word alleged at face value?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ua2tv/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":4,"subreddit":"singapore","type":"comment","id":"l0ua2tv","datetime":"2024-04-23 11:43:32"}
	{"user":"Jjzeng","content":"I was certainly offended by their driving","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uh6g8/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":15,"subreddit":"singapore","type":"comment","id":"l0uh6g8","datetime":"2024-04-23 12:42:14"}
	{"user":"hehetypo","content":"no this one is sinkie pwn sinkie driving end up pwn ownself so can sleep soundly at night","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ul3w7/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ul3w7","datetime":"2024-04-23 13:18:37"}
	{"user":"Stormagedd0nDarkLord","content":"Exactly. I really dunno why md is getting this level of hate and blame for this. It's illogical.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ug8vb/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":10,"subreddit":"singapore","type":"comment","id":"l0ug8vb","datetime":"2024-04-23 12:34:46"}
	{"user":"Additional-Ad-1644","content":"Life doesnt have to be black and white, you know..\n\nWait till you are trying to overtake a lane hogger who somehow decides to speed up when you are passing him. Doesnt matter if hes right or wrong or legal or illegal. Still an asshole driver.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uoyq2/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uoyq2","datetime":"2024-04-23 13:58:49"}
	{"user":"Background_Tax_1985","content":"I believe it would have still occured without the sideswipe incident. \n\nThe sideswipe incident took place pretty far away from the junction and he had the option of also making a left turn (zebra crossing), a right turn (traffic light) to get away from the merc if that was the intention. Infact, i would even warrant to say that going left would have been much better route to \"escape\".\n\nClearly sb was not really bothered by the sideswipe, if at all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uhd3z/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":3,"subreddit":"singapore","type":"comment","id":"l0uhd3z","datetime":"2024-04-23 12:43:49"}
	{"user":"kumgongkia","content":"Are u the Saab driver? How would u know how that guy thinks? After kena sideswiped the knee jerk reaction is to accelerate all the way? Huh?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ukfhh/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ukfhh","datetime":"2024-04-23 13:12:03"}
	{"user":"meowinbox","content":"I'm not defending the *driver*. Which part of what I said defended him? \n\n\nWhat I meant was, that post could have been written by some troll at home, and these netizens are wasting their energy giving this redditor all the rage and attention he wants, while the actual driver is somewhere else in his own world.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ubf3i/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-10,"subreddit":"singapore","type":"comment","id":"l0ubf3i","datetime":"2024-04-23 11:54:22"}
	{"user":"_WonderStruck_17","content":"To be fair that instance does exemplify the typical kiasi behaviour that most of our SG drivers have, not wanting to give way to others which infuriates the motoring community a lot. That clip of the Merc driver committing a full corner like as though he's racing for their F1 team to overtake a motorbike on a expressway exit is one example.\n\nBut of course this tragic incident shouldn't be attributed to him. Hopefully this is a hard lesson for all.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uinzd/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":13,"subreddit":"singapore","type":"comment","id":"l0uinzd","datetime":"2024-04-23 12:55:25"}
	{"user":"deathzz123","content":"I agree with you no black and white and yes he is an asshole driver but if I overtake someone who speeds back up I will go back to my lane. At most miss exit go 1 round lo","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0up7dj/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0up7dj","datetime":"2024-04-23 14:01:27"}
	{"user":"Possible-Grocery6244","content":"Him ramming through the traffic junction clearly shows that he is incapable of grasping the situation and brake accordingly when its a red light. But he took maneuvers to try to cut the behind cam car + merc driver and evade the motorcycle right before the sideswipe occurs. Isnt this just more evidence that his state of mind was different before and after the sideswipe, and that the sideswipe is the catalyst for this particular instance. My argument is he would have just rammed into the motorcycle or into the back of the merc without trying to cut both of them if his state of mind was the same before and after the sideswipe","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ujbfx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":-2,"subreddit":"singapore","type":"comment","id":"l0ujbfx","datetime":"2024-04-23 13:01:29"}
	{"user":"Possible-Grocery6244","content":"i did not say the knee jeck reaction is to accelerate all the way. Im merely stating what is observed from the video that the SAAB driver indeed accelerated all the way after the sideswipe and assumption is he was under the influenced and the sideswipe triggered a hit and run scenario","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0ulrqz/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0ulrqz","datetime":"2024-04-23 13:25:14"}
	{"user":"NekoIdo","content":"Youre absolutely right, it could be him, could not be him.\n\nIts a public forum though so good luck gate keeping all the content here. Have fun!","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uc1bx/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uc1bx","datetime":"2024-04-23 11:59:22"}
	{"user":"TimidHuman","content":"Justify so much but you also feeding the troll (if it was truly one). Same same la","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uck2s/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uck2s","datetime":"2024-04-23 12:03:36"}
	{"user":"happycanliao","content":"You can tell his state of mind just from that? Are you a psychiatrist?","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uk42j/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uk42j","datetime":"2024-04-23 13:08:58"}
	{"user":"Background_Tax_1985","content":"I can't really buy into your arguement. \n\nMy hypotesis is that if he was not intoxicated by drugs or alcohol, then he was trying to speed to somewhere (god knows where). \n\nThis is seen from the good control over the vehicle, even up to the accident. The vehicle barely wobbled, swerve around (except when overtaking, even after overtaking he was going as straight as an arrow) etc. Only issue is that sb was going way too fast. \n\nAnd in essence, there is no difference in his state of mind before or after. At least not so much that it would have caused the accident.","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uo6te/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uo6te","datetime":"2024-04-23 13:50:25"}
	{"user":"Possible-Grocery6244","content":"isnt it clear the difference between the state of mind of the driver if 1. you are trying to avoid the vehicles infront of you by maneuvering the car and 2. you just straight plow through a red light junction? I dont think you need to be a psych to reach this conclusion","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0uknwf/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0uknwf","datetime":"2024-04-23 13:14:16"}
	{"user":"happycanliao","content":"I don't think it's a state of mind issue? There could be other issues such as being distracted or the car may have been damaged by the accident causing loss of control (not likely but who knows).","url":"https://www.reddit.com/r/singapore/comments/1cau62k/screenshot_of_snh7z_drivers_alleged_self/l0um9zs/","context":"Screenshot of SNH7Z Driver's alleged \"Self Justification\"","score":1,"subreddit":"singapore","type":"comment","id":"l0um9zs","datetime":"2024-04-23 13:30:20"}
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442/spark_reddit_preprocessing.py", line 100, in <module>
	    .save()
	     ^^^^^^
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/pyspark.zip/pyspark/sql/readwriter.py", line 1461, in save
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1322, in __call__
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/pyspark.zip/pyspark/errors/exceptions/captured.py", line 179, in deco
	  File "/opt/spark-3.5.1-bin-hadoop3-scala2.13/python/lib/py4j-0.10.9.7-src.zip/py4j/protocol.py", line 326, in get_return_value
	py4j.protocol.Py4JJavaError: An error occurred while calling o111.save.
	: java.lang.NoClassDefFoundError: org/apache/kafka/common/serialization/ByteArraySerializer
		at org.apache.spark.sql.kafka010.KafkaSourceProvider$.<clinit>(KafkaSourceProvider.scala:601)
		at org.apache.spark.sql.kafka010.KafkaSourceProvider.createRelation(KafkaSourceProvider.scala:180)
		at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:48)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)
		at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
		at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
		at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
		at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
		at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
		at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
		at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
		at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
		at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
		at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
		at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
		at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
		at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)
		at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)
		at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)
		at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:248)
		at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
		at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
		at py4j.Gateway.invoke(Gateway.java:282)
		at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
		at py4j.commands.CallCommand.execute(CallCommand.java:79)
		at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
		at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
		at java.lang.Thread.run(Thread.java:750)
	Caused by: java.lang.ClassNotFoundException: org.apache.kafka.common.serialization.ByteArraySerializer
		at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
		at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
		... 43 more
	
	24/04/24 10:59:45 INFO SparkContext: Invoking stop() from shutdown hook
	24/04/24 10:59:45 INFO SparkContext: SparkContext is stopping with exitCode 0.
	24/04/24 10:59:45 INFO SparkUI: Stopped Spark web UI at http://6b0330d1bc18:4040
	24/04/24 10:59:45 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
	24/04/24 10:59:45 INFO MemoryStore: MemoryStore cleared
	24/04/24 10:59:45 INFO BlockManager: BlockManager stopped
	24/04/24 10:59:45 INFO BlockManagerMaster: BlockManagerMaster stopped
	24/04/24 10:59:45 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
	24/04/24 10:59:45 INFO SparkContext: Successfully stopped SparkContext
	24/04/24 10:59:45 INFO ShutdownHookManager: Shutdown hook called
	24/04/24 10:59:45 INFO ShutdownHookManager: Deleting directory /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c/pyspark-343d9878-6a10-4675-9ecb-d46bd38b1c7f
	24/04/24 10:59:45 INFO ShutdownHookManager: Deleting directory /tmp/spark-81ae2194-8cdb-4a29-b929-e4e6c0f92f5c
	24/04/24 10:59:45 INFO ShutdownHookManager: Deleting directory /tmp/spark-1b8b407b-274b-41c7-b5ca-d58342cc0d59
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.509 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442, processId:1342 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.510 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.510 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.511 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.515 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.516 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.516 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_109/577/1442
[WI-577][TI-1442] - [INFO] 2024-04-24 10:59:45.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-1442] - [INFO] 2024-04-24 10:59:46.494 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=1442, success=true)
