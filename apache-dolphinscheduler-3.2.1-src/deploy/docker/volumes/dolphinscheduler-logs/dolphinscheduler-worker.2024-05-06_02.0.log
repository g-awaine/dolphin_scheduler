[WI-0][TI-0] - [INFO] 2024-05-06 02:09:09.897 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8881795281041478 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:10.945 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7091483135684584 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:15.007 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.771513353115727 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:36.091 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9292307692307693 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:40.082 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3784, taskName=consume filtered data, firstSubmitTime=1714932580071, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3784'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020940'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.091 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.091 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.103 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.103 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932580104
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3784
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3784,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714932580071,
  "startTime" : 1714932580104,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3784.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3784"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020940"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1013_3784",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3784 check successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.114 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.115 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.115 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.115 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.115 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.116 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.116 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.116 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3784/1013_3784.sh
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:40.142 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3000
[WI-0][TI-3784] - [INFO] 2024-05-06 02:09:40.971 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3784, success=true)
[WI-0][TI-3784] - [INFO] 2024-05-06 02:09:40.988 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3784)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:41.146 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.152 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3784, processId:3000 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:41.166 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8087248322147651 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3784
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.218 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3784
[WI-1013][TI-3784] - [INFO] 2024-05-06 02:09:41.218 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3784] - [INFO] 2024-05-06 02:09:41.892 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3784, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:41.951 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3785, taskName=parse the message, firstSubmitTime=1714932581944, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3785'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020941'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.953 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.954 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932581956
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3785
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3785,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714932581944,
  "startTime" : 1714932581956,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3785.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"[\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"]\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3785"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020941"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1013_3785",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.957 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.957 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.960 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.961 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785 check successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.962 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.963 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.963 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785/py_1013_3785.py
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.964 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.965 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.965 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.965 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785/py_1013_3785.py
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.965 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.966 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785/1013_3785.sh
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:41.969 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3011
[WI-0][TI-3785] - [INFO] 2024-05-06 02:09:42.897 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3785, success=true)
[WI-0][TI-3785] - [INFO] 2024-05-06 02:09:42.904 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3785)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:42.970 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors=["Erin Hale", "sss hale"])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.976 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785, processId:3011 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.976 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.978 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.983 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.983 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3785
[WI-1013][TI-3785] - [INFO] 2024-05-06 02:09:42.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3785] - [INFO] 2024-05-06 02:09:43.894 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3785, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:43.982 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3786, taskName=persist in postgresql, firstSubmitTime=1714932583969, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3786'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020943'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@22bdf03c, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.984 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.985 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.986 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932583987
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3786
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3786,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932583969,
  "startTime" : 1714932583987,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3786.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3786"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020943"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1013_3786",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.988 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.989 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.989 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:43.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.000 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.001 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3786 check successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.001 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.001 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.002 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.003 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.004 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.005 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.006 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.007 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.008 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.008 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.010 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.010 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.011 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.011 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.012 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.013 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.013 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.014 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.015 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1013][TI-3786] - [WARN] 2024-05-06 02:09:44.016 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.040 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='Erin Hale'}, 2=Property{prop='authors', direct=IN, type=VARCHAR, value='sss hale'}, 3=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 4=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 5=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 6=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 7=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1013][TI-3786] - [ERROR] 2024-05-06 02:09:44.044 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: INSERT has more expressions than target columns
  Position: 70
[WI-1013][TI-3786] - [ERROR] 2024-05-06 02:09:44.047 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1013][TI-3786] - [ERROR] 2024-05-06 02:09:44.048 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.049 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3786.log
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.049 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3786.log, fetch way: log 
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.049 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.050 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1013][TI-3786] - [INFO] 2024-05-06 02:09:44.058 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3786] - [INFO] 2024-05-06 02:09:44.901 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3786, success=true)
[WI-0][TI-3786] - [INFO] 2024-05-06 02:09:44.910 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3786, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:46.106 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3787, taskName=persist in postgresql, firstSubmitTime=1714932586052, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3787'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020946'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@219945bb, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.114 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.119 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.119 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932586119
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.119 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3787
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3787,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932586052,
  "startTime" : 1714932586119,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3787.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3787"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020946"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1013_3787",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.121 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.121 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.128 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.129 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.136 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3787 check successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.137 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.137 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.137 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.140 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.142 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.143 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.144 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.144 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.159 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1013][TI-3787] - [WARN] 2024-05-06 02:09:46.160 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.193 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='Erin Hale'}, 2=Property{prop='authors', direct=IN, type=VARCHAR, value='sss hale'}, 3=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 4=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 5=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 6=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 7=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1013][TI-3787] - [ERROR] 2024-05-06 02:09:46.200 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: INSERT has more expressions than target columns
  Position: 70
[WI-1013][TI-3787] - [ERROR] 2024-05-06 02:09:46.201 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1013][TI-3787] - [ERROR] 2024-05-06 02:09:46.201 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.201 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3787.log
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.201 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3787.log, fetch way: log 
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.202 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.202 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1013][TI-3787] - [INFO] 2024-05-06 02:09:46.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3787] - [INFO] 2024-05-06 02:09:46.917 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3787, success=true)
[WI-0][TI-3787] - [INFO] 2024-05-06 02:09:46.959 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3787, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:47.267 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7103658536585367 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:48.085 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3788, taskName=persist in postgresql, firstSubmitTime=1714932588062, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3788'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020948'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@32b1c58a, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.087 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.087 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.089 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.089 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.089 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.090 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932588090
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.091 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3788
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.091 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3788,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932588062,
  "startTime" : 1714932588090,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3788.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3788"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020948"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1013_3788",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.097 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.097 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.097 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3788 check successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.098 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.099 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.099 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.099 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.100 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.101 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.102 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.102 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.102 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.102 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.102 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.103 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.103 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.103 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.103 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1013][TI-3788] - [WARN] 2024-05-06 02:09:48.109 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.129 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='Erin Hale'}, 2=Property{prop='authors', direct=IN, type=VARCHAR, value='sss hale'}, 3=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 4=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 5=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 6=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 7=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1013][TI-3788] - [ERROR] 2024-05-06 02:09:48.132 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: INSERT has more expressions than target columns
  Position: 70
[WI-1013][TI-3788] - [ERROR] 2024-05-06 02:09:48.132 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1013][TI-3788] - [ERROR] 2024-05-06 02:09:48.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.133 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3788.log
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.133 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3788.log, fetch way: log 
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.133 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.133 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.136 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1013][TI-3788] - [INFO] 2024-05-06 02:09:48.136 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3788] - [INFO] 2024-05-06 02:09:48.919 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3788, success=true)
[WI-0][TI-3788] - [INFO] 2024-05-06 02:09:48.927 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3788, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:09:50.043 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3789, taskName=persist in postgresql, firstSubmitTime=1714932590028, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=56, appIds=null, processInstanceId=1013, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3789'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506020950'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1013'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1cb91335, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.044 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.045 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.046 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.046 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932590049
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1013_3789
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.051 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3789,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932590028,
  "startTime" : 1714932590049,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3789.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 56,
  "processInstanceId" : 1013,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3789"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506020950"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1013"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1013_3789",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.069 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.071 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.073 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_56/1013/3789 check successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.073 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.074 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.074 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.075 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.075 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.076 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.077 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.078 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1013][TI-3789] - [WARN] 2024-05-06 02:09:50.080 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.123 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='Erin Hale'}, 2=Property{prop='authors', direct=IN, type=VARCHAR, value='sss hale'}, 3=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 4=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 5=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 6=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 7=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1013][TI-3789] - [ERROR] 2024-05-06 02:09:50.131 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: INSERT has more expressions than target columns
  Position: 70
[WI-1013][TI-3789] - [ERROR] 2024-05-06 02:09:50.132 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1013][TI-3789] - [ERROR] 2024-05-06 02:09:50.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: INSERT has more expressions than target columns
  Position: 70
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.132 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3789.log
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.132 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/56/1013/3789.log, fetch way: log 
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.132 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1013][TI-3789] - [INFO] 2024-05-06 02:09:50.140 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3789] - [INFO] 2024-05-06 02:09:50.917 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3789, success=true)
[WI-0][TI-3789] - [INFO] 2024-05-06 02:09:50.924 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3789, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:10:43.830 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7064220183486238 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:10:44.913 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7362637362637363 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:10:48.969 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8109756097560975 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:03.072 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7228571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:30.079 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3790, taskName=consume filtered data, firstSubmitTime=1714932690065, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3790'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021130'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.090 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932690164
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3790
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3790,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714932690065,
  "startTime" : 1714932690164,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3790.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3790"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021130"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1014_3790",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.165 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.165 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.165 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3790 check successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.182 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.182 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.182 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.183 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.185 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.185 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.185 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.185 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.185 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3790/1014_3790.sh
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:30.251 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3044
[WI-0][TI-3790] - [INFO] 2024-05-06 02:11:30.943 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3790, success=true)
[WI-0][TI-3790] - [INFO] 2024-05-06 02:11:30.950 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3790)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:31.268 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.272 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3790, processId:3044 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.272 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.274 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.285 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.286 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3790
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.288 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3790
[WI-1014][TI-3790] - [INFO] 2024-05-06 02:11:31.288 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3790] - [INFO] 2024-05-06 02:11:31.942 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3790, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:32.090 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3791, taskName=parse the message, firstSubmitTime=1714932692072, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3791'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021132'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.093 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.094 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.101 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932692106
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3791
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.106 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3791,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714932692072,
  "startTime" : 1714932692106,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3791.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"[\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"]\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3791"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021132"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1014_3791",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.107 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.107 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.107 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.126 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.128 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791 check successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.128 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.129 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.129 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.129 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.131 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.132 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.133 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.133 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791/py_1014_3791.py
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.133 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.134 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.134 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.134 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791/py_1014_3791.py
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.134 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.134 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791/1014_3791.sh
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:32.143 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3055
[WI-0][TI-3791] - [INFO] 2024-05-06 02:11:32.946 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3791, success=true)
[WI-0][TI-3791] - [INFO] 2024-05-06 02:11:32.954 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3791)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:33.153 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors=["Erin Hale", "sss hale"])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.155 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791, processId:3055 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3791
[WI-1014][TI-3791] - [INFO] 2024-05-06 02:11:33.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3791] - [INFO] 2024-05-06 02:11:33.955 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3791, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:34.045 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3792, taskName=persist in postgresql, firstSubmitTime=1714932694035, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3792'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021134'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@712fa983, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.051 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.052 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.055 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.055 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.055 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.055 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932694055
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.056 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3792
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.057 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3792,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932694035,
  "startTime" : 1714932694055,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3792.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3792"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021134"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1014_3792",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.058 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.059 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.059 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.065 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.078 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.085 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3792 check successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.085 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.086 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.088 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.088 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.088 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.092 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.093 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.096 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.096 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.096 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.098 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.098 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.098 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.099 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.099 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:["Erin Hale", "sss hale"](VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.099 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1014][TI-3792] - [WARN] 2024-05-06 02:11:34.100 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.158 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1014][TI-3792] - [ERROR] 2024-05-06 02:11:34.162 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1014][TI-3792] - [ERROR] 2024-05-06 02:11:34.163 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1014][TI-3792] - [ERROR] 2024-05-06 02:11:34.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.163 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3792.log
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.164 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3792.log, fetch way: log 
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.164 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.165 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1014][TI-3792] - [INFO] 2024-05-06 02:11:34.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3792] - [INFO] 2024-05-06 02:11:34.990 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3792, success=true)
[WI-0][TI-3792] - [INFO] 2024-05-06 02:11:35.002 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3792, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:35.237 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7798258944485095 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:36.071 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3793, taskName=persist in postgresql, firstSubmitTime=1714932696052, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3793'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021136'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@12a61b60, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.072 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.074 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.079 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.079 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.079 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.079 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932696079
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.080 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3793
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.081 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3793,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932696052,
  "startTime" : 1714932696079,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3793.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3793"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021136"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1014_3793",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.083 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.083 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.083 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.102 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.103 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3793 check successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.108 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.109 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.110 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.111 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.112 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.112 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.112 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.113 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.113 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.126 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.132 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.133 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.133 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.133 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.133 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:["Erin Hale", "sss hale"](VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.133 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1014][TI-3793] - [WARN] 2024-05-06 02:11:36.134 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.171 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1014][TI-3793] - [ERROR] 2024-05-06 02:11:36.173 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1014][TI-3793] - [ERROR] 2024-05-06 02:11:36.173 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1014][TI-3793] - [ERROR] 2024-05-06 02:11:36.174 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.174 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3793.log
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.174 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3793.log, fetch way: log 
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.175 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.175 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1014][TI-3793] - [INFO] 2024-05-06 02:11:36.182 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3793] - [INFO] 2024-05-06 02:11:37.054 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3793, success=true)
[WI-0][TI-3793] - [INFO] 2024-05-06 02:11:37.096 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3793, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:38.241 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3794, taskName=persist in postgresql, firstSubmitTime=1714932698229, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3794'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021138'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@76b083ad, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.242 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.242 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.243 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.243 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.243 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.243 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932698243
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.243 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3794
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.244 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3794,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932698229,
  "startTime" : 1714932698243,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3794.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3794"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021138"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1014_3794",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.244 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.244 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.244 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.272 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.273 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.280 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3794 check successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.284 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.290 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.291 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.291 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.291 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.291 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.291 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.292 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.292 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.292 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.294 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.294 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.295 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.295 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:["Erin Hale", "sss hale"](VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.295 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1014][TI-3794] - [WARN] 2024-05-06 02:11:38.296 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.319 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1014][TI-3794] - [ERROR] 2024-05-06 02:11:38.323 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1014][TI-3794] - [ERROR] 2024-05-06 02:11:38.324 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1014][TI-3794] - [ERROR] 2024-05-06 02:11:38.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.324 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3794.log
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.324 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3794.log, fetch way: log 
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.325 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.325 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.331 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1014][TI-3794] - [INFO] 2024-05-06 02:11:38.331 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3794] - [INFO] 2024-05-06 02:11:38.967 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3794, success=true)
[WI-0][TI-3794] - [INFO] 2024-05-06 02:11:38.974 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3794, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:11:40.032 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3795, taskName=persist in postgresql, firstSubmitTime=1714932700021, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=57, appIds=null, processInstanceId=1014, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3795'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021140'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1014'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@77f39179, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.034 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.034 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.035 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.036 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932700036
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1014_3795
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.037 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3795,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932700021,
  "startTime" : 1714932700036,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3795.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 57,
  "processInstanceId" : 1014,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3795"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021140"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1014"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1014_3795",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.042 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_57/1014/3795 check successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.044 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.044 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.044 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.044 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.045 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.046 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.046 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.046 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.046 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.047 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.047 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.047 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.047 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:["Erin Hale", "sss hale"](VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.047 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1014][TI-3795] - [WARN] 2024-05-06 02:11:40.048 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.066 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='["Erin Hale", "sss hale"]'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1014][TI-3795] - [ERROR] 2024-05-06 02:11:40.069 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1014][TI-3795] - [ERROR] 2024-05-06 02:11:40.069 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1014][TI-3795] - [ERROR] 2024-05-06 02:11:40.070 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.071 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3795.log
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.071 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/57/1014/3795.log, fetch way: log 
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.072 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.072 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.075 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1014][TI-3795] - [INFO] 2024-05-06 02:11:40.075 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3795] - [INFO] 2024-05-06 02:11:40.967 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3795, success=true)
[WI-0][TI-3795] - [INFO] 2024-05-06 02:11:40.975 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3795, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:12:55.517 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7771428571428571 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:12:59.581 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8495297805642633 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:03.633 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7606060606060606 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:27.795 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7065868263473054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:35.878 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8250559359956607 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:36.902 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7562695924764891 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:41.531 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3796, taskName=consume filtered data, firstSubmitTime=1714932821521, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=58, appIds=null, processInstanceId=1015, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3796'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021341'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1015'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.532 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.533 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.547 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.548 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932821548
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1015_3796
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.549 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3796,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714932821521,
  "startTime" : 1714932821548,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3796.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 58,
  "processInstanceId" : 1015,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3796"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021341"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1015"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1015_3796",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.554 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.555 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.555 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3796 check successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.556 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.556 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.556 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.557 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.559 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.560 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.560 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.560 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.560 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3796/1015_3796.sh
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:41.565 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3100
[WI-0][TI-3796] - [INFO] 2024-05-06 02:13:42.242 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3796, success=true)
[WI-0][TI-3796] - [INFO] 2024-05-06 02:13:42.265 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3796)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:42.570 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.578 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3796, processId:3100 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.579 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.580 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.587 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.587 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3796
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.591 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3796
[WI-1015][TI-3796] - [INFO] 2024-05-06 02:13:42.592 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3796] - [INFO] 2024-05-06 02:13:43.237 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3796, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:43.333 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3797, taskName=parse the message, firstSubmitTime=1714932823296, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=58, appIds=null, processInstanceId=1015, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3797'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021343'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1015'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932823341
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.342 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1015_3797
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3797,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714932823296,
  "startTime" : 1714932823341,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3797.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 58,
  "processInstanceId" : 1015,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3797"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021343"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1015"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1015_3797",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.344 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.344 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.344 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.338 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797 check successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.354 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.355 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.356 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.357 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797/py_1015_3797.py
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.357 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.358 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.358 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.358 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797/py_1015_3797.py
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.358 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.358 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797/1015_3797.sh
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:43.372 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3111
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:44.105 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7889908256880733 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3797] - [INFO] 2024-05-06 02:13:44.237 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3797, success=true)
[WI-0][TI-3797] - [INFO] 2024-05-06 02:13:44.247 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3797)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:44.378 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={"Erin Hale", "sss hale"})}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.382 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797, processId:3111 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.384 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.385 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.385 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.385 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.389 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.389 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.389 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3797
[WI-1015][TI-3797] - [INFO] 2024-05-06 02:13:44.390 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3797] - [INFO] 2024-05-06 02:13:45.238 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3797, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:45.364 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3798, taskName=persist in postgresql, firstSubmitTime=1714932825350, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=58, appIds=null, processInstanceId=1015, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3798'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021345'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1015'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@56a2eaef, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.367 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.368 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932825370
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1015_3798
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3798,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932825350,
  "startTime" : 1714932825370,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3798.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 58,
  "processInstanceId" : 1015,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3798"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021345"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1015"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\"Erin Hale\", \"sss hale\"}"
    }
  },
  "taskAppId" : "1015_3798",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\\"Erin Hale\\\", \\\"sss hale\\\"}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.372 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.372 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.379 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.380 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.381 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3798 check successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.381 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}] successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.383 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}] ,query max result limit  0
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.384 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.385 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.385 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.385 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.386 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.386 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.387 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.387 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{"Erin Hale", "sss hale"}(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.387 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1015][TI-3798] - [WARN] 2024-05-06 02:13:45.388 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.445 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1015][TI-3798] - [ERROR] 2024-05-06 02:13:45.455 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1015][TI-3798] - [ERROR] 2024-05-06 02:13:45.458 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1015][TI-3798] - [ERROR] 2024-05-06 02:13:45.459 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.459 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3798.log
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.460 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3798.log, fetch way: log 
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.464 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.464 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.479 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1015][TI-3798] - [INFO] 2024-05-06 02:13:45.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3798] - [INFO] 2024-05-06 02:13:46.540 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3798, success=true)
[WI-0][TI-3798] - [INFO] 2024-05-06 02:13:46.555 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3798, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:47.645 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3799, taskName=persist in postgresql, firstSubmitTime=1714932827632, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=58, appIds=null, processInstanceId=1015, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3799'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021347'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1015'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@129e1bae, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.647 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.649 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.649 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932827649
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1015_3799
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.651 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3799,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932827632,
  "startTime" : 1714932827649,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3799.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 58,
  "processInstanceId" : 1015,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3799"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021347"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1015"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\"Erin Hale\", \"sss hale\"}"
    }
  },
  "taskAppId" : "1015_3799",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\\"Erin Hale\\\", \\\"sss hale\\\"}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.651 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.662 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.663 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3799 check successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.664 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.664 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.666 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}] successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.667 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.667 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}] ,query max result limit  0
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.669 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.669 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.669 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.669 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.669 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.670 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.670 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.670 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{"Erin Hale", "sss hale"}(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.671 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1015][TI-3799] - [WARN] 2024-05-06 02:13:47.671 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.705 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1015][TI-3799] - [ERROR] 2024-05-06 02:13:47.710 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1015][TI-3799] - [ERROR] 2024-05-06 02:13:47.711 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1015][TI-3799] - [ERROR] 2024-05-06 02:13:47.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.712 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3799.log
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.712 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3799.log, fetch way: log 
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.713 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1015][TI-3799] - [INFO] 2024-05-06 02:13:47.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3799] - [INFO] 2024-05-06 02:13:48.539 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3799, success=true)
[WI-0][TI-3799] - [INFO] 2024-05-06 02:13:48.558 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3799, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:49.717 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3800, taskName=persist in postgresql, firstSubmitTime=1714932829666, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=58, appIds=null, processInstanceId=1015, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3800'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506021349'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1015'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@707a834b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.768 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.772 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.775 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.777 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714932829777
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.777 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1015_3800
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3800,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714932829666,
  "startTime" : 1714932829777,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3800.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 58,
  "processInstanceId" : 1015,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3800"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506021349"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1015"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\"Erin Hale\", \"sss hale\"}"
    }
  },
  "taskAppId" : "1015_3800",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\\"Erin Hale\\\", \\\"sss hale\\\"}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.809 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.814 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_58/1015/3800 check successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.820 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.821 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.822 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.822 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.822 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}] successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.825 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.825 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.825 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}] ,query max result limit  0
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.829 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.830 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.831 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{"Erin Hale", "sss hale"}(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.831 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1015][TI-3800] - [WARN] 2024-05-06 02:13:49.831 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.902 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1015][TI-3800] - [ERROR] 2024-05-06 02:13:49.904 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1015][TI-3800] - [ERROR] 2024-05-06 02:13:49.904 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1015][TI-3800] - [ERROR] 2024-05-06 02:13:49.905 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.906 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3800.log
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.906 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/58/1015/3800.log, fetch way: log 
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.908 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.908 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.926 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1015][TI-3800] - [INFO] 2024-05-06 02:13:49.927 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:50.519 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7417710727259248 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3800] - [INFO] 2024-05-06 02:13:50.535 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3800, success=true)
[WI-0][TI-3800] - [INFO] 2024-05-06 02:13:50.549 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3800, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:51.541 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8422535211267606 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:13:59.570 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7115987460815048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:14:54.113 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7734138972809668 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:14:55.127 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.701501474662615 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:17:39.320 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7366771159874608 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:17:43.397 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8427672955974843 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:30:23.707 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7307692307692308 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:27.532 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8632218844984803 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:37.602 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7583081570996978 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:38.642 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7333333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:43.699 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3802, taskName=consume filtered data, firstSubmitTime=1714933903694, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=59, appIds=null, processInstanceId=1016, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3802'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506023143'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1016'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.701 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.701 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.706 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.706 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714933903706
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1016_3802
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3802,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714933903694,
  "startTime" : 1714933903706,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/59/1016/3802.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 59,
  "processInstanceId" : 1016,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3802"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506023143"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1016"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1016_3802",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3802 check successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.710 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.711 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.711 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.711 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.711 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.712 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3802/1016_3802.sh
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:43.718 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3335
[WI-0][TI-3802] - [INFO] 2024-05-06 02:31:44.527 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3802, success=true)
[WI-0][TI-3802] - [INFO] 2024-05-06 02:31:44.533 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3802)
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:44.719 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.721 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3802, processId:3335 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.722 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.722 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.722 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.725 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.726 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.726 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3802
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.726 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3802
[WI-1016][TI-3802] - [INFO] 2024-05-06 02:31:44.727 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3802] - [INFO] 2024-05-06 02:31:45.534 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3802, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:45.593 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3803, taskName=parse the message, firstSubmitTime=1714933905586, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=59, appIds=null, processInstanceId=1016, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3803'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506023145'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1016'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.596 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.597 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.599 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.600 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.600 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.600 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714933905600
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1016_3803
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3803,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714933905586,
  "startTime" : 1714933905600,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/59/1016/3803.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 59,
  "processInstanceId" : 1016,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3803"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506023145"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1016"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1016_3803",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803 check successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.657 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.659 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.659 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.659 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803/py_1016_3803.py
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.659 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([f"\"{x}\"" for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.660 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.660 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.660 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803/py_1016_3803.py
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.660 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.660 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803/1016_3803.sh
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:45.667 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 3346
[WI-0][TI-3803] - [INFO] 2024-05-06 02:31:46.539 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3803, success=true)
[WI-0][TI-3803] - [INFO] 2024-05-06 02:31:46.547 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3803)
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:46.674 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={"Erin Hale", "sss hale"})}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.701 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803, processId:3346 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.709 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.716 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.719 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3803
[WI-1016][TI-3803] - [INFO] 2024-05-06 02:31:46.719 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3803] - [INFO] 2024-05-06 02:31:47.529 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3803, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:47.641 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3804, taskName=persist in postgresql, firstSubmitTime=1714933907628, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=59, appIds=null, processInstanceId=1016, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3804'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506023147'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1016'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1a7818eb, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.642 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714933907645
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1016_3804
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3804,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714933907628,
  "startTime" : 1714933907645,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/59/1016/3804.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 59,
  "processInstanceId" : 1016,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3804"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506023147"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1016"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{\"Erin Hale\", \"sss hale\"}"
    }
  },
  "taskAppId" : "1016_3804",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{\\\"Erin Hale\\\", \\\"sss hale\\\"}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.652 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.652 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.653 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3804 check successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.653 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.653 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.654 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.654 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.654 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{\"Erin Hale\", \"sss hale\"}"}] successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.655 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}] ,query max result limit  0
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.656 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (CAST(${authors} AS VARCHAR[]), ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.658 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)

[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.659 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{"Erin Hale", "sss hale"}(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.659 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1016][TI-3804] - [WARN] 2024-05-06 02:31:47.660 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:47.689 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7885196374622356 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.696 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{"Erin Hale", "sss hale"}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.729 +0800 o.a.d.p.t.s.SqlTask:[328] - main statement execute update result: 1, for sql: INSERT INTO filtered_data_persistence
VALUES (CAST(? AS VARCHAR[]), ?, ?, ?, ?, ?)

[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.734 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.746 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.746 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3804
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_59/1016/3804
[WI-1016][TI-3804] - [INFO] 2024-05-06 02:31:47.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3804] - [INFO] 2024-05-06 02:31:48.547 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3804, success=true)
[WI-0][TI-3804] - [INFO] 2024-05-06 02:31:48.559 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3804, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 02:31:49.724 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7052023121387284 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:46:12.910 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7492537313432835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:46:13.952 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.739612188365651 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:46:14.958 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7398843930635838 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:46:21.979 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7669902912621359 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:57:06.101 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7298850574712643 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:58:14.309 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7595307917888563 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:58:15.329 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7478753541076487 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:58:16.346 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7443181818181819 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 02:58:32.402 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7072368421052632 is over then the MaxCpuUsagePercentageThresholds 0.7
