[WI-0][TI-0] - [INFO] 2024-05-06 01:02:42.660 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8384146341463414 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:02:43.693 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.875796178343949 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:09.002 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8184523809523809 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:44.211 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8048048048048049 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:55.252 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3710, taskName=consume filtered data, firstSubmitTime=1714929235243, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3710'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011355'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.256 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.263 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.264 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929235264
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3710
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3710,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714929235243,
  "startTime" : 1714929235264,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3710.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3710"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011355"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1000_3710",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.271 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.277 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.278 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3710 check successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.282 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.283 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.284 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.286 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.287 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.288 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.288 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.291 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.292 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.292 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.292 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.293 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.299 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3710/1000_3710.sh
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:55.310 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2044
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:55.432 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7115513712648384 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3710] - [INFO] 2024-05-06 01:13:56.042 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3710, success=true)
[WI-0][TI-3710] - [INFO] 2024-05-06 01:13:56.064 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3710)
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:56.311 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.313 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3710, processId:2044 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.314 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.314 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.315 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.315 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.319 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3710
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.320 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3710
[WI-1000][TI-3710] - [INFO] 2024-05-06 01:13:56.320 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3710] - [INFO] 2024-05-06 01:13:57.004 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3710, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:57.115 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3711, taskName=parse the message, firstSubmitTime=1714929237089, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\'{\" + ', '.join([str(x) for x in authors]) + \"}\\'\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3711'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011357'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.118 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.118 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.122 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.122 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.122 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.122 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929237122
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.122 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3711
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.138 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3711,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714929237089,
  "startTime" : 1714929237122,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3711.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\\\n\\\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\\\n\\\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\\\n\\\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\\\n\\\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\\\n\\\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\\\n\\\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\\\n\\\\nThe WSJ did not immediately respond to a request for comment.\\\\n\\\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\\\n\\\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\\\n\\\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\\\n\\\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\\\n\\\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\\\n\\\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\\\n\\\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\\\n\\\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\\\",\\n\\t\\\"url\\\": \\\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n\\t\\\"context\\\": \\\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"\\\\'{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\\'\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3711"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011357"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1000_3711",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.141 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.161 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711 check successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.170 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\'{\" + ', '.join([str(x) for x in authors]) + \"}\\'\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.171 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.171 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.171 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.172 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\'{" + ', '.join([str(x) for x in authors]) + "}\'"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.173 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.173 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711/py_1000_3711.py
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.173 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\'{" + ', '.join([str(x) for x in authors]) + "}\'"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.174 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.174 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.174 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711/py_1000_3711.py
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.175 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.175 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711/1000_3711.sh
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:57.191 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2055
[WI-0][TI-3711] - [INFO] 2024-05-06 01:13:58.009 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3711, success=true)
[WI-0][TI-3711] - [INFO] 2024-05-06 01:13:58.018 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3711)
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:58.194 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors='{Erin Hale}')}
	#{setValue(content=Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.
	
	Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.
	
	Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.
	
	The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.
	
	In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.
	
	“At the core of these changes is the creation of a new business, finance and economics group,” she said.
	
	“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”
	
	The WSJ did not immediately respond to a request for comment.
	
	Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.
	
	China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.
	
	Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.
	
	Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.
	
	Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.
	
	Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.
	
	Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.
	
	Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.)}
	#{setValue(url=https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en)}
	#{setValue(context=Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.198 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711, processId:2055 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.198 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.198 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.199 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.199 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.206 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.206 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.206 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.207 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3711
[WI-1000][TI-3711] - [INFO] 2024-05-06 01:13:58.207 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3711] - [INFO] 2024-05-06 01:13:59.010 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3711, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:13:59.166 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3712, taskName=persist in postgresql, firstSubmitTime=1714929239146, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3712'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011359'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@35f191ab, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.168 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.168 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.170 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.171 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929239171
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3712
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3712,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929239146,
  "startTime" : 1714929239171,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3712.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3712"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011359"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1000_3712",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.178 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.179 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.179 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3712 check successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.179 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.180 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}] successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.181 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.182 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.182 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.182 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.182 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.182 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.183 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.184 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:'{Erin Hale}'(VARCHAR)Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.(VARCHAR)https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en(VARCHAR)Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.184 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1000][TI-3712] - [WARN] 2024-05-06 01:13:59.185 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.216 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1000][TI-3712] - [ERROR] 2024-05-06 01:13:59.224 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1000][TI-3712] - [ERROR] 2024-05-06 01:13:59.225 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1000][TI-3712] - [ERROR] 2024-05-06 01:13:59.225 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.225 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3712.log
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.225 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3712.log, fetch way: log 
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.226 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1000][TI-3712] - [INFO] 2024-05-06 01:13:59.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3712] - [INFO] 2024-05-06 01:14:00.032 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3712, success=true)
[WI-0][TI-3712] - [INFO] 2024-05-06 01:14:00.063 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3712, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:01.317 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3713, taskName=persist in postgresql, firstSubmitTime=1714929241164, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3713'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011401'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@52c34357, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.335 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.337 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.337 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929241337
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3713
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.338 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3713,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929241164,
  "startTime" : 1714929241337,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3713.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3713"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011401"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1000_3713",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.379 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.381 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3713 check successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.384 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.407 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.411 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.412 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.412 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}] successfully
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.413 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.413 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.413 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.413 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.413 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.427 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.430 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.432 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.432 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.434 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.435 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.436 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.443 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:'{Erin Hale}'(VARCHAR)Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.(VARCHAR)https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en(VARCHAR)Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.453 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1000][TI-3713] - [WARN] 2024-05-06 01:14:01.454 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.516 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1000][TI-3713] - [ERROR] 2024-05-06 01:14:01.524 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1000][TI-3713] - [ERROR] 2024-05-06 01:14:01.530 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1000][TI-3713] - [ERROR] 2024-05-06 01:14:01.532 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.535 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3713.log
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.538 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3713.log, fetch way: log 
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.538 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:01.554 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8558282208588958 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.570 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1000][TI-3713] - [INFO] 2024-05-06 01:14:01.571 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3713] - [INFO] 2024-05-06 01:14:02.042 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3713, success=true)
[WI-0][TI-3713] - [INFO] 2024-05-06 01:14:02.054 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3713, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:03.124 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3714, taskName=persist in postgresql, firstSubmitTime=1714929243108, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3714'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011403'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@a965203, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.140 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929243153
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3714
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3714,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929243108,
  "startTime" : 1714929243153,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3714.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3714"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011403"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1000_3714",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.167 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3714 check successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.180 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}] successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.181 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.186 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.186 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.186 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.186 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.187 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.190 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.190 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.191 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.191 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.191 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.191 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.191 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:'{Erin Hale}'(VARCHAR)Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.(VARCHAR)https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en(VARCHAR)Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.192 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1000][TI-3714] - [WARN] 2024-05-06 01:14:03.192 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.220 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1000][TI-3714] - [ERROR] 2024-05-06 01:14:03.224 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1000][TI-3714] - [ERROR] 2024-05-06 01:14:03.224 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1000][TI-3714] - [ERROR] 2024-05-06 01:14:03.224 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.224 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3714.log
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.224 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3714.log, fetch way: log 
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.225 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.225 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.230 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1000][TI-3714] - [INFO] 2024-05-06 01:14:03.230 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3714] - [INFO] 2024-05-06 01:14:04.017 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3714, success=true)
[WI-0][TI-3714] - [INFO] 2024-05-06 01:14:04.025 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3714, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:05.145 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3715, taskName=persist in postgresql, firstSubmitTime=1714929245080, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=45, appIds=null, processInstanceId=1000, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3715'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011405'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1000'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@7ebb1cf6, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.151 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.152 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.153 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.154 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929245154
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1000_3715
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.155 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3715,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929245080,
  "startTime" : 1714929245154,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3715.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 45,
  "processInstanceId" : 1000,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3715"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011405"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1000"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1000_3715",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.162 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_45/1000/3715 check successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.172 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"'{Erin Hale}'"}] successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.173 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.174 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.174 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.174 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:'{Erin Hale}'(VARCHAR)Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.(VARCHAR)https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en(VARCHAR)Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.175 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1000][TI-3715] - [WARN] 2024-05-06 01:14:05.176 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.207 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value=''{Erin Hale}''}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1000][TI-3715] - [ERROR] 2024-05-06 01:14:05.225 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1000][TI-3715] - [ERROR] 2024-05-06 01:14:05.226 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1000][TI-3715] - [ERROR] 2024-05-06 01:14:05.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.227 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3715.log
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.227 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/45/1000/3715.log, fetch way: log 
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.227 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.227 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.237 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1000][TI-3715] - [INFO] 2024-05-06 01:14:05.237 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3715] - [INFO] 2024-05-06 01:14:06.048 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3715, success=true)
[WI-0][TI-3715] - [INFO] 2024-05-06 01:14:06.072 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3715, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:06.609 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7368421052631579 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:09.641 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7142857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:32.013 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7582089552238805 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:14:51.142 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7315634218289085 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:17.295 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7420382165605095 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:19.255 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3716, taskName=consume filtered data, firstSubmitTime=1714929319238, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=46, appIds=null, processInstanceId=1001, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3716'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011519'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1001'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.257 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.273 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.273 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.274 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929319274
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.274 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1001_3716
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.275 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3716,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714929319238,
  "startTime" : 1714929319274,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/46/1001/3716.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 46,
  "processInstanceId" : 1001,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3716"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011519"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1001"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1001_3716",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.276 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.296 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.297 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.299 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3716 check successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.307 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.311 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.312 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.312 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.312 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.313 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3716/1001_3716.sh
[WI-0][TI-3716] - [INFO] 2024-05-06 01:15:19.326 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3716, success=true)
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:19.332 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2088
[WI-0][TI-3716] - [INFO] 2024-05-06 01:15:19.364 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3716)
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:20.338 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.339 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3716, processId:2088 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3716
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3716
[WI-1001][TI-3716] - [INFO] 2024-05-06 01:15:20.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3716] - [INFO] 2024-05-06 01:15:21.296 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3716, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:21.414 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3717, taskName=parse the message, firstSubmitTime=1714929321401, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=46, appIds=null, processInstanceId=1001, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"VARCHAR","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3717'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011521'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1001'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.415 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.420 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.420 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.420 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929321420
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.420 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1001_3717
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.421 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3717,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714929321401,
  "startTime" : 1714929321420,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/46/1001/3717.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 46,
  "processInstanceId" : 1001,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\\\n\\\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\\\n\\\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\\\n\\\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\\\n\\\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\\\n\\\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\\\n\\\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\\\n\\\\nThe WSJ did not immediately respond to a request for comment.\\\\n\\\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\\\n\\\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\\\n\\\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\\\n\\\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\\\n\\\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\\\n\\\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\\\n\\\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\\\n\\\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\\\",\\n\\t\\\"url\\\": \\\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n\\t\\\"context\\\": \\\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3717"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011521"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1001"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1001_3717",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.422 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.426 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.428 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717 check successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.432 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.435 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.437 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.437 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.438 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.439 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.439 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.439 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.441 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.442 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717/py_1001_3717.py
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.442 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.444 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.445 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.446 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717/py_1001_3717.py
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.446 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.447 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717/1001_3717.sh
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:21.453 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2099
[WI-0][TI-3717] - [INFO] 2024-05-06 01:15:22.345 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3717, success=true)
[WI-0][TI-3717] - [INFO] 2024-05-06 01:15:22.367 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3717)
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:22.455 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={Erin Hale})}
	#{setValue(content=Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.
	
	Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.
	
	Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.
	
	The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.
	
	In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.
	
	“At the core of these changes is the creation of a new business, finance and economics group,” she said.
	
	“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”
	
	The WSJ did not immediately respond to a request for comment.
	
	Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.
	
	China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.
	
	Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.
	
	Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.
	
	Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.
	
	Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.
	
	Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.
	
	Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.)}
	#{setValue(url=https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en)}
	#{setValue(context=Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.459 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717, processId:2099 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.460 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.460 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.471 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3717
[WI-1001][TI-3717] - [INFO] 2024-05-06 01:15:22.473 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3717] - [INFO] 2024-05-06 01:15:23.321 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3717, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:23.366 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3718, taskName=persist in postgresql, firstSubmitTime=1714929323348, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=46, appIds=null, processInstanceId=1001, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3718'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506011523'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1001'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=VARCHAR, value='{Erin Hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@32520df, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{Erin Hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.368 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.368 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929323370
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1001_3718
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3718,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929323348,
  "startTime" : 1714929323370,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/46/1001/3718.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 46,
  "processInstanceId" : 1001,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3718"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506011523"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1001"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "{Erin Hale}"
    }
  },
  "taskAppId" : "1001_3718",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"{Erin Hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.374 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.375 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.375 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.420 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.425 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.425 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_46/1001/3718 check successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.436 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.454 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.454 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.454 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.468 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.473 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"VARCHAR","value":"{Erin Hale}"}] successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.474 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.474 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.474 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.474 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.474 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=VARCHAR, value='{Erin Hale}'}] ,query max result limit  0
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.494 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.501 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)

[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.502 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:{Erin Hale}(VARCHAR)Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.(VARCHAR)https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en(VARCHAR)Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English(VARCHAR)article(VARCHAR)2024-05-03 13:45:22(TIMESTAMP)
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.508 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1001][TI-3718] - [WARN] 2024-05-06 01:15:23.509 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.542 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : INSERT INTO filtered_data_persistence
VALUES (?, ?, ?, ?, ?, ?)
, sql parameters : {1=Property{prop='authors', direct=IN, type=VARCHAR, value='{Erin Hale}'}, 2=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, 3=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, 4=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, 5=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, 6=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}}
[WI-1001][TI-3718] - [ERROR] 2024-05-06 01:15:23.547 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
[WI-1001][TI-3718] - [ERROR] 2024-05-06 01:15:23.547 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1001][TI-3718] - [ERROR] 2024-05-06 01:15:23.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: column "authors" is of type character varying[] but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 47
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:149)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:327)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.547 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/46/1001/3718.log
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.547 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/46/1001/3718.log, fetch way: log 
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.549 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.549 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1001][TI-3718] - [INFO] 2024-05-06 01:15:23.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:24.334 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7109144542772861 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3718] - [INFO] 2024-05-06 01:15:24.337 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3718, success=true)
[WI-0][TI-3718] - [INFO] 2024-05-06 01:15:24.354 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3718, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:15:28.399 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7238095238095238 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:22:16.592 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7191358024691359 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:22:20.690 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8815112674876434 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:22:34.750 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8309037900874636 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:22:44.809 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.71301775147929 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:03.852 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3726, taskName=consume filtered data, firstSubmitTime=1714929783839, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3726'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012303'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.853 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.897 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.898 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.898 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.898 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929783898
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.898 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3726
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3726,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714929783839,
  "startTime" : 1714929783898,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3726.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3726"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012303"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1003_3726",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.902 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.915 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.919 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.922 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3726 check successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.924 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.925 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.927 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.940 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.941 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.942 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.944 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.944 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.944 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.945 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3726/1003_3726.sh
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:03.996 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2202
[WI-0][TI-3726] - [INFO] 2024-05-06 01:23:04.394 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3726, success=true)
[WI-0][TI-3726] - [INFO] 2024-05-06 01:23:04.402 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3726)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:05.002 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.004 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3726, processId:2202 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.004 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.004 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3726
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.009 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3726
[WI-1003][TI-3726] - [INFO] 2024-05-06 01:23:05.009 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3726] - [INFO] 2024-05-06 01:23:05.398 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3726, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:05.476 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3727, taskName=parse the message, firstSubmitTime=1714929785455, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3727'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012305'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.477 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.477 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.480 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.480 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929785480
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3727
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3727,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714929785455,
  "startTime" : 1714929785480,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3727.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\\\n\\\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\\\n\\\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\\\n\\\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\\\n\\\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\\\n\\\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\\\n\\\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\\\n\\\\nThe WSJ did not immediately respond to a request for comment.\\\\n\\\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\\\n\\\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\\\n\\\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\\\n\\\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\\\n\\\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\\\n\\\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\\\n\\\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\\\n\\\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\\\",\\n\\t\\\"url\\\": \\\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n\\t\\\"context\\\": \\\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3727"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012305"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1003_3727",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.482 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.483 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.485 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.490 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.491 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.492 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727 check successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.494 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.495 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.495 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.501 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.505 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.506 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.507 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.507 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.507 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.508 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.509 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727/py_1003_3727.py
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.509 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.511 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.511 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.511 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727/py_1003_3727.py
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.512 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.512 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727/1003_3727.sh
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:05.523 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2213
[WI-0][TI-3727] - [INFO] 2024-05-06 01:23:06.414 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3727, success=true)
[WI-0][TI-3727] - [INFO] 2024-05-06 01:23:06.425 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3727)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:06.538 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={Erin Hale})}
	#{setValue(content=Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.
	
	Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.
	
	Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.
	
	The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.
	
	In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.
	
	“At the core of these changes is the creation of a new business, finance and economics group,” she said.
	
	“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”
	
	The WSJ did not immediately respond to a request for comment.
	
	Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.
	
	China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.
	
	Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.
	
	Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.
	
	Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.
	
	Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.
	
	Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.
	
	Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.)}
	#{setValue(url=https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en)}
	#{setValue(context=Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.551 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727, processId:2213 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.553 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.554 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.554 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.555 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.561 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.561 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.562 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3727
[WI-1003][TI-3727] - [INFO] 2024-05-06 01:23:06.562 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3727] - [INFO] 2024-05-06 01:23:07.410 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3727, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:07.511 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3728, taskName=persist in postgresql, firstSubmitTime=1714929787496, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3728'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012307'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6a4713c3, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.512 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.514 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929787514
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.514 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3728
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.515 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3728,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929787496,
  "startTime" : 1714929787514,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3728.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3728"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012307"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale}"
    }
  },
  "taskAppId" : "1003_3728",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.521 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.522 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.523 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3728 check successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.528 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}] successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.531 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.531 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}] ,query max result limit  0
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.532 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3728] - [ERROR] 2024-05-06 01:23:07.534 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3728] - [ERROR] 2024-05-06 01:23:07.534 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3728] - [ERROR] 2024-05-06 01:23:07.534 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.535 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3728.log
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.535 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3728.log, fetch way: log 
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.535 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1003][TI-3728] - [INFO] 2024-05-06 01:23:07.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3728] - [INFO] 2024-05-06 01:23:08.405 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3728, success=true)
[WI-0][TI-3728] - [INFO] 2024-05-06 01:23:08.413 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3728, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:09.519 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3729, taskName=persist in postgresql, firstSubmitTime=1714929789501, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3729'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012309'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@478faece, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.520 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.521 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.523 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.523 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.523 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929789524
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3729
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3729,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929789501,
  "startTime" : 1714929789524,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3729.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3729"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012309"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale}"
    }
  },
  "taskAppId" : "1003_3729",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3729 check successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.530 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.530 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.530 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.530 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}] successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.531 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}] ,query max result limit  0
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.533 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.534 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.535 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.536 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.536 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.536 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3729] - [ERROR] 2024-05-06 01:23:09.537 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3729] - [ERROR] 2024-05-06 01:23:09.538 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3729] - [ERROR] 2024-05-06 01:23:09.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.539 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3729.log
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.539 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3729.log, fetch way: log 
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.540 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1003][TI-3729] - [INFO] 2024-05-06 01:23:09.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3729] - [INFO] 2024-05-06 01:23:10.407 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3729, success=true)
[WI-0][TI-3729] - [INFO] 2024-05-06 01:23:10.414 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3729, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:11.454 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3730, taskName=persist in postgresql, firstSubmitTime=1714929791426, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3730'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012311'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@32fc694c, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.455 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.456 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.458 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.458 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.458 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929791458
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.458 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3730
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.460 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3730,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929791426,
  "startTime" : 1714929791458,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3730.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3730"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012311"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale}"
    }
  },
  "taskAppId" : "1003_3730",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.469 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3730 check successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.470 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.471 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.475 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.475 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.475 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.476 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}] successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.476 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.476 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.476 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.476 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.477 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}] ,query max result limit  0
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.479 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.480 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.480 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.480 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.480 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.480 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3730] - [ERROR] 2024-05-06 01:23:11.480 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3730] - [ERROR] 2024-05-06 01:23:11.481 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3730] - [ERROR] 2024-05-06 01:23:11.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.481 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3730.log
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.481 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3730.log, fetch way: log 
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.482 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.482 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1003][TI-3730] - [INFO] 2024-05-06 01:23:11.488 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3730] - [INFO] 2024-05-06 01:23:12.419 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3730, success=true)
[WI-0][TI-3730] - [INFO] 2024-05-06 01:23:12.427 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3730, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:13.455 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3731, taskName=persist in postgresql, firstSubmitTime=1714929793441, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=47, appIds=null, processInstanceId=1003, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3731'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012313'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1003'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@3e40d015, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.457 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.457 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.459 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.459 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929793459
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.459 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1003_3731
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.471 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3731,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929793441,
  "startTime" : 1714929793459,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3731.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 47,
  "processInstanceId" : 1003,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3731"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012313"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1003"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale}"
    }
  },
  "taskAppId" : "1003_3731",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.473 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.480 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.485 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.499 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_47/1003/3731 check successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.500 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.500 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.501 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.502 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.504 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale}"}] successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.505 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.505 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale}'}] ,query max result limit  0
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.507 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.509 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.509 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.509 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.509 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.509 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1003][TI-3731] - [ERROR] 2024-05-06 01:23:13.510 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3731] - [ERROR] 2024-05-06 01:23:13.510 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1003][TI-3731] - [ERROR] 2024-05-06 01:23:13.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.531 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3731.log
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.532 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/47/1003/3731.log, fetch way: log 
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.533 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.533 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1003][TI-3731] - [INFO] 2024-05-06 01:23:13.539 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3731] - [INFO] 2024-05-06 01:23:14.421 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3731, success=true)
[WI-0][TI-3731] - [INFO] 2024-05-06 01:23:14.430 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3731, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:23:24.010 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.770764119601329 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:35.568 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3732, taskName=consume filtered data, firstSubmitTime=1714929995554, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3732'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012635'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.586 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.611 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.611 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929995612
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3732
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.614 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3732,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714929995554,
  "startTime" : 1714929995612,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3732.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3732"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012635"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1004_3732",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3732 check successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.625 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.626 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.627 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.630 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.630 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.631 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.631 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.631 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3732/1004_3732.sh
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:35.648 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2270
[WI-0][TI-3732] - [INFO] 2024-05-06 01:26:36.424 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3732, success=true)
[WI-0][TI-3732] - [INFO] 2024-05-06 01:26:36.431 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3732)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:36.503 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7118155619596542 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:36.651 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.654 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3732, processId:2270 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.666 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.666 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3732
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.666 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3732
[WI-1004][TI-3732] - [INFO] 2024-05-06 01:26:36.667 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3732] - [INFO] 2024-05-06 01:26:37.448 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3732, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:37.504 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3733, taskName=parse the message, firstSubmitTime=1714929997492, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\'{\" + ', '.join([str(x) for x in authors]) + \"}\\'\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3733'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012637'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.505 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929997508
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3733
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3733,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714929997492,
  "startTime" : 1714929997508,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3733.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\\\n\\\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\\\n\\\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\\\n\\\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\\\n\\\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\\\n\\\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\\\n\\\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\\\n\\\\nThe WSJ did not immediately respond to a request for comment.\\\\n\\\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\\\n\\\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\\\n\\\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\\\n\\\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\\\n\\\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\\\n\\\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\\\n\\\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\\\n\\\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\\\",\\n\\t\\\"url\\\": \\\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n\\t\\\"context\\\": \\\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"2024-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"\\\\'{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\\'\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3733"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012637"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1004_3733",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.537 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733 check successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.545 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\"\n\t],\n\t\"content\": \"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\",\n\t\"url\": \"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n\t\"context\": \"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\",\n\t\"type\": \"article\",\n\t\"datetime\": \"2024-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\'{\" + ', '.join([str(x) for x in authors]) + \"}\\'\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.548 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.549 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\'{" + ', '.join([str(x) for x in authors]) + "}\'"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.550 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.550 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733/py_1004_3733.py
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.550 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale"
	],
	"content": "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.",
	"url": "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
	"context": "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English",
	"type": "article",
	"datetime": "2024-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\'{" + ', '.join([str(x) for x in authors]) + "}\'"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.551 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.551 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.551 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733/py_1004_3733.py
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.551 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.551 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733/1004_3733.sh
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:37.573 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2281
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:37.574 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-3733] - [INFO] 2024-05-06 01:26:38.430 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3733, success=true)
[WI-0][TI-3733] - [INFO] 2024-05-06 01:26:38.439 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3733)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:38.587 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(authors='{Erin Hale}')}
	#{setValue(content=Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.
	
	Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.
	
	Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.
	
	The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.
	
	In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.
	
	“At the core of these changes is the creation of a new business, finance and economics group,” she said.
	
	“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”
	
	The WSJ did not immediately respond to a request for comment.
	
	Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.
	
	China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.
	
	Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.
	
	Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.
	
	Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.
	
	Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.
	
	Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.
	
	Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.)}
	#{setValue(url=https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en)}
	#{setValue(context=Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English)}
	#{setValue(type=article)}
	#{setValue(datetime=2024-05-03 13:45:22)}
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.588 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733, processId:2281 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.590 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3733
[WI-1004][TI-3733] - [INFO] 2024-05-06 01:26:38.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3733] - [INFO] 2024-05-06 01:26:39.491 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3733, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:39.580 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3734, taskName=persist in postgresql, firstSubmitTime=1714929999538, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3734'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012639'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@2a702a04, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.581 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.582 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.583 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.584 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714929999584
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3734
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3734,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714929999538,
  "startTime" : 1714929999584,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3734.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3734"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012639"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1004_3734",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.587 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.597 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3734 check successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.602 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.605 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}] successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.610 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.610 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.613 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3734] - [ERROR] 2024-05-06 01:26:39.614 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"'{Erin Hale}'"; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4761)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4667)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3734] - [ERROR] 2024-05-06 01:26:39.614 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3734] - [ERROR] 2024-05-06 01:26:39.614 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.614 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3734.log
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.615 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3734.log, fetch way: log 
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.615 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.617 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.647 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1004][TI-3734] - [INFO] 2024-05-06 01:26:39.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3734] - [INFO] 2024-05-06 01:26:40.476 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3734, success=true)
[WI-0][TI-3734] - [INFO] 2024-05-06 01:26:40.489 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3734, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:40.551 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7669616519174041 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:41.562 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7005649717514125 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:41.581 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3735, taskName=persist in postgresql, firstSubmitTime=1714930001555, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3735'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012641'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@462fa2ef, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.582 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.583 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.585 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.585 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930001585
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3735
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.586 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3735,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930001555,
  "startTime" : 1714930001585,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3735.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3735"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012641"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1004_3735",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.591 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.591 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.591 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3735 check successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.607 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.607 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.613 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.613 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.614 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.614 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.616 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}] successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.617 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.617 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.617 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.618 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.618 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.619 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.619 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.620 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.621 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.621 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.622 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3735] - [ERROR] 2024-05-06 01:26:41.622 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"'{Erin Hale}'"; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4761)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4667)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3735] - [ERROR] 2024-05-06 01:26:41.622 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3735] - [ERROR] 2024-05-06 01:26:41.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.648 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3735.log
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.649 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3735.log, fetch way: log 
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.651 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.654 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1004][TI-3735] - [INFO] 2024-05-06 01:26:41.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3735] - [INFO] 2024-05-06 01:26:42.460 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3735, success=true)
[WI-0][TI-3735] - [INFO] 2024-05-06 01:26:42.484 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3735, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:43.525 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3736, taskName=persist in postgresql, firstSubmitTime=1714930003500, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3736'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012643'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@5401f3c, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.534 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.544 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.555 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.557 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930003558
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3736
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3736,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930003500,
  "startTime" : 1714930003558,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3736.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3736"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012643"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1004_3736",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.567 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.569 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3736 check successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.573 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}] successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.574 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.574 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.574 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.574 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.574 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.579 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.579 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.580 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.580 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.580 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.580 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3736] - [ERROR] 2024-05-06 01:26:43.580 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"'{Erin Hale}'"; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4761)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4667)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3736] - [ERROR] 2024-05-06 01:26:43.581 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3736] - [ERROR] 2024-05-06 01:26:43.581 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.582 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3736.log
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.582 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3736.log, fetch way: log 
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.582 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.582 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1004][TI-3736] - [INFO] 2024-05-06 01:26:43.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3736] - [INFO] 2024-05-06 01:26:44.469 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3736, success=true)
[WI-0][TI-3736] - [INFO] 2024-05-06 01:26:44.478 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3736, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:45.555 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3737, taskName=persist in postgresql, firstSubmitTime=1714930005532, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=48, appIds=null, processInstanceId=1004, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3737'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506012645'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1004'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@17c38fe0, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.558 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.560 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.565 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930005566
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1004_3737
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.567 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3737,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930005532,
  "startTime" : 1714930005566,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3737.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 48,
  "processInstanceId" : 1004,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3737"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506012645"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "2024-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1004"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "'{Erin Hale}'"
    }
  },
  "taskAppId" : "1004_3737",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"2024-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\\n\\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\\n\\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\\n\\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\\n\\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\\n\\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\\n\\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\\n\\nThe WSJ did not immediately respond to a request for comment.\\n\\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\\n\\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\\n\\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\\n\\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\\n\\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\\n\\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\\n\\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\\n\\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"'{Erin Hale}'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.570 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.580 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_48/1004/3737 check successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.581 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.583 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.585 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"2024-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.\n\nHong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.\n\nEditor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.\n\nThe cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.\n\nIn her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.\n\n“At the core of these changes is the creation of a new business, finance and economics group,” she said.\n\n“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”\n\nThe WSJ did not immediately respond to a request for comment.\n\nSince the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.\n\nChina’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.\n\nEarlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.\n\nHundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.\n\nMainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.\n\nSeveral local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.\n\nOnce known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.\n\nLast month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai."},{"prop":"url","direct":"IN","type":"VARCHAR","value":"https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en"},{"prop":"authors","direct":"IN","type":"LIST","value":"'{Erin Hale}'"}] successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.588 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.588 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='2024-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='Wall Street Journal cuts Hong Kong staff, shifts focus to Singapore - Al Jazeera English'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='Company-wide memo says the newspaper is shifting its ‘center of gravity in the region’ to Southeast Asian hub.

Hong Kong, China – The Wall Street Journal has announced staff cuts at its Hong Kong bureau as it shifts its “center of gravity in the region” to Singapore, marking the latest blow to the financial hub’s once-thriving media industry.

Editor-in-chief Emma Tucker told staff in a company-wide memo on Thursday that the newspaper was following the same path that “many of the companies we cover have done”.

The cuts include six editorial staff in Hong Kong and two reporters at the newspaper’s Singapore office, two sources familiar with the matter told Al Jazeera on condition of anonymity.

In her memo, Tucker said “some of our colleagues, mostly in Hong Kong, will be leaving us”, while listing several new positions in Singapore, including an editor and several reporters.

“At the core of these changes is the creation of a new business, finance and economics group,” she said.

“This unites what had been separate teams under one banner with a common goal: Focus on the biggest money stories in Asia – the rise of China’s EV industry, the chip war, China Shock 2.0, the struggles of Hong Kong’s finance industry and China’s stunning property bust.”

The WSJ did not immediately respond to a request for comment.

Since the imposition of a Beijing-decreed national security law and some of the world’s toughest pandemic curbs in 2020, numerous international companies have departed Hong Kong or scaled bank operations in the city, shifting resources elsewhere.

China’s economic slowdown has also impacted the work of the army of analysts and financiers who thrived in Hong Kong’s once-free-wheeling atmosphere, in turn informing the coverage of media outlets such as the WSJ.

Earlier this year, Hong Kong’s Hang Seng Index fell to its lowest levels since 1997, the year the former British colony was returned to Chinese sovereignty, in what was widely seen as an ominous sign for the future of the city’s economy – although the market has rebounded over 10 percent during the last month.

Hundreds of thousands of expatriate and local residents have departed the city in recent years, many of them driven to leave by harsh zero-COVID curbs and a national security crackdown that has weakened rights and freedoms that are supposed to be guaranteed until 2047 under an arrangement known as “one country, two systems”.

Mainland Chinese and Hong Kong officials have argued that a greater focus on national security has been necessary to restore peace and stability to the city after mass antigovernment protests in 2019 that devolved into widespread property destruction and clashes with police.

Several local independent news outlets have shuttered under political pressure, while international media including The New York Times and Radio Free Asia have shifted editorial positions to cities such as Seoul and Taipei.

Once known as one of the freest media environments in Asia, Hong Kong ranks 135 out of 180 countries and territories in Reporters without Borders’ (RSF) latest media freedom index released on Friday, falling between the Philippines and South Sudan.

Last month, Hong Kong immigration authorities denied entry to an RSF representative who visited the city to attend the ongoing national security trial of media tycoon Jimmy Lai.'}, Property{prop='url', direct=IN, type=VARCHAR, value='https://news.google.com/rss/articles/CBMibWh0dHBzOi8vd3d3LmFsamF6ZWVyYS5jb20vZWNvbm9teS8yMDI0LzUvMy93YWxsLXN0cmVldC1qb3VybmFsLWN1dHMtaG9uZy1rb25nLXN0YWZmLXNoaWZ0cy1mb2N1cy10by1zaW5nYXBvcmXSAXFodHRwczovL3d3dy5hbGphemVlcmEuY29tL2FtcC9lY29ub215LzIwMjQvNS8zL3dhbGwtc3RyZWV0LWpvdXJuYWwtY3V0cy1ob25nLWtvbmctc3RhZmYtc2hpZnRzLWZvY3VzLXRvLXNpbmdhcG9yZQ?oc=5&hl=en-SG&gl=SG&ceid=SG:en'}, Property{prop='authors', direct=IN, type=LIST, value=''{Erin Hale}''}] ,query max result limit  0
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.594 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.595 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.596 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.596 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.597 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.597 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1004][TI-3737] - [ERROR] 2024-05-06 01:26:45.598 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"'{Erin Hale}'"; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4761)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4667)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3737] - [ERROR] 2024-05-06 01:26:45.598 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1004][TI-3737] - [ERROR] 2024-05-06 01:26:45.598 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.599 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3737.log
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.599 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/48/1004/3737.log, fetch way: log 
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.599 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.604 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1004][TI-3737] - [INFO] 2024-05-06 01:26:45.605 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3737] - [INFO] 2024-05-06 01:26:46.525 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3737, success=true)
[WI-0][TI-3737] - [INFO] 2024-05-06 01:26:46.538 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3737, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:26:47.604 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7037037037037037 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:13.784 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8047337278106509 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:23.484 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7433333333333334 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:24.591 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3738, taskName=consume filtered data, firstSubmitTime=1714930344577, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3738'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013224'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.594 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.595 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.609 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.609 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930344609
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3738
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3738,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714930344577,
  "startTime" : 1714930344609,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3738.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3738"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013224"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1005_3738",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3738 check successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.625 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.625 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.631 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.632 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.633 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.633 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.634 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.634 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.634 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.634 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.635 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3738/1005_3738.sh
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:24.641 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2368
[WI-0][TI-3738] - [INFO] 2024-05-06 01:32:25.552 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3738, success=true)
[WI-0][TI-3738] - [INFO] 2024-05-06 01:32:25.563 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3738)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:25.647 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.650 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3738, processId:2368 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.652 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3738
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.657 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3738
[WI-1005][TI-3738] - [INFO] 2024-05-06 01:32:25.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3738] - [INFO] 2024-05-06 01:32:26.557 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3738, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:26.813 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3739, taskName=parse the message, firstSubmitTime=1714930346768, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\\"{\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3739'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013226'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.837 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.840 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930346851
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3739
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3739,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714930346768,
  "startTime" : 1714930346851,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3739.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"\\\\\\\"{\\\" + ', '.join([f\\\"\\\\'{x}\\\\'\\\" for x in authors]) + \\\"}\\\\\\\"\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3739"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013226"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1005_3739",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.862 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.862 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.862 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.890 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.893 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.893 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739 check successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.893 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.893 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.896 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\\"{\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.896 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.897 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.897 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.897 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\"{" + ', '.join([f"\'{x}\'" for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.898 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.899 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739/py_1005_3739.py
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.899 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\"{" + ', '.join([f"\'{x}\'" for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.900 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.900 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.901 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739/py_1005_3739.py
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.901 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.901 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739/1005_3739.sh
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:26.934 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2379
[WI-0][TI-3739] - [INFO] 2024-05-06 01:32:27.556 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3739, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:27.560 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7945619335347431 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3739] - [INFO] 2024-05-06 01:32:27.581 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3739)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:27.955 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors="{'Erin Hale', 'sss hale'}")}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.960 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739, processId:2379 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.975 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.976 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.984 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3739
[WI-1005][TI-3739] - [INFO] 2024-05-06 01:32:27.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3739] - [INFO] 2024-05-06 01:32:28.550 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3739, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:28.627 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3740, taskName=persist in postgresql, firstSubmitTime=1714930348618, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3740'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013228'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@706b7851, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.628 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.628 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.631 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.631 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930348632
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.632 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3740
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.634 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3740,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930348618,
  "startTime" : 1714930348632,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3740.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3740"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013228"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{'Erin Hale', 'sss hale'}\""
    }
  },
  "taskAppId" : "1005_3740",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{'Erin Hale', 'sss hale'}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.637 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.643 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.644 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3740 check successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.646 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.646 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.647 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.647 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.647 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}] successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.648 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.649 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}] ,query max result limit  0
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.650 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.651 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.651 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.651 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.653 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.653 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3740] - [ERROR] 2024-05-06 01:32:28.654 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{'Erin Hale', 'sss hale'}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3740] - [ERROR] 2024-05-06 01:32:28.655 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3740] - [ERROR] 2024-05-06 01:32:28.656 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.667 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3740.log
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.673 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3740.log, fetch way: log 
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.674 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.674 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1005][TI-3740] - [INFO] 2024-05-06 01:32:28.697 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3740] - [INFO] 2024-05-06 01:32:29.557 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3740, success=true)
[WI-0][TI-3740] - [INFO] 2024-05-06 01:32:29.565 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3740, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:30.696 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3741, taskName=persist in postgresql, firstSubmitTime=1714930350644, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3741'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013230'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@416e2c49, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.698 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.699 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.700 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.701 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930350701
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3741
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.702 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3741,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930350644,
  "startTime" : 1714930350701,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3741.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3741"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013230"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{'Erin Hale', 'sss hale'}\""
    }
  },
  "taskAppId" : "1005_3741",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{'Erin Hale', 'sss hale'}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.715 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3741 check successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.747 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.748 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.748 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.748 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}] successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.754 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.754 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}] ,query max result limit  0
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.755 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.756 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.756 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.756 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.757 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.757 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3741] - [ERROR] 2024-05-06 01:32:30.758 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{'Erin Hale', 'sss hale'}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3741] - [ERROR] 2024-05-06 01:32:30.758 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3741] - [ERROR] 2024-05-06 01:32:30.759 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.762 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3741.log
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.763 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3741.log, fetch way: log 
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.765 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.773 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1005][TI-3741] - [INFO] 2024-05-06 01:32:30.773 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3741] - [INFO] 2024-05-06 01:32:31.595 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3741, success=true)
[WI-0][TI-3741] - [INFO] 2024-05-06 01:32:31.606 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3741, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:31.620 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7098765432098765 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:32.703 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7219251336898396 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:32.717 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3742, taskName=persist in postgresql, firstSubmitTime=1714930352704, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3742'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013232'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@495f4341, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.719 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.721 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.722 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930352722
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3742
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3742,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930352704,
  "startTime" : 1714930352722,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3742.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3742"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013232"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{'Erin Hale', 'sss hale'}\""
    }
  },
  "taskAppId" : "1005_3742",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{'Erin Hale', 'sss hale'}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.730 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3742 check successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.731 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.732 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.732 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}] successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.734 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.734 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.734 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}] ,query max result limit  0
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.735 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.735 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.735 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.735 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.736 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.736 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3742] - [ERROR] 2024-05-06 01:32:32.737 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{'Erin Hale', 'sss hale'}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3742] - [ERROR] 2024-05-06 01:32:32.739 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3742] - [ERROR] 2024-05-06 01:32:32.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.740 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3742.log
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.741 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3742.log, fetch way: log 
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.742 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.742 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1005][TI-3742] - [INFO] 2024-05-06 01:32:32.750 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3742] - [INFO] 2024-05-06 01:32:33.557 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3742, success=true)
[WI-0][TI-3742] - [INFO] 2024-05-06 01:32:33.565 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3742, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:34.631 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3743, taskName=persist in postgresql, firstSubmitTime=1714930354617, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=49, appIds=null, processInstanceId=1005, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3743'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013234'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1005'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@4b9e686f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.632 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.633 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.635 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.635 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930354635
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.635 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1005_3743
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.636 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3743,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930354617,
  "startTime" : 1714930354635,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3743.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 49,
  "processInstanceId" : 1005,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3743"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013234"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1005"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{'Erin Hale', 'sss hale'}\""
    }
  },
  "taskAppId" : "1005_3743",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{'Erin Hale', 'sss hale'}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.639 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.639 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_49/1005/3743 check successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.640 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{'Erin Hale', 'sss hale'}\""}] successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.641 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{'Erin Hale', 'sss hale'}"'}] ,query max result limit  0
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.642 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.643 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.643 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.643 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.644 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.644 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1005][TI-3743] - [ERROR] 2024-05-06 01:32:34.644 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{'Erin Hale', 'sss hale'}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3743] - [ERROR] 2024-05-06 01:32:34.644 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1005][TI-3743] - [ERROR] 2024-05-06 01:32:34.644 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.644 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3743.log
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.644 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/49/1005/3743.log, fetch way: log 
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.645 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.645 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.647 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1005][TI-3743] - [INFO] 2024-05-06 01:32:34.648 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3743] - [INFO] 2024-05-06 01:32:35.581 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3743, success=true)
[WI-0][TI-3743] - [INFO] 2024-05-06 01:32:35.595 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3743, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:32:37.779 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7142857142857143 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:35:34.673 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8449848024316109 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:11.785 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7111801242236024 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:15.828 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7896253602305476 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:22.885 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8348909657320872 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:26.914 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.764525993883792 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:27.906 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3744, taskName=consume filtered data, firstSubmitTime=1714930587897, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3744'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013627'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.908 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.922 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930587923
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3744
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3744,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714930587897,
  "startTime" : 1714930587923,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3744.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3744"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013627"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1006_3744",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.924 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.925 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.925 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3744 check successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.936 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.937 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.938 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.938 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.939 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.940 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.940 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.940 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.941 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.942 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.943 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.943 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.943 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3744/1006_3744.sh
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:27.953 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2442
[WI-0][TI-3744] - [INFO] 2024-05-06 01:36:28.663 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3744, success=true)
[WI-0][TI-3744] - [INFO] 2024-05-06 01:36:28.669 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3744)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:28.954 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.958 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3744, processId:2442 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.959 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.964 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3744
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3744
[WI-1006][TI-3744] - [INFO] 2024-05-06 01:36:28.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3744] - [INFO] 2024-05-06 01:36:29.664 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3744, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:29.713 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3745, taskName=parse the message, firstSubmitTime=1714930589705, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\n# authors = \"\\\"{\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3745'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013629'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.715 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930589717
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3745
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3745,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714930589705,
  "startTime" : 1714930589717,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3745.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\n# authors = \\\"\\\\\\\"{\\\" + ', '.join([f\\\"\\\\'{x}\\\\'\\\" for x in authors]) + \\\"}\\\\\\\"\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3745"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013629"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1006_3745",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.718 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745 check successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\n# authors = \"\\\"{\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.725 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
# authors = "\"{" + ', '.join([f"\'{x}\'" for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.725 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.726 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745/py_1006_3745.py
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.726 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
# authors = "\"{" + ', '.join([f"\'{x}\'" for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.727 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.727 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.727 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745/py_1006_3745.py
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.727 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.727 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745/1006_3745.sh
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:29.730 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2453
[WI-0][TI-3745] - [INFO] 2024-05-06 01:36:30.751 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3745, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:30.733 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors=['Erin Hale', 'sss hale'])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.752 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745, processId:2453 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.752 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.753 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.753 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.771 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.774 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.774 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3745
[WI-1006][TI-3745] - [INFO] 2024-05-06 01:36:30.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3745] - [INFO] 2024-05-06 01:36:30.935 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3745)
[WI-0][TI-3745] - [INFO] 2024-05-06 01:36:30.973 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3745, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:30.975 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7309941520467836 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:31.120 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3746, taskName=persist in postgresql, firstSubmitTime=1714930591087, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3746'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013631'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@321e3151, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.121 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.121 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.123 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.123 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.123 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.123 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930591123
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.124 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3746
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.124 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3746,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930591087,
  "startTime" : 1714930591123,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3746.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3746"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013631"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1006_3746",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.125 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.125 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.125 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.147 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3746 check successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.159 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.160 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.169 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.170 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.180 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.181 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.181 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.181 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.181 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3746] - [ERROR] 2024-05-06 01:36:31.181 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3746] - [ERROR] 2024-05-06 01:36:31.194 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3746] - [ERROR] 2024-05-06 01:36:31.195 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.195 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3746.log
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.195 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3746.log, fetch way: log 
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.196 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.196 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.208 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1006][TI-3746] - [INFO] 2024-05-06 01:36:31.209 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3746] - [INFO] 2024-05-06 01:36:31.683 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3746, success=true)
[WI-0][TI-3746] - [INFO] 2024-05-06 01:36:31.692 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3746, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:32.037 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8732394366197183 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:32.780 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3747, taskName=persist in postgresql, firstSubmitTime=1714930592764, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3747'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013632'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@5b1c9813, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.790 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.795 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.795 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.795 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.795 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930592795
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3747
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3747,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930592764,
  "startTime" : 1714930592795,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3747.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3747"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013632"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1006_3747",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.834 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.835 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3747 check successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.849 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.851 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.860 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.861 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.862 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.862 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.862 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.863 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.864 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.865 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.865 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.865 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.865 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3747] - [ERROR] 2024-05-06 01:36:32.866 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3747] - [ERROR] 2024-05-06 01:36:32.866 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3747] - [ERROR] 2024-05-06 01:36:32.866 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.866 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3747.log
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.866 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3747.log, fetch way: log 
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.867 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.881 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1006][TI-3747] - [INFO] 2024-05-06 01:36:32.882 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3747] - [INFO] 2024-05-06 01:36:33.684 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3747, success=true)
[WI-0][TI-3747] - [INFO] 2024-05-06 01:36:33.692 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3747, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:34.828 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3748, taskName=persist in postgresql, firstSubmitTime=1714930594799, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3748'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013634'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@16eb3987, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.831 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.831 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.833 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.834 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.834 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.834 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930594834
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.834 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3748
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.834 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3748,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930594799,
  "startTime" : 1714930594834,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3748.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3748"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013634"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1006_3748",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.835 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.835 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.835 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.872 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.873 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3748 check successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.873 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.877 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.880 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.880 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.882 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.885 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.886 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.886 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.886 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.887 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.887 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.887 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.887 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3748] - [ERROR] 2024-05-06 01:36:34.887 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3748] - [ERROR] 2024-05-06 01:36:34.887 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3748] - [ERROR] 2024-05-06 01:36:34.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.888 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3748.log
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.888 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3748.log, fetch way: log 
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.888 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1006][TI-3748] - [INFO] 2024-05-06 01:36:34.897 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3748] - [INFO] 2024-05-06 01:36:35.705 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3748, success=true)
[WI-0][TI-3748] - [INFO] 2024-05-06 01:36:35.715 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3748, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:36:36.783 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3749, taskName=persist in postgresql, firstSubmitTime=1714930596738, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=50, appIds=null, processInstanceId=1006, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3749'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506013636'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1006'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@7f136b4f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.785 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.788 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.788 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.788 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.788 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714930596788
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.789 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1006_3749
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.789 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3749,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714930596738,
  "startTime" : 1714930596788,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3749.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 50,
  "processInstanceId" : 1006,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3749"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506013636"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1006"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1006_3749",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.795 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_50/1006/3749 check successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.796 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.797 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.797 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.797 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.797 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.797 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.798 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.799 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.800 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.800 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.800 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.801 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.801 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.801 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1006][TI-3749] - [ERROR] 2024-05-06 01:36:36.803 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3749] - [ERROR] 2024-05-06 01:36:36.803 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1006][TI-3749] - [ERROR] 2024-05-06 01:36:36.805 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.805 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3749.log
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.805 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/50/1006/3749.log, fetch way: log 
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.806 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.807 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1006][TI-3749] - [INFO] 2024-05-06 01:36:36.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3749] - [INFO] 2024-05-06 01:36:37.701 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3749, success=true)
[WI-0][TI-3749] - [INFO] 2024-05-06 01:36:37.712 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3749, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:23.847 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7321428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:27.958 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3750, taskName=consume filtered data, firstSubmitTime=1714931067947, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3750'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014427'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.966 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.966 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.993 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.993 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.993 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931067994
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3750
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3750,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714931067947,
  "startTime" : 1714931067994,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3750.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3750"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014427"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1007_3750",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:27.999 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.003 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3750 check successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.016 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.017 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.017 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.017 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.017 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3750/1007_3750.sh
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:28.032 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2562
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:28.032 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-3750] - [INFO] 2024-05-06 01:44:28.080 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3750, success=true)
[WI-0][TI-3750] - [INFO] 2024-05-06 01:44:28.101 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3750)
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.040 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3750, processId:2562 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.041 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.041 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.041 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.043 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3750
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.050 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3750
[WI-1007][TI-3750] - [INFO] 2024-05-06 01:44:29.051 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3750] - [INFO] 2024-05-06 01:44:29.075 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3750, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:29.184 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3751, taskName=parse the message, firstSubmitTime=1714931069165, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\\"{\" + ', '.join([str(x) for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3751'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014429'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.202 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.204 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.206 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.206 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.208 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.208 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931069208
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.208 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3751
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.209 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3751,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714931069165,
  "startTime" : 1714931069208,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3751.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"\\\\\\\"{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\\\\\"\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3751"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014429"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1007_3751",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.211 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.211 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.211 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.240 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.241 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.242 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751 check successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.244 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.245 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.246 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.252 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.252 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"\\\"{\" + ', '.join([str(x) for x in authors]) + \"}\\\"\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.253 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\"{" + ', '.join([str(x) for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.254 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.254 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751/py_1007_3751.py
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.254 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "\"{" + ', '.join([str(x) for x in authors]) + "}\""

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.255 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.255 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.255 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751/py_1007_3751.py
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.255 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.255 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751/1007_3751.sh
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:29.276 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2573
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:29.921 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7126760563380282 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3751] - [INFO] 2024-05-06 01:44:30.084 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3751, success=true)
[WI-0][TI-3751] - [INFO] 2024-05-06 01:44:30.105 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3751)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:30.281 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors="{Erin Hale, sss hale}")}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.302 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751, processId:2573 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.305 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.320 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.322 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3751
[WI-1007][TI-3751] - [INFO] 2024-05-06 01:44:30.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:30.995 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7329700272479565 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3751] - [INFO] 2024-05-06 01:44:31.108 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3751, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:31.327 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3752, taskName=persist in postgresql, firstSubmitTime=1714931071298, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3752'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014431'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@4e1f9017, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.331 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.332 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.335 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931071335
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3752
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3752,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931071298,
  "startTime" : 1714931071335,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3752.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3752"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014431"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{Erin Hale, sss hale}\""
    }
  },
  "taskAppId" : "1007_3752",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{Erin Hale, sss hale}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.363 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.364 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3752 check successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.366 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.373 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.379 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.386 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.387 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.387 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.387 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}] successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.388 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.392 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.392 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.392 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.392 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}] ,query max result limit  0
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.394 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.395 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.407 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.409 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.409 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.409 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3752] - [ERROR] 2024-05-06 01:44:31.410 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{Erin Hale, sss hale}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3752] - [ERROR] 2024-05-06 01:44:31.410 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3752] - [ERROR] 2024-05-06 01:44:31.410 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.415 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3752.log
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.415 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3752.log, fetch way: log 
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.417 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.418 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1007][TI-3752] - [INFO] 2024-05-06 01:44:31.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:31.996 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7446808510638298 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3752] - [INFO] 2024-05-06 01:44:32.087 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3752, success=true)
[WI-0][TI-3752] - [INFO] 2024-05-06 01:44:32.094 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3752, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:33.251 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3753, taskName=persist in postgresql, firstSubmitTime=1714931073185, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3753'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014433'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@7bdd897, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.253 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.253 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.255 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.255 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931073255
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3753
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.256 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3753,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931073185,
  "startTime" : 1714931073255,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3753.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3753"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014433"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{Erin Hale, sss hale}\""
    }
  },
  "taskAppId" : "1007_3753",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{Erin Hale, sss hale}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.261 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.263 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3753 check successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.264 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.265 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.265 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.267 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}] successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.268 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.269 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.271 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.271 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.273 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}] ,query max result limit  0
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.286 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.292 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.292 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.293 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3753] - [ERROR] 2024-05-06 01:44:33.297 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{Erin Hale, sss hale}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3753] - [ERROR] 2024-05-06 01:44:33.298 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3753] - [ERROR] 2024-05-06 01:44:33.299 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.299 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3753.log
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.302 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3753.log, fetch way: log 
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.304 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1007][TI-3753] - [INFO] 2024-05-06 01:44:33.315 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3753] - [INFO] 2024-05-06 01:44:34.098 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3753, success=true)
[WI-0][TI-3753] - [INFO] 2024-05-06 01:44:34.109 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3753, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:35.138 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3754, taskName=persist in postgresql, firstSubmitTime=1714931075123, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3754'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014435'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1b3858f2, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.139 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.139 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.142 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931075142
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.142 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3754
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.143 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3754,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931075123,
  "startTime" : 1714931075142,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3754.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3754"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014435"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{Erin Hale, sss hale}\""
    }
  },
  "taskAppId" : "1007_3754",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{Erin Hale, sss hale}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3754 check successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.172 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}] successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.175 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.175 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}] ,query max result limit  0
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.175 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.176 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.176 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.176 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.176 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.177 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3754] - [ERROR] 2024-05-06 01:44:35.177 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{Erin Hale, sss hale}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3754] - [ERROR] 2024-05-06 01:44:35.177 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3754] - [ERROR] 2024-05-06 01:44:35.178 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.178 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3754.log
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.179 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3754.log, fetch way: log 
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.180 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.180 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.191 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1007][TI-3754] - [INFO] 2024-05-06 01:44:35.192 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3754] - [INFO] 2024-05-06 01:44:36.093 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3754, success=true)
[WI-0][TI-3754] - [INFO] 2024-05-06 01:44:36.126 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3754, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:44:37.153 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3755, taskName=persist in postgresql, firstSubmitTime=1714931077140, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=51, appIds=null, processInstanceId=1007, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3755'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014437'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1007'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@a9e57bd, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.155 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.157 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931077157
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1007_3755
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3755,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931077140,
  "startTime" : 1714931077157,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3755.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 51,
  "processInstanceId" : 1007,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3755"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014437"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1007"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "\"{Erin Hale, sss hale}\""
    }
  },
  "taskAppId" : "1007_3755",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"\\\"{Erin Hale, sss hale}\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.158 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.158 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.158 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.191 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.192 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.192 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_51/1007/3755 check successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.193 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.193 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.193 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.193 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"\"{Erin Hale, sss hale}\""}] successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.194 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='"{Erin Hale, sss hale}"'}] ,query max result limit  0
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.195 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1007][TI-3755] - [ERROR] 2024-05-06 01:44:37.196 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from String value (token `JsonToken.VALUE_STRING`)
 at [Source: (String)""{Erin Hale, sss hale}""; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromString(CollectionDeserializer.java:326)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:250)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3755] - [ERROR] 2024-05-06 01:44:37.196 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1007][TI-3755] - [ERROR] 2024-05-06 01:44:37.196 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.197 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3755.log
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.197 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/51/1007/3755.log, fetch way: log 
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.197 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.197 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.200 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1007][TI-3755] - [INFO] 2024-05-06 01:44:37.200 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3755] - [INFO] 2024-05-06 01:44:38.093 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3755, success=true)
[WI-0][TI-3755] - [INFO] 2024-05-06 01:44:38.119 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3755, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:00.100 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7393939393939394 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:26.249 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8939393939393939 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:30.267 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3756, taskName=consume filtered data, firstSubmitTime=1714931130252, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3756'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014530'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.269 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.270 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:30.331 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7576687116564418 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931130344
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3756
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.347 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3756,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714931130252,
  "startTime" : 1714931130344,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3756.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3756"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014530"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1008_3756",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.366 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.381 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.391 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.393 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.393 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3756 check successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.395 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.396 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.396 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.396 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3756/1008_3756.sh
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:30.412 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2600
[WI-0][TI-3756] - [INFO] 2024-05-06 01:45:31.161 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3756, success=true)
[WI-0][TI-3756] - [INFO] 2024-05-06 01:45:31.189 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3756)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:31.415 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.424 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3756, processId:2600 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.425 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.425 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.425 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.427 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.441 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.441 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.443 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3756
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.444 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3756
[WI-1008][TI-3756] - [INFO] 2024-05-06 01:45:31.449 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3756] - [INFO] 2024-05-06 01:45:32.161 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3756, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:32.222 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3757, taskName=parse the message, firstSubmitTime=1714931132216, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3757'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014532'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.223 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.224 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.226 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.226 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931132226
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.226 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3757
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.227 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3757,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714931132216,
  "startTime" : 1714931132226,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3757.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"{\\\" + ', '.join([str(x) for x in authors]) + \\\"}\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3757"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014532"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1008_3757",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.228 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.228 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.228 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.230 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.230 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757 check successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.232 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.232 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.232 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"{\" + ', '.join([str(x) for x in authors]) + \"}\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.233 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.234 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757/py_1008_3757.py
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.234 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "{" + ', '.join([str(x) for x in authors]) + "}"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.235 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.235 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.235 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757/py_1008_3757.py
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.236 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.236 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757/1008_3757.sh
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:32.240 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2616
[WI-0][TI-3757] - [INFO] 2024-05-06 01:45:33.167 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3757, success=true)
[WI-0][TI-3757] - [INFO] 2024-05-06 01:45:33.175 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3757)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:33.242 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors={Erin Hale, sss hale})}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.244 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757, processId:2616 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.245 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.245 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.245 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.245 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.251 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.251 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.251 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.252 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3757
[WI-1008][TI-3757] - [INFO] 2024-05-06 01:45:33.252 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:33.403 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8052325581395349 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3757] - [INFO] 2024-05-06 01:45:34.163 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3757, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:34.299 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3758, taskName=persist in postgresql, firstSubmitTime=1714931134291, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3758'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014534'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@58cb2005, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.302 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.304 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931134304
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.305 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3758
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.306 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3758,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931134291,
  "startTime" : 1714931134304,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3758.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3758"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014534"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale, sss hale}"
    }
  },
  "taskAppId" : "1008_3758",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale, sss hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.307 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.307 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.307 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.313 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.313 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3758 check successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.316 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.317 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}] successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.319 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.319 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.319 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}] ,query max result limit  0
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.319 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.320 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.320 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.320 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.321 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.321 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3758] - [ERROR] 2024-05-06 01:45:34.326 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale, sss hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3758] - [ERROR] 2024-05-06 01:45:34.327 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3758] - [ERROR] 2024-05-06 01:45:34.328 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.328 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3758.log
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.328 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3758.log, fetch way: log 
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.329 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.329 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1008][TI-3758] - [INFO] 2024-05-06 01:45:34.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:34.445 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7636887608069164 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3758] - [INFO] 2024-05-06 01:45:35.173 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3758, success=true)
[WI-0][TI-3758] - [INFO] 2024-05-06 01:45:35.181 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3758, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:36.295 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3759, taskName=persist in postgresql, firstSubmitTime=1714931136282, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3759'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014536'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@7340b233, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.299 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.299 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.301 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.301 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931136301
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3759
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.302 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3759,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931136282,
  "startTime" : 1714931136301,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3759.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3759"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014536"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale, sss hale}"
    }
  },
  "taskAppId" : "1008_3759",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale, sss hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.303 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.308 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.309 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3759 check successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.309 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.310 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.311 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}] successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.313 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.313 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}] ,query max result limit  0
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.343 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.343 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.343 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.344 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.344 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.344 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3759] - [ERROR] 2024-05-06 01:45:36.345 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale, sss hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3759] - [ERROR] 2024-05-06 01:45:36.347 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3759] - [ERROR] 2024-05-06 01:45:36.348 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.348 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3759.log
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.348 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3759.log, fetch way: log 
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.349 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1008][TI-3759] - [INFO] 2024-05-06 01:45:36.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3759] - [INFO] 2024-05-06 01:45:37.171 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3759, success=true)
[WI-0][TI-3759] - [INFO] 2024-05-06 01:45:37.182 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3759, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:38.288 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3760, taskName=persist in postgresql, firstSubmitTime=1714931138252, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3760'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014538'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@3a14e0f2, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.290 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.291 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.293 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.294 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931138295
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.295 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3760
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.296 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3760,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931138252,
  "startTime" : 1714931138295,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3760.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3760"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014538"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale, sss hale}"
    }
  },
  "taskAppId" : "1008_3760",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale, sss hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.297 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.300 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.303 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3760 check successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.304 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.305 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.306 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.306 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.307 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}] successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.308 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}] ,query max result limit  0
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.310 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3760] - [ERROR] 2024-05-06 01:45:38.310 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale, sss hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3760] - [ERROR] 2024-05-06 01:45:38.311 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3760] - [ERROR] 2024-05-06 01:45:38.311 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.311 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3760.log
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.311 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3760.log, fetch way: log 
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.312 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.312 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.360 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1008][TI-3760] - [INFO] 2024-05-06 01:45:38.360 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3760] - [INFO] 2024-05-06 01:45:39.207 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3760, success=true)
[WI-0][TI-3760] - [INFO] 2024-05-06 01:45:39.216 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3760, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:45:40.321 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3761, taskName=persist in postgresql, firstSubmitTime=1714931140304, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=52, appIds=null, processInstanceId=1008, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3761'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014540'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1008'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@5d2ba84d, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.323 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.325 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931140327
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1008_3761
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3761,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931140304,
  "startTime" : 1714931140327,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3761.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 52,
  "processInstanceId" : 1008,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3761"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014540"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1008"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "{Erin Hale, sss hale}"
    }
  },
  "taskAppId" : "1008_3761",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"{Erin Hale, sss hale}\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.329 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.329 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.329 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.339 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.342 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_52/1008/3761 check successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.346 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.347 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.348 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"{Erin Hale, sss hale}"}] successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.349 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.350 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='{Erin Hale, sss hale}'}] ,query max result limit  0
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.351 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.351 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.351 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.352 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.352 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.353 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1008][TI-3761] - [ERROR] 2024-05-06 01:45:40.353 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.util.ArrayList<java.lang.Object>` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: (String)"{Erin Hale, sss hale}"; line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1741)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1515)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1462)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.handleNonArray(CollectionDeserializer.java:392)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:252)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3761] - [ERROR] 2024-05-06 01:45:40.354 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1008][TI-3761] - [ERROR] 2024-05-06 01:45:40.355 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.356 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3761.log
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.356 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/52/1008/3761.log, fetch way: log 
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.357 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.362 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1008][TI-3761] - [INFO] 2024-05-06 01:45:40.363 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3761] - [INFO] 2024-05-06 01:45:41.190 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3761, success=true)
[WI-0][TI-3761] - [INFO] 2024-05-06 01:45:41.208 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3761, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:12.075 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.752906976744186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:15.750 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3762, taskName=consume filtered data, firstSubmitTime=1714931235734, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3762'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014715'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.752 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.753 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.757 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.757 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931235758
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3762
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3762,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714931235734,
  "startTime" : 1714931235758,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3762.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3762"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014715"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1009_3762",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.759 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.759 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.759 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.774 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.777 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.778 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3762 check successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.781 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.781 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.781 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.782 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.782 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.783 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.783 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.784 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.784 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.785 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3762/1009_3762.sh
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:15.799 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2649
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:16.181 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.784375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3762] - [INFO] 2024-05-06 01:47:16.392 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3762, success=true)
[WI-0][TI-3762] - [INFO] 2024-05-06 01:47:16.405 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3762)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:16.800 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.808 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3762, processId:2649 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.809 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3762
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.814 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3762
[WI-1009][TI-3762] - [INFO] 2024-05-06 01:47:16.814 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3762] - [INFO] 2024-05-06 01:47:17.377 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3762, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:17.507 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3763, taskName=parse the message, firstSubmitTime=1714931237496, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([str(x) for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3763'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014717'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.509 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.512 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.512 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931237512
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3763
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3763,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714931237496,
  "startTime" : 1714931237512,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3763.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"[\\\" + ', '.join([str(x) for x in authors]) + \\\"]\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3763"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014717"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1009_3763",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.513 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.514 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.516 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763 check successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([str(x) for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.518 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.519 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.519 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([str(x) for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.519 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.519 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763/py_1009_3763.py
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.520 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([str(x) for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.520 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.520 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.520 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763/py_1009_3763.py
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.520 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.521 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763/1009_3763.sh
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:17.524 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2660
[WI-0][TI-3763] - [INFO] 2024-05-06 01:47:18.405 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3763, success=true)
[WI-0][TI-3763] - [INFO] 2024-05-06 01:47:18.417 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3763)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:18.525 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors=[Erin Hale, sss hale])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.527 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763, processId:2660 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.532 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.532 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3763
[WI-1009][TI-3763] - [INFO] 2024-05-06 01:47:18.533 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3763] - [INFO] 2024-05-06 01:47:19.386 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3763, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:19.463 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3764, taskName=persist in postgresql, firstSubmitTime=1714931239453, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3764'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014719'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@bd51b7d, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.464 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.465 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.466 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.466 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.466 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.466 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931239466
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.466 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3764
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.467 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3764,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931239453,
  "startTime" : 1714931239466,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3764.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3764"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014719"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[Erin Hale, sss hale]"
    }
  },
  "taskAppId" : "1009_3764",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[Erin Hale, sss hale]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.469 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.469 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.469 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.472 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.476 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3764 check successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}] successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.481 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}] ,query max result limit  0
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.482 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3764] - [ERROR] 2024-05-06 01:47:19.482 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Erin': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"[Erin Hale, sss hale]"; line: 1, column: 6]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:745)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:2961)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2002)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3764] - [ERROR] 2024-05-06 01:47:19.485 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3764] - [ERROR] 2024-05-06 01:47:19.485 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.485 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3764.log
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.485 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3764.log, fetch way: log 
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.485 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.485 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1009][TI-3764] - [INFO] 2024-05-06 01:47:19.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3764] - [INFO] 2024-05-06 01:47:20.402 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3764, success=true)
[WI-0][TI-3764] - [INFO] 2024-05-06 01:47:20.426 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3764, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:21.473 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3765, taskName=persist in postgresql, firstSubmitTime=1714931241464, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3765'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014721'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@20c24f61, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.475 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.476 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.478 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.478 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.479 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.479 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931241479
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.479 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3765
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.480 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3765,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931241464,
  "startTime" : 1714931241479,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3765.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3765"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014721"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[Erin Hale, sss hale]"
    }
  },
  "taskAppId" : "1009_3765",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[Erin Hale, sss hale]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.481 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.489 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.489 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.492 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.492 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3765 check successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.494 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.495 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.495 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}] successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.497 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.497 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.497 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.498 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.498 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}] ,query max result limit  0
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.500 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.500 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.500 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.500 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.501 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.501 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3765] - [ERROR] 2024-05-06 01:47:21.501 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Erin': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"[Erin Hale, sss hale]"; line: 1, column: 6]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:745)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:2961)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2002)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3765] - [ERROR] 2024-05-06 01:47:21.502 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3765] - [ERROR] 2024-05-06 01:47:21.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.503 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3765.log
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.504 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3765.log, fetch way: log 
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.505 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.505 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1009][TI-3765] - [INFO] 2024-05-06 01:47:21.509 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3765] - [INFO] 2024-05-06 01:47:22.391 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3765, success=true)
[WI-0][TI-3765] - [INFO] 2024-05-06 01:47:22.418 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3765, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:23.599 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3766, taskName=persist in postgresql, firstSubmitTime=1714931243522, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3766'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014723'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6bf17556, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.600 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.601 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.640 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.661 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.661 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931243661
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.662 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3766
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.662 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3766,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931243522,
  "startTime" : 1714931243661,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3766.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3766"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014723"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[Erin Hale, sss hale]"
    }
  },
  "taskAppId" : "1009_3766",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[Erin Hale, sss hale]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.750 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3766 check successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.750 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}] successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.751 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.752 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.752 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.752 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.752 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}] ,query max result limit  0
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.753 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.753 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.753 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.753 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.754 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.754 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3766] - [ERROR] 2024-05-06 01:47:23.755 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Erin': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"[Erin Hale, sss hale]"; line: 1, column: 6]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:745)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:2961)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2002)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3766] - [ERROR] 2024-05-06 01:47:23.755 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3766] - [ERROR] 2024-05-06 01:47:23.755 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.755 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3766.log
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.755 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3766.log, fetch way: log 
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.756 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.756 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.782 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1009][TI-3766] - [INFO] 2024-05-06 01:47:23.787 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:24.253 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7244582043343653 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3766] - [INFO] 2024-05-06 01:47:24.393 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3766, success=true)
[WI-0][TI-3766] - [INFO] 2024-05-06 01:47:24.402 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3766, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:25.486 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3767, taskName=persist in postgresql, firstSubmitTime=1714931245449, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=53, appIds=null, processInstanceId=1009, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3767'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014725'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1009'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6bf1bb83, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.490 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.490 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.493 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.493 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931245493
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.493 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1009_3767
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.494 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3767,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931245449,
  "startTime" : 1714931245493,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3767.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 53,
  "processInstanceId" : 1009,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3767"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014725"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1009"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[Erin Hale, sss hale]"
    }
  },
  "taskAppId" : "1009_3767",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[Erin Hale, sss hale]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.495 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.496 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.496 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.504 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.505 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.505 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_53/1009/3767 check successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.506 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.506 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.507 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.507 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[Erin Hale, sss hale]"}] successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.509 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.509 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='[Erin Hale, sss hale]'}] ,query max result limit  0
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.518 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.534 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.547 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.548 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.548 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.548 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1009][TI-3767] - [ERROR] 2024-05-06 01:47:25.560 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Erin': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"[Erin Hale, sss hale]"; line: 1, column: 6]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:745)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:2961)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2002)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3767] - [ERROR] 2024-05-06 01:47:25.561 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1009][TI-3767] - [ERROR] 2024-05-06 01:47:25.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.577 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3767.log
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.577 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/53/1009/3767.log, fetch way: log 
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.578 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.579 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1009][TI-3767] - [INFO] 2024-05-06 01:47:25.596 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3767] - [INFO] 2024-05-06 01:47:26.393 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3767, success=true)
[WI-0][TI-3767] - [INFO] 2024-05-06 01:47:26.401 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3767, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:52.370 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7142857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:47:57.427 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8621700879765395 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:01.460 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7172619047619048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:02.519 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8217270194986073 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:53.697 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7517241379310345 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:58.288 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3768, taskName=consume filtered data, firstSubmitTime=1714931338276, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3768'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014858'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.292 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.292 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.314 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931338314
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3768
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.314 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3768,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714931338276,
  "startTime" : 1714931338314,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3768.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3768"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014858"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1010_3768",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.315 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.315 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.315 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.322 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.323 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3768 check successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.324 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.325 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.325 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.325 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.326 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.327 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.327 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.328 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.328 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.328 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.328 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.328 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3768/1010_3768.sh
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:58.336 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2693
[WI-0][TI-3768] - [INFO] 2024-05-06 01:48:58.640 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3768, success=true)
[WI-0][TI-3768] - [INFO] 2024-05-06 01:48:58.652 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3768)
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:59.336 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.339 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3768, processId:2693 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.340 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3768
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3768
[WI-1010][TI-3768] - [INFO] 2024-05-06 01:48:59.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3768] - [INFO] 2024-05-06 01:48:59.607 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3768, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:59.788 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3769, taskName=parse the message, firstSubmitTime=1714931339765, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3769'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014859'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.791 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.800 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.801 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931339801
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3769
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.805 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3769,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714931339765,
  "startTime" : 1714931339801,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3769.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"[\\\" + ', '.join([f\\\"\\\\'{x}\\\\'\\\" for x in authors]) + \\\"]\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3769"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014859"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1010_3769",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.835 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.843 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.848 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.853 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769 check successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.853 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.853 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.854 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.854 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.854 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\'{x}\\'\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.855 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\'{x}\'" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.856 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.856 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769/py_1010_3769.py
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.856 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\'{x}\'" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.857 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.858 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.859 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769/py_1010_3769.py
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.859 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.859 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769/1010_3769.sh
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:48:59.874 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2704
[WI-0][TI-0] - [INFO] 2024-05-06 01:48:59.874 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-3769] - [INFO] 2024-05-06 01:49:00.607 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3769, success=true)
[WI-0][TI-3769] - [INFO] 2024-05-06 01:49:00.616 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3769)
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:00.878 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	#{setValue(authors=['Erin Hale', 'sss hale'])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:00.987 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769, processId:2704 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:00.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:00.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:00.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:00.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:01.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:01.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:01.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:01.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3769
[WI-1010][TI-3769] - [INFO] 2024-05-06 01:49:01.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3769] - [INFO] 2024-05-06 01:49:01.610 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3769, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:01.665 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3770, taskName=persist in postgresql, firstSubmitTime=1714931341654, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3770'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014901'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@18caae5e, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.666 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931341668
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3770
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3770,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931341654,
  "startTime" : 1714931341668,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3770.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3770"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014901"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1010_3770",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.675 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.675 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3770 check successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.677 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.678 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.678 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.678 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.678 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.678 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3770] - [ERROR] 2024-05-06 01:49:01.678 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3770] - [ERROR] 2024-05-06 01:49:01.679 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3770] - [ERROR] 2024-05-06 01:49:01.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.679 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3770.log
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.679 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3770.log, fetch way: log 
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.679 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1010][TI-3770] - [INFO] 2024-05-06 01:49:01.686 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:01.859 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8922155688622754 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3770] - [INFO] 2024-05-06 01:49:02.610 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3770, success=true)
[WI-0][TI-3770] - [INFO] 2024-05-06 01:49:02.618 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3770, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:02.904 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8285714285714285 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:03.708 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3771, taskName=persist in postgresql, firstSubmitTime=1714931343687, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3771'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014903'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@69441a07, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.709 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.709 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931343713
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3771
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3771,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931343687,
  "startTime" : 1714931343713,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3771.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3771"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014903"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1010_3771",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.717 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.719 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3771 check successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.723 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.724 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.725 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.725 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.726 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.726 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.726 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.727 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3771] - [ERROR] 2024-05-06 01:49:03.727 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3771] - [ERROR] 2024-05-06 01:49:03.728 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3771] - [ERROR] 2024-05-06 01:49:03.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.728 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3771.log
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.729 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3771.log, fetch way: log 
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.729 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1010][TI-3771] - [INFO] 2024-05-06 01:49:03.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3771] - [INFO] 2024-05-06 01:49:04.611 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3771, success=true)
[WI-0][TI-3771] - [INFO] 2024-05-06 01:49:04.619 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3771, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:05.728 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3772, taskName=persist in postgresql, firstSubmitTime=1714931345711, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3772'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014905'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@2be0e2c, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.729 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.731 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.732 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.732 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.732 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931345732
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.732 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3772
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.732 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3772,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931345711,
  "startTime" : 1714931345732,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3772.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3772"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014905"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1010_3772",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3772 check successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.739 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.740 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3772] - [ERROR] 2024-05-06 01:49:05.741 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3772] - [ERROR] 2024-05-06 01:49:05.741 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3772] - [ERROR] 2024-05-06 01:49:05.742 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.742 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3772.log
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.742 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3772.log, fetch way: log 
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.746 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.746 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1010][TI-3772] - [INFO] 2024-05-06 01:49:05.749 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3772] - [INFO] 2024-05-06 01:49:06.616 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3772, success=true)
[WI-0][TI-3772] - [INFO] 2024-05-06 01:49:06.623 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3772, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:49:07.653 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3773, taskName=persist in postgresql, firstSubmitTime=1714931347634, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=54, appIds=null, processInstanceId=1010, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3773'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506014907'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1010'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@3ab1f937, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.656 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.657 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.658 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931347658
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.659 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1010_3773
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.659 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3773,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931347634,
  "startTime" : 1714931347658,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3773.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 54,
  "processInstanceId" : 1010,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3773"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506014907"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1010"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "['Erin Hale', 'sss hale']"
    }
  },
  "taskAppId" : "1010_3773",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"['Erin Hale', 'sss hale']\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.660 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.660 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.660 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.667 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.667 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_54/1010/3773 check successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.667 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.668 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.668 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.669 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.669 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.669 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"['Erin Hale', 'sss hale']"}] successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.670 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.670 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='['Erin Hale', 'sss hale']'}] ,query max result limit  0
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.672 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.673 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.673 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.673 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.673 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.673 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1010][TI-3773] - [ERROR] 2024-05-06 01:49:07.674 +0800 o.a.d.c.u.JSONUtils:[186] - parse list exception!
com.fasterxml.jackson.core.JsonParseException: Unexpected character (''' (code 39)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"['Erin Hale', 'sss hale']"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2391)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:735)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:659)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2005)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:802)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:346)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3629)
	at org.apache.dolphinscheduler.common.utils.JSONUtils.toList(JSONUtils.java:184)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3773] - [ERROR] 2024-05-06 01:49:07.676 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-1010][TI-3773] - [ERROR] 2024-05-06 01:49:07.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.UnsupportedOperationException: null
	at java.util.AbstractList.add(AbstractList.java:148)
	at java.util.AbstractList.add(AbstractList.java:108)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.expandListParameter(ParameterUtils.java:207)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.getSqlAndSqlParamsMap(SqlTask.java:459)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Collections$2.tryAdvance(Collections.java:4719)
	at java.util.Collections$2.forEachRemaining(Collections.java:4727)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:143)
	... 5 common frames omitted
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.676 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3773.log
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.676 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/54/1010/3773.log, fetch way: log 
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.677 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.677 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1010][TI-3773] - [INFO] 2024-05-06 01:49:07.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3773] - [INFO] 2024-05-06 01:49:08.643 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3773, success=true)
[WI-0][TI-3773] - [INFO] 2024-05-06 01:49:08.658 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3773, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:50:03.070 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7039274924471299 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:50:37.191 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7757575757575758 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:50:55.259 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7816455696202531 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:50:58.286 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7446808510638298 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:04.340 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7178571428571427 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:18.156 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3778, taskName=consume filtered data, firstSubmitTime=1714931478149, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"filtered_data_message","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume filtered data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3778'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015118'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.160 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume filtered data to wait queue success
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.173 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.174 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.174 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.174 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931478174
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.174 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3778
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.175 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3778,
  "taskName" : "consume filtered data",
  "firstSubmitTime" : 1714931478149,
  "startTime" : 1714931478174,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3778.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"filtered_data_message\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic ${input_topic} \\\\\\n#     --max-messages 1 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\\\\\n#     --timeout-ms 15000)\\n\\n# echo \\\"#{setValue(filtered_data_message=${filtered_data_message})}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk\nexport KAFKA_HOME=/opt/kafka_2.13-3.7.0",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume filtered data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3778"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015118"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1012_3778",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.175 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.176 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.176 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.181 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.183 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.186 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3778 check successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.186 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.187 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.187 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.187 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.188 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ {
    "prop" : "filtered_data_message",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic ${input_topic} \\\n#     --max-messages 1 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \\\n#     --timeout-ms 15000)\n\n# echo \"#{setValue(filtered_data_message=${filtered_data_message})}\"",
  "resourceList" : [ ]
}
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.188 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.189 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.189 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.190 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.190 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.191 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.191 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.191 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
export KAFKA_HOME=/opt/kafka_2.13-3.7.0
# filtered_data_message = $(${KAFKA_HOME}/bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic gnews_filtered \
#     --max-messages 1 \
#     --from-beginning \
#     --group filtered_data_consumer \
#     --timeout-ms 15000)

# echo "#{setValue(filtered_data_message=${filtered_data_message})}"
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.192 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.192 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3778/1012_3778.sh
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:18.198 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2748
[WI-0][TI-3778] - [INFO] 2024-05-06 01:51:18.917 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3778, success=true)
[WI-0][TI-3778] - [INFO] 2024-05-06 01:51:18.923 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3778)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:19.199 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.228 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3778, processId:2748 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.230 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.231 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.231 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3778
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.237 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3778
[WI-1012][TI-3778] - [INFO] 2024-05-06 01:51:19.237 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3778] - [INFO] 2024-05-06 01:51:19.919 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3778, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:20.060 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3779, taskName=parse the message, firstSubmitTime=1714931480042, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"authors","direct":"OUT","type":"LIST","value":""},{"prop":"content","direct":"OUT","type":"VARCHAR","value":""},{"prop":"url","direct":"OUT","type":"VARCHAR","value":""},{"prop":"context","direct":"OUT","type":"VARCHAR","value":""},{"prop":"type","direct":"OUT","type":"VARCHAR","value":""},{"prop":"datetime","direct":"OUT","type":"TIMESTAMP","value":""}],"rawScript":"filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='parse the message'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3779'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015120'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.073 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: parse the message to wait queue success
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.077 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.104 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.104 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.104 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931480105
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3779
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.105 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3779,
  "taskName" : "parse the message",
  "firstSubmitTime" : 1714931480042,
  "startTime" : 1714931480105,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3779.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"authors\",\"direct\":\"OUT\",\"type\":\"LIST\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"url\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"context\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"type\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"datetime\",\"direct\":\"OUT\",\"type\":\"TIMESTAMP\",\"value\":\"\"}],\"rawScript\":\"filtered_data_message = {\\n\\t\\\"authors\\\": [\\n\\t\\t\\\"Erin Hale\\\",\\n        \\\"sss hale\\\"\\n\\t],\\n\\t\\\"content\\\": \\\"lolcontent\\\",\\n\\t\\\"url\\\": \\\"lol\\\",\\n\\t\\\"context\\\": \\\"context\\\",\\n\\t\\\"type\\\": \\\"article\\\",\\n\\t\\\"datetime\\\": \\\"24-05-03 13:45:22\\\"\\n}\\n\\n# save the message data into separate variables\\n\\nauthors = filtered_data_message['authors']\\n# convert the list of authors into a format that is accepted in the SQL query\\nauthors = \\\"[\\\" + ', '.join([f\\\"\\\\\\\"{x}\\\\\\\"\\\" for x in authors]) + \\\"]\\\"\\n\\ncontent = filtered_data_message['content']\\nurl = filtered_data_message['url']\\ncontext = filtered_data_message['context']\\ntype = filtered_data_message['type']\\ndatetime = filtered_data_message['datetime']\\n\\n# pass the data downstream as parameters suited for the parameterized query\\nprint('#{setValue(authors=%s)}' % str(authors))\\nprint('#{setValue(content=%s)}' % str(content))\\nprint('#{setValue(url=%s)}' % str(url))\\nprint('#{setValue(context=%s)}' % str(context))\\nprint('#{setValue(type=%s)}' % str(type))\\nprint('#{setValue(datetime=%s)}' % str(datetime))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "parse the message"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3779"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015120"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "1012_3779",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.108 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.108 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.109 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779 check successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.156 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.162 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.162 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "authors",
    "direct" : "OUT",
    "type" : "LIST",
    "value" : ""
  }, {
    "prop" : "content",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "url",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "context",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "type",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  }, {
    "prop" : "datetime",
    "direct" : "OUT",
    "type" : "TIMESTAMP",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "filtered_data_message = {\n\t\"authors\": [\n\t\t\"Erin Hale\",\n        \"sss hale\"\n\t],\n\t\"content\": \"lolcontent\",\n\t\"url\": \"lol\",\n\t\"context\": \"context\",\n\t\"type\": \"article\",\n\t\"datetime\": \"24-05-03 13:45:22\"\n}\n\n# save the message data into separate variables\n\nauthors = filtered_data_message['authors']\n# convert the list of authors into a format that is accepted in the SQL query\nauthors = \"[\" + ', '.join([f\"\\\"{x}\\\"\" for x in authors]) + \"]\"\n\ncontent = filtered_data_message['content']\nurl = filtered_data_message['url']\ncontext = filtered_data_message['context']\ntype = filtered_data_message['type']\ndatetime = filtered_data_message['datetime']\n\n# pass the data downstream as parameters suited for the parameterized query\nprint('#{setValue(authors=%s)}' % str(authors))\nprint('#{setValue(content=%s)}' % str(content))\nprint('#{setValue(url=%s)}' % str(url))\nprint('#{setValue(context=%s)}' % str(context))\nprint('#{setValue(type=%s)}' % str(type))\nprint('#{setValue(datetime=%s)}' % str(datetime))",
  "resourceList" : [ ]
}
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.163 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.164 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.165 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.165 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779/py_1012_3779.py
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.169 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

filtered_data_message = {
	"authors": [
		"Erin Hale",
        "sss hale"
	],
	"content": "lolcontent",
	"url": "lol",
	"context": "context",
	"type": "article",
	"datetime": "24-05-03 13:45:22"
}

# save the message data into separate variables

authors = filtered_data_message['authors']
# convert the list of authors into a format that is accepted in the SQL query
authors = "[" + ', '.join([f"\"{x}\"" for x in authors]) + "]"

content = filtered_data_message['content']
url = filtered_data_message['url']
context = filtered_data_message['context']
type = filtered_data_message['type']
datetime = filtered_data_message['datetime']

# pass the data downstream as parameters suited for the parameterized query
print('#{setValue(authors=%s)}' % str(authors))
print('#{setValue(content=%s)}' % str(content))
print('#{setValue(url=%s)}' % str(url))
print('#{setValue(context=%s)}' % str(context))
print('#{setValue(type=%s)}' % str(type))
print('#{setValue(datetime=%s)}' % str(datetime))
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.208 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.208 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.208 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779/py_1012_3779.py
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.208 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.208 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779/1012_3779.sh
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:20.225 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 2759
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:20.493 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7469879518072289 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3779] - [INFO] 2024-05-06 01:51:20.923 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3779, success=true)
[WI-0][TI-3779] - [INFO] 2024-05-06 01:51:20.941 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=3779)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:21.246 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(authors=["Erin Hale", "sss hale"])}
	#{setValue(content=lolcontent)}
	#{setValue(url=lol)}
	#{setValue(context=context)}
	#{setValue(type=article)}
	#{setValue(datetime=24-05-03 13:45:22)}
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.249 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779, processId:2759 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.251 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.251 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.251 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.251 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.255 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.256 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3779
[WI-1012][TI-3779] - [INFO] 2024-05-06 01:51:21.256 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3779] - [INFO] 2024-05-06 01:51:21.934 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3779, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:22.054 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3780, taskName=persist in postgresql, firstSubmitTime=1714931482045, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3780'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015122'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@56a507ff, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.059 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.060 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.061 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.061 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931482061
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.061 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3780
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.062 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3780,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931482045,
  "startTime" : 1714931482061,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3780.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3780"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015122"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1012_3780",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.066 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.068 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.068 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3780 check successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.069 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.069 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.069 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.070 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.071 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.072 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.072 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.073 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.073 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.073 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.073 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.073 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.074 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.074 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)24-05-03 13:45:22(TIMESTAMP)
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.074 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1012][TI-3780] - [WARN] 2024-05-06 01:51:22.075 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1012][TI-3780] - [ERROR] 2024-05-06 01:51:22.152 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: SQL task prepareStatementAndBind error
[WI-1012][TI-3780] - [ERROR] 2024-05-06 01:51:22.153 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3780] - [ERROR] 2024-05-06 01:51:22.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.154 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3780.log
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.156 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3780.log, fetch way: log 
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.157 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.162 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1012][TI-3780] - [INFO] 2024-05-06 01:51:22.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3780] - [INFO] 2024-05-06 01:51:22.934 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3780, success=true)
[WI-0][TI-3780] - [INFO] 2024-05-06 01:51:22.943 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3780, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:24.010 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3781, taskName=persist in postgresql, firstSubmitTime=1714931483983, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3781'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015123'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@4925178, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.012 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.013 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931484016
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3781
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3781,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931483983,
  "startTime" : 1714931484016,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3781.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3781"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015123"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1012_3781",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.018 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.018 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.018 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.027 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3781 check successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.029 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.029 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.039 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.039 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.039 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.039 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.039 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.040 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.040 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.041 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)24-05-03 13:45:22(TIMESTAMP)
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.041 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1012][TI-3781] - [WARN] 2024-05-06 01:51:24.042 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1012][TI-3781] - [ERROR] 2024-05-06 01:51:24.065 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: SQL task prepareStatementAndBind error
[WI-1012][TI-3781] - [ERROR] 2024-05-06 01:51:24.066 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3781] - [ERROR] 2024-05-06 01:51:24.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.067 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3781.log
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.067 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3781.log, fetch way: log 
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.067 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.067 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.069 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1012][TI-3781] - [INFO] 2024-05-06 01:51:24.070 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3781] - [INFO] 2024-05-06 01:51:24.947 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3781, success=true)
[WI-0][TI-3781] - [INFO] 2024-05-06 01:51:24.955 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3781, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:25.569 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.725552050473186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:26.092 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3782, taskName=persist in postgresql, firstSubmitTime=1714931486052, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3782'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015126'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6263f14f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.094 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.095 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931486096
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3782
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3782,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931486052,
  "startTime" : 1714931486096,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3782.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3782"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015126"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1012_3782",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.100 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.111 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3782 check successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.112 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.113 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.114 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.115 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.116 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.116 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)24-05-03 13:45:22(TIMESTAMP)
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.116 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1012][TI-3782] - [WARN] 2024-05-06 01:51:26.116 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1012][TI-3782] - [ERROR] 2024-05-06 01:51:26.201 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: SQL task prepareStatementAndBind error
[WI-1012][TI-3782] - [ERROR] 2024-05-06 01:51:26.202 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3782] - [ERROR] 2024-05-06 01:51:26.204 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.204 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3782.log
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.205 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3782.log, fetch way: log 
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.205 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.205 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.242 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1012][TI-3782] - [INFO] 2024-05-06 01:51:26.242 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:26.645 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.854054054054054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-3782] - [INFO] 2024-05-06 01:51:26.945 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3782, success=true)
[WI-0][TI-3782] - [INFO] 2024-05-06 01:51:26.953 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3782, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:28.018 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=3783, taskName=persist in postgresql, firstSubmitTime=1714931487998, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.11:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=55, appIds=null, processInstanceId=1012, scheduleTime=0, globalParams=[{"prop":"input_topic","direct":"IN","type":"VARCHAR","value":"gnews_filtered"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n","sqlType":"1","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/google_news'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, input_topic=Property{prop='input_topic', direct=IN, type=VARCHAR, value='gnews_filtered'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240506'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='3783'}, type=Property{prop='type', direct=IN, type=VARCHAR, value='article'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, filtered_data_message=Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, content=Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, url=Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240506015128'}, datetime=Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='1012'}, context=Property{prop='context', direct=IN, type=VARCHAR, value='context'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240505'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, authors=Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1bc54f0b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.019 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.020 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.021 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.021 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.021 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.021 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714931488021
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.021 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 1012_3783
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.022 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 3783,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714931487998,
  "startTime" : 1714931488021,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3783.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 55,
  "processInstanceId" : 1012,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"input_topic\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"gnews_filtered\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"INSERT INTO filtered_data_persistence\\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\\n\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/google_news"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "input_topic" : {
      "prop" : "input_topic",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "gnews_filtered"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "3783"
    },
    "type" : {
      "prop" : "type",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "article"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "filtered_data_message" : {
      "prop" : "filtered_data_message",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "content" : {
      "prop" : "content",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lolcontent"
    },
    "url" : {
      "prop" : "url",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "lol"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240506015128"
    },
    "datetime" : {
      "prop" : "datetime",
      "direct" : "IN",
      "type" : "TIMESTAMP",
      "value" : "24-05-03 13:45:22"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "1012"
    },
    "context" : {
      "prop" : "context",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "context"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240505"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "authors" : {
      "prop" : "authors",
      "direct" : "IN",
      "type" : "LIST",
      "value" : "[\"Erin Hale\", \"sss hale\"]"
    }
  },
  "taskAppId" : "1012_3783",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"datetime\",\"direct\":\"IN\",\"type\":\"TIMESTAMP\",\"value\":\"24-05-03 13:45:22\"},{\"prop\":\"context\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"context\"},{\"prop\":\"type\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"article\"},{\"prop\":\"filtered_data_message\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"},{\"prop\":\"content\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lolcontent\"},{\"prop\":\"url\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"lol\"},{\"prop\":\"authors\",\"direct\":\"IN\",\"type\":\"LIST\",\"value\":\"[\\\"Erin Hale\\\", \\\"sss hale\\\"]\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.029 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.029 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.030 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_55/1012/3783 check successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.030 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.030 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "INSERT INTO filtered_data_persistence\nVALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})\n",
  "sqlType" : 1,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"datetime","direct":"IN","type":"TIMESTAMP","value":"24-05-03 13:45:22"},{"prop":"context","direct":"IN","type":"VARCHAR","value":"context"},{"prop":"type","direct":"IN","type":"VARCHAR","value":"article"},{"prop":"filtered_data_message","direct":"IN","type":"VARCHAR","value":""},{"prop":"content","direct":"IN","type":"VARCHAR","value":"lolcontent"},{"prop":"url","direct":"IN","type":"VARCHAR","value":"lol"},{"prop":"authors","direct":"IN","type":"LIST","value":"[\"Erin Hale\", \"sss hale\"]"}] successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.031 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
', sqlType=1, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.032 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='datetime', direct=IN, type=TIMESTAMP, value='24-05-03 13:45:22'}, Property{prop='context', direct=IN, type=VARCHAR, value='context'}, Property{prop='type', direct=IN, type=VARCHAR, value='article'}, Property{prop='filtered_data_message', direct=IN, type=VARCHAR, value=''}, Property{prop='content', direct=IN, type=VARCHAR, value='lolcontent'}, Property{prop='url', direct=IN, type=VARCHAR, value='lol'}, Property{prop='authors', direct=IN, type=LIST, value='["Erin Hale", "sss hale"]'}] ,query max result limit  0
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.032 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: authors put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: content put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: url put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: context put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: type put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: datetime put in sqlParamsMap of content INSERT INTO filtered_data_persistence
VALUES (${authors}, ${content}, ${url}, ${context}, ${type}, ${datetime})
 successfully.
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : INSERT INTO filtered_data_persistence
VALUES (?,?, ?, ?, ?, ?, ?)

[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:Erin Hale(VARCHAR)sss hale(VARCHAR)lolcontent(VARCHAR)lol(VARCHAR)context(VARCHAR)article(VARCHAR)24-05-03 13:45:22(TIMESTAMP)
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.033 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-1012][TI-3783] - [WARN] 2024-05-06 01:51:28.034 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-1012][TI-3783] - [ERROR] 2024-05-06 01:51:28.071 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: SQL task prepareStatementAndBind error
[WI-1012][TI-3783] - [ERROR] 2024-05-06 01:51:28.072 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3783] - [ERROR] 2024-05-06 01:51:28.072 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.plugin.task.api.TaskException: SQL task prepareStatementAndBind error
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:396)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeUpdate(SqlTask.java:326)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:208)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
Caused by: java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]
	at java.sql.Timestamp.valueOf(Timestamp.java:237)
	at org.apache.dolphinscheduler.plugin.task.api.utils.ParameterUtils.setInParameter(ParameterUtils.java:150)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.prepareStatementAndBind(SqlTask.java:389)
	... 8 common frames omitted
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.072 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3783.log
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.072 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240506/13426477386080/55/1012/3783.log, fetch way: log 
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.073 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.073 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.080 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-1012][TI-3783] - [INFO] 2024-05-06 01:51:28.080 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-3783] - [INFO] 2024-05-06 01:51:28.952 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=3783, success=true)
[WI-0][TI-3783] - [INFO] 2024-05-06 01:51:29.015 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=3783, success=true)
[WI-0][TI-0] - [INFO] 2024-05-06 01:51:31.661 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8292682926829268 is over then the MaxCpuUsagePercentageThresholds 0.7
